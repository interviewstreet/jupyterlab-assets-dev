"use strict";(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[7808],{17808:(e,t,n)=>{n.r(t);n.d(t,{ToolbarItems:()=>U,default:()=>P,downloadPlugin:()=>j,openBrowserTabPlugin:()=>N,pathStatusPlugin:()=>O,savingStatusPlugin:()=>R});var o=n(49655);var a=n.n(o);var r=n(87447);var i=n.n(r);var s=n(78098);var l=n.n(s);var d=n(15115);var c=n.n(d);var u=n(68299);var m=n.n(u);var p=n(53825);var g=n.n(p);var v=n(50724);var f=n.n(v);var h=n(27425);var w=n.n(h);var _=n(10535);var b=n.n(_);var y=n(55172);var C=n.n(y);var x=n(19289);var D=n.n(x);var k=n(65178);var W=n.n(k);var F=n(37900);var S=n.n(F);var I;(function(e){e.clone="docmanager:clone";e.deleteFile="docmanager:delete-file";e.newUntitled="docmanager:new-untitled";e.open="docmanager:open";e.openBrowserTab="docmanager:open-browser-tab";e.reload="docmanager:reload";e.rename="docmanager:rename";e.del="docmanager:delete";e.duplicate="docmanager:duplicate";e.restoreCheckpoint="docmanager:restore-checkpoint";e.save="docmanager:save";e.saveAll="docmanager:save-all";e.saveAs="docmanager:save-as";e.download="docmanager:download";e.toggleAutosave="docmanager:toggle-autosave";e.showInFileBrowser="docmanager:show-in-file-browser"})(I||(I={}));const T="@jupyterlab/docmanager-extension:plugin";const E={id:"@jupyterlab/docmanager-extension:opener",description:"Provides the widget opener.",autoStart:true,provides:d.IDocumentWidgetOpener,activate:e=>{const{shell:t}=e;return new class{constructor(){this._opened=new x.Signal(this)}open(e,n){if(!e.id){e.id=`document-manager-${++z.id}`}e.title.dataset={type:"document-title",...e.title.dataset};if(!e.isAttached){t.add(e,"main",n||{})}if((n===null||n===void 0?void 0:n.activate)!==false){t.activateById(e.id)}this._opened.emit(e)}get opened(){return this._opened}}}};const A={id:"@jupyterlab/docmanager-extension:contexts",description:"Adds the handling of opened documents dirty state.",autoStart:true,requires:[d.IDocumentManager,d.IDocumentWidgetOpener],optional:[o.ILabStatus],activate:(e,t,n,o)=>{const a=new WeakSet;n.opened.connect(((e,n)=>{const r=t.contextForWidget(n);if(r&&!a.has(r)){if(o){J(o,r)}a.add(r)}}))}};const B={id:"@jupyterlab/docmanager-extension:manager",description:"Provides the document manager.",provides:d.IDocumentManager,requires:[d.IDocumentWidgetOpener],optional:[v.ITranslator,o.ILabStatus,r.ISessionContextDialogs,o.JupyterLab.IInfo],activate:(e,t,n,o,a,i)=>{var s;const{serviceManager:l,docRegistry:c}=e;const u=n!==null&&n!==void 0?n:v.nullTranslator;const m=a!==null&&a!==void 0?a:new r.SessionContextDialogs({translator:u});const p=e.restored.then((()=>void 0));const g=new d.DocumentManager({registry:c,manager:l,opener:t,when:p,setBusy:(s=o&&(()=>o.setBusy()))!==null&&s!==void 0?s:undefined,sessionDialogs:m,translator:u!==null&&u!==void 0?u:v.nullTranslator,isConnectedCallback:()=>{if(i){return i.isConnected}return true}});return g}};const M={id:T,description:"Adds commands and settings to the document manager.",autoStart:true,requires:[d.IDocumentManager,d.IDocumentWidgetOpener,u.ISettingRegistry],optional:[v.ITranslator,r.ICommandPalette,o.ILabShell],activate:(e,t,n,o,a,r,i)=>{a=a!==null&&a!==void 0?a:v.nullTranslator;const s=a.load("jupyterlab");const l=e.docRegistry;L(e,t,n,o,a,i,r);const d=n=>{const o=n.get("autosave").composite;t.autosave=o===true||o===false?o:true;e.commands.notifyCommandChanged(I.toggleAutosave);const a=n.get("confirmClosingDocument").composite;t.confirmClosingDocument=a!==null&&a!==void 0?a:true;const r=n.get("autosaveInterval").composite;t.autosaveInterval=r||120;const i=n.get("lastModifiedCheckMargin").composite;t.lastModifiedCheckMargin=i||500;const s=n.get("renameUntitledFileOnSave").composite;t.renameUntitledFileOnSave=s!==null&&s!==void 0?s:true;const d=n.get("defaultViewers").composite;const c={};Object.keys(d).forEach((e=>{if(!l.getFileType(e)){console.warn(`File Type ${e} not found`);return}if(!l.getWidgetFactory(d[e])){console.warn(`Document viewer ${d[e]} not found`)}c[e]=d[e]}));for(const e of l.fileTypes()){try{l.setDefaultWidgetFactory(e.name,c[e.name])}catch(u){console.warn(`Failed to set default viewer ${c[e.name]} for file type ${e.name}`)}}};Promise.all([o.load(T),e.restored]).then((([e])=>{e.changed.connect(d);d(e);const n=(t,n)=>{if(["autosave","autosaveInterval","confirmClosingDocument","lastModifiedCheckMargin","renameUntitledFileOnSave"].includes(n.name)&&e.get(n.name).composite!==n.newValue){e.set(n.name,n.newValue).catch((e=>{console.error(`Failed to set the setting '${n.name}':\n${e}`)}))}};t.stateChanged.connect(n)})).catch((e=>{console.error(e.message)}));o.transform(T,{fetch:e=>{const t=Array.from(l.fileTypes()).map((e=>e.name)).join("    \n");const n=Array.from(l.widgetFactories()).map((e=>e.name)).join("    \n");const o=s.__(`Overrides for the default viewers for file types.\nSpecify a mapping from file type name to document viewer name, for example:\n\ndefaultViewers: {\n  markdown: "Markdown Preview"\n}\n\nIf you specify non-existent file types or viewers, or if a viewer cannot\nopen a given file type, the override will not function.\n\nAvailable viewers:\n%1\n\nAvailable file types:\n%2`,n,t);const a=y.JSONExt.deepCopy(e.schema);a.properties.defaultViewers.description=o;return{...e,schema:a}}});l.changed.connect((()=>o.load(T,true)))}};const R={id:"@jupyterlab/docmanager-extension:saving-status",description:"Adds a saving status indicator.",autoStart:true,requires:[d.IDocumentManager,o.ILabShell],optional:[v.ITranslator,p.IStatusBar],activate:(e,t,n,o,a)=>{if(!a){return}const r=new d.SavingStatus({docManager:t,translator:o!==null&&o!==void 0?o:v.nullTranslator});r.model.widget=n.currentWidget;n.currentChanged.connect((()=>{r.model.widget=n.currentWidget}));a.registerStatusItem(R.id,{item:r,align:"middle",isActive:()=>r.model!==null&&r.model.status!==null,activeStateChanged:r.model.stateChanged})}};const O={id:"@jupyterlab/docmanager-extension:path-status",description:"Adds a file path indicator in the status bar.",autoStart:true,requires:[d.IDocumentManager,o.ILabShell],optional:[p.IStatusBar],activate:(e,t,n,o)=>{if(!o){return}const a=new d.PathStatus({docManager:t});a.model.widget=n.currentWidget;n.currentChanged.connect((()=>{a.model.widget=n.currentWidget}));o.registerStatusItem(O.id,{item:a,align:"right",rank:0})}};const j={id:"@jupyterlab/docmanager-extension:download",description:"Adds command to download files.",autoStart:true,requires:[d.IDocumentManager],optional:[v.ITranslator,r.ICommandPalette],activate:(e,t,n,o)=>{const a=(n!==null&&n!==void 0?n:v.nullTranslator).load("jupyterlab");const{commands:i,shell:s}=e;const l=()=>{const{currentWidget:e}=s;return!!(e&&t.contextForWidget(e))};i.addCommand(I.download,{label:a.__("Download"),caption:a.__("Download the file to your computer"),isEnabled:l,execute:()=>{if(l()){const e=t.contextForWidget(s.currentWidget);if(!e){return(0,r.showDialog)({title:a.__("Cannot Download"),body:a.__("No context found for current widget!"),buttons:[r.Dialog.okButton()]})}return e.download()}}});const d=a.__("File Operations");if(o){o.addItem({command:I.download,category:d})}}};const N={id:"@jupyterlab/docmanager-extension:open-browser-tab",description:"Adds command to open a browser tab.",autoStart:true,requires:[d.IDocumentManager],optional:[v.ITranslator],activate:(e,t,n)=>{const o=(n!==null&&n!==void 0?n:v.nullTranslator).load("jupyterlab");const{commands:a}=e;a.addCommand(I.openBrowserTab,{execute:e=>{const n=typeof e["path"]==="undefined"?"":e["path"];if(!n){return}return t.services.contents.getDownloadUrl(n).then((e=>{const t=window.open();if(t){t.opener=null;t.location.href=e}else{throw new Error("Failed to open new browser tab.")}}))},iconClass:e=>e["icon"]||"",label:()=>o.__("Open in New Browser Tab")})}};const $=[B,M,A,O,R,j,N,E];const P=$;var U;(function(e){function t(e,t){return(0,r.addCommandToolbarButtonClass)(r.ReactWidget.create(F.createElement(r.UseSignal,{signal:t},(()=>F.createElement(r.CommandToolbarButtonComponent,{commands:e,id:I.save,label:"",args:{toolbar:true}})))))}e.createSaveButton=t})(U||(U={}));class V extends k.Widget{constructor(e,t,n="notebook"){super({node:z.createRevertConfirmNode(e,n,t)})}}function q(e,t){if(!e){return"File"}const n=t.contextForWidget(e);if(!n){return""}const o=t.registry.getFileTypesForPath(n.path);return o.length&&o[0].displayName?o[0].displayName:"File"}function L(e,t,n,o,a,i,l){const d=a.load("jupyterlab");const{commands:c,shell:u}=e;const m=d.__("File Operations");const p=()=>{const{currentWidget:e}=u;return!!(e&&t.contextForWidget(e))};const g=()=>{var e;const{currentWidget:n}=u;if(!n){return false}const o=t.contextForWidget(n);return!!((e=o===null||o===void 0?void 0:o.contentsModel)===null||e===void 0?void 0:e.writable)};const v=e=>r.Notification.warning(d.__(`%1 is permissioned as read-only. Use "save as..." instead.`,e),{autoClose:5e3});if(i){H(e,t,i,n,a)}c.addCommand(I.deleteFile,{label:()=>`Delete ${q(u.currentWidget,t)}`,execute:e=>{const n=typeof e["path"]==="undefined"?"":e["path"];if(!n){const e=I.deleteFile;throw new Error(`A non-empty path is required for ${e}.`)}return t.deleteFile(n)}});c.addCommand(I.newUntitled,{execute:e=>{const n=e["error"]||d.__("Error");const o=typeof e["path"]==="undefined"?"":e["path"];const a={type:e["type"],path:o};if(e["type"]==="file"){a.ext=e["ext"]||".txt"}return t.services.contents.newUntitled(a).catch((e=>(0,r.showErrorMessage)(n,e)))},label:e=>e["label"]||`New ${e["type"]}`});c.addCommand(I.open,{execute:e=>{const n=typeof e["path"]==="undefined"?"":e["path"];const o=e["factory"]||void 0;const a=e===null||e===void 0?void 0:e.kernel;const r=e["options"]||void 0;return t.services.contents.get(n,{content:false}).then((()=>t.openOrReveal(n,o,a,r)))},iconClass:e=>e["icon"]||"",label:e=>{var t;return(t=e["label"]||e["factory"])!==null&&t!==void 0?t:d.__("Open the provided `path`.")},mnemonic:e=>e["mnemonic"]||-1});c.addCommand(I.reload,{label:()=>d.__("Reload %1 from Disk",q(u.currentWidget,t)),caption:d.__("Reload contents from disk"),isEnabled:p,execute:()=>{if(!p()){return}const e=t.contextForWidget(u.currentWidget);const n=q(u.currentWidget,t);if(!e){return(0,r.showDialog)({title:d.__("Cannot Reload"),body:d.__("No context found for current widget!"),buttons:[r.Dialog.okButton()]})}if(e.model.dirty){return(0,r.showDialog)({title:d.__("Reload %1 from Disk",n),body:d.__("Are you sure you want to reload the %1 from the disk?",n),buttons:[r.Dialog.cancelButton(),r.Dialog.warnButton({label:d.__("Reload")})]}).then((t=>{if(t.button.accept&&!e.isDisposed){return e.revert()}}))}else{if(!e.isDisposed){return e.revert()}}}});c.addCommand(I.restoreCheckpoint,{label:()=>d.__("Revert %1 to Checkpoint…",q(u.currentWidget,t)),caption:d.__("Revert contents to previous checkpoint"),isEnabled:p,execute:()=>{if(!p()){return}const e=t.contextForWidget(u.currentWidget);if(!e){return(0,r.showDialog)({title:d.__("Cannot Revert"),body:d.__("No context found for current widget!"),buttons:[r.Dialog.okButton()]})}return e.listCheckpoints().then((async n=>{const o=q(u.currentWidget,t);if(n.length<1){await(0,r.showErrorMessage)(d.__("No checkpoints"),d.__("No checkpoints are available for this %1.",o));return}const a=n.length===1?n[0]:await z.getTargetCheckpoint(n.reverse(),d);if(!a){return}return(0,r.showDialog)({title:d.__("Revert %1 to checkpoint",o),body:new V(a,d,o),buttons:[r.Dialog.cancelButton(),r.Dialog.warnButton({label:d.__("Revert"),ariaLabel:d.__("Revert to Checkpoint")})]}).then((t=>{if(e.isDisposed){return}if(t.button.accept){if(e.model.readOnly){return e.revert()}return e.restoreCheckpoint(a.id).then((()=>e.revert()))}}))}))}});const f=()=>{if(u.currentWidget){const e=t.contextForWidget(u.currentWidget);if(e===null||e===void 0?void 0:e.model.collaborative){return d.__("In collaborative mode, the document is saved automatically after every change")}if(!g()){return d.__(`document is permissioned readonly; "save" is disabled, use "save as..." instead`)}}return d.__("Save and create checkpoint")};const w=new WeakSet;c.addCommand(I.save,{label:()=>d.__("Save %1",q(u.currentWidget,t)),caption:f,icon:e=>e.toolbar?h.saveIcon:undefined,isEnabled:e=>{if(e._luminoEvent){return e._luminoEvent.type==="keybinding"?true:g()}else{return g()}},execute:async e=>{var n,a,i,l,c;const m=u.currentWidget;const g=t.contextForWidget(m);if(p()){if(!g){return(0,r.showDialog)({title:d.__("Cannot Save"),body:d.__("No context found for current widget!"),buttons:[r.Dialog.okButton()]})}else{if(w.has(g)){return}if(!((n=g.contentsModel)===null||n===void 0?void 0:n.writable)&&!g.model.collaborative){let t=(a=e._luminoEvent)===null||a===void 0?void 0:a.type;if(e._luminoEvent&&t==="keybinding"){v(g.path);return}else{return(0,r.showDialog)({title:d.__("Cannot Save"),body:d.__("Document is read-only"),buttons:[r.Dialog.okButton()]})}}w.add(g);const u=s.PathExt.basename((l=(i=g.contentsModel)===null||i===void 0?void 0:i.path)!==null&&l!==void 0?l:"");let p=u;if(t.renameUntitledFileOnSave&&m.isUntitled===true){const e=await r.InputDialog.getText({title:d.__("Rename file"),okLabel:d.__("Rename"),placeholder:d.__("File name"),text:u,selectionRange:u.length-s.PathExt.extname(u).length,checkbox:{label:d.__("Do not ask me again."),caption:d.__("If checked, you will not be asked to rename future untitled files when saving them.")}});if(e.button.accept){p=(c=e.value)!==null&&c!==void 0?c:u;m.isUntitled=false;if(typeof e.isChecked==="boolean"){const t=(await o.get(T,"renameUntitledFileOnSave")).composite;if(e.isChecked===t){o.set(T,"renameUntitledFileOnSave",!e.isChecked).catch((e=>{console.error(`Fail to set 'renameUntitledFileOnSave:\n${e}`)}))}}}}try{await g.save();if(!(m===null||m===void 0?void 0:m.isDisposed)){return g.createCheckpoint()}}catch(f){if(f.name==="ModalCancelError"){return}throw f}finally{w.delete(g);if(p!==u){await g.rename(p)}}}}}});c.addCommand(I.saveAll,{label:()=>d.__("Save All"),caption:d.__("Save all open documents"),isEnabled:()=>(0,_.some)(u.widgets("main"),(e=>{var n,o,a;return(a=(o=(n=t.contextForWidget(e))===null||n===void 0?void 0:n.contentsModel)===null||o===void 0?void 0:o.writable)!==null&&a!==void 0?a:false})),execute:()=>{var e;const n=[];const o=new Set;for(const a of u.widgets("main")){const r=t.contextForWidget(a);if(r&&!o.has(r.path)){if((e=r.contentsModel)===null||e===void 0?void 0:e.writable){o.add(r.path);n.push(r.save())}else{v(r.path)}}}return Promise.all(n)}});c.addCommand(I.saveAs,{label:()=>d.__("Save %1 As…",q(u.currentWidget,t)),caption:d.__("Save with new path"),isEnabled:p,execute:()=>{if(p()){const e=t.contextForWidget(u.currentWidget);if(!e){return(0,r.showDialog)({title:d.__("Cannot Save"),body:d.__("No context found for current widget!"),buttons:[r.Dialog.okButton()]})}const n=(n,o)=>{if(o.type==="save"&&o.newValue&&o.newValue.path!==e.path){void t.closeFile(e.path);void c.execute(I.open,{path:o.newValue.path})}};t.services.contents.fileChanged.connect(n);void e.saveAs().finally((()=>t.services.contents.fileChanged.disconnect(n)))}}});c.addCommand(I.toggleAutosave,{label:d.__("Autosave Documents"),isToggled:()=>t.autosave,execute:()=>{const e=!t.autosave;const n="autosave";return o.set(T,n,e).catch((e=>{console.error(`Failed to set ${T}:${n} - ${e.message}`)}))}});if(l){[I.reload,I.restoreCheckpoint,I.save,I.saveAs,I.toggleAutosave,I.duplicate].forEach((e=>{l.addItem({command:e,category:m})}))}}function H(e,t,n,o,a){const i=a.load("jupyterlab");const{commands:s}=e;const l=()=>{var o;const a=/[Pp]ath:\s?(.*)\n?/;const r=e=>{var t;return!!((t=e["title"])===null||t===void 0?void 0:t.match(a))};const i=e.contextMenuHitTest(r);const s=i===null||i===void 0?void 0:i["title"].match(a);return(o=s&&t.findWidget(s[1],null))!==null&&o!==void 0?o:n.currentWidget};const c=()=>{const{currentWidget:e}=n;return!!(e&&t.contextForWidget(e))};s.addCommand(I.clone,{label:()=>i.__("New View for %1",q(l(),t)),isEnabled:c,execute:e=>{const n=l();const a=e["options"]||{mode:"split-right"};if(!n){return}const r=t.cloneWidget(n);if(r){o.open(r,a)}}});s.addCommand(I.rename,{label:()=>{let e=q(l(),t);if(e){e=" "+e}return i.__("Rename%1…",e)},isEnabled:c,execute:()=>{if(c()){const e=t.contextForWidget(l());return(0,d.renameDialog)(t,e)}}});s.addCommand(I.duplicate,{label:()=>i.__("Duplicate %1",q(l(),t)),isEnabled:c,execute:()=>{if(c()){const e=t.contextForWidget(l());if(!e){return}return t.duplicate(e.path)}}});s.addCommand(I.del,{label:()=>i.__("Delete %1",q(l(),t)),isEnabled:c,execute:async()=>{if(c()){const n=t.contextForWidget(l());if(!n){return}const o=await(0,r.showDialog)({title:i.__("Delete"),body:i.__("Are you sure you want to delete %1",n.path),buttons:[r.Dialog.cancelButton(),r.Dialog.warnButton({label:i.__("Delete")})]});if(o.button.accept){await e.commands.execute("docmanager:delete-file",{path:n.path})}}}});s.addCommand(I.showInFileBrowser,{label:()=>i.__("Show in File Browser"),isEnabled:c,execute:async()=>{const e=l();const n=e&&t.contextForWidget(e);if(!n){return}await s.execute("filebrowser:activate",{path:n.path});await s.execute("filebrowser:go-to-path",{path:n.path})}})}function J(e,t){let n=null;const o=(t,o)=>{if(o.name==="dirty"){if(o.newValue===true){if(!n){n=e.setDirty()}}else if(n){n.dispose();n=null}}};void t.ready.then((()=>{t.model.stateChanged.connect(o);if(t.model.dirty){n=e.setDirty()}}));t.disposed.connect((()=>{if(n){n.dispose()}}))}var z;(function(e){e.id=0;function t(e,t,n){const o=document.createElement("div");const a=document.createElement("p");const r=document.createTextNode(n.__("Are you sure you want to revert the %1 to checkpoint? ",t));const i=document.createElement("strong");i.textContent=n.__("This cannot be undone.");a.appendChild(r);a.appendChild(i);const l=document.createElement("p");const d=document.createTextNode(n.__("The checkpoint was last updated at: "));const c=document.createElement("p");const u=new Date(e.last_modified);c.style.textAlign="center";c.textContent=s.Time.format(u)+" ("+s.Time.formatHuman(u)+")";l.appendChild(d);l.appendChild(c);o.appendChild(a);o.appendChild(l);return o}e.createRevertConfirmNode=t;async function n(e,t){const n=".";const o=e.map(((e,t)=>{const o=s.Time.format(e.last_modified);const a=s.Time.formatHuman(e.last_modified);return`${t}${n} ${o} (${a})`}));const a=(await r.InputDialog.getItem({items:o,title:t.__("Choose a checkpoint")})).value;if(!a){return}const i=a.split(n,1)[0];return e[parseInt(i,10)]}e.getTargetCheckpoint=n})(z||(z={}))}}]);
//# sourceMappingURL=7808.52538f9725cb01b498a5.js.map?v=52538f9725cb01b498a5