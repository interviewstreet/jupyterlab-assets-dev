(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[6462,5115],{36462:(e,t,o)=>{"use strict";o.r(t);o.d(t,{CellBarExtension:()=>u,CellToolbarTracker:()=>d});var l=o(67616);var n=o(24445);var i=o(47063);var a=o(8595);const s="jp-cell-toolbar";const r="jp-cell-menu";const c="jp-toolbar-overlap";class d{constructor(e,t){this._isDisposed=false;this._panel=e;this._previousActiveCell=this._panel.content.activeCell;this._toolbar=t;this._onToolbarChanged();this._toolbar.changed.connect(this._onToolbarChanged,this);void e.revealed.then((()=>this._onActiveCellChanged(e.content)));e.content.activeCellChanged.connect(this._onActiveCellChanged,this)}_onActiveCellChanged(e){if(this._previousActiveCell){this._removeToolbar(this._previousActiveCell.model)}const t=e.activeCell;if(!t){return}this._addToolbar(t.model);this._previousActiveCell=t;this._updateCellForToolbarOverlap(t)}get isDisposed(){return this._isDisposed}dispose(){var e;if(this.isDisposed){return}this._isDisposed=true;this._toolbar.changed.disconnect(this._onToolbarChanged,this);const t=(e=this._panel)===null||e===void 0?void 0:e.context.model.cells;if(t){(0,i.each)(t.iter(),(e=>this._removeToolbar(e)))}this._panel=null;a.Signal.clearData(this)}_addToolbar(e){const t=this._getCell(e);if(t){const e=new l.Toolbar;e.addClass(r);(0,i.toArray)(this._toolbar).forEach((({name:t,widget:o})=>{e.addItem(t,o)}));e.addClass(s);t.layout.insertWidget(0,e);t.displayChanged.connect(this._resizeEventCallback,this);t.model.contentChanged.connect(this._changedEventCallback,this)}}_getCell(e){var t;return(t=this._panel)===null||t===void 0?void 0:t.content.widgets.find((t=>t.model===e))}_findToolbarWidgets(e){const t=e.layout.widgets;return t.filter((e=>e.hasClass(s)))||[]}_removeToolbar(e){const t=this._getCell(e);if(t){this._findToolbarWidgets(t).forEach((e=>e.dispose()));t.displayChanged.disconnect(this._resizeEventCallback,this);t.model.contentChanged.disconnect(this._changedEventCallback,this)}}_onToolbarChanged(){var e;const t=(e=this._panel)===null||e===void 0?void 0:e.content.activeCell;if(t){this._removeToolbar(t.model);this._addToolbar(t.model)}}_changedEventCallback(){var e;const t=(e=this._panel)===null||e===void 0?void 0:e.content.activeCell;if(t===null||t===undefined){return}this._updateCellForToolbarOverlap(t)}_resizeEventCallback(){var e;const t=(e=this._panel)===null||e===void 0?void 0:e.content.activeCell;if(t===null||t===undefined){return}this._updateCellForToolbarOverlap(t)}_updateCellForToolbarOverlap(e){const t=e.node;t.classList.remove(c);if(this._cellToolbarOverlapsContents(e)){t.classList.add(c)}}_cellToolbarOverlapsContents(e){const t=e.model.type;const o=this._cellEditorWidgetLeft(e);const l=this._cellEditorWidgetRight(e);const n=this._cellToolbarLeft(e);if(n===null){return false}if((o+l)/2>n){return true}if(t==="markdown"&&e.rendered){return this._markdownOverlapsToolbar(e)}return this._codeOverlapsToolbar(e)}_markdownOverlapsToolbar(e){const t=e.inputArea;const o=t.renderedInput;const l=o.node;const n=l.firstElementChild;if(n===null){return false}const i=n.style.maxWidth;n.style.maxWidth="max-content";const a=n.getBoundingClientRect().right;n.style.maxWidth=i;const s=this._cellToolbarLeft(e);return s===null?false:a>s}_codeOverlapsToolbar(e){const t=e.editorWidget;const o=e.editor;if(o.lineCount<1){return false}const l=t.node.getElementsByClassName("CodeMirror-line");if(l.length<1){return false}const n=l[0].children[0].getBoundingClientRect().right;const i=this._cellToolbarLeft(e);return i===null?false:n>i}_cellEditorWidgetLeft(e){return e.editorWidget.node.getBoundingClientRect().left}_cellEditorWidgetRight(e){return e.editorWidget.node.getBoundingClientRect().right}_cellToolbarLeft(e){const t=this._findToolbarWidgets(e);if(t.length<1){return null}const o=t[0].node;return o.getBoundingClientRect().left}}const h=[{command:"notebook:duplicate-below",name:"duplicate-cell"},{command:"notebook:move-cell-up",name:"move-cell-up"},{command:"notebook:move-cell-down",name:"move-cell-down"},{command:"notebook:insert-cell-above",name:"insert-cell-above"},{command:"notebook:insert-cell-below",name:"insert-cell-below"},{command:"notebook:delete-cell",name:"delete-cell"}];class u{constructor(e,t){this._commands=e;this._toolbarFactory=t!==null&&t!==void 0?t:this.defaultToolbarFactory}get defaultToolbarFactory(){const e=(0,l.createDefaultFactory)(this._commands);return t=>new n.ObservableList({values:h.map((o=>({name:o.name,widget:e(u.FACTORY_NAME,t,o)})))})}createNew(e){return new d(e,this._toolbarFactory(e))}}u.FACTORY_NAME="Cell"}}]);
//# sourceMappingURL=6462.04aa03611328401f2dbd.js.map?v=04aa03611328401f2dbd