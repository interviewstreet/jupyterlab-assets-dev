(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[3093],{23093:(e,t,s)=>{"use strict";s.r(t);s.d(t,{AttachmentsCell:()=>Ue,AttachmentsCellModel:()=>Q,Cell:()=>Le,CellDragUtils:()=>c,CellFooter:()=>k,CellHeader:()=>S,CellModel:()=>K,CodeCell:()=>$e,CodeCellModel:()=>ee,Collapser:()=>y,ExecutionCountWidget:()=>R,InputArea:()=>H,InputCollapser:()=>v,InputPlaceholder:()=>le,InputPrompt:()=>V,MARKDOWN_HEADING_COLLAPSED:()=>Ae,MarkdownCell:()=>Te,MarkdownCellModel:()=>Z,OutputCollapser:()=>w,OutputPlaceholder:()=>ue,Placeholder:()=>de,RawCell:()=>Je,RawCellModel:()=>Y,isCodeCellModel:()=>G,isMarkdownCellModel:()=>q,isRawCellModel:()=>X});var n=s(47063);var a=s(997);const o=5;const i="jp-dragImage";const r="jp-dragImage-singlePrompt";const d="jp-dragImage-content";const l="jp-dragImage-prompt";const u="jp-dragImage-multipleBack";var c;(function(e){function t(e,t,s){let a=-1;while(e&&e.parentElement){if(s(e)){(0,n.each)(t,((t,s)=>{if(t.node===e){a=s;return false}}));break}e=e.parentElement}return a}e.findCell=t;function s(e,t){let s;if(e){if(e.editorWidget.node.contains(t)){s="input"}else if(e.promptNode.contains(t)){s="prompt"}else{s="cell"}}else{s="unknown"}return s}e.detectTargetArea=s;function c(e,t,s,n){const a=Math.abs(s-e);const i=Math.abs(n-t);return a>=o||i>=o}e.shouldStartDrag=c;function h(e,t){const s=t.length;let n;if(e.model.type==="code"){const t=e.model.executionCount;n=" ";if(t){n=t.toString()}}else{n=""}const o=e.model.value.text.split("\n")[0].slice(0,26);if(s>1){if(n!==""){return a.VirtualDOM.realize(a.h.div(a.h.div({className:i},a.h.span({className:l},"["+n+"]:"),a.h.span({className:d},o)),a.h.div({className:u},"")))}else{return a.VirtualDOM.realize(a.h.div(a.h.div({className:i},a.h.span({className:l}),a.h.span({className:d},o)),a.h.div({className:u},"")))}}else{if(n!==""){return a.VirtualDOM.realize(a.h.div(a.h.div({className:`${i} ${r}`},a.h.span({className:l},"["+n+"]:"),a.h.span({className:d},o))))}else{return a.VirtualDOM.realize(a.h.div(a.h.div({className:`${i} ${r}`},a.h.span({className:l}),a.h.span({className:d},o))))}}}e.createCellDragImage=h})(c||(c={}));var h=s(67616);var p=s(89650);var m=s(2411);const g="jp-Collapser";const f="jp-Collapser-child";const C="jp-InputCollapser";const _="jp-OutputCollapser";class y extends h.ReactWidget{constructor(){super();this.addClass(g)}get collapsed(){return false}render(){const e=f;return m.createElement("div",{className:e,onClick:e=>this.handleClick(e)})}}class v extends y{constructor(){super();this.addClass(C)}get collapsed(){var e;const t=(e=this.parent)===null||e===void 0?void 0:e.parent;if(t){return t.inputHidden}else{return false}}handleClick(e){var t;const s=(t=this.parent)===null||t===void 0?void 0:t.parent;if(s){s.inputHidden=!s.inputHidden}this.update()}}class w extends y{constructor(){super();this.addClass(_)}get collapsed(){var e;const t=(e=this.parent)===null||e===void 0?void 0:e.parent;if(t){return t.outputHidden}else{return false}}handleClick(e){var t,s;const n=(t=this.parent)===null||t===void 0?void 0:t.parent;if(n){n.outputHidden=!n.outputHidden;if(n.outputHidden){let e=(s=n.parent)===null||s===void 0?void 0:s.node;if(e){p.ElementExt.scrollIntoViewIfNeeded(e,n.node)}}}this.update()}}var b=s(18453);const x="jp-CellHeader";const O="jp-CellFooter";class S extends b.Widget{constructor(){super();this.addClass(x)}}class k extends b.Widget{constructor(){super();this.addClass(O)}}var E=s(41994);var j=s(72842);var D=s(29131);const M=3;class N extends h.ReactWidget{constructor(){super();this._collaborators=[]}get collaborators(){return this._collaborators}set collaborators(e){this._collaborators=e;this.update()}render(){const e=this._collaborators.slice(0,M);const t=e.length===M?this._collaborators.slice(M):[];return m.createElement("div",null,e.map((function(e,t){var s;return m.createElement(D.Tooltip,{content:e.name||"",key:e.userId},m.createElement("div",{style:{color:e.color,marginRight:4,fontWeight:"bold"}},(s=e.name)===null||s===void 0?void 0:s.charAt(0).toUpperCase()))})),t.length>0?m.createElement(D.Tooltip,{content:t.map((e=>e.name)).join(", ")},"..."):null)}}const A="jp-InputArea";const F="jp-InputArea-prompt";const W="jp-InputPrompt";const I="jp-InputArea-editor";const P="jp-ExecutionContent";class H extends b.Widget{constructor(e){super();this.addClass(A);const t=this.model=e.model;const s=this.contentFactory=e.contentFactory||H.defaultContentFactory;const n=this._prompt=s.createInputPrompt();n.addClass(F);const a={model:t,factory:s.editorFactory,updateOnShow:e.updateOnShow};const o=this._editor=new E.CodeEditorWrapper(a);o.addClass(I);const i=this.layout=new b.PanelLayout;i.addWidget(n);if(!e.placeholder){i.addWidget(o)}}get editorWidget(){return this._editor}get editor(){return this._editor.editor}get promptNode(){return this._prompt.node}get renderedInput(){return this._rendered}get collaborators(){return this._prompt.collaborators}set collaborators(e){this._prompt.collaborators=e}renderInput(e){const t=this.layout;if(this._rendered){this._rendered.parent=null}this._editor.hide();this._rendered=e;t.addWidget(e)}showEditor(){if(this._rendered){this._rendered.parent=null}this._editor.show()}setPrompt(e){this._prompt.executionCount=e}dispose(){if(this.isDisposed){return}this._prompt=null;this._editor=null;this._rendered=null;super.dispose()}}(function(e){class t{constructor(t={}){this._editor=t.editorFactory||e.defaultEditorFactory}get editorFactory(){return this._editor}createInputPrompt(){return new V}}e.ContentFactory=t;function s(){const e=new j.CodeMirrorEditorFactory;return e.newInlineEditor}e.defaultEditorFactory=s();e.defaultContentFactory=new t({})})(H||(H={}));class V extends b.Widget{constructor(){super();const e=this.layout=new b.PanelLayout;const t=this._collaboratorsWidget=new N;const s=this._executionCountWidget=new R;e.addWidget(s);e.addWidget(t);this.addClass(W)}get executionCount(){return this._executionCountWidget.executionCount}set executionCount(e){this._executionCountWidget.executionCount=e}get collaborators(){return this._collaboratorsWidget.collaborators}set collaborators(e){this._collaboratorsWidget.collaborators=e}}class R extends b.Widget{constructor(){super();this._executionCount=null;this.addClass(P)}get executionCount(){return this._executionCount}set executionCount(e){this._executionCount=e;if(e===null){this.node.textContent=" "}else{this.node.textContent=`[${e||" "}]:`}}}var B=s(98034);var L=s(8595);var $=s(66051);var U=s(76637);var T=s(95496);var J=undefined&&undefined.__rest||function(e,t){var s={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0)s[n]=e[n];if(e!=null&&typeof Object.getOwnPropertySymbols==="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++){if(t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a]))s[n[a]]=e[n[a]]}return s};const z=U.createMutex();function G(e){return e.type==="code"}function q(e){return e.type==="markdown"}function X(e){return e.type==="raw"}class K extends E.CodeEditor.Model{constructor(e){var t;super({modelDB:e.modelDB,id:e.id||((t=e.cell)===null||t===void 0?void 0:t.id)||B.UUID.uuid4()});this.contentChanged=new L.Signal(this);this.stateChanged=new L.Signal(this);this.value.changed.connect(this.onGenericChange,this);const s=this.modelDB.createValue("type");s.set(this.type);const n=this.modelDB.createMap("metadata");n.changed.connect(this.onModelDBMetadataChange,this);n.changed.connect(this.onGenericChange,this);const a=e.cell;const o=this.modelDB.createValue("trusted");o.changed.connect(this.onTrustedChanged,this);if(!a){o.set(false);return}o.set(!!a.metadata["trusted"]);delete a.metadata["trusted"];if(Array.isArray(a.source)){this.value.text=a.source.map((e=>e.replace(/\r\n/g,"\n").replace(/\r/g,"\n"))).join("")}else{this.value.text=a.source.replace(/\r\n/g,"\n").replace(/\r/g,"\n")}const i=B.JSONExt.deepCopy(a.metadata);if(this.type!=="raw"){delete i["format"]}if(this.type!=="code"){delete i["collapsed"];delete i["scrolled"]}for(const r in i){n.set(r,i[r])}}get type(){return"raw"}get id(){return this.sharedModel.getId()}get metadata(){return this.modelDB.get("metadata")}get trusted(){return this.modelDB.getValue("trusted")}set trusted(e){const t=this.trusted;if(t===e){return}this.modelDB.setValue("trusted",e)}toJSON(){const e=Object.create(null);for(const t of this.metadata.keys()){const s=JSON.parse(JSON.stringify(this.metadata.get(t)));e[t]=s}if(this.trusted){e["trusted"]=true}return{cell_type:this.type,source:this.value.text,metadata:e}}onTrustedChanged(e,t){}switchSharedModel(e,t){if(t){const t=e.getMetadata();if(t){this._updateModelDBMetadata(t)}}super.switchSharedModel(e,t)}onModelDBMetadataChange(e,t){const s=this.sharedModel.getMetadata();z((()=>{switch(t.type){case"add":this._changeCellMetadata(s,t);break;case"change":this._changeCellMetadata(s,t);break;case"remove":delete s[t.key];break;default:throw new Error(`Invalid event type: ${t.type}`)}this.sharedModel.setMetadata(s)}))}_changeCellMetadata(e,t){switch(t.key){case"jupyter":e.jupyter=t.newValue;break;case"collapsed":e.collapsed=t.newValue;break;case"name":e.name=t.newValue;break;case"scrolled":e.scrolled=t.newValue;break;case"tags":e.tags=t.newValue;break;case"trusted":e.trusted=t.newValue;break;default:e[t.key]=t.newValue}}_onSharedModelChanged(e,t){super._onSharedModelChanged(e,t);z((()=>{var e;if(t.metadataChange){const s=(e=t.metadataChange)===null||e===void 0?void 0:e.newValue;if(s){this._updateModelDBMetadata(s)}}if(t.collaboratorsChange){this.stateChanged.emit({name:"collaborators",oldValue:t.collaboratorsChange.oldValue,newValue:t.collaboratorsChange.newValue})}}))}_updateModelDBMetadata(e){Object.keys(e).map((t=>{switch(t){case"collapsed":this.metadata.set("collapsed",e.jupyter);break;case"jupyter":this.metadata.set("jupyter",e.jupyter);break;case"name":this.metadata.set("name",e.name);break;case"scrolled":this.metadata.set("scrolled",e.scrolled);break;case"tags":this.metadata.set("tags",e.tags);break;case"trusted":this.metadata.set("trusted",e.trusted);break;default:this.metadata.set(t,e[t])}}))}onGenericChange(){this.contentChanged.emit(void 0)}}class Q extends K{constructor(e){super(e);const t=e.contentFactory||Q.defaultContentFactory;let s;const n=e.cell;if(n&&(n.cell_type==="raw"||n.cell_type==="markdown")){s=n.attachments}this._attachments=t.createAttachmentsModel({values:s,modelDB:this.modelDB});this._attachments.stateChanged.connect(this.onGenericChange,this)}get attachments(){return this._attachments}toJSON(){const e=super.toJSON();if(this.attachments.length){e.attachments=this.attachments.toJSON()}return e}}(function(e){class t{createAttachmentsModel(e){return new $.AttachmentsModel(e)}}e.ContentFactory=t;e.defaultContentFactory=new t})(Q||(Q={}));class Y extends Q{get type(){return"raw"}toJSON(){const e=super.toJSON();e.id=this.id;return e}}class Z extends Q{constructor(e){super(e);this.mimeType="text/x-ipythongfm"}get type(){return"markdown"}toJSON(){const e=super.toJSON();e.id=this.id;return e}}class ee extends K{constructor(e){var t;super(e);this._executedCode="";this._isDirty=false;const s=e.contentFactory||ee.defaultContentFactory;const n=this.trusted;const a=e.cell;let o=[];const i=this.modelDB.createValue("executionCount");if(!i.get()){if(a&&a.cell_type==="code"){i.set(a.execution_count||null);o=(t=a.outputs)!==null&&t!==void 0?t:[];if(a.execution_count!=null){this._executedCode=this.value.text.trim()}}else{i.set(null)}}this.value.changed.connect(this._onValueChanged,this);i.changed.connect(this._onExecutionCountChanged,this);z((()=>{const e=this.sharedModel;e.setOutputs(o)}));this._outputs=s.createOutputArea({trusted:n,values:o});this._outputs.changed.connect(this.onGenericChange,this);this._outputs.changed.connect(this.onModelDBOutputsChange,this);this.metadata.changed.connect(te.collapseChanged,this);if(this.metadata.has("collapsed")){const e=this.metadata.get("collapsed");te.collapseChanged(this.metadata,{type:"change",key:"collapsed",oldValue:e,newValue:e})}else if(this.metadata.has("jupyter")){const e=this.metadata.get("jupyter");if(e.hasOwnProperty("outputs_hidden")){te.collapseChanged(this.metadata,{type:"change",key:"jupyter",oldValue:e,newValue:e})}}}switchSharedModel(e,t){if(t){this.clearExecution();e.getOutputs().forEach((e=>this._outputs.add(e)))}super.switchSharedModel(e,t)}get type(){return"code"}get executionCount(){return this.modelDB.has("executionCount")?this.modelDB.getValue("executionCount"):null}set executionCount(e){const t=this.executionCount;if(e===t){return}this.modelDB.setValue("executionCount",e||null)}get isDirty(){return this._isDirty}_setDirty(e){if(e!==this._isDirty){if(!e){this._executedCode=this.value.text.trim()}this._isDirty=e;this.stateChanged.emit({name:"isDirty",oldValue:!e,newValue:e})}}clearExecution(){this.outputs.clear();this.executionCount=null;this._setDirty(false);this.metadata.delete("execution")}get outputs(){return this._outputs}dispose(){if(this.isDisposed){return}this._outputs.dispose();this._outputs=null;super.dispose()}toJSON(){const e=super.toJSON();e.execution_count=this.executionCount||null;e.outputs=this.outputs.toJSON();e.id=this.id;return e}onTrustedChanged(e,t){if(this._outputs){this._outputs.trusted=t.newValue}this.stateChanged.emit({name:"trusted",oldValue:t.oldValue,newValue:t.newValue})}onModelDBOutputsChange(e,t){const s=this.sharedModel;z((()=>{switch(t.type){case"add":{const e=t.newValues.map((e=>e.toJSON()));s.updateOutputs(t.newIndex,t.newIndex+e.length,e);break}case"set":{const e=t.newValues.map((e=>e.toJSON()));s.updateOutputs(t.oldIndex,t.oldIndex+e.length,e);break}case"remove":s.updateOutputs(t.oldIndex,t.oldValues.length);break;default:throw new Error(`Invalid event type: ${t.type}`)}}))}_onValueChanged(){if(this.executionCount!==null){this._setDirty(this._executedCode!==this.value.text.trim())}}_onSharedModelChanged(e,t){super._onSharedModelChanged(e,t);z((()=>{if(t.outputsChange){this.clearExecution();e.getOutputs().forEach((e=>this._outputs.add(e)))}if(t.executionCountChange){this.executionCount=t.executionCountChange.newValue?t.executionCountChange.newValue:null}}))}_onExecutionCountChanged(e,t){const s=this.sharedModel;z((()=>{s.execution_count=t.newValue?t.newValue:null}));this.contentChanged.emit(void 0);this.stateChanged.emit({name:"executionCount",oldValue:t.oldValue,newValue:t.newValue});if(t.newValue&&this.isDirty){this._setDirty(false)}}}(function(e){class t{createOutputArea(e){return new T.OutputAreaModel(e)}}e.ContentFactory=t;e.defaultContentFactory=new t})(ee||(ee={}));var te;(function(e){function t(e,t){if(t.key==="collapsed"){const s=e.get("jupyter")||{};const{outputs_hidden:n}=s,a=J(s,["outputs_hidden"]);if(n!==t.newValue){if(t.newValue!==undefined){a["outputs_hidden"]=t.newValue}if(Object.keys(a).length===0){e.delete("jupyter")}else{e.set("jupyter",a)}}}else if(t.key==="jupyter"){const s=t.newValue||{};if(s.hasOwnProperty("outputs_hidden")){e.set("collapsed",s.outputs_hidden)}else{e.delete("collapsed")}}}e.collapseChanged=t})(te||(te={}));const se="jp-Placeholder";const ne="jp-Placeholder-prompt jp-InputPrompt";const ae="jp-Placeholder-prompt jp-OutputPrompt";const oe="jp-Placeholder-content";const ie="jp-InputPlaceholder";const re="jp-OutputPlaceholder";class de extends h.ReactWidget{constructor(e){super();this.addClass(se);this._callback=e}handleClick(e){const t=this._callback;t(e)}}class le extends de{constructor(e){super(e);this.addClass(ie)}render(){return[m.createElement("div",{className:ne,key:"input"}),m.createElement("div",{className:oe,onClick:e=>this.handleClick(e),key:"content"},m.createElement(D.ellipsesIcon.react,{className:"jp-MoreHorizIcon",elementPosition:"center",height:"auto",width:"32px"}))]}}class ue extends de{constructor(e){super(e);this.addClass(re)}render(){return[m.createElement("div",{className:ae,key:"output"}),m.createElement("div",{className:oe,onClick:e=>this.handleClick(e),key:"content"},m.createElement(D.ellipsesIcon.react,{className:"jp-MoreHorizIcon",elementPosition:"center",height:"auto",width:"32px"}))]}}var ce=s(87134);var he=s(66853);var pe=s(21464);var me=s(72245);const ge="jp-CellResizeHandle";const fe="jp-mod-resizedCell";class Ce extends b.Widget{constructor(e){super();this.targetNode=e;this._isActive=false;this._isDragging=false;this._protectedWidth=10;this.addClass(ge)}onAfterAttach(e){super.onAfterAttach(e);this.node.addEventListener("dblclick",this);this.node.addEventListener("mousedown",this)}onAfterDetach(e){super.onAfterAttach(e);this.node.removeEventListener("dblclick",this);this.node.removeEventListener("mousedown",this)}handleEvent(e){var t,s;switch(e.type){case"dblclick":(t=this.targetNode.parentNode)===null||t===void 0?void 0:t.childNodes.forEach((e=>{e.classList.remove(fe)}));document.documentElement.style.setProperty("--jp-side-by-side-resized-cell","");this._isActive=false;break;case"mousedown":this._mouseOffset=e.clientX-this.node.getBoundingClientRect().x;this._isDragging=true;if(!this._isActive){(s=this.targetNode.parentNode)===null||s===void 0?void 0:s.childNodes.forEach((e=>{e.classList.add(fe)}));this._isActive=true}window.addEventListener("mousemove",this);window.addEventListener("mouseup",this);break;case"mousemove":{if(!this._isActive||!this._isDragging){return}const t=this.targetNode.getBoundingClientRect();const s=e.clientX-t.x-this._mouseOffset;const n=1-Math.min(Math.max(s,this._protectedWidth),t.width-this._protectedWidth)/(t.width-this._protectedWidth);if(Math.round(n*100)%10==0){document.documentElement.style.setProperty("--jp-side-by-side-resized-cell",n+"fr")}break}case"mouseup":this._isDragging=false;window.removeEventListener("mousemove",this);window.removeEventListener("mouseup",this);break;default:break}}}const _e="jp-Cell";const ye="jp-Cell-header";const ve="jp-Cell-footer";const we="jp-Cell-inputWrapper";const be="jp-Cell-outputWrapper";const xe="jp-Cell-inputArea";const Oe="jp-Cell-outputArea";const Se="jp-Cell-inputCollapser";const ke="jp-Cell-outputCollapser";const Ee="jp-mod-readOnly";const je="jp-mod-dirty";const De="jp-CodeCell";const Me="jp-MarkdownCell";const Ne="jp-MarkdownOutput";const Ae="jp-MarkdownHeadingCollapsed";const Fe="jp-collapseHeadingButton";const We="jp-showHiddenCellsButton";const Ie="jp-RawCell";const Pe="jp-mod-rendered";const He="jp-mod-noOutputs";const Ve="Type Markdown and LaTeX: $ α^2 $";const Re=1e3;const Be="application/x-jupyter-icontentsrich";class Le extends b.Widget{constructor(e){super();this._displayChanged=new L.Signal(this);this._readOnly=false;this._inputHidden=false;this._syncCollapse=false;this._syncEditable=false;this._resizeDebouncer=new me.Debouncer((()=>{this._displayChanged.emit()}),0);this.addClass(_e);const t=this._model=e.model;const s=this.contentFactory=e.contentFactory||Le.defaultContentFactory;this.layout=new b.PanelLayout;const n=s.createCellHeader();n.addClass(ye);this.layout.addWidget(n);const a=this._inputWrapper=new b.Panel;a.addClass(we);const o=new v;o.addClass(Se);const i=this._input=new H({model:t,contentFactory:s,updateOnShow:e.updateEditorOnShow,placeholder:e.placeholder});i.addClass(xe);a.addWidget(o);a.addWidget(i);this.layout.addWidget(a);this._inputPlaceholder=new le((()=>{this.inputHidden=!this.inputHidden}));const r=this.contentFactory.createCellFooter();r.addClass(ve);this.layout.addWidget(r);if(e.editorConfig){this.editor.setOptions(Object.assign({},e.editorConfig))}t.metadata.changed.connect(this.onMetadataChanged,this);t.stateChanged.connect(this.onStateChanged,this)}initializeState(){this.loadCollapseState();this.loadEditableState();return this}get displayChanged(){return this._displayChanged}get promptNode(){if(!this._inputHidden){return this._input.promptNode}else{return this._inputPlaceholder.node.firstElementChild}}get editorWidget(){return this._input.editorWidget}get editor(){return this._input.editor}get model(){return this._model}get inputArea(){return this._input}get readOnly(){return this._readOnly}set readOnly(e){if(e===this._readOnly){return}this._readOnly=e;if(this.syncEditable){this.saveEditableState()}this.update()}saveEditableState(){const{metadata:e}=this.model;const t=e.get("editable");if(this.readOnly&&t===false||!this.readOnly&&t===undefined){return}if(this.readOnly){this.model.metadata.set("editable",false)}else{this.model.metadata.delete("editable")}}loadEditableState(){this.readOnly=this.model.metadata.get("editable")===false}get ready(){return Promise.resolve(undefined)}setPrompt(e){this._input.setPrompt(e)}get inputHidden(){return this._inputHidden}set inputHidden(e){if(this._inputHidden===e){return}const t=this._inputWrapper.layout;if(e){this._input.parent=null;t.addWidget(this._inputPlaceholder)}else{this._inputPlaceholder.parent=null;t.addWidget(this._input)}this._inputHidden=e;if(this.syncCollapse){this.saveCollapseState()}this.handleInputHidden(e)}saveCollapseState(){const e=Object.assign({},this.model.metadata.get("jupyter"));if(this.inputHidden&&e.source_hidden===true||!this.inputHidden&&e.source_hidden===undefined){return}if(this.inputHidden){e.source_hidden=true}else{delete e.source_hidden}if(Object.keys(e).length===0){this.model.metadata.delete("jupyter")}else{this.model.metadata.set("jupyter",e)}}loadCollapseState(){const e=this.model.metadata.get("jupyter")||{};this.inputHidden=!!e.source_hidden}handleInputHidden(e){return}get syncCollapse(){return this._syncCollapse}set syncCollapse(e){if(this._syncCollapse===e){return}this._syncCollapse=e;if(e){this.loadCollapseState()}}get syncEditable(){return this._syncEditable}set syncEditable(e){if(this._syncEditable===e){return}this._syncEditable=e;if(e){this.loadEditableState()}}clone(){const e=this.constructor;return new e({model:this.model,contentFactory:this.contentFactory,placeholder:false})}dispose(){if(this.isDisposed){return}this._input=null;this._model=null;this._inputWrapper=null;this._inputPlaceholder=null;super.dispose()}onStateChanged(e,t){switch(t.name){case"collaborators":this._input.collaborators=t.newValue;break;default:break}}onAfterAttach(e){this.update()}onActivateRequest(e){this.editor.focus()}onFitRequest(e){this.editor.refresh()}onResize(e){void this._resizeDebouncer.invoke()}onUpdateRequest(e){if(!this._model){return}if(this.editor.getOption("readOnly")!==this._readOnly){this.editor.setOption("readOnly",this._readOnly);this.toggleClass(Ee,this._readOnly)}}onMetadataChanged(e,t){switch(t.key){case"jupyter":if(this.syncCollapse){this.loadCollapseState()}break;case"editable":if(this.syncEditable){this.loadEditableState()}break;default:break}}}(function(e){class t{constructor(e={}){this._editorFactory=e.editorFactory||H.defaultEditorFactory}get editorFactory(){return this._editorFactory}createCellHeader(){return new S}createCellFooter(){return new k}createInputPrompt(){return new V}createOutputPrompt(){return new T.OutputPrompt}createStdin(e){return new T.Stdin(e)}}e.ContentFactory=t;e.defaultContentFactory=new t})(Le||(Le={}));class $e extends Le{constructor(e){super(e);this._outputHidden=false;this._syncScrolled=false;this._savingMetadata=false;this.addClass(De);const t=this._rendermime=e.rendermime;const s=this.contentFactory;const n=this.model;if(!e.placeholder){const a=this._outputWrapper=new b.Panel;a.addClass(be);const o=new w;o.addClass(ke);const i=this._output=new T.OutputArea({model:n.outputs,rendermime:t,contentFactory:s,maxNumberOutputs:e.maxNumberOutputs});i.addClass(Oe);if(n.outputs.length===0){this.addClass(He)}i.outputLengthChanged.connect(this._outputLengthHandler,this);a.addWidget(o);a.addWidget(i);this.layout.insertWidget(2,new Ce(this.node));this.layout.insertWidget(3,a);if(n.isDirty){this.addClass(je)}this._outputPlaceholder=new ue((()=>{this.outputHidden=!this.outputHidden}))}}initializeState(){super.initializeState();this.loadScrolledState();this.setPrompt(`${this.model.executionCount||""}`);return this}get outputArea(){return this._output}get outputHidden(){return this._outputHidden}set outputHidden(e){if(this._outputHidden===e){return}const t=this._outputWrapper.layout;if(e){t.removeWidget(this._output);t.addWidget(this._outputPlaceholder);if(this.inputHidden&&!this._outputWrapper.isHidden){this._outputWrapper.hide()}}else{if(this._outputWrapper.isHidden){this._outputWrapper.show()}t.removeWidget(this._outputPlaceholder);t.addWidget(this._output)}this._outputHidden=e;if(this.syncCollapse){this.saveCollapseState()}}saveCollapseState(){this._savingMetadata=true;try{super.saveCollapseState();const e=this.model.metadata;const t=this.model.metadata.get("collapsed");if(this.outputHidden&&t===true||!this.outputHidden&&t===undefined){return}if(this.outputHidden){e.set("collapsed",true)}else{e.delete("collapsed")}}finally{this._savingMetadata=false}}loadCollapseState(){super.loadCollapseState();this.outputHidden=!!this.model.metadata.get("collapsed")}get outputsScrolled(){return this._outputsScrolled}set outputsScrolled(e){this.toggleClass("jp-mod-outputsScrolled",e);this._outputsScrolled=e;if(this.syncScrolled){this.saveScrolledState()}}saveScrolledState(){const{metadata:e}=this.model;const t=e.get("scrolled");if(this.outputsScrolled&&t===true||!this.outputsScrolled&&t===undefined){return}if(this.outputsScrolled){e.set("scrolled",true)}else{e.delete("scrolled")}}loadScrolledState(){const e=this.model.metadata;if(e.get("scrolled")==="auto"){this.outputsScrolled=false}else{this.outputsScrolled=!!e.get("scrolled")}}get syncScrolled(){return this._syncScrolled}set syncScrolled(e){if(this._syncScrolled===e){return}this._syncScrolled=e;if(e){this.loadScrolledState()}}handleInputHidden(e){if(!e&&this._outputWrapper.isHidden){this._outputWrapper.show()}else if(e&&!this._outputWrapper.isHidden&&this._outputHidden){this._outputWrapper.hide()}}clone(){const e=this.constructor;return new e({model:this.model,contentFactory:this.contentFactory,rendermime:this._rendermime,placeholder:false})}cloneOutputArea(){return new T.SimplifiedOutputArea({model:this.model.outputs,contentFactory:this.contentFactory,rendermime:this._rendermime})}dispose(){if(this.isDisposed){return}this._output.outputLengthChanged.disconnect(this._outputLengthHandler,this);this._rendermime=null;this._output=null;this._outputWrapper=null;this._outputPlaceholder=null;super.dispose()}onStateChanged(e,t){super.onStateChanged(e,t);switch(t.name){case"executionCount":this.setPrompt(`${e.executionCount||""}`);break;case"isDirty":if(e.isDirty){this.addClass(je)}else{this.removeClass(je)}break;default:break}}onMetadataChanged(e,t){if(this._savingMetadata){return}switch(t.key){case"scrolled":if(this.syncScrolled){this.loadScrolledState()}break;case"collapsed":if(this.syncCollapse){this.loadCollapseState()}break;default:break}super.onMetadataChanged(e,t)}_outputLengthHandler(e,t){const s=t===0?true:false;this.toggleClass(He,s)}}(function(e){async function t(e,t,s){var n;const a=e.model;const o=a.value.text;if(!o.trim()||!((n=t.session)===null||n===void 0?void 0:n.kernel)){a.clearExecution();return}const i={cellId:a.id};s=Object.assign(Object.assign(Object.assign({},a.metadata.toJSON()),s),i);const{recordTiming:r}=s;a.clearExecution();e.outputHidden=false;e.setPrompt("*");a.trusted=true;let d;try{const n=T.OutputArea.execute(o,e.outputArea,t,s);if(r){const t=e=>{let t;switch(e.header.msg_type){case"status":t=`status.${e.content.execution_state}`;break;case"execute_input":t="execute_input";break;default:return true}const s=e.header.date||(new Date).toISOString();const n=Object.assign({},a.metadata.get("execution"));n[`iopub.${t}`]=s;a.metadata.set("execution",n);return true};e.outputArea.future.registerMessageHook(t)}else{a.metadata.delete("execution")}d=e.outputArea.future;const i=await n;a.executionCount=i.content.execution_count;if(r){const e=Object.assign({},a.metadata.get("execution"));const t=i.metadata.started;if(t){e["shell.execute_reply.started"]=t}const s=i.header.date;e["shell.execute_reply"]=s||(new Date).toISOString();a.metadata.set("execution",e)}return i}catch(l){if(d&&!e.isDisposed&&e.outputArea.future===d){e.setPrompt("")}throw l}}e.execute=t})($e||($e={}));class Ue extends Le{handleEvent(e){switch(e.type){case"paste":this._evtPaste(e);break;case"dragenter":e.preventDefault();break;case"dragover":e.preventDefault();break;case"drop":this._evtNativeDrop(e);break;case"lm-dragover":this._evtDragOver(e);break;case"lm-drop":this._evtDrop(e);break;default:break}}onAfterAttach(e){super.onAfterAttach(e);const t=this.node;t.addEventListener("lm-dragover",this);t.addEventListener("lm-drop",this);t.addEventListener("dragenter",this);t.addEventListener("dragover",this);t.addEventListener("drop",this);t.addEventListener("paste",this)}onBeforeDetach(e){const t=this.node;t.removeEventListener("drop",this);t.removeEventListener("dragover",this);t.removeEventListener("dragenter",this);t.removeEventListener("paste",this);t.removeEventListener("lm-dragover",this);t.removeEventListener("lm-drop",this)}_evtDragOver(e){const t=(0,n.some)(pe.imageRendererFactory.mimeTypes,(t=>{if(!e.mimeData.hasData(Be)){return false}const s=e.mimeData.getData(Be);return s.model.mimetype===t}));if(!t){return}e.preventDefault();e.stopPropagation();e.dropAction=e.proposedAction}_evtPaste(e){if(e.clipboardData){const t=e.clipboardData.items;for(let s=0;s<t.length;s++){if(t[s].type==="text/plain"){if(s<t.length-1&&t[s+1].kind==="file"){continue}t[s].getAsString((e=>{var t,s;(s=(t=this.editor).replaceSelection)===null||s===void 0?void 0:s.call(t,e)}))}this._attachFiles(e.clipboardData.items)}}e.preventDefault()}_evtNativeDrop(e){if(e.dataTransfer){this._attachFiles(e.dataTransfer.items)}e.preventDefault()}_evtDrop(e){const t=(0,n.toArray)((0,n.filter)(e.mimeData.types(),(t=>{if(t===Be){const t=e.mimeData.getData(Be);return pe.imageRendererFactory.mimeTypes.indexOf(t.model.mimetype)!==-1}return pe.imageRendererFactory.mimeTypes.indexOf(t)!==-1})));if(t.length===0){return}e.preventDefault();e.stopPropagation();if(e.proposedAction==="none"){e.dropAction="none";return}e.dropAction="copy";for(const s of t){if(s===Be){const{model:t,withContent:s}=e.mimeData.getData(Be);if(t.type==="file"){const e=this._generateURI(t.name);this.updateCellSourceWithAttachment(t.name,e);void s().then((t=>{this.model.attachments.set(e,{[t.mimetype]:t.content})}))}}else{const t=this._generateURI();this.model.attachments.set(t,{[s]:e.mimeData.getData(s)});this.updateCellSourceWithAttachment(t,t)}}}_attachFiles(e){for(let t=0;t<e.length;t++){const s=e[t];if(s.kind==="file"){const e=s.getAsFile();if(e){this._attachFile(e)}}}}_attachFile(e){const t=new FileReader;t.onload=s=>{const{href:n,protocol:a}=he.URLExt.parse(t.result);if(a!=="data:"){return}const o=/([\w+\/\+]+)?(?:;(charset=[\w\d-]*|base64))?,(.*)/;const i=o.exec(n);if(!i||i.length!==4){return}const r=i[1];const d=i[3];const l={[r]:d};const u=this._generateURI(e.name);if(r.startsWith("image/")){this.model.attachments.set(u,l);this.updateCellSourceWithAttachment(e.name,u)}};t.onerror=t=>{console.error(`Failed to attach ${e.name}`+t)};t.readAsDataURL(e)}_generateURI(e=""){const t=e.lastIndexOf(".");return t!==-1?B.UUID.uuid4().concat(e.substring(t)):B.UUID.uuid4()}}class Te extends Ue{constructor(e){var t,s,n;super(e);this._toggleCollapsedSignal=new L.Signal(this);this._renderer=null;this._rendered=true;this._prevText="";this._ready=new B.PromiseDelegate;this._showEditorForReadOnlyMarkdown=true;this.addClass(Me);this._rendermime=e.rendermime.clone({resolver:new $.AttachmentsResolver({parent:(t=e.rendermime.resolver)!==null&&t!==void 0?t:undefined,model:this.model.attachments})});this.editor.setOption("handlePaste",false);this._headingCollapsed=(s=this.model.metadata.get(Ae))!==null&&s!==void 0?s:false;this._monitor=new he.ActivityMonitor({signal:this.model.contentChanged,timeout:Re});this._monitor.activityStopped.connect((()=>{if(this._rendered){this.update()}}),this);void this._updateRenderedInput().then((()=>{this._ready.resolve(void 0)}));this.renderCollapseButtons(this._renderer);this.renderInput(this._renderer);this._showEditorForReadOnlyMarkdown=(n=e.showEditorForReadOnlyMarkdown)!==null&&n!==void 0?n:Te.defaultShowEditorForReadOnlyMarkdown}get ready(){return this._ready.promise}get headingInfo(){let e=this.model.value.text;const t=ce.TU.lexer(e);let s;for(s of t){if(s.type==="heading"){return{text:s.text,level:s.depth}}else if(s.type==="html"){let e=s.raw.match(/<h([1-6])(.*?)>(.*?)<\/h\1>/);if(e===null||e===void 0?void 0:e[3]){return{text:e[3],level:parseInt(e[1])}}return{text:"",level:-1}}}return{text:"",level:-1}}get headingCollapsed(){return this._headingCollapsed}set headingCollapsed(e){this._headingCollapsed=e;if(e){this.model.metadata.set(Ae,e)}else if(this.model.metadata.has(Ae)){this.model.metadata.delete(Ae)}const t=this.inputArea.promptNode.getElementsByClassName(Fe)[0];if(t){if(e){t.classList.add("jp-mod-collapsed")}else{t.classList.remove("jp-mod-collapsed")}}this.renderCollapseButtons(this._renderer)}get numberChildNodes(){return this._numberChildNodes}set numberChildNodes(e){this._numberChildNodes=e;this.renderCollapseButtons(this._renderer)}get toggleCollapsedSignal(){return this._toggleCollapsedSignal}get rendered(){return this._rendered}set rendered(e){if(this.readOnly&&this._showEditorForReadOnlyMarkdown===false){e=true}if(e===this._rendered){return}this._rendered=e;this._handleRendered();if(!this._rendered){this.editor.refresh()}this._displayChanged.emit()}get showEditorForReadOnly(){return this._showEditorForReadOnlyMarkdown}set showEditorForReadOnly(e){this._showEditorForReadOnlyMarkdown=e;if(e===false){this.rendered=true}}maybeCreateCollapseButton(){if(this.headingInfo.level>0&&this.inputArea.promptNode.getElementsByClassName(Fe).length==0){let e=this.inputArea.promptNode.appendChild(document.createElement("button"));e.className=`jp-Button ${Fe}`;e.setAttribute("data-heading-level",this.headingInfo.level.toString());if(this._headingCollapsed){e.classList.add("jp-mod-collapsed")}else{e.classList.remove("jp-mod-collapsed")}e.onclick=e=>{this.headingCollapsed=!this.headingCollapsed;this._toggleCollapsedSignal.emit(this._headingCollapsed)}}}maybeCreateOrUpdateExpandButton(){var e,t;const s=this.node.getElementsByClassName(We);if(this.headingCollapsed&&s.length===0&&this._numberChildNodes>0){const e=document.createElement("button");e.className=`bp3-button bp3-minimal jp-Button ${We}`;D.addIcon.render(e);const t=document.createElement("div");t.nodeValue=`${this._numberChildNodes} cell${this._numberChildNodes>1?"s":""} hidden`;e.appendChild(t);e.onclick=()=>{this.headingCollapsed=false;this._toggleCollapsedSignal.emit(this._headingCollapsed)};this.node.appendChild(e)}else if(((t=(e=s===null||s===void 0?void 0:s[0])===null||e===void 0?void 0:e.childNodes)===null||t===void 0?void 0:t.length)>1){if(this._headingCollapsed){s[0].childNodes[1].textContent=`${this._numberChildNodes} cell${this._numberChildNodes>1?"s":""} hidden`}else{for(const e of s){this.node.removeChild(e)}}}}renderCollapseButtons(e){this.node.classList.toggle(Ae,this._headingCollapsed);this.maybeCreateCollapseButton();this.maybeCreateOrUpdateExpandButton()}renderInput(e){this.addClass(Pe);this.renderCollapseButtons(e);this.inputArea.renderInput(e)}showEditor(){this.removeClass(Pe);this.inputArea.showEditor()}onUpdateRequest(e){this._handleRendered();super.onUpdateRequest(e)}updateCellSourceWithAttachment(e,t){var s,n;const a=`![${e}](attachment:${t!==null&&t!==void 0?t:e})`;(n=(s=this.editor).replaceSelection)===null||n===void 0?void 0:n.call(s,a)}_handleRendered(){if(!this._rendered){this.showEditor()}else{void this._updateRenderedInput();this.renderInput(this._renderer)}}_updateRenderedInput(){const e=this.model;const t=e&&e.value.text||Ve;if(t!==this._prevText){const e=new pe.MimeModel({data:{"text/markdown":t}});if(!this._renderer){this._renderer=this._rendermime.createRenderer("text/markdown");this._renderer.addClass(Ne)}this._prevText=t;return this._renderer.renderModel(e)}return Promise.resolve(void 0)}clone(){const e=this.constructor;return new e({model:this.model,contentFactory:this.contentFactory,rendermime:this._rendermime,placeholder:false})}}(function(e){e.defaultShowEditorForReadOnlyMarkdown=true})(Te||(Te={}));class Je extends Le{constructor(e){super(e);this.addClass(Ie)}clone(){const e=this.constructor;return new e({model:this.model,contentFactory:this.contentFactory,placeholder:false})}}}}]);
//# sourceMappingURL=3093.6a8972f7fd5d9c3a4f51.js.map?v=6a8972f7fd5d9c3a4f51