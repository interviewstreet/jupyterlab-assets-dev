(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[3202],{63202:(e,t,n)=>{"use strict";n.r(t);n.d(t,{CellTypeSwitcher:()=>b,CommandEditStatus:()=>E,ExecutionIndicator:()=>Ie,ExecutionIndicatorComponent:()=>Oe,INotebookTools:()=>ve,INotebookTracker:()=>be,INotebookWidgetFactory:()=>_e,KernelError:()=>g,Notebook:()=>he,NotebookActions:()=>f,NotebookModel:()=>M,NotebookModelFactory:()=>O,NotebookPanel:()=>pe,NotebookTools:()=>P,NotebookTracker:()=>ye,NotebookTrustStatus:()=>Se,NotebookWidgetFactory:()=>xe,StaticNotebook:()=>ce,ToolbarItems:()=>v});var o=n(67616);var s=n(37767);var i=n(70278);var l=n(47063);var a=n(98034);var r=n(89650);var d=n(8595);var c=n(2411);var h=n.n(c);const u="application/vnd.jupyter.cells";class g extends Error{constructor(e){const t=e;const n=t.ename;const o=t.evalue;super(`KernelReplyNotOK: ${n} ${o}`);this.errorName=n;this.errorValue=o;this.traceback=t.traceback;Object.setPrototypeOf(this,g.prototype)}}class f{static get executed(){return m.executed}static get executionScheduled(){return m.executionScheduled}static get selectionExecuted(){return m.selectionExecuted}constructor(){}}(function(e){function t(e){if(!e.model||!e.activeCell){return}if(!m.isNotebookRendered(e)){return}const t=m.getState(e);e.deselectAll();const n=e.model;const o=e.activeCellIndex;const s=e.widgets[o];const i=s.editor;const l=i.getSelections();const a=s.model.value.text;const r=[0];let d=-1;let c=-1;for(let m=0;m<l.length;m++){d=i.getOffsetAt(l[m].start);c=i.getOffsetAt(l[m].end);if(d<c){r.push(d);r.push(c)}else if(c<d){r.push(c);r.push(d)}else{r.push(d)}}r.push(a.length);const h=[];for(let C=0;C+1<r.length;C++){const e=m.cloneCell(n,s.model);h.push(e)}for(let m=0;m<h.length;m++){if(m!==h.length-1&&h[m].type==="code"){h[m].outputs.clear()}h[m].value.text=a.slice(r[m],r[m+1]).replace(/^\n+/,"").replace(/\n+$/,"")}const u=n.cells;u.beginCompoundOperation();for(let m=0;m<h.length;m++){if(m===0){u.set(o,h[m])}else{u.insert(o+m,h[m])}}u.endCompoundOperation();const g=d!==c?2:1;e.activeCellIndex=o+h.length-g;const f=e.activeCell.editor;f.focus();m.handleState(e,t)}e.splitCell=t;function n(e,t=false){if(!e.model||!e.activeCell){return}if(!m.isNotebookRendered(e)){return}const n=m.getState(e);const o=[];const i=[];const l=e.model;const a=l.cells;const r=e.activeCell;const d=e.activeCellIndex;const c={};e.widgets.forEach(((t,n)=>{if(e.isSelectedOrActive(t)){o.push(t.model.value.text);if(n!==d){i.push(t.model)}const e=t.model;if((0,s.isRawCellModel)(e)||(0,s.isMarkdownCellModel)(e)){for(const t of e.attachments.keys){c[t]=e.attachments.get(t).toJSON()}}}}));if(o.length===1){if(t===true){if(d===0){return}const e=a.get(d-1);o.unshift(e.value.text);i.push(e)}else if(t===false){if(d===a.length-1){return}const e=a.get(d+1);o.push(e.value.text);i.push(e)}}e.deselectAll();const h=m.cloneCell(l,r.model);h.value.text=o.join("\n\n");if((0,s.isCodeCellModel)(h)){h.outputs.clear()}else if((0,s.isMarkdownCellModel)(h)||(0,s.isRawCellModel)(h)){h.attachments.fromJSON(c)}a.beginCompoundOperation();a.set(d,h);i.forEach((e=>{a.removeValue(e)}));a.endCompoundOperation();if(r instanceof s.MarkdownCell){e.activeCell.rendered=false}m.handleState(e,n)}e.mergeCells=n;function d(e){if(!e.model||!e.activeCell){return}if(!m.isNotebookRendered(e)){return}const t=m.getState(e);m.deleteCells(e);m.handleState(e,t,true)}e.deleteCells=d;function h(e){if(!e.model||!e.activeCell){return}if(!m.isNotebookRendered(e)){return}const t=m.getState(e);const n=e.model;const o=n.contentFactory.createCell(e.notebookConfig.defaultCell,{});const s=e.activeCellIndex;n.cells.insert(s,o);e.activeCellIndex=s;e.deselectAll();m.handleState(e,t,true)}e.insertAbove=h;function g(e){if(!e.model||!e.activeCell){return}if(!m.isNotebookRendered(e)){return}const t=m.getState(e);const n=e.model;const o=n.contentFactory.createCell(e.notebookConfig.defaultCell,{});n.cells.insert(e.activeCellIndex+1,o);e.activeCellIndex++;e.deselectAll();m.handleState(e,t,true)}e.insertBelow=g;function f(e){if(!e.model||!e.activeCell){return}if(!m.isNotebookRendered(e)){return}const t=m.getState(e);const n=e.model.cells;const o=e.widgets;n.beginCompoundOperation();for(let s=n.length-2;s>-1;s--){if(e.isSelectedOrActive(o[s])){if(!e.isSelectedOrActive(o[s+1])){n.move(s,s+1);if(e.activeCellIndex===s){e.activeCellIndex++}e.select(o[s+1]);e.deselect(o[s])}}}n.endCompoundOperation();m.handleState(e,t,true)}e.moveDown=f;function C(e){if(!e.model||!e.activeCell){return}if(!m.isNotebookRendered(e)){return}const t=m.getState(e);const n=e.model.cells;const o=e.widgets;n.beginCompoundOperation();for(let s=1;s<n.length;s++){if(e.isSelectedOrActive(o[s])){if(!e.isSelectedOrActive(o[s-1])){n.move(s,s-1);if(e.activeCellIndex===s){e.activeCellIndex--}e.select(o[s-1]);e.deselect(o[s])}}}n.endCompoundOperation();m.handleState(e,t,true)}e.moveUp=C;function p(e,t){if(!e.model||!e.activeCell){return}const n=m.getState(e);m.changeCellType(e,t);m.handleState(e,n)}e.changeCellType=p;function _(e,t){if(!e.model||!e.activeCell){return Promise.resolve(false)}const n=m.getState(e);const o=m.runSelected(e,t);m.handleRunState(e,n,false);return o}e.run=_;function v(e,t){if(!e.model||!e.activeCell){return Promise.resolve(false)}const n=m.getState(e);const o=m.runSelected(e,t);const s=e.model;if(e.activeCellIndex===e.widgets.length-1){const t=s.contentFactory.createCell(e.notebookConfig.defaultCell,{});s.cells.insert(e.widgets.length,t);e.activeCellIndex++;e.mode="edit"}else{e.activeCellIndex++}m.handleRunState(e,n,true);return o}e.runAndAdvance=v;function b(e,t){if(!e.model||!e.activeCell){return Promise.resolve(false)}if(!m.isNotebookRendered(e)){return Promise.resolve(false)}const n=m.getState(e);const o=m.runSelected(e,t);const s=e.model;const i=s.contentFactory.createCell(e.notebookConfig.defaultCell,{});s.cells.insert(e.activeCellIndex+1,i);e.activeCellIndex++;e.mode="edit";m.handleRunState(e,n,true);return o}e.runAndInsert=b;function y(e,t){if(!e.model||!e.activeCell){return Promise.resolve(false)}const n=m.getState(e);e.widgets.forEach((t=>{e.select(t)}));const o=m.runSelected(e,t);m.handleRunState(e,n,true);return o}e.runAll=y;function k(e,t){if(!e.model||!e.activeCell){return Promise.resolve(false)}const n=e.activeCellIndex;const o=m.getState(e);e.widgets.forEach(((t,n)=>{if(t.model.type==="markdown"){e.select(t);e.activeCellIndex=n}}));if(e.activeCell.model.type!=="markdown"){return Promise.resolve(true)}const s=m.runSelected(e,t);e.activeCellIndex=n;m.handleRunState(e,o,true);return s}e.renderAllMarkdown=k;function w(e,t){const{activeCell:n,activeCellIndex:o,model:s}=e;if(!s||!n||o<1){return Promise.resolve(false)}const i=m.getState(e);e.activeCellIndex--;e.deselectAll();for(let a=0;a<e.activeCellIndex;++a){e.select(e.widgets[a])}const l=m.runSelected(e,t);e.activeCellIndex++;m.handleRunState(e,i,true);return l}e.runAllAbove=w;function S(e,t){if(!e.model||!e.activeCell){return Promise.resolve(false)}const n=m.getState(e);e.deselectAll();for(let s=e.activeCellIndex;s<e.widgets.length;++s){e.select(e.widgets[s])}const o=m.runSelected(e,t);m.handleRunState(e,n,true);return o}e.runAllBelow=S;function x(e,t){var n,o;if(!e.model||!e.activeCell){return}(o=(n=e.activeCell.editor).replaceSelection)===null||o===void 0?void 0:o.call(n,t)}e.replaceSelection=x;function M(e){if(!e.model||!e.activeCell){return}if(e.activeCellIndex===0){return}let t=e.activeCellIndex-1;while(t>=0){const n=e.widgets[t];if(!n.inputHidden&&!n.isHidden){break}t-=1}const n=m.getState(e);e.activeCellIndex=t;e.deselectAll();m.handleState(e,n,true)}e.selectAbove=M;function O(e){if(!e.model||!e.activeCell){return}let t=e.widgets.length-1;while(e.widgets[t].isHidden||e.widgets[t].inputHidden){t-=1}if(e.activeCellIndex===t){return}let n=e.activeCellIndex+1;while(n<t){let t=e.widgets[n];if(!t.inputHidden&&!t.isHidden){break}n+=1}const o=m.getState(e);e.activeCellIndex=n;e.deselectAll();m.handleState(e,o,true)}e.selectBelow=O;function I(e,t=false){if(!e.model||!e.activeCell){return}if(e.activeCellIndex===0){return}const n=m.getState(e);e.mode="command";if(t){e.extendContiguousSelectionTo(0)}else{e.extendContiguousSelectionTo(e.activeCellIndex-1)}m.handleState(e,n,true)}e.extendSelectionAbove=I;function A(e,t=false){if(!e.model||!e.activeCell){return}if(e.activeCellIndex===e.widgets.length-1){return}const n=m.getState(e);e.mode="command";if(t){e.extendContiguousSelectionTo(e.widgets.length-1)}else{e.extendContiguousSelectionTo(e.activeCellIndex+1)}m.handleState(e,n,true)}e.extendSelectionBelow=A;function E(e){if(!e.model||!e.activeCell){return}e.widgets.forEach((t=>{e.select(t)}))}e.selectAll=E;function T(e){if(!e.model||!e.activeCell){return}e.deselectAll()}e.deselectAll=T;function N(e){m.copyOrCut(e,false)}e.copy=N;function D(e){if(!m.isNotebookRendered(e)){return}m.copyOrCut(e,true)}e.cut=D;function R(e,t="below"){if(!m.isNotebookRendered(e)){return}const n=o.Clipboard.getInstance();if(!n.hasData(u)){return}const s=n.getData(u);P(e,t,s,true)}e.paste=R;function F(e,t="below"){const n=m.selectedCells(e);if(!n||n.length===0){return}P(e,t,n,false)}e.duplicate=F;function P(e,t="below",n,o=false){if(!e.model||!e.activeCell){return}const s=m.getState(e);const i=e.model;e.mode="command";const l=n.map((t=>{switch(t.cell_type){case"code":if(e.lastClipboardInteraction==="cut"&&typeof t.id==="string"){let e=t.id;return i.contentFactory.createCodeCell({id:e,cell:t})}else{return i.contentFactory.createCodeCell({cell:t})}case"markdown":return i.contentFactory.createMarkdownCell({cell:t});default:return i.contentFactory.createRawCell({cell:t})}}));const a=e.model.cells;let r;a.beginCompoundOperation();switch(t){case"below":r=e.activeCellIndex;break;case"belowSelected":e.widgets.forEach(((t,n)=>{if(e.isSelectedOrActive(t)){r=n}}));break;case"above":r=e.activeCellIndex-1;break;case"replace":{const t=[];e.widgets.forEach(((n,o)=>{const s=n.model.metadata.get("deletable")!==false;if(e.isSelectedOrActive(n)&&s){t.push(o)}}));if(t.length>0){t.reverse().forEach((e=>{a.remove(e)}))}r=t[0];break}default:break}l.forEach((e=>{a.insert(++r,e)}));a.endCompoundOperation();e.activeCellIndex+=l.length;e.deselectAll();if(o){e.lastClipboardInteraction="paste"}m.handleState(e,s)}function B(e){if(!e.model||!e.activeCell){return}if(!m.isNotebookRendered(e)){return}const t=m.getState(e);e.mode="command";e.model.sharedModel.undo();e.deselectAll();m.handleState(e,t)}e.undo=B;function j(e){if(!e.model||!e.activeCell){return}const t=m.getState(e);e.mode="command";e.model.sharedModel.redo();e.deselectAll();m.handleState(e,t)}e.redo=j;function L(e){if(!e.model||!e.activeCell){return}const t=m.getState(e);const n=e.editorConfig;const o=!(n.code.lineNumbers&&n.markdown.lineNumbers&&n.raw.lineNumbers);const s={code:Object.assign(Object.assign({},n.code),{lineNumbers:o}),markdown:Object.assign(Object.assign({},n.markdown),{lineNumbers:o}),raw:Object.assign(Object.assign({},n.raw),{lineNumbers:o})};e.editorConfig=s;m.handleState(e,t)}e.toggleAllLineNumbers=L;function V(e){if(!e.model||!e.activeCell){return}const t=m.getState(e);(0,l.each)(e.model.cells,((t,n)=>{const o=e.widgets[n];if(e.isSelectedOrActive(o)&&t.type==="code"){t.clearExecution();o.outputHidden=false}}));m.handleState(e,t,true)}e.clearOutputs=V;function H(e){if(!e.model||!e.activeCell){return}const t=m.getState(e);(0,l.each)(e.model.cells,((t,n)=>{const o=e.widgets[n];if(t.type==="code"){t.clearExecution();o.outputHidden=false}}));m.handleState(e,t,true)}e.clearAllOutputs=H;function W(e){if(!e.model||!e.activeCell){return}const t=m.getState(e);e.widgets.forEach((t=>{if(e.isSelectedOrActive(t)&&t.model.type==="code"){t.inputHidden=true}}));m.handleState(e,t)}e.hideCode=W;function J(e){if(!e.model||!e.activeCell){return}const t=m.getState(e);e.widgets.forEach((t=>{if(e.isSelectedOrActive(t)&&t.model.type==="code"){t.inputHidden=false}}));m.handleState(e,t)}e.showCode=J;function U(e){if(!e.model||!e.activeCell){return}const t=m.getState(e);e.widgets.forEach((e=>{if(e.model.type==="code"){e.inputHidden=true}}));m.handleState(e,t)}e.hideAllCode=U;function z(e){if(!e.model||!e.activeCell){return}const t=m.getState(e);e.widgets.forEach((e=>{if(e.model.type==="code"){e.inputHidden=false}}));m.handleState(e,t)}e.showAllCode=z;function K(e){if(!e.model||!e.activeCell){return}const t=m.getState(e);e.widgets.forEach((t=>{if(e.isSelectedOrActive(t)&&t.model.type==="code"){t.outputHidden=true}}));m.handleState(e,t,true)}e.hideOutput=K;function q(e){if(!e.model||!e.activeCell){return}const t=m.getState(e);e.widgets.forEach((t=>{if(e.isSelectedOrActive(t)&&t.model.type==="code"){t.outputHidden=false}}));m.handleState(e,t)}e.showOutput=q;function $(e){if(!e.model||!e.activeCell){return}const t=m.getState(e);e.widgets.forEach((e=>{if(e.model.type==="code"){e.outputHidden=true}}));m.handleState(e,t,true)}e.hideAllOutputs=$;function G(e){e.renderingLayout="side-by-side"}e.renderSideBySide=G;function Y(e){e.renderingLayout="default"}e.renderDefault=Y;function X(e){if(!e.model||!e.activeCell){return}const t=m.getState(e);e.widgets.forEach((e=>{if(e.model.type==="code"){e.outputHidden=false}}));m.handleState(e,t)}e.showAllOutputs=X;function Q(e){if(!e.model||!e.activeCell){return}const t=m.getState(e);e.widgets.forEach((t=>{if(e.isSelectedOrActive(t)&&t.model.type==="code"){t.outputsScrolled=true}}));m.handleState(e,t,true)}e.enableOutputScrolling=Q;function Z(e){if(!e.model||!e.activeCell){return}const t=m.getState(e);e.widgets.forEach((t=>{if(e.isSelectedOrActive(t)&&t.model.type==="code"){t.outputsScrolled=false}}));m.handleState(e,t)}e.disableOutputScrolling=Z;function ee(e){let t=null;let n=null;e.widgets.forEach(((e,o)=>{if(e.model.type==="code"){const s=e.model.metadata.get("execution");if(s&&a.JSONExt.isObject(s)&&s["iopub.status.busy"]!==undefined){const e=s["iopub.status.busy"].toString();if(e){const s=new Date(e);if(!t||s>=t){t=s;n=o}}}}}));if(n!==null){e.activeCellIndex=n}}e.selectLastRunCell=ee;function te(e,t){if(!e.model||!e.activeCell){return}const n=m.getState(e);const o=e.model.cells;t=Math.min(Math.max(t,1),6);e.widgets.forEach(((n,s)=>{if(e.isSelectedOrActive(n)){m.setMarkdownHeader(o.get(s),t)}}));m.changeCellType(e,"markdown");m.handleState(e,n)}e.setMarkdownHeader=te;function ne(t){for(const n of t.widgets){if(e.getHeadingInfo(n).isHeading){e.setHeadingCollapse(n,true,t);e.setCellCollapse(n,true)}}}e.collapseAll=ne;function oe(t){for(const n of t.widgets){if(e.getHeadingInfo(n).isHeading){e.setHeadingCollapse(n,false,t);e.setCellCollapse(n,false)}}}e.expandAllHeadings=oe;function se(e,t){const n=(0,l.findIndex)(t.widgets,((t,n)=>e.model.id===t.model.id));if(n===-1){return}if(n>=t.widgets.length){return}let o=ce(t.widgets[n]);for(let s=n-1;s>=0;s--){if(s<t.widgets.length){let e=ce(t.widgets[s]);if(e.isHeading&&e.headingLevel<o.headingLevel){return t.widgets[s]}}}return}function ie(e,t){let n=se(e,t);if(!n){return}if(!ce(n).collapsed&&!n.isHidden){return}if(n.isHidden){ie(n,t)}if(ce(n).collapsed){ae(n,false,t)}}e.expandParent=ie;function le(e,t){let n=(0,l.findIndex)(t.widgets,((t,n)=>e.model.id===t.model.id));if(n===-1){return-1}let o=ce(e);for(n=n+1;n<t.widgets.length;n++){let e=ce(t.widgets[n]);if(e.isHeading&&e.headingLevel<=o.headingLevel){return n}}return t.widgets.length}e.findNextParentHeading=le;function ae(t,n,o){const i=(0,l.findIndex)(o.widgets,((e,n)=>t.model.id===e.model.id));if(i===-1){return-1}if(!o.widgets.length){return i+1}let a=e.getHeadingInfo(t);if(t.isHidden||!(t instanceof s.MarkdownCell)||!a.isHeading){return i+1}let r=false;let d=0;let c;for(c=i+1;c<o.widgets.length;c++){let t=o.widgets[c];let s=e.getHeadingInfo(t);if(s.isHeading&&s.headingLevel<=a.headingLevel){c-=1;break}if(r&&s.isHeading&&s.headingLevel<=d){r=false}if(n||r){t.setHidden(true);continue}if(s.collapsed&&s.isHeading){r=true;d=s.headingLevel}t.setHidden(false)}if(c===o.widgets.length){t.numberChildNodes=c-i-1}else{t.numberChildNodes=c-i}e.setCellCollapse(t,n);return c+1}e.setHeadingCollapse=ae;function re(t){if(!t.activeCell||t.activeCellIndex===undefined){return}let n=e.getHeadingInfo(t.activeCell);if(n.isHeading){e.setHeadingCollapse(t.activeCell,!n.collapsed,t)}r.ElementExt.scrollIntoViewIfNeeded(t.node,t.activeCell.node)}e.toggleCurrentHeadingCollapse=re;function de(e,t){if(e instanceof s.MarkdownCell){e.headingCollapsed=t}else{e.setHidden(t)}}e.setCellCollapse=de;function ce(e){if(!(e instanceof s.MarkdownCell)){return{isHeading:false,headingLevel:7}}let t=e.headingInfo.level;let n=e.headingCollapsed;return{isHeading:t>0,headingLevel:t,collapsed:n}}e.getHeadingInfo=ce;function he(e,t){t=t||i.nullTranslator;const n=t.load("jupyterlab");if(!e.model){return Promise.resolve()}const s=(0,l.toArray)(e.model.cells);const a=s.every((e=>e.trusted));const r=c.createElement("p",null,n.__("A trusted Jupyter notebook may execute hidden malicious code when you open it."),c.createElement("br",null),n.__("Selecting trust will re-render this notebook in a trusted state."),c.createElement("br",null),n.__("For more information, see")," ",c.createElement("a",{href:"https://jupyter-server.readthedocs.io/en/stable/operators/security.html",target:"_blank",rel:"noopener noreferrer"},n.__("the Jupyter security documentation")));if(a){return(0,o.showDialog)({body:n.__("Notebook is already trusted"),buttons:[o.Dialog.okButton({label:n.__("Ok")})]}).then((()=>undefined))}return(0,o.showDialog)({body:r,title:n.__("Trust this notebook?"),buttons:[o.Dialog.cancelButton({label:n.__("Cancel")}),o.Dialog.warnButton({label:n.__("Ok")})]}).then((e=>{if(e.button.accept){s.forEach((e=>{e.trusted=true}))}}))}e.trust=he})(f||(f={}));var m;(function(e){e.executed=new d.Signal({});e.executionScheduled=new d.Signal({});e.selectionExecuted=new d.Signal({});function t(e){const t=e.translator;const n=t.load("jupyterlab");if(e.remainingCellToRenderCount!==0){(0,o.showDialog)({body:n.__(`Notebook is still rendering and has for now (%1) remaining cells to render.\n\nPlease wait for the complete rendering before invoking that action.`,e.remainingCellToRenderCount),buttons:[o.Dialog.okButton({label:n.__("Ok")})]}).catch((e=>{console.error("An error occurred when displaying notebook rendering warning",e)}));return false}return true}e.isNotebookRendered=t;function n(e){return{wasFocused:e.node.contains(document.activeElement),activeCell:e.activeCell}}e.getState=n;function a(e,t,n=false){const{activeCell:o,node:s}=e;if(t.wasFocused||e.mode==="edit"){e.activate()}if(n&&o){r.ElementExt.scrollIntoViewIfNeeded(s,o.node)}}e.handleState=a;function c(e,t,n=false){if(t.wasFocused||e.mode==="edit"){e.activate()}if(n&&t.activeCell){const n=t.activeCell.inputArea.node.getBoundingClientRect();e.scrollToPosition(n.bottom,45)}}e.handleRunState=c;function h(e,t){switch(t.type){case"code":return e.contentFactory.createCodeCell({cell:t.toJSON()});case"markdown":return e.contentFactory.createMarkdownCell({cell:t.toJSON()});default:return e.contentFactory.createRawCell({cell:t.toJSON()})}}e.cloneCell=h;function f(t,n){t.mode="command";let o=t.activeCellIndex;const s=t.widgets.filter(((e,n)=>{const s=t.isSelectedOrActive(e);if(s){o=n}return s}));t.activeCellIndex=o;t.deselectAll();return Promise.all(s.map((e=>m(t,e,n)))).then((n=>{if(t.isDisposed){return false}e.selectionExecuted.emit({notebook:t,lastCell:t.widgets[o]});t.update();return n.every((e=>e))})).catch((n=>{if(n.message.startsWith("KernelReplyNotOK")){s.map((e=>{if(e.model.type==="code"&&e.model.executionCount==null){e.setPrompt("")}}))}else{throw n}e.selectionExecuted.emit({notebook:t,lastCell:t.widgets[o]});t.update();return false}))}e.runSelected=f;function m(t,n,l,a){var r,d,c;a=a||i.nullTranslator;const h=a.load("jupyterlab");switch(n.model.type){case"markdown":n.rendered=true;n.inputHidden=false;e.executed.emit({notebook:t,cell:n,success:true});break;case"code":if(l){if(l.isTerminating){void(0,o.showDialog)({title:h.__("Kernel Terminating"),body:h.__("The kernel for %1 appears to be terminating. You can not run any cell for now.",(r=l.session)===null||r===void 0?void 0:r.path),buttons:[o.Dialog.okButton({label:h.__("Ok")})]});break}if(l.pendingInput){void(0,o.showDialog)({title:h.__("Cell not executed due to pending input"),body:h.__("The cell has not been executed to avoid kernel deadlock as there is another pending input! Submit your pending input and try again."),buttons:[o.Dialog.okButton({label:h.__("Ok")})]});return Promise.resolve(false)}if(l.hasNoKernel){void o.sessionContextDialogs.selectKernel(l);return Promise.resolve(false)}const i=(c=(d=t.model)===null||d===void 0?void 0:d.deletedCells)!==null&&c!==void 0?c:[];e.executionScheduled.emit({notebook:t,cell:n});return s.CodeCell.execute(n,l,{deletedCells:i,recordTiming:t.notebookConfig.recordTiming}).then((e=>{i.splice(0,i.length);if(n.isDisposed){return false}if(!e){return true}if(e.content.status==="ok"){const o=e.content;if(o.payload&&o.payload.length){C(o,t,n)}return true}else{throw new g(e.content)}})).catch((o=>{if(n.isDisposed||o.message.startsWith("Canceled")){return false}e.executed.emit({notebook:t,cell:n,success:false,error:o});throw o})).then((o=>{if(o){e.executed.emit({notebook:t,cell:n,success:true})}return o}))}n.model.clearExecution();break;default:break}return Promise.resolve(true)}function C(e,t,n){var o;const s=(o=e.payload)===null||o===void 0?void 0:o.filter((e=>e.source==="set_next_input"))[0];if(!s){return}const i=s.text;const a=s.replace;if(a){n.model.value.text=i;return}const r=t.model.contentFactory.createCodeCell({});const d=t.model.cells;const c=l.ArrayExt.firstIndexOf((0,l.toArray)(d),n.model);r.value.text=i;if(c===-1){d.push(r)}else{d.insert(c+1,r)}}function p(e){return e.widgets.filter((t=>e.isSelectedOrActive(t))).map((e=>e.model.toJSON())).map((e=>{if(e.metadata.deletable!==undefined){delete e.metadata.deletable}return e}))}e.selectedCells=p;function _(t,s){if(!t.model||!t.activeCell){return}const i=n(t);const l=o.Clipboard.getInstance();t.mode="command";l.clear();const r=e.selectedCells(t);l.setData(u,r);if(s){b(t)}else{t.deselectAll()}if(s){t.lastClipboardInteraction="cut"}else{t.lastClipboardInteraction="copy"}a(t,i)}e.copyOrCut=_;function v(e,t){const n=e.model;const o=n.cells;o.beginCompoundOperation();e.widgets.forEach(((s,i)=>{if(!e.isSelectedOrActive(s)){return}if(s.model.type!==t){const e=s.model.toJSON();let l;switch(t){case"code":l=n.contentFactory.createCodeCell({cell:e});break;case"markdown":l=n.contentFactory.createMarkdownCell({cell:e});if(s.model.type==="code"){l.trusted=false}break;default:l=n.contentFactory.createRawCell({cell:e});if(s.model.type==="code"){l.trusted=false}}o.set(i,l)}if(t==="markdown"){s=e.widgets[i];s.rendered=false}}));o.endCompoundOperation();e.deselectAll()}e.changeCellType=v;function b(e){const t=e.model;const n=t.cells;const o=[];e.mode="command";e.widgets.forEach(((n,s)=>{const i=n.model.metadata.get("deletable")!==false;if(e.isSelectedOrActive(n)&&i){o.push(s);t.deletedCells.push(n.model.id)}}));if(o.length>0){n.beginCompoundOperation();o.reverse().forEach((e=>{n.remove(e)}));if(!n.length){n.push(t.contentFactory.createCell(e.notebookConfig.defaultCell,{}))}n.endCompoundOperation();e.activeCellIndex=o[0]-o.length+1}e.deselectAll()}e.deleteCells=b;function y(e,t){let n=e.value.text;const o=/^(#+\s*)|^(\s*)/;const s=Array(t+1).join("#")+" ";const i=o.exec(n);if(i){n=n.slice(i[0].length)}e.value.text=s+n}e.setMarkdownHeader=y})(m||(m={}));var C=n(29131);const p="jp-Notebook-toolbarCellType";const _="jp-Notebook-toolbarCellTypeDropdown";var v;(function(e){function t(e,t){const n=(t||i.nullTranslator).load("jupyterlab");function s(){if(e.context.model.readOnly){return(0,o.showDialog)({title:n.__("Cannot Save"),body:n.__("Document is read-only"),buttons:[o.Dialog.okButton({label:n.__("Ok")})]})}void e.context.save().then((()=>{if(!e.isDisposed){return e.context.createCheckpoint()}}))}return(0,o.addToolbarButtonClass)(o.ReactWidget.create(c.createElement(o.UseSignal,{signal:e.context.fileChanged},(()=>c.createElement(o.ToolbarButtonComponent,{icon:C.saveIcon,onClick:s,tooltip:n.__("Save the notebook contents and create checkpoint"),enabled:!!(e&&e.context&&e.context.contentsModel&&e.context.contentsModel.writable)})))))}e.createSaveButton=t;function n(e,t){const n=(t||i.nullTranslator).load("jupyterlab");return new o.ToolbarButton({icon:C.addIcon,onClick:()=>{f.insertBelow(e.content)},tooltip:n.__("Insert a cell below")})}e.createInsertButton=n;function s(e,t){const n=(t||i.nullTranslator).load("jupyterlab");return new o.ToolbarButton({icon:C.cutIcon,onClick:()=>{f.cut(e.content)},tooltip:n.__("Cut the selected cells")})}e.createCutButton=s;function l(e,t){const n=(t||i.nullTranslator).load("jupyterlab");return new o.ToolbarButton({icon:C.copyIcon,onClick:()=>{f.copy(e.content)},tooltip:n.__("Copy the selected cells")})}e.createCopyButton=l;function a(e,t){const n=(t||i.nullTranslator).load("jupyterlab");return new o.ToolbarButton({icon:C.pasteIcon,onClick:()=>{f.paste(e.content)},tooltip:n.__("Paste cells from the clipboard")})}e.createPasteButton=a;function r(e,t){const n=(t||i.nullTranslator).load("jupyterlab");return new o.ToolbarButton({icon:C.runIcon,onClick:()=>{void f.runAndAdvance(e.content,e.sessionContext)},tooltip:n.__("Run the selected cells and advance")})}e.createRunButton=r;function d(e,t,n){const s=(n||i.nullTranslator).load("jupyterlab");return new o.ToolbarButton({icon:C.fastForwardIcon,onClick:()=>{void(t!==null&&t!==void 0?t:o.sessionContextDialogs).restart(e.sessionContext,n).then((t=>{if(t){void f.runAll(e.content,e.sessionContext)}return t}))},tooltip:s.__("Restart the kernel, then re-run the whole notebook")})}e.createRestartRunAllButton=d;function h(e,t){return new b(e.content,t)}e.createCellTypeItem=h;function u(e,i,c){return[{name:"save",widget:t(e,c)},{name:"insert",widget:n(e,c)},{name:"cut",widget:s(e,c)},{name:"copy",widget:l(e,c)},{name:"paste",widget:a(e,c)},{name:"run",widget:r(e,c)},{name:"interrupt",widget:o.Toolbar.createInterruptButton(e.sessionContext,c)},{name:"restart",widget:o.Toolbar.createRestartButton(e.sessionContext,i,c)},{name:"restart-and-run",widget:d(e,i,c)},{name:"cellType",widget:h(e,c)},{name:"spacer",widget:o.Toolbar.createSpacerItem()},{name:"kernelName",widget:o.Toolbar.createKernelNameItem(e.sessionContext,i,c)}]}e.getDefaultItems=u})(v||(v={}));class b extends o.ReactWidget{constructor(e,t){super();this.handleChange=e=>{if(e.target.value!=="-"){f.changeCellType(this._notebook,e.target.value);this._notebook.activate()}};this.handleKeyDown=e=>{if(e.keyCode===13){this._notebook.activate()}};this._trans=(t||i.nullTranslator).load("jupyterlab");this.addClass(p);this._notebook=e;if(e.model){this.update()}e.activeCellChanged.connect(this.update,this);e.selectionChanged.connect(this.update,this)}render(){let e="-";if(this._notebook.activeCell){e=this._notebook.activeCell.model.type}for(const t of this._notebook.widgets){if(this._notebook.isSelectedOrActive(t)){if(t.model.type!==e){e="-";break}}}return c.createElement(C.HTMLSelect,{className:_,onChange:this.handleChange,onKeyDown:this.handleKeyDown,value:e,"aria-label":this._trans.__("Cell type"),title:this._trans.__("Select the cell type")},c.createElement("option",{value:"-"},"-"),c.createElement("option",{value:"code"},this._trans.__("Code")),c.createElement("option",{value:"markdown"},this._trans.__("Markdown")),c.createElement("option",{value:"raw"},this._trans.__("Raw")))}}var y=n(63738);var k=n(24445);var w=n(76637);class S{constructor(e,t,n){this._mutex=w.createMutex();this._isDisposed=false;this._changed=new d.Signal(this);this._factory=t;this._cellOrder=e.createList("cellOrder");this._cellMap=new k.ObservableMap;this._cellOrder.changed.connect(this._onOrderChanged,this);this.nbmodel=n;this.nbmodel.changed.connect(this.onSharedModelChanged,this);this.changed.connect(this.onModelDBChanged,this)}onModelDBChanged(e,t){this._mutex((()=>{const e=this.nbmodel;e.transact((()=>{if(t.type==="set"||t.type==="remove"){e.deleteCellRange(t.oldIndex,t.oldIndex+t.oldValues.length)}if(t.type==="set"||t.type==="add"||t.type==="move"){const n=t.newValues.map((e=>e.sharedModel.clone()));let o=t.newIndex;if(t.type==="move"&&o>t.oldIndex){o+=t.oldValues.length}e.insertCells(o,n);t.newValues.forEach(((e,t)=>{e.switchSharedModel(n[t],false)}))}if(t.type==="move"){let n=t.oldIndex;if(n>=t.newIndex){n+=t.oldValues.length}e.deleteCellRange(n,n+t.oldValues.length)}}))}))}onSharedModelChanged(e,t){this._mutex((()=>{var e;let n=0;(e=t.cellsChange)===null||e===void 0?void 0:e.forEach((e=>{if(e.insert!=null){const t=e.insert.map((e=>{const t=this._factory.createCell(e.cell_type,{});t.switchSharedModel(e,true);return t}));this.insertAll(n,t);n+=e.insert.length}else if(e.delete!=null){this.removeRange(n,n+e.delete)}else if(e.retain!=null){n+=e.retain}}))}))}get changed(){return this._changed}get isDisposed(){return this._isDisposed}get isEmpty(){return this._cellOrder.length===0}get length(){return this._cellOrder.length}iter(){const e=[];for(const t of(0,l.toArray)(this._cellOrder)){e.push(this._cellMap.get(t))}return new l.ArrayIterator(e)}dispose(){if(this._isDisposed){return}this._isDisposed=true;d.Signal.clearData(this);for(const e of this._cellMap.values()){e.dispose()}this._cellMap.dispose();this._cellOrder.dispose()}get(e){return this._cellMap.get(this._cellOrder.get(e))}set(e,t){this._cellMap.set(t.id,t);this._cellOrder.set(e,t.id)}push(e){this._cellMap.set(e.id,e);const t=this._cellOrder.push(e.id);return t}insert(e,t){this._cellMap.set(t.id,t);this._cellOrder.insert(e,t.id)}removeValue(e){const t=l.ArrayExt.findFirstIndex((0,l.toArray)(this._cellOrder),(t=>this._cellMap.get(t)===e));this.remove(t);return t}remove(e){const t=this._cellOrder.get(e);this._cellOrder.remove(e);const n=this._cellMap.get(t);return n}clear(){this._cellOrder.clear()}move(e,t){this._cellOrder.move(e,t)}pushAll(e){const t=(0,l.toArray)(e);(0,l.each)(t,(e=>{this._cellMap.set(e.id,e);this._cellOrder.push(e.id)}));return this.length}insertAll(e,t){const n=(0,l.toArray)(t);(0,l.each)(n,(t=>{this._cellMap.set(t.id,t);this._cellOrder.beginCompoundOperation();this._cellOrder.insert(e++,t.id);this._cellOrder.endCompoundOperation()}));return this.length}removeRange(e,t){this._cellOrder.removeRange(e,t);return this.length}get canRedo(){return this.nbmodel.canRedo()}get canUndo(){return this.nbmodel.canUndo()}beginCompoundOperation(e){this._cellOrder.beginCompoundOperation(e)}endCompoundOperation(){this._cellOrder.endCompoundOperation()}undo(){this.nbmodel.undo()}redo(){this.nbmodel.redo()}clearUndo(){this.nbmodel.clearUndoHistory()}_onOrderChanged(e,t){if(t.type==="add"||t.type==="set"){(0,l.each)(t.newValues,(e=>{const t=this._cellMap.get(e);if(t==null){const t=this._factory.modelDB;const n=t.createValue(e+".type");let o;switch(n.get()){case"code":o=this._factory.createCodeCell({id:e});break;case"markdown":o=this._factory.createMarkdownCell({id:e});break;default:o=this._factory.createRawCell({id:e});break}this._cellMap.set(e,o)}else if(!t.sharedModel.isStandalone){this._mutex((()=>{const n=t.toJSON();let o=null;switch(n.cell_type){case"code":o=this._factory.createCodeCell({cell:n});break;case"markdown":o=this._factory.createMarkdownCell({cell:n});break;default:o=this._factory.createRawCell({cell:n});break}this._cellMap.set(e,o)}))}}))}const n=[];const o=[];(0,l.each)(t.newValues,(e=>{n.push(this._cellMap.get(e))}));(0,l.each)(t.oldValues,(e=>{o.push(this._cellMap.get(e))}));this._changed.emit({type:t.type,oldIndex:t.oldIndex,newIndex:t.newIndex,oldValues:o,newValues:n})}}const x=["kernelspec","language_info"];class M{constructor(e={}){this._modelDBMutex=w.createMutex();this._readOnly=false;this._contentChanged=new d.Signal(this);this._stateChanged=new d.Signal(this);this._nbformat=y.MAJOR_VERSION;this._nbformatMinor=y.MINOR_VERSION;this._isDisposed=false;if(e.modelDB){this.modelDB=e.modelDB}else{this.modelDB=new k.ModelDB}this.sharedModel=w.YNotebook.create(e.disableDocumentWideUndoRedo||false);this._isInitialized=e.isInitialized===false?false:true;const t=e.contentFactory||M.defaultContentFactory;this.contentFactory=t.clone(this.modelDB.view("cells"));this._cells=new S(this.modelDB,this.contentFactory,this.sharedModel);this._trans=(e.translator||i.nullTranslator).load("jupyterlab");this._cells.changed.connect(this._onCellsChanged,this);const n=this.modelDB.createMap("metadata");if(!n.has("language_info")){const t=e.languagePreference||"";n.set("language_info",{name:t})}this._ensureMetadata();n.changed.connect(this._onMetadataChanged,this);this._deletedCells=[];this.sharedModel.dirty=false;this.sharedModel.changed.connect(this._onStateChanged,this)}get contentChanged(){return this._contentChanged}get stateChanged(){return this._stateChanged}get dirty(){return this.sharedModel.dirty}set dirty(e){if(e===this.dirty){return}this.sharedModel.dirty=e}get readOnly(){return this._readOnly}set readOnly(e){if(e===this._readOnly){return}const t=this._readOnly;this._readOnly=e;this.triggerStateChange({name:"readOnly",oldValue:t,newValue:e})}get metadata(){return this.modelDB.get("metadata")}get cells(){return this._cells}get nbformat(){return this._nbformat}get nbformatMinor(){return this._nbformatMinor}get defaultKernelName(){const e=this.metadata.get("kernelspec");return e?e.name:""}get deletedCells(){return this._deletedCells}get isInitialized(){return this._isInitialized}get defaultKernelLanguage(){const e=this.metadata.get("language_info");return e?e.name:""}dispose(){if(this.isDisposed){return}const e=this.cells;this._cells=null;e.dispose();this._isDisposed=true;d.Signal.clearData(this)}toString(){return JSON.stringify(this.toJSON())}fromString(e){this.fromJSON(JSON.parse(e))}toJSON(){var e,t;const n=[];for(let s=0;s<((t=(e=this.cells)===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:0);s++){const e=this.cells.get(s).toJSON();if(this._nbformat===4&&this._nbformatMinor<=4){delete e.id}n.push(e)}this._ensureMetadata();const o=this.sharedModel.getMetadata();for(const s of this.metadata.keys()){o[s]=JSON.parse(JSON.stringify(this.metadata.get(s)))}return{metadata:o,nbformat_minor:this._nbformatMinor,nbformat:this._nbformat,cells:n}}fromJSON(e){const t=[];const n=this.contentFactory;const s=e.nbformat===4&&e.nbformat_minor>=5;for(const o of e.cells){const e={cell:o};if(s){e.id=o.id}switch(o.cell_type){case"code":t.push(n.createCodeCell(e));break;case"markdown":t.push(n.createMarkdownCell(e));break;case"raw":t.push(n.createRawCell(e));break;default:continue}}this.cells.beginCompoundOperation();this.cells.clear();this.cells.pushAll(t);this.cells.endCompoundOperation();this.sharedModel.nbformat_minor=y.MINOR_VERSION;this.sharedModel.nbformat=y.MAJOR_VERSION;const i=e.metadata.orig_nbformat;if(e.nbformat!==this._nbformat){this.sharedModel.nbformat=e.nbformat}if(e.nbformat_minor>this._nbformatMinor){this.sharedModel.nbformat_minor=e.nbformat_minor}if(i!==undefined&&this._nbformat!==i){const e=this._nbformat>i;let t;if(e){t=this._trans.__(`This notebook has been converted from an older notebook format (v%1)\nto the current notebook format (v%2).\nThe next time you save this notebook, the current notebook format (v%2) will be used.\n'Older versions of Jupyter may not be able to read the new format.' To preserve the original format version,\nclose the notebook without saving it.`,i,this._nbformat)}else{t=this._trans.__(`This notebook has been converted from an newer notebook format (v%1)\nto the current notebook format (v%2).\nThe next time you save this notebook, the current notebook format (v%2) will be used.\nSome features of the original notebook may not be available.' To preserve the original format version,\nclose the notebook without saving it.`,i,this._nbformat)}void(0,o.showDialog)({title:this._trans.__("Notebook converted"),body:t,buttons:[o.Dialog.okButton({label:this._trans.__("Ok")})]})}this.metadata.clear();const l=e.metadata;for(const o in l){if(o==="orig_nbformat"){continue}this.metadata.set(o,l[o])}this._ensureMetadata();this.dirty=true}initialize(){if(!this.cells.length){const e=this.contentFactory;this.cells.push(e.createCodeCell({}))}this._isInitialized=true;this.cells.clearUndo()}_onCellsChanged(e,t){switch(t.type){case"add":t.newValues.forEach((e=>{e.contentChanged.connect(this.triggerContentChange,this)}));break;case"remove":break;case"set":t.newValues.forEach((e=>{e.contentChanged.connect(this.triggerContentChange,this)}));break;default:break}this.triggerContentChange()}_onStateChanged(e,t){if(t.stateChange){t.stateChange.forEach((e=>{if(e.name==="nbformat"){this._nbformat=e.newValue}if(e.name==="nbformatMinor"){this._nbformatMinor=e.newValue}if(e.name!=="dirty"||e.oldValue!==e.newValue){this.triggerStateChange(e)}}))}if(t.metadataChange){const e=t.metadataChange.newValue;this._modelDBMutex((()=>{Object.entries(e).forEach((([e,t])=>{this.metadata.set(e,t)}))}))}}_onMetadataChanged(e,t){if(!x.includes(t.key)){this._modelDBMutex((()=>{this.sharedModel.updateMetadata(e.toJSON())}))}this.triggerContentChange()}_ensureMetadata(){const e=this.metadata;if(!e.has("language_info")){e.set("language_info",{name:""})}if(!e.has("kernelspec")){e.set("kernelspec",{name:"",display_name:""})}}triggerStateChange(e){this._stateChanged.emit(e)}triggerContentChange(){this._contentChanged.emit(void 0);this.dirty=true}get isDisposed(){return this._isDisposed}}(function(e){class t{constructor(e){this.codeCellContentFactory=e.codeCellContentFactory||s.CodeCellModel.defaultContentFactory;this.modelDB=e.modelDB}createCell(e,t){switch(e){case"code":return this.createCodeCell(t);case"markdown":return this.createMarkdownCell(t);case"raw":default:return this.createRawCell(t)}}createCodeCell(e){if(e.contentFactory){e.contentFactory=this.codeCellContentFactory}if(this.modelDB){if(!e.id){e.id=a.UUID.uuid4()}e.modelDB=this.modelDB.view(e.id)}return new s.CodeCellModel(e)}createMarkdownCell(e){if(this.modelDB){if(!e.id){e.id=a.UUID.uuid4()}e.modelDB=this.modelDB.view(e.id)}return new s.MarkdownCellModel(e)}createRawCell(e){if(this.modelDB){if(!e.id){e.id=a.UUID.uuid4()}e.modelDB=this.modelDB.view(e.id)}return new s.RawCellModel(e)}clone(e){return new t({modelDB:e,codeCellContentFactory:this.codeCellContentFactory})}}e.ContentFactory=t;e.defaultContentFactory=new t({})})(M||(M={}));class O{constructor(e){this._disposed=false;this._disableDocumentWideUndoRedo=e.disableDocumentWideUndoRedo||false;const t=e.codeCellContentFactory;this.contentFactory=e.contentFactory||new M.ContentFactory({codeCellContentFactory:t})}set disableDocumentWideUndoRedo(e){this._disableDocumentWideUndoRedo=e}get name(){return"notebook"}get contentType(){return"notebook"}get fileFormat(){return"json"}get isDisposed(){return this._disposed}dispose(){this._disposed=true}createNew(e,t,n){const o=this.contentFactory;return new M({languagePreference:e,contentFactory:o,modelDB:t,isInitialized:n,disableDocumentWideUndoRedo:this._disableDocumentWideUndoRedo})}preferredLanguage(e){return""}}var I=n(26351);function A(e){const t=(e.translator||i.nullTranslator).load("jupyterlab");return c.createElement(I.TextItem,{source:t.__("Mode: %1",e.modeNames[e.notebookMode])})}class E extends o.VDomRenderer{constructor(e){super(new E.Model);this.translator=e||i.nullTranslator;this._trans=this.translator.load("jupyterlab");this._modeNames={command:this._trans.__("Command"),edit:this._trans.__("Edit")}}render(){if(!this.model){return null}this.node.title=this._trans.__("Notebook is in %1 mode",this._modeNames[this.model.notebookMode]);return c.createElement(A,{notebookMode:this.model.notebookMode,translator:this.translator,modeNames:this._modeNames})}}(function(e){class t extends o.VDomModel{constructor(){super(...arguments);this._onChanged=e=>{const t=this._notebookMode;if(this._notebook){this._notebookMode=e.mode}else{this._notebookMode="command"}this._triggerChange(t,this._notebookMode)};this._notebookMode="command";this._notebook=null}get notebookMode(){return this._notebookMode}set notebook(e){const t=this._notebook;if(t!==null){t.stateChanged.disconnect(this._onChanged,this);t.activeCellChanged.disconnect(this._onChanged,this);t.modelContentChanged.disconnect(this._onChanged,this)}const n=this._notebookMode;this._notebook=e;if(this._notebook===null){this._notebookMode="command"}else{this._notebookMode=this._notebook.mode;this._notebook.stateChanged.connect(this._onChanged,this);this._notebook.activeCellChanged.connect(this._onChanged,this);this._notebook.modelContentChanged.connect(this._onChanged,this)}this._triggerChange(n,this._notebookMode)}_triggerChange(e,t){if(e!==t){this.stateChanged.emit(void 0)}}}e.Model=t})(E||(E={}));var T=n(41994);var N=n(64936);var D=n(997);var R=n(18453);class F extends R.Widget{constructor(){super();this._items=[];this.layout=new R.PanelLayout;this.addClass("jp-RankedPanel")}addWidget(e,t){const n={widget:e,rank:t};const o=l.ArrayExt.upperBound(this._items,n,B.itemCmp);l.ArrayExt.insert(this._items,o,n);const s=this.layout;s.insertWidget(o,e)}onChildRemoved(e){const t=l.ArrayExt.findFirstIndex(this._items,(t=>t.widget===e.child));if(t!==-1){l.ArrayExt.removeAt(this._items,t)}}}class P extends R.Widget{constructor(e){super();this.addClass("jp-NotebookTools");this.translator=e.translator||i.nullTranslator;this._trans=this.translator.load("jupyterlab");this._commonTools=new F;this._advancedTools=new F;this._advancedTools.title.label=this._trans.__("Advanced Tools");const t=this.layout=new R.PanelLayout;t.addWidget(this._commonTools);t.addWidget(new o.Collapse({widget:this._advancedTools}));this._tracker=e.tracker;this._tracker.currentChanged.connect(this._onActiveNotebookPanelChanged,this);this._tracker.activeCellChanged.connect(this._onActiveCellChanged,this);this._tracker.selectionChanged.connect(this._onSelectionChanged,this);this._onActiveNotebookPanelChanged();this._onActiveCellChanged();this._onSelectionChanged()}get activeCell(){return this._tracker.activeCell}get selectedCells(){const e=this._tracker.currentWidget;if(!e){return[]}const t=e.content;return t.widgets.filter((e=>t.isSelectedOrActive(e)))}get activeNotebookPanel(){return this._tracker.currentWidget}addItem(e){var t;const n=e.tool;const o=(t=e.rank)!==null&&t!==void 0?t:100;let s;if(e.section==="advanced"){s=this._advancedTools}else{s=this._commonTools}n.addClass("jp-NotebookTools-tool");s.addWidget(n,o);n.notebookTools=this;N.MessageLoop.sendMessage(n,P.ActiveNotebookPanelMessage);N.MessageLoop.sendMessage(n,P.ActiveCellMessage)}_onActiveNotebookPanelChanged(){if(this._prevActiveNotebookModel&&!this._prevActiveNotebookModel.isDisposed){this._prevActiveNotebookModel.metadata.changed.disconnect(this._onActiveNotebookPanelMetadataChanged,this)}const e=this.activeNotebookPanel&&this.activeNotebookPanel.content?this.activeNotebookPanel.content.model:null;this._prevActiveNotebookModel=e;if(e){e.metadata.changed.connect(this._onActiveNotebookPanelMetadataChanged,this)}(0,l.each)(this._toolChildren(),(e=>{N.MessageLoop.sendMessage(e,P.ActiveNotebookPanelMessage)}))}_onActiveCellChanged(){if(this._prevActiveCell&&!this._prevActiveCell.isDisposed){this._prevActiveCell.metadata.changed.disconnect(this._onActiveCellMetadataChanged,this)}const e=this.activeCell?this.activeCell.model:null;this._prevActiveCell=e;if(e){e.metadata.changed.connect(this._onActiveCellMetadataChanged,this)}(0,l.each)(this._toolChildren(),(e=>{N.MessageLoop.sendMessage(e,P.ActiveCellMessage)}))}_onSelectionChanged(){(0,l.each)(this._toolChildren(),(e=>{N.MessageLoop.sendMessage(e,P.SelectionMessage)}))}_onActiveNotebookPanelMetadataChanged(e,t){const n=new k.ObservableJSON.ChangeMessage("activenotebookpanel-metadata-changed",t);(0,l.each)(this._toolChildren(),(e=>{N.MessageLoop.sendMessage(e,n)}))}_onActiveCellMetadataChanged(e,t){const n=new k.ObservableJSON.ChangeMessage("activecell-metadata-changed",t);(0,l.each)(this._toolChildren(),(e=>{N.MessageLoop.sendMessage(e,n)}))}_toolChildren(){return(0,l.chain)(this._commonTools.children(),this._advancedTools.children())}}(function(e){e.ActiveNotebookPanelMessage=new N.ConflatableMessage("activenotebookpanel-changed");e.ActiveCellMessage=new N.ConflatableMessage("activecell-changed");e.SelectionMessage=new N.ConflatableMessage("selection-changed");class t extends R.Widget{dispose(){super.dispose();if(this.notebookTools){this.notebookTools=null}}processMessage(e){super.processMessage(e);switch(e.type){case"activenotebookpanel-changed":this.onActiveNotebookPanelChanged(e);break;case"activecell-changed":this.onActiveCellChanged(e);break;case"selection-changed":this.onSelectionChanged(e);break;case"activecell-metadata-changed":this.onActiveCellMetadataChanged(e);break;case"activenotebookpanel-metadata-changed":this.onActiveNotebookPanelMetadataChanged(e);break;default:break}}onActiveNotebookPanelChanged(e){}onActiveCellChanged(e){}onSelectionChanged(e){}onActiveCellMetadataChanged(e){}onActiveNotebookPanelMetadataChanged(e){}}e.Tool=t;class n extends t{constructor(){super();this._model=new T.CodeEditor.Model;this.addClass("jp-ActiveCellTool");this.addClass("jp-InputArea");this.layout=new R.PanelLayout}dispose(){if(this._model===null){return}this._model.dispose();this._model=null;super.dispose()}onActiveCellChanged(){const e=this.notebookTools.activeCell;const t=this.layout;const n=t.widgets.length;for(let d=0;d<n;d++){t.widgets[0].dispose()}if(this._cellModel&&!this._cellModel.isDisposed){this._cellModel.value.changed.disconnect(this._onValueChanged,this);this._cellModel.mimeTypeChanged.disconnect(this._onMimeTypeChanged,this)}if(!e){const e=new R.Widget;e.addClass("jp-InputArea-editor");e.addClass("jp-InputArea-editor");t.addWidget(e);this._cellModel=null;return}const o=e.promptNode?e.promptNode.cloneNode(true):undefined;const s=new R.Widget({node:o});const i=e.contentFactory.editorFactory;const l=this._cellModel=e.model;l.value.changed.connect(this._onValueChanged,this);l.mimeTypeChanged.connect(this._onMimeTypeChanged,this);this._model.value.text=l.value.text.split("\n")[0];this._model.mimeType=l.mimeType;const a=this._model;const r=new T.CodeEditorWrapper({model:a,factory:i});r.addClass("jp-InputArea-editor");r.addClass("jp-InputArea-editor");r.editor.setOption("readOnly",true);t.addWidget(s);t.addWidget(r)}_onValueChanged(){this._model.value.text=this._cellModel.value.text.split("\n")[0]}_onMimeTypeChanged(){this._model.mimeType=this._cellModel.mimeType}}e.ActiveCellTool=n;class o extends t{constructor(e){super();const{editorFactory:t}=e;this.addClass("jp-MetadataEditorTool");const n=this.layout=new R.PanelLayout;this.editor=new T.JSONEditor({editorFactory:t});this.editor.title.label=e.label||"Edit Metadata";const o=new R.Widget({node:document.createElement("label")});o.node.textContent=e.label||"Edit Metadata";n.addWidget(o);n.addWidget(this.editor)}}e.MetadataEditorTool=o;class s extends o{constructor(e){const t=e.translator||i.nullTranslator;const n=t.load("jupyterlab");e.label=e.label||n.__("Notebook Metadata");super(e)}onActiveNotebookPanelChanged(e){this._update()}onActiveNotebookPanelMetadataChanged(e){this._update()}_update(){var e,t;const n=this.notebookTools.activeNotebookPanel&&this.notebookTools.activeNotebookPanel.content;this.editor.source=(t=(e=n===null||n===void 0?void 0:n.model)===null||e===void 0?void 0:e.metadata)!==null&&t!==void 0?t:null}}e.NotebookMetadataEditorTool=s;class l extends o{constructor(e){const t=e.translator||i.nullTranslator;const n=t.load("jupyterlab");e.label=e.label||n.__("Cell Metadata");super(e)}onActiveCellChanged(e){this._update()}onActiveCellMetadataChanged(e){this._update()}_update(){const e=this.notebookTools.activeCell;this.editor.source=e?e.model.metadata:null}}e.CellMetadataEditorTool=l;class a extends t{constructor(e){super({node:B.createSelectorNode(e)});this._getValue=e=>{let t=e.model.metadata.get(this.key);if(t===undefined){t=this._default}return t};this._setValue=(e,t)=>{if(t===this._default){e.model.metadata.delete(this.key)}else{e.model.metadata.set(this.key,t)}};this._changeGuard=false;this.addClass("jp-KeySelector");this.key=e.key;this._default=e.default;this._validCellTypes=e.validCellTypes||[];this._getter=e.getter||this._getValue;this._setter=e.setter||this._setValue}get selectNode(){return this.node.getElementsByTagName("select")[0]}handleEvent(e){switch(e.type){case"change":this.onValueChanged();break;default:break}}onAfterAttach(e){const t=this.selectNode;t.addEventListener("change",this)}onBeforeDetach(e){const t=this.selectNode;t.removeEventListener("change",this)}onActiveCellChanged(e){const t=this.selectNode;const n=this.notebookTools.activeCell;if(!n){t.disabled=true;t.value="";return}const o=n.model.type;if(this._validCellTypes.length&&this._validCellTypes.indexOf(o)===-1){t.value="";t.disabled=true;return}t.disabled=false;this._changeGuard=true;const s=this._getter;t.value=JSON.stringify(s(n));this._changeGuard=false}onActiveCellMetadataChanged(e){if(this._changeGuard){return}const t=this.selectNode;const n=this.notebookTools.activeCell;if(e.args.key===this.key&&n){this._changeGuard=true;const e=this._getter;t.value=JSON.stringify(e(n));this._changeGuard=false}}onValueChanged(){const e=this.notebookTools.activeCell;if(!e||this._changeGuard){return}this._changeGuard=true;const t=this.selectNode;const n=this._setter;n(e,JSON.parse(t.value));this._changeGuard=false}}e.KeySelector=a;function r(e){e=e||i.nullTranslator;const t=e.load("jupyterlab");t.__("");const n={key:"slideshow",title:t.__("Slide Type"),optionValueArray:[["-",null],[t.__("Slide"),"slide"],[t.__("Sub-Slide"),"subslide"],[t.__("Fragment"),"fragment"],[t.__("Skip"),"skip"],[t.__("Notes"),"notes"]],getter:e=>{const t=e.model.metadata.get("slideshow");return t&&t["slide_type"]},setter:(e,t)=>{let n=e.model.metadata.get("slideshow")||Object.create(null);if(t===null){n=Object.assign({},n);delete n.slide_type}else{n=Object.assign(Object.assign({},n),{slide_type:t})}if(Object.keys(n).length>0){e.model.metadata.set("slideshow",n)}else{e.model.metadata.delete("slideshow")}}};return new a(n)}e.createSlideShowSelector=r;function d(e,t){t=t||i.nullTranslator;const n=t.load("jupyterlab");return new a({key:"raw_mimetype",title:n.__("Raw NBConvert Format"),optionValueArray:e,validCellTypes:["raw"]})}e.createNBConvertSelector=d})(P||(P={}));var B;(function(e){function t(e,t){return e.rank-t.rank}e.itemCmp=t;function n(e){const t=e.key;const n=e.title||t[0].toLocaleUpperCase()+t.slice(1);const s=[];let i;let a;(0,l.each)(e.optionValueArray,(e=>{a=e[0];i=JSON.stringify(e[1]);s.push(D.h.option({value:i},a))}));const r=D.VirtualDOM.realize(D.h.div({},D.h.label(n,D.h.select({},s))));o.Styling.styleNode(r);return r}e.createSelectorNode=n})(B||(B={}));var j=n(66853);var L=n(70865);var V=n(38986);var H=n(97083);const W="jpKernelUser";const J="jpCodeRunner";const U="jpUndoer";const z="jp-Notebook";const K="jp-Notebook-cell";const q="jp-mod-editMode";const $="jp-mod-commandMode";const G="jp-mod-active";const Y="jp-mod-selected";const X="jp-mod-multiSelected";const Q="jp-mod-unconfined";const Z="jp-mod-dropTarget";const ee="jp-mod-dropSource";const te="jp-dragImage";const ne="jp-dragImage-singlePrompt";const oe="jp-dragImage-content";const se="jp-dragImage-prompt";const ie="jp-dragImage-multipleBack";const le="application/vnd.jupyter.cells";const ae=5;const re="jp-collapseHeadingButton";const de="jp-mod-sideBySide";if(window.requestIdleCallback===undefined){window.requestIdleCallback=function(e){let t=Date.now();return setTimeout((function(){e({didTimeout:false,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})}),1)};window.cancelIdleCallback=function(e){clearTimeout(e)}}class ce extends R.Widget{constructor(e){var t,n;super();this._editorConfig=ce.defaultEditorConfig;this._notebookConfig=ce.defaultNotebookConfig;this._mimetype="text/plain";this._model=null;this._modelChanged=new d.Signal(this);this._modelContentChanged=new d.Signal(this);this._fullyRendered=new d.Signal(this);this._placeholderCellRendered=new d.Signal(this);this._renderedCellsCount=0;this.addClass(z);this.node.dataset[W]="true";this.node.dataset[U]="true";this.node.dataset[J]="true";this.rendermime=e.rendermime;this.translator=(t=e.translator)!==null&&t!==void 0?t:i.nullTranslator;this.layout=new ue.NotebookPanelLayout;this.contentFactory=e.contentFactory||ce.defaultContentFactory;this.editorConfig=e.editorConfig||ce.defaultEditorConfig;this.notebookConfig=e.notebookConfig||ce.defaultNotebookConfig;this._mimetypeService=e.mimeTypeService;this.renderingLayout=(n=e.notebookConfig)===null||n===void 0?void 0:n.renderingLayout;this._idleCallBack=null;this._toRenderMap=new Map;this._cellsArray=new Array;if("IntersectionObserver"in window){this._observer=new IntersectionObserver(((e,t)=>{e.forEach((e=>{if(e.isIntersecting){t.unobserve(e.target);const n=this._toRenderMap.get(e.target.id);if(n){const{cell:e,index:t}=n;this._renderPlaceholderCell(e,t)}}}))}),{root:this.node,threshold:1,rootMargin:`${this.notebookConfig.observedTopMargin} 0px ${this.notebookConfig.observedBottomMargin} 0px`})}}get fullyRendered(){return this._fullyRendered}get placeholderCellRendered(){return this._placeholderCellRendered}get modelChanged(){return this._modelChanged}get modelContentChanged(){return this._modelContentChanged}get model(){return this._model}set model(e){e=e||null;if(this._model===e){return}const t=this._model;this._model=e;if(t&&t.modelDB.isCollaborative){void t.modelDB.connected.then((()=>{t.modelDB.collaborators.changed.disconnect(this._onCollaboratorsChanged,this)}))}if(e&&e.modelDB.isCollaborative){void e.modelDB.connected.then((()=>{e.modelDB.collaborators.changed.connect(this._onCollaboratorsChanged,this)}))}this._onModelChanged(t,e);this.onModelChanged(t,e);this._modelChanged.emit(void 0)}get codeMimetype(){return this._mimetype}get widgets(){return this.layout.widgets}get editorConfig(){return this._editorConfig}set editorConfig(e){this._editorConfig=e;this._updateEditorConfig()}get notebookConfig(){return this._notebookConfig}set notebookConfig(e){this._notebookConfig=e;this._updateNotebookConfig()}get renderingLayout(){return this._renderingLayout}set renderingLayout(e){this._renderingLayout=e;if(this._renderingLayout==="side-by-side"){this.node.classList.add(de)}else{this.node.classList.remove(de)}}dispose(){if(this.isDisposed){return}this._model=null;super.dispose()}onModelChanged(e,t){}onModelContentChanged(e,t){this._modelContentChanged.emit(void 0)}onMetadataChanged(e,t){switch(t.key){case"language_info":this._updateMimetype();break;default:break}}onCellInserted(e,t){}onCellMoved(e,t){}onCellRemoved(e,t){}_onModelChanged(e,t){const n=this.layout;if(e){e.cells.changed.disconnect(this._onCellsChanged,this);e.metadata.changed.disconnect(this.onMetadataChanged,this);e.contentChanged.disconnect(this.onModelContentChanged,this);while(n.widgets.length){this._removeCell(0)}}if(!t){this._mimetype="text/plain";return}this._updateMimetype();const o=t.cells;if(!o.length&&t.isInitialized){o.push(t.contentFactory.createCell(this.notebookConfig.defaultCell,{}))}(0,l.each)(o,((e,t)=>{this._insertCell(t,e,"set")}));o.changed.connect(this._onCellsChanged,this);t.contentChanged.connect(this.onModelContentChanged,this);t.metadata.changed.connect(this.onMetadataChanged,this)}_onCellsChanged(e,t){let n=0;switch(t.type){case"add":n=t.newIndex;const o=t.oldIndex==-1?"push":"insert";(0,l.each)(t.newValues,(e=>{this._insertCell(n++,e,o)}));break;case"move":this._moveCell(t.oldIndex,t.newIndex);break;case"remove":(0,l.each)(t.oldValues,(e=>{this._removeCell(t.oldIndex)}));if(!e.length){const e=this.model;requestAnimationFrame((()=>{if(e&&!e.isDisposed&&!e.cells.length){e.cells.push(e.contentFactory.createCell(this.notebookConfig.defaultCell,{}))}}))}break;case"set":n=t.newIndex;(0,l.each)(t.newValues,(e=>{this._insertCell(n,e,"set");this._removeCell(n+1);n++}));break;default:return}}_insertCell(e,t,n){let o;switch(t.type){case"code":o=this._createCodeCell(t);o.model.mimeType=this._mimetype;break;case"markdown":o=this._createMarkdownCell(t);if(t.value.text===""){o.rendered=false}break;default:o=this._createRawCell(t)}o.addClass(K);const s=this.layout;this._cellsArray.push(o);if(this._observer&&n==="push"&&this._renderedCellsCount>=this.notebookConfig.numberCellsToRenderDirectly&&t.type!=="markdown"){this._toRenderMap.set(o.model.id,{index:e,cell:o});const n=this._createPlaceholderCell(t,e);n.node.id=o.model.id;s.insertWidget(e,n);this.onCellInserted(e,n);this._fullyRendered.emit(false);this._observer.observe(n.node)}else{s.insertWidget(e,o);this.onCellInserted(e,o);this._incrementRenderedCount()}this._scheduleCellRenderOnIdle()}_scheduleCellRenderOnIdle(){if(this._observer&&this.notebookConfig.renderCellOnIdle&&!this.isDisposed){if(!this._idleCallBack){const e=this._renderPlaceholderCells.bind(this);this._idleCallBack=window.requestIdleCallback(e,{timeout:3e3})}}}_renderPlaceholderCells(e){if(this.notebookConfig.remainingTimeBeforeRescheduling>0){const t=e.timeRemaining();if(e.didTimeout||t<this.notebookConfig.remainingTimeBeforeRescheduling){if(this._idleCallBack){window.cancelIdleCallback(this._idleCallBack);this._idleCallBack=null}this._scheduleCellRenderOnIdle()}}if(this._renderedCellsCount<this._cellsArray.length&&this._renderedCellsCount>=this.notebookConfig.numberCellsToRenderDirectly){const e=this._toRenderMap.entries().next();this._renderPlaceholderCell(e.value[1].cell,e.value[1].index)}}_renderPlaceholderCell(e,t){if(!this.layout){return}const n=this.layout;n.removeWidgetAt(t);n.insertWidget(t,e);this._toRenderMap.delete(e.model.id);this._incrementRenderedCount();this.onCellInserted(t,e);this._placeholderCellRendered.emit(e)}_createCodeCell(e){const t=this.rendermime;const n=this.contentFactory;const o=this.editorConfig.code;const s={editorConfig:o,model:e,rendermime:t,contentFactory:n,updateEditorOnShow:false,placeholder:false,maxNumberOutputs:this.notebookConfig.maxNumberOutputs};const i=this.contentFactory.createCodeCell(s,this);i.syncCollapse=true;i.syncEditable=true;i.syncScrolled=true;return i}_createMarkdownCell(e){const t=this.rendermime;const n=this.contentFactory;const o=this.editorConfig.markdown;const s={editorConfig:o,model:e,rendermime:t,contentFactory:n,updateEditorOnShow:false,placeholder:false,showEditorForReadOnlyMarkdown:this._notebookConfig.showEditorForReadOnlyMarkdown};const i=this.contentFactory.createMarkdownCell(s,this);i.syncCollapse=true;i.syncEditable=true;i.toggleCollapsedSignal.connect(((e,t)=>{f.setHeadingCollapse(e,t,this)}));return i}_createPlaceholderCell(e,t){const n=this.contentFactory;const o=this.editorConfig.raw;const s={editorConfig:o,model:e,contentFactory:n,updateEditorOnShow:false,placeholder:true};const i=this.contentFactory.createRawCell(s,this);i.node.innerHTML=`\n      <div class="jp-Cell-Placeholder">\n        <div class="jp-Cell-Placeholder-wrapper">\n        </div>\n      </div>`;i.inputHidden=true;i.syncCollapse=true;i.syncEditable=true;return i}_createRawCell(e){const t=this.contentFactory;const n=this.editorConfig.raw;const o={editorConfig:n,model:e,contentFactory:t,updateEditorOnShow:false,placeholder:false};const s=this.contentFactory.createRawCell(o,this);s.syncCollapse=true;s.syncEditable=true;return s}_moveCell(e,t){const n=this.layout;n.insertWidget(t,n.widgets[e]);this.onCellMoved(e,t)}_removeCell(e){const t=this.layout;const n=t.widgets[e];n.parent=null;this.onCellRemoved(e,n);n.dispose()}_updateMimetype(){var e;const t=(e=this._model)===null||e===void 0?void 0:e.metadata.get("language_info");if(!t){return}this._mimetype=this._mimetypeService.getMimeTypeByLanguage(t);(0,l.each)(this.widgets,(e=>{if(e.model.type==="code"){e.model.mimeType=this._mimetype}}))}_onCollaboratorsChanged(){var e,t,n;for(let o=0;o<this.widgets.length;o++){const s=this.widgets[o];for(const o of s.model.selections.keys()){if(false===((n=(t=(e=this._model)===null||e===void 0?void 0:e.modelDB)===null||t===void 0?void 0:t.collaborators)===null||n===void 0?void 0:n.has(o))){s.model.selections.delete(o)}}}}_updateEditorConfig(){for(let e=0;e<this.widgets.length;e++){const t=this.widgets[e];let n={};switch(t.model.type){case"code":n=this._editorConfig.code;break;case"markdown":n=this._editorConfig.markdown;break;default:n=this._editorConfig.raw;break}t.editor.setOptions(Object.assign({},n));t.editor.refresh()}}_updateNotebookConfig(){this.toggleClass("jp-mod-scrollPastEnd",this._notebookConfig.scrollPastEnd);const e=this._notebookConfig.showEditorForReadOnlyMarkdown;if(e!==undefined&&this._cellsArray){for(const t of this._cellsArray){if(t.model.type==="markdown"){t.showEditorForReadOnly=e}}}}_incrementRenderedCount(){if(this._toRenderMap.size===0){this._fullyRendered.emit(true)}this._renderedCellsCount++}get remainingCellToRenderCount(){return this._toRenderMap.size}}(function(e){e.defaultEditorConfig={code:Object.assign(Object.assign({},T.CodeEditor.defaultConfig),{lineWrap:"off",matchBrackets:true,autoClosingBrackets:false}),markdown:Object.assign(Object.assign({},T.CodeEditor.defaultConfig),{lineWrap:"on",matchBrackets:false,autoClosingBrackets:false}),raw:Object.assign(Object.assign({},T.CodeEditor.defaultConfig),{lineWrap:"on",matchBrackets:false,autoClosingBrackets:false})};e.defaultNotebookConfig={scrollPastEnd:true,defaultCell:"code",recordTiming:false,numberCellsToRenderDirectly:99999,remainingTimeBeforeRescheduling:50,renderCellOnIdle:true,observedTopMargin:"1000px",observedBottomMargin:"1000px",maxNumberOutputs:50,showEditorForReadOnlyMarkdown:true,disableDocumentWideUndoRedo:false,renderingLayout:"default",sideBySideLeftMarginOverride:"10px",sideBySideRightMarginOverride:"10px"};class t extends s.Cell.ContentFactory{createCodeCell(e,t){if(!e.contentFactory){e.contentFactory=this}return new s.CodeCell(e).initializeState()}createMarkdownCell(e,t){if(!e.contentFactory){e.contentFactory=this}return new s.MarkdownCell(e).initializeState()}createRawCell(e,t){if(!e.contentFactory){e.contentFactory=this}return new s.RawCell(e).initializeState()}}e.ContentFactory=t;e.defaultContentFactory=new t})(ce||(ce={}));class he extends ce{constructor(e){super(ue.processNotebookOptions(e));this._activeCellIndex=-1;this._activeCell=null;this._mode="command";this._drag=null;this._fragment="";this._dragData=null;this._mouseMode=null;this._activeCellChanged=new d.Signal(this);this._stateChanged=new d.Signal(this);this._selectionChanged=new d.Signal(this);this._checkCacheOnNextResize=false;this._lastClipboardInteraction=null;this.node.tabIndex=0;this.node.setAttribute("data-lm-dragscroll","true")}get activeCellChanged(){return this._activeCellChanged}get stateChanged(){return this._stateChanged}get selectionChanged(){return this._selectionChanged}get mode(){return this._mode}set mode(e){const t=this.activeCell;if(!t){e="command"}if(e===this._mode){this._ensureFocus();return}this.update();const n=this._mode;this._mode=e;if(e==="edit"){(0,l.each)(this.widgets,(e=>{this.deselect(e)}));if(t instanceof s.MarkdownCell){t.rendered=false}t.inputHidden=false}else{this.node.focus()}this._stateChanged.emit({name:"mode",oldValue:n,newValue:e});this._ensureFocus()}get activeCellIndex(){if(!this.model){return-1}return this.model.cells.length?this._activeCellIndex:-1}set activeCellIndex(e){var t;const n=this._activeCellIndex;if(!this.model||!this.model.cells.length){e=-1}else{e=Math.max(e,0);e=Math.min(e,this.model.cells.length-1)}this._activeCellIndex=e;const o=this.widgets[e];if(o!==this._activeCell){this.update();this._activeCell=o;this._activeCellChanged.emit(o)}if(this.mode==="edit"&&o instanceof s.MarkdownCell){o.rendered=false}this._ensureFocus();if(e===n){return}this._trimSelections();this._stateChanged.emit({name:"activeCellIndex",oldValue:n,newValue:e});const i=j.PageConfig.getOption("collaborative")=="true"?true:false;if(i){((t=this.model)===null||t===void 0?void 0:t.sharedModel).notifyActiveCellIndex(n,e)}}get activeCell(){return this._activeCell}get lastClipboardInteraction(){return this._lastClipboardInteraction}set lastClipboardInteraction(e){this._lastClipboardInteraction=e}dispose(){if(this.isDisposed){return}this._activeCell=null;super.dispose()}select(e){if(ue.selectedProperty.get(e)){return}ue.selectedProperty.set(e,true);this._selectionChanged.emit(void 0);this.update()}deselect(e){if(!ue.selectedProperty.get(e)){return}ue.selectedProperty.set(e,false);this._selectionChanged.emit(void 0);this.update()}isSelected(e){return ue.selectedProperty.get(e)}isSelectedOrActive(e){if(e===this._activeCell){return true}return ue.selectedProperty.get(e)}deselectAll(){let e=false;(0,l.each)(this.widgets,(t=>{if(ue.selectedProperty.get(t)){e=true}ue.selectedProperty.set(t,false)}));if(e){this._selectionChanged.emit(void 0)}this.activeCellIndex=this.activeCellIndex;this.update()}extendContiguousSelectionTo(e){let{head:t,anchor:n}=this.getContiguousSelection();let o;if(n===null||t===null){if(e===this.activeCellIndex){return}t=this.activeCellIndex;n=this.activeCellIndex}this.activeCellIndex=e;e=this.activeCellIndex;if(e===n){this.deselectAll();return}let s=false;if(t<e){if(t<n){ue.selectedProperty.set(this.widgets[t],false);s=true}for(o=t+1;o<e;o++){if(o!==n){ue.selectedProperty.set(this.widgets[o],!ue.selectedProperty.get(this.widgets[o]));s=true}}}else if(e<t){if(n<t){ue.selectedProperty.set(this.widgets[t],false);s=true}for(o=e+1;o<t;o++){if(o!==n){ue.selectedProperty.set(this.widgets[o],!ue.selectedProperty.get(this.widgets[o]));s=true}}}if(!ue.selectedProperty.get(this.widgets[n])){s=true}ue.selectedProperty.set(this.widgets[n],true);if(!ue.selectedProperty.get(this.widgets[e])){s=true}ue.selectedProperty.set(this.widgets[e],true);if(s){this._selectionChanged.emit(void 0)}}getContiguousSelection(){const e=this.widgets;const t=l.ArrayExt.findFirstIndex(e,(e=>this.isSelected(e)));if(t===-1){return{head:null,anchor:null}}const n=l.ArrayExt.findLastIndex(e,(e=>this.isSelected(e)),-1,t);for(let s=t;s<=n;s++){if(!this.isSelected(e[s])){throw new Error("Selection not contiguous")}}const o=this.activeCellIndex;if(t!==o&&n!==o){throw new Error("Active cell not at endpoint of selection")}if(t===o){return{head:t,anchor:n}}else{return{head:n,anchor:t}}}scrollToPosition(e,t=25){const n=this.node;const o=n.getBoundingClientRect();const s=e-o.top-o.height/2;if(Math.abs(s)>o.height*t/100){n.scrollTop+=s}}scrollToCell(e){r.ElementExt.scrollIntoViewIfNeeded(this.node,e.node);this.deselectAll();this.select(e);e.activate()}setFragment(e){void Promise.all(this.widgets.map((e=>e.ready))).then((()=>{this._fragment=e;this.update()}))}handleEvent(e){if(!this.model){return}switch(e.type){case"contextmenu":if(e.eventPhase===Event.CAPTURING_PHASE){this._evtContextMenuCapture(e)}break;case"mousedown":if(e.eventPhase===Event.CAPTURING_PHASE){this._evtMouseDownCapture(e)}else{this._evtMouseDown(e)}break;case"mouseup":if(e.currentTarget===document){this._evtDocumentMouseup(e)}break;case"mousemove":if(e.currentTarget===document){this._evtDocumentMousemove(e)}break;case"keydown":this._ensureFocus(true);break;case"dblclick":this._evtDblClick(e);break;case"focusin":this._evtFocusIn(e);break;case"focusout":this._evtFocusOut(e);break;case"lm-dragenter":this._evtDragEnter(e);break;case"lm-dragleave":this._evtDragLeave(e);break;case"lm-dragover":this._evtDragOver(e);break;case"lm-drop":this._evtDrop(e);break;default:break}}onAfterAttach(e){super.onAfterAttach(e);const t=this.node;t.addEventListener("contextmenu",this,true);t.addEventListener("mousedown",this,true);t.addEventListener("mousedown",this);t.addEventListener("keydown",this);t.addEventListener("dblclick",this);t.addEventListener("focusin",this);t.addEventListener("focusout",this);t.addEventListener("lm-dragenter",this,true);t.addEventListener("lm-dragleave",this,true);t.addEventListener("lm-dragover",this,true);t.addEventListener("lm-drop",this,true)}onBeforeDetach(e){const t=this.node;t.removeEventListener("contextmenu",this,true);t.removeEventListener("mousedown",this,true);t.removeEventListener("mousedown",this);t.removeEventListener("keydown",this);t.removeEventListener("dblclick",this);t.removeEventListener("focusin",this);t.removeEventListener("focusout",this);t.removeEventListener("lm-dragenter",this,true);t.removeEventListener("lm-dragleave",this,true);t.removeEventListener("lm-dragover",this,true);t.removeEventListener("lm-drop",this,true);document.removeEventListener("mousemove",this,true);document.removeEventListener("mouseup",this,true)}onAfterShow(e){this._checkCacheOnNextResize=true}onResize(e){if(!this._checkCacheOnNextResize){return super.onResize(e)}this._checkCacheOnNextResize=false;const t=this._cellLayoutStateCache;const n=parseInt(this.node.style.width,10);if(t){if(n===t.width){return}}this._cellLayoutStateCache={width:n};for(const o of this.widgets){if(o instanceof s.Cell){o.editorWidget.update()}}}onBeforeHide(e){const t=parseInt(this.node.style.width,10);this._cellLayoutStateCache={width:t}}onActivateRequest(e){this._ensureFocus(true)}onUpdateRequest(e){const t=this.activeCell;if(this.mode==="edit"){this.addClass(q);this.removeClass($)}else{this.addClass($);this.removeClass(q)}if(t){t.addClass(G)}let n=0;(0,l.each)(this.widgets,(e=>{if(e!==t){e.removeClass(G)}e.removeClass(X);if(this.isSelectedOrActive(e)){e.addClass(Y);n++}else{e.removeClass(Y)}}));if(n>1){t===null||t===void 0?void 0:t.addClass(X)}if(this._fragment){let e;try{e=this.node.querySelector(this._fragment.startsWith("#")?`#${CSS.escape(this._fragment.slice(1))}`:this._fragment)}catch(o){console.warn("Unable to set URI fragment identifier",o)}if(e){e.scrollIntoView()}this._fragment=""}}onCellInserted(e,t){if(this.model&&this.model.modelDB.isCollaborative){const e=this.model.modelDB;void e.connected.then((()=>{if(!t.isDisposed){const n=e.collaborators.localCollaborator;t.editor.uuid=n.sessionId;t.editor.selectionStyle=Object.assign(Object.assign({},T.CodeEditor.defaultSelectionStyle),{color:n.color})}}))}t.editor.edgeRequested.connect(this._onEdgeRequest,this);this.activeCellIndex=e<=this.activeCellIndex?this.activeCellIndex+1:this.activeCellIndex}onCellMoved(e,t){const n=this.activeCellIndex;if(e===n){this.activeCellIndex=t}else if(e<n&&n<=t){this.activeCellIndex--}else if(t<=n&&n<e){this.activeCellIndex++}}onCellRemoved(e,t){this.activeCellIndex=e<=this.activeCellIndex?this.activeCellIndex-1:this.activeCellIndex;if(this.isSelected(t)){this._selectionChanged.emit(void 0)}}onModelChanged(e,t){super.onModelChanged(e,t);this.activeCellIndex=0}_onEdgeRequest(e,t){const n=this.activeCellIndex;if(t==="top"){this.activeCellIndex--;if(this.activeCellIndex<n){const e=this.activeCell.editor;const t=e.lineCount-1;e.setCursorPosition({line:t,column:0})}}else if(t==="bottom"){this.activeCellIndex++;if(this.activeCellIndex>n){const e=this.activeCell.editor;e.setCursorPosition({line:0,column:0})}}this.mode="edit"}_ensureFocus(e=false){const t=this.activeCell;if(this.mode==="edit"&&t){if(!t.editor.hasFocus()){t.editor.focus()}}if(e&&!this.node.contains(document.activeElement)){this.node.focus()}}_findCell(e){let t=e;while(t&&t!==this.node){if(t.classList.contains(K)){const e=l.ArrayExt.findFirstIndex(this.widgets,(e=>e.node===t));if(e!==-1){return e}break}t=t.parentElement}return-1}_findEventTargetAndCell(e){let t=e.target;let n=this._findCell(t);if(n===-1){t=document.elementFromPoint(e.clientX,e.clientY);n=this._findCell(t)}return[t,n]}_evtContextMenuCapture(e){if(e.shiftKey){return}const[t,n]=this._findEventTargetAndCell(e);const o=this.widgets[n];if(o&&o.editorWidget.node.contains(t)){e.preventDefault()}}_evtMouseDownCapture(e){const{button:t,shiftKey:n}=e;const[o,s]=this._findEventTargetAndCell(e);const i=this.widgets[s];if(t===2&&!n&&i&&i.editorWidget.node.contains(o)){this.mode="command";e.preventDefault()}}_evtMouseDown(e){var t;const{button:n,shiftKey:o}=e;if(!(n===0||n===2)){return}if(o&&n===2){return}const[s,i]=this._findEventTargetAndCell(e);const l=this.widgets[i];let a;if(l){if(l.editorWidget.node.contains(s)){a="input"}else if(l.promptNode.contains(s)){a="prompt"}else{a="cell"}}else{a="notebook"}if(a!=="input"){this.mode="command"}if(a==="notebook"){this.deselectAll()}else if(a==="prompt"||a==="cell"){const s=((t=window.getSelection())!==null&&t!==void 0?t:"").toString()!=="";if(n===0&&o&&!s){e.preventDefault();try{this.extendContiguousSelectionTo(i)}catch(r){console.error(r);this.deselectAll();return}this._mouseMode="select";document.addEventListener("mouseup",this,true);document.addEventListener("mousemove",this,true)}else if(n===0&&!o){if(a==="prompt"){this._dragData={pressX:e.clientX,pressY:e.clientY,index:i};this._mouseMode="couldDrag";document.addEventListener("mouseup",this,true);document.addEventListener("mousemove",this,true);e.preventDefault()}if(!this.isSelectedOrActive(l)){this.deselectAll();this.activeCellIndex=i}}else if(n===2){if(!this.isSelectedOrActive(l)){this.deselectAll();this.activeCellIndex=i}e.preventDefault()}}else if(a==="input"){if(n===2&&!this.isSelectedOrActive(l)){this.deselectAll();this.activeCellIndex=i}}this._ensureFocus(true)}_evtDocumentMouseup(e){e.preventDefault();e.stopPropagation();document.removeEventListener("mousemove",this,true);document.removeEventListener("mouseup",this,true);if(this._mouseMode==="couldDrag"){const[,t]=this._findEventTargetAndCell(e);this.deselectAll();this.activeCellIndex=t}this._mouseMode=null}_evtDocumentMousemove(e){e.preventDefault();e.stopPropagation();switch(this._mouseMode){case"select":{const t=e.target;const n=this._findCell(t);if(n!==-1){this.extendContiguousSelectionTo(n)}break}case"couldDrag":{const t=this._dragData;const n=Math.abs(e.clientX-t.pressX);const o=Math.abs(e.clientY-t.pressY);if(n>=ae||o>=ae){this._mouseMode=null;this._startDrag(t.index,e.clientX,e.clientY)}break}default:break}}_evtDragEnter(e){if(!e.mimeData.hasData(le)){return}e.preventDefault();e.stopPropagation();const t=e.target;const n=this._findCell(t);if(n===-1){return}const o=this.layout.widgets[n];o.node.classList.add(Z)}_evtDragLeave(e){if(!e.mimeData.hasData(le)){return}e.preventDefault();e.stopPropagation();const t=this.node.getElementsByClassName(Z);if(t.length){t[0].classList.remove(Z)}}_evtDragOver(e){if(!e.mimeData.hasData(le)){return}e.preventDefault();e.stopPropagation();e.dropAction=e.proposedAction;const t=this.node.getElementsByClassName(Z);if(t.length){t[0].classList.remove(Z)}const n=e.target;const o=this._findCell(n);if(o===-1){return}const s=this.layout.widgets[o];s.node.classList.add(Z)}_evtDrop(e){if(!e.mimeData.hasData(le)){return}e.preventDefault();e.stopPropagation();if(e.proposedAction==="none"){e.dropAction="none";return}let t=e.target;while(t&&t.parentElement){if(t.classList.contains(Z)){t.classList.remove(Z);break}t=t.parentElement}const n=this.model;const o=e.source;if(o===this){e.dropAction="move";const i=e.mimeData.getData("internal:cells");const a=i[i.length-1];if(a instanceof s.MarkdownCell&&a.headingCollapsed){const e=f.findNextParentHeading(a,o);if(e>0){const t=(0,l.findIndex)(o.widgets,(e=>a.model.id===e.model.id));i.push(...o.widgets.slice(t+1,e))}}let r=l.ArrayExt.firstIndexOf(this.widgets,i[0]);let d=this._findCell(t);if(d!==-1&&d>r){d-=1}else if(d===-1){d=this.widgets.length-1}if(d>=r&&d<r+i.length){return}n.cells.beginCompoundOperation();if(r<d){(0,l.each)(i,(e=>{n.cells.move(r,d)}))}else if(r>d){(0,l.each)(i,(e=>{n.cells.move(r++,d++)}))}n.cells.endCompoundOperation()}else{e.dropAction="copy";let o=this._findCell(t);if(o===-1){o=this.widgets.length}const s=o;const i=e.mimeData.getData(le);const a=n.contentFactory;n.cells.beginCompoundOperation();(0,l.each)(i,(e=>{let t;switch(e.cell_type){case"code":t=a.createCodeCell({cell:e});break;case"markdown":t=a.createMarkdownCell({cell:e});break;default:t=a.createRawCell({cell:e});break}n.cells.insert(o++,t)}));n.cells.endCompoundOperation();this.deselectAll();this.activeCellIndex=s;this.extendContiguousSelectionTo(o-1)}}_startDrag(e,t,n){var o;const s=this.model.cells;const i=[];const r=[];(0,l.each)(this.widgets,((e,t)=>{const n=s.get(t);if(this.isSelectedOrActive(e)){e.addClass(ee);i.push(n.toJSON());r.push(e)}}));const d=this.activeCell;let c=null;let h;if((d===null||d===void 0?void 0:d.model.type)==="code"){const e=d.model.executionCount;h=" ";if(e){h=e.toString()}}else{h=""}c=ue.createDragImage(i.length,h,(o=d===null||d===void 0?void 0:d.model.value.text.split("\n")[0].slice(0,26))!==null&&o!==void 0?o:"");this._drag=new V.Drag({mimeData:new a.MimeData,dragImage:c,supportedActions:"copy-move",proposedAction:"copy",source:this});this._drag.mimeData.setData(le,i);this._drag.mimeData.setData("internal:cells",r);const u=r.map((e=>e.model.value.text)).join("\n");this._drag.mimeData.setData("text/plain",u);document.removeEventListener("mousemove",this,true);document.removeEventListener("mouseup",this,true);this._mouseMode=null;void this._drag.start(t,n).then((e=>{if(this.isDisposed){return}this._drag=null;(0,l.each)(r,(e=>{e.removeClass(ee)}))}))}_evtFocusIn(e){const t=e.target;const n=this._findCell(t);if(n!==-1){const e=this.widgets[n];if(!e.editorWidget.node.contains(t)){this.mode="command"}this.activeCellIndex=n;const o=e.editorWidget.node;if(o.contains(t)){this.mode="edit"}this.activeCellIndex=n}else{this.mode="command"}}_evtFocusOut(e){const t=e.relatedTarget;if(!t){return}const n=this._findCell(t);if(n!==-1){const e=this.widgets[n];if(e.editorWidget.node.contains(t)){return}}if(this.mode!=="command"){this.mode="command";if(t){t.focus()}}}_evtDblClick(e){const t=this.model;if(!t){return}this.deselectAll();const[n,o]=this._findEventTargetAndCell(e);if(e.target.classList.contains(re)){return}if(o===-1){return}this.activeCellIndex=o;if(t.cells.get(o).type==="markdown"){const e=this.widgets[o];e.rendered=false}else if(n.localName==="img"){n.classList.toggle(Q)}}_trimSelections(){for(let e=0;e<this.widgets.length;e++){if(e!==this._activeCellIndex){const t=this.widgets[e];t.model.selections.delete(t.editor.uuid)}}}}(function(e){class t extends ce.ContentFactory{}e.ContentFactory=t;e.defaultContentFactory=new t})(he||(he={}));var ue;(function(e){e.selectedProperty=new H.AttachedProperty({name:"selected",create:()=>false});class t extends R.PanelLayout{onUpdateRequest(e){}}e.NotebookPanelLayout=t;function n(e,t,n){if(e>1){if(t!==""){return D.VirtualDOM.realize(D.h.div(D.h.div({className:te},D.h.span({className:se},"["+t+"]:"),D.h.span({className:oe},n)),D.h.div({className:ie},"")))}else{return D.VirtualDOM.realize(D.h.div(D.h.div({className:te},D.h.span({className:se}),D.h.span({className:oe},n)),D.h.div({className:ie},"")))}}else{if(t!==""){return D.VirtualDOM.realize(D.h.div(D.h.div({className:`${te} ${ne}`},D.h.span({className:se},"["+t+"]:"),D.h.span({className:oe},n))))}else{return D.VirtualDOM.realize(D.h.div(D.h.div({className:`${te} ${ne}`},D.h.span({className:se}),D.h.span({className:oe},n))))}}}e.createDragImage=n;function o(e){if(e.contentFactory){return e}else{return{rendermime:e.rendermime,languagePreference:e.languagePreference,contentFactory:he.defaultContentFactory,mimeTypeService:e.mimeTypeService}}}e.processNotebookOptions=o})(ue||(ue={}));const ge="jp-NotebookPanel";const fe="jp-NotebookPanel-toolbar";const me="jp-NotebookPanel-notebook";const Ce="jp-DocumentSearch-document-loaded";class pe extends L.DocumentWidget{constructor(e){super(e);this._autorestarting=false;this.translator=e.translator||i.nullTranslator;this._trans=this.translator.load("jupyterlab");this.addClass(ge);this.toolbar.addClass(fe);this.content.addClass(me);this.content.model=this.context.model;this.context.sessionContext.kernelChanged.connect(this._onKernelChanged,this);this.context.sessionContext.statusChanged.connect(this._onSessionStatusChanged,this);this.content.fullyRendered.connect(this._onFullyRendered,this);this.context.saveState.connect(this._onSave,this);void this.revealed.then((()=>{if(this.isDisposed){return}if(this.content.widgets.length===1){const e=this.content.widgets[0].model;if(e.type==="code"&&e.value.text===""){this.content.mode="edit"}}}))}_onSave(e,t){if(t==="started"&&this.model){const{cells:e}=this.model;(0,l.each)(e,(e=>{if((0,s.isMarkdownCellModel)(e)){for(const t of e.attachments.keys){if(!e.value.text.includes(t)){e.attachments.remove(t)}}}}))}}get sessionContext(){return this.context.sessionContext}get model(){return this.content.model}setConfig(e){this.content.editorConfig=e.editorConfig;this.content.notebookConfig=e.notebookConfig;const t=this.context.sessionContext.kernelPreference;this.context.sessionContext.kernelPreference=Object.assign(Object.assign({},t),{shutdownOnDispose:e.kernelShutdown})}setFragment(e){void this.context.ready.then((()=>{this.content.setFragment(e)}))}dispose(){this.content.dispose();super.dispose()}[o.Printing.symbol](){return async()=>{if(this.context.model.dirty&&!this.context.model.readOnly){await this.context.save()}await o.Printing.printURL(j.PageConfig.getNBConvertURL({format:"html",download:false,path:this.context.path}))}}_onFullyRendered(e,t){t?this.removeClass(Ce):this.addClass(Ce)}_onKernelChanged(e,t){if(!this.model||!t.newValue){return}const{newValue:n}=t;void n.info.then((e=>{var t;if(this.model&&((t=this.context.sessionContext.session)===null||t===void 0?void 0:t.kernel)===n){this._updateLanguage(e.language_info)}}));void this._updateSpec(n)}_onSessionStatusChanged(e,t){var n;if(t==="autorestarting"&&!this._autorestarting){void(0,o.showDialog)({title:this._trans.__("Kernel Restarting"),body:this._trans.__("The kernel for %1 appears to have died. It will restart automatically.",(n=this.sessionContext.session)===null||n===void 0?void 0:n.path),buttons:[o.Dialog.okButton({label:this._trans.__("Ok")})]});this._autorestarting=true}else if(t==="restarting"){}else{this._autorestarting=false}}_updateLanguage(e){this.model.metadata.set("language_info",e)}async _updateSpec(e){const t=await e.spec;if(this.isDisposed){return}this.model.metadata.set("kernelspec",{name:e.name,display_name:t===null||t===void 0?void 0:t.display_name,language:t===null||t===void 0?void 0:t.language})}}(function(e){class t extends he.ContentFactory{createNotebook(e){return new he(e)}}e.ContentFactory=t;e.defaultContentFactory=new t;e.IContentFactory=new a.Token("@jupyterlab/notebook:IContentFactory")})(pe||(pe={}));const _e=new a.Token("@jupyterlab/notebook:INotebookWidgetFactory");const ve=new a.Token("@jupyterlab/notebook:INotebookTools");const be=new a.Token("@jupyterlab/notebook:INotebookTracker");class ye extends o.WidgetTracker{constructor(){super(...arguments);this._activeCell=null;this._activeCellChanged=new d.Signal(this);this._selectionChanged=new d.Signal(this)}get activeCell(){const e=this.currentWidget;if(!e){return null}return e.content.activeCell||null}get activeCellChanged(){return this._activeCellChanged}get selectionChanged(){return this._selectionChanged}add(e){const t=super.add(e);e.content.activeCellChanged.connect(this._onActiveCellChanged,this);e.content.selectionChanged.connect(this._onSelectionChanged,this);return t}dispose(){this._activeCell=null;super.dispose()}onCurrentChanged(e){const t=this.activeCell;if(t&&t===this._activeCell){return}this._activeCell=t;if(!e){return}this._activeCellChanged.emit(e.content.activeCell||null)}_onActiveCellChanged(e,t){if(this.currentWidget&&this.currentWidget.content===e){this._activeCell=t||null;this._activeCellChanged.emit(this._activeCell)}}_onSelectionChanged(e){if(this.currentWidget&&this.currentWidget.content===e){this._selectionChanged.emit(void 0)}}}function ke(e,t){t=t||i.nullTranslator;const n=t.load("jupyterlab");if(e.trustedCells===e.totalCells){return[n.__("Notebook trusted: %1 of %2 cells trusted.",e.trustedCells,e.totalCells),"jp-StatusItem-trusted"]}else if(e.activeCellTrusted){return[n.__("Active cell trusted: %1 of %2 cells trusted.",e.trustedCells,e.totalCells),"jp-StatusItem-trusted"]}else{return[n.__("Notebook not trusted: %1 of %2 cells trusted.",e.trustedCells,e.totalCells),"jp-StatusItem-untrusted"]}}function we(e){if(e.allCellsTrusted){return h().createElement(C.trustedIcon.react,{top:"2px",stylesheet:"statusBar"})}else{return h().createElement(C.notTrustedIcon.react,{top:"2px",stylesheet:"statusBar"})}}class Se extends o.VDomRenderer{constructor(e){super(new Se.Model);this.translator=e||i.nullTranslator}render(){if(!this.model){return null}this.node.title=ke(this.model,this.translator)[0];return h().createElement("div",null,h().createElement(we,{allCellsTrusted:this.model.trustedCells===this.model.totalCells,activeCellTrusted:this.model.activeCellTrusted,totalCells:this.model.totalCells,trustedCells:this.model.trustedCells}))}}(function(e){class t extends o.VDomModel{constructor(){super(...arguments);this._trustedCells=0;this._totalCells=0;this._activeCellTrusted=false;this._notebook=null}get trustedCells(){return this._trustedCells}get totalCells(){return this._totalCells}get activeCellTrusted(){return this._activeCellTrusted}get notebook(){return this._notebook}set notebook(e){const t=this._notebook;if(t!==null){t.activeCellChanged.disconnect(this._onActiveCellChanged,this);t.modelContentChanged.disconnect(this._onModelChanged,this)}const n=this._getAllState();this._notebook=e;if(this._notebook===null){this._trustedCells=0;this._totalCells=0;this._activeCellTrusted=false}else{this._notebook.activeCellChanged.connect(this._onActiveCellChanged,this);this._notebook.modelContentChanged.connect(this._onModelChanged,this);if(this._notebook.activeCell!==undefined){this._activeCellTrusted=this._notebook.activeCell.model.trusted}else{this._activeCellTrusted=false}const{total:e,trusted:t}=this._deriveCellTrustState(this._notebook.model);this._totalCells=e;this._trustedCells=t}this._triggerChange(n,this._getAllState())}_onModelChanged(e){const t=this._getAllState();const{total:n,trusted:o}=this._deriveCellTrustState(e.model);this._totalCells=n;this._trustedCells=o;this._triggerChange(t,this._getAllState())}_onActiveCellChanged(e,t){const n=this._getAllState();if(t){this._activeCellTrusted=t.model.trusted}else{this._activeCellTrusted=false}this._triggerChange(n,this._getAllState())}_deriveCellTrustState(e){if(e===null){return{total:0,trusted:0}}const t=(0,l.toArray)(e.cells);const n=t.reduce(((e,t)=>{if(t.trusted){return e+1}else{return e}}),0);const o=t.length;return{total:o,trusted:n}}_getAllState(){return[this._trustedCells,this._totalCells,this.activeCellTrusted]}_triggerChange(e,t){if(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]){this.stateChanged.emit(void 0)}}}e.Model=t})(Se||(Se={}));class xe extends L.ABCWidgetFactory{constructor(e){super(e);this.rendermime=e.rendermime;this.contentFactory=e.contentFactory||pe.defaultContentFactory;this.mimeTypeService=e.mimeTypeService;this._editorConfig=e.editorConfig||ce.defaultEditorConfig;this._notebookConfig=e.notebookConfig||ce.defaultNotebookConfig;this._sessionDialogs=e.sessionDialogs||o.sessionContextDialogs}get editorConfig(){return this._editorConfig}set editorConfig(e){this._editorConfig=e}get notebookConfig(){return this._notebookConfig}set notebookConfig(e){this._notebookConfig=e}createNewWidget(e,t){const n={rendermime:t?t.content.rendermime:this.rendermime.clone({resolver:e.urlResolver}),contentFactory:this.contentFactory,mimeTypeService:this.mimeTypeService,editorConfig:t?t.content.editorConfig:this._editorConfig,notebookConfig:t?t.content.notebookConfig:this._notebookConfig,translator:this.translator};const o=this.contentFactory.createNotebook(n);return new pe({context:e,content:o})}defaultToolbarFactory(e){return v.getDefaultItems(e,this._sessionDialogs,this.translator)}}var Me=n(42911);function Oe(e){const t=e.translator||i.nullTranslator;const n=(0,o.translateKernelStatuses)(t);const s=t.load("jupyterlab");const l=e.state;const a=e.displayOption.showOnToolBar;const r=e.displayOption.showProgress;const d=a?"down":"up";const c=h().createElement("div",null);if(!l){return c}const u=l.kernelStatus;const g={alignSelf:"normal",height:"24px"};const f=l.totalTime;const m=l.scheduledCellNumber||0;const p=l.scheduledCell.size||0;const _=m-p;let v=100*_/m;let b=r?"":"hidden";if(!r&&v<100){v=0}const y=e=>h().createElement(I.ProgressCircle,{progress:e,width:16,height:24});const k=e=>s.__("Kernel status: %1",e);const w=(e,t,o)=>h().createElement("div",{className:"jp-Notebook-ExecutionIndicator",title:r?"":k(n[e]),"data-status":e},t,h().createElement("div",{className:`jp-Notebook-ExecutionIndicator-tooltip ${d} ${b}`},h().createElement("span",null," ",k(n[e])," "),o));if(l.kernelStatus==="connecting"||l.kernelStatus==="disconnected"||l.kernelStatus==="unknown"){return w(u,h().createElement(C.offlineBoltIcon.react,Object.assign({},g)),[])}if(l.kernelStatus==="starting"||l.kernelStatus==="terminating"||l.kernelStatus==="restarting"||l.kernelStatus==="initializing"){return w(u,h().createElement(C.circleIcon.react,Object.assign({},g)),[])}if(l.executionStatus==="busy"){return w("busy",y(v),[h().createElement("span",{key:0},s.__(`Executed ${_}/${m} requests`)),h().createElement("span",{key:1},s._n("Elapsed time: %1 second","Elapsed time: %1 seconds",f))])}else{if(f===0){return w("idle",y(100),[])}else{return w("idle",y(100),[h().createElement("span",{key:0},s._n("Executed %1 request","Executed %1 requests",m)),h().createElement("span",{key:1},s._n("Elapsed time: %1 second","Elapsed time: %1 seconds",f))])}}}class Ie extends o.VDomRenderer{constructor(e,t=true){super(new Ie.Model);this.translator=e||i.nullTranslator;this.addClass(I.interactiveItem)}render(){if(this.model===null||!this.model.renderFlag){return h().createElement("div",null)}else{const e=this.model.currentNotebook;if(!e){return h().createElement(Oe,{displayOption:this.model.displayOption,state:undefined,translator:this.translator})}return h().createElement(Oe,{displayOption:this.model.displayOption,state:this.model.executionState(e),translator:this.translator})}}}(function(e){class t extends o.VDomModel{constructor(){super();this._notebookExecutionProgress=new WeakMap;this._displayOption={showOnToolBar:true,showProgress:true};this._renderFlag=true}attachNotebook(e){var t,n,o,s;if(e&&e.content&&e.context){const i=e.content;const l=e.context;this._currentNotebook=i;if(!this._notebookExecutionProgress.has(i)){this._notebookExecutionProgress.set(i,{executionStatus:"idle",kernelStatus:"idle",totalTime:0,interval:0,timeout:0,scheduledCell:new Set,scheduledCellNumber:0,needReset:true});const e=this._notebookExecutionProgress.get(i);const a=t=>{if(e){e.kernelStatus=t.kernelDisplayStatus}this.stateChanged.emit(void 0)};l.statusChanged.connect(a,this);const r=t=>{if(e){e.kernelStatus=t.kernelDisplayStatus}this.stateChanged.emit(void 0)};l.connectionStatusChanged.connect(r,this);l.disposed.connect((e=>{e.connectionStatusChanged.disconnect(r,this);e.statusChanged.disconnect(a,this)}));const d=(e,t)=>{const n=t.msg;const o=n.header.msg_id;if(Me.KernelMessage.isCommMsgMsg(n)&&n.content.data["method"]){const e=n.content.data["method"];if(e!=="request_state"&&e!=="update"){this._cellScheduledCallback(i,o);this._startTimer(i)}}else if(n.header.msg_type==="execute_request"){this._cellScheduledCallback(i,o)}else if(Me.KernelMessage.isStatusMsg(n)&&n.content.execution_state==="idle"){const e=n.parent_header.msg_id;this._cellExecutedCallback(i,e)}else if(n.header.msg_type==="execute_input"){this._startTimer(i)}};(n=(t=l.session)===null||t===void 0?void 0:t.kernel)===null||n===void 0?void 0:n.anyMessage.connect(d);(s=(o=l.session)===null||o===void 0?void 0:o.kernel)===null||s===void 0?void 0:s.disposed.connect((e=>e.anyMessage.disconnect(d)));const c=(t,n)=>{if(e){this._resetTime(e);this.stateChanged.emit(void 0);if(n.newValue){n.newValue.anyMessage.connect(d)}}};l.kernelChanged.connect(c);l.disposed.connect((e=>e.kernelChanged.disconnect(c)))}}}get currentNotebook(){return this._currentNotebook}get displayOption(){return this._displayOption}set displayOption(e){this._displayOption=e}executionState(e){return this._notebookExecutionProgress.get(e)}_cellExecutedCallback(e,t){const n=this._notebookExecutionProgress.get(e);if(n&&n.scheduledCell.has(t)){n.scheduledCell.delete(t);if(n.scheduledCell.size===0){window.setTimeout((()=>{n.executionStatus="idle";clearInterval(n.interval);this.stateChanged.emit(void 0)}),150);n.timeout=window.setTimeout((()=>{n.needReset=true}),1e3)}}}_startTimer(e){const t=this._notebookExecutionProgress.get(e);if(t){if(t.executionStatus!=="busy"){t.executionStatus="busy";clearTimeout(t.timeout);this.stateChanged.emit(void 0);t.interval=window.setInterval((()=>{this._tick(t)}),1e3)}}}_cellScheduledCallback(e,t){const n=this._notebookExecutionProgress.get(e);if(n&&!n.scheduledCell.has(t)){if(n.needReset){this._resetTime(n)}n.scheduledCell.add(t);n.scheduledCellNumber+=1}}_tick(e){e.totalTime+=1;this.stateChanged.emit(void 0)}_resetTime(e){e.totalTime=0;e.scheduledCellNumber=0;e.executionStatus="idle";e.scheduledCell=new Set;clearTimeout(e.timeout);clearInterval(e.interval);e.needReset=false}get renderFlag(){return this._renderFlag}updateRenderOption(e){if(this.displayOption.showOnToolBar){if(!e.showOnToolBar){this._renderFlag=false}else{this._renderFlag=true}}this.displayOption.showProgress=e.showProgress;this.stateChanged.emit(void 0)}}e.Model=t;function n(t,n,o){const i=new e(n);i.model.displayOption={showOnToolBar:true,showProgress:true};i.model.attachNotebook({content:t.content,context:t.sessionContext});t.disposed.connect((()=>{i.dispose()}));if(o){o.then((e=>{i.model.updateRenderOption(s(e));e.changed.connect((e=>{i.model.updateRenderOption(s(e))}))})).catch((e=>{console.error(e.message)}))}return i}e.createExecutionIndicatorItem=n;function s(e){let t=true;let n=true;const o=e.get("kernelStatus").composite;if(o){t=!o.showOnStatusBar;n=o.showProgress}return{showOnToolBar:t,showProgress:n}}e.getSettingValue=s})(Ie||(Ie={}))}}]);
//# sourceMappingURL=3202.1a5754d67e8a83ae13d3.js.map?v=1a5754d67e8a83ae13d3