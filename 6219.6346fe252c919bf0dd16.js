"use strict";(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[6219],{6219:(e,t,i)=>{i.r(t);i.d(t,{COMPLETER_ACTIVE_CLASS:()=>b,COMPLETER_ENABLED_CLASS:()=>N,CodeEditor:()=>a,CodeEditorWrapper:()=>k,CodeViewerWidget:()=>B,IEditorMimeTypeService:()=>r,IEditorServices:()=>T,IPositionModel:()=>x,JSONEditor:()=>g,LineCol:()=>E});var s=i(33792);var o=i(54999);var n=i(19289);var r;(function(e){e.defaultMimeType="text/plain"})(r||(r={}));var a;(function(e){class t{constructor(e={}){var t,i;this.standaloneModel=false;this._isDisposed=false;this._selections=new o.ObservableMap;this._mimeType=r.defaultMimeType;this._mimeTypeChanged=new n.Signal(this);this.standaloneModel=typeof e.sharedModel==="undefined";this.sharedModel=(t=e.sharedModel)!==null&&t!==void 0?t:new s.YFile;this._mimeType=(i=e.mimeType)!==null&&i!==void 0?i:r.defaultMimeType}get mimeTypeChanged(){return this._mimeTypeChanged}get selections(){return this._selections}get mimeType(){return this._mimeType}set mimeType(e){const t=this.mimeType;if(t===e){return}this._mimeType=e;this._mimeTypeChanged.emit({name:"mimeType",oldValue:t,newValue:e})}get isDisposed(){return this._isDisposed}dispose(){if(this._isDisposed){return}this._isDisposed=true;this._selections.dispose();if(this.standaloneModel){this.sharedModel.dispose()}n.Signal.clearData(this)}}e.Model=t})(a||(a={}));var d=i(50724);var l=i(27425);var h=i(55172);var c=i(65178);const u="jp-JSONEditor";const m="jp-mod-error";const p="jp-JSONEditor-host";const _="jp-JSONEditor-header";class g extends c.Widget{constructor(e){super();this._dataDirty=false;this._inputDirty=false;this._source=null;this._originalValue=h.JSONExt.emptyObject;this._changeGuard=false;this.translator=e.translator||d.nullTranslator;this._trans=this.translator.load("jupyterlab");this.addClass(u);this.headerNode=document.createElement("div");this.headerNode.className=_;this.revertButtonNode=l.undoIcon.element({tag:"span",title:this._trans.__("Revert changes to data")});this.commitButtonNode=l.checkIcon.element({tag:"span",title:this._trans.__("Commit changes to data"),marginLeft:"8px"});this.editorHostNode=document.createElement("div");this.editorHostNode.className=p;this.headerNode.appendChild(this.revertButtonNode);this.headerNode.appendChild(this.commitButtonNode);this.node.appendChild(this.headerNode);this.node.appendChild(this.editorHostNode);const t=new a.Model({mimeType:"application/json"});t.sharedModel.changed.connect(this._onModelChanged,this);this.model=t;this.editor=e.editorFactory({host:this.editorHostNode,model:t,config:{readOnly:true}})}get source(){return this._source}set source(e){if(this._source===e){return}if(this._source){this._source.changed.disconnect(this._onSourceChanged,this)}this._source=e;this.editor.setOption("readOnly",e===null);if(e){e.changed.connect(this._onSourceChanged,this)}this._setValue()}get isDirty(){return this._dataDirty||this._inputDirty}dispose(){var e;if(this.isDisposed){return}(e=this.source)===null||e===void 0?void 0:e.dispose();this.model.dispose();this.editor.dispose();super.dispose()}handleEvent(e){switch(e.type){case"blur":this._evtBlur(e);break;case"click":this._evtClick(e);break;default:break}}onAfterAttach(e){const t=this.editorHostNode;t.addEventListener("blur",this,true);t.addEventListener("click",this,true);this.revertButtonNode.hidden=true;this.commitButtonNode.hidden=true;this.headerNode.addEventListener("click",this)}onBeforeDetach(e){const t=this.editorHostNode;t.removeEventListener("blur",this,true);t.removeEventListener("click",this,true);this.headerNode.removeEventListener("click",this)}_onSourceChanged(e,t){if(this._changeGuard){return}if(this._inputDirty||this.editor.hasFocus()){this._dataDirty=true;return}this._setValue()}_onModelChanged(e,t){if(t.sourceChange){let e=true;try{const e=JSON.parse(this.editor.model.sharedModel.getSource());this.removeClass(m);this._inputDirty=!this._changeGuard&&!h.JSONExt.deepEqual(e,this._originalValue)}catch(i){this.addClass(m);this._inputDirty=true;e=false}this.revertButtonNode.hidden=!this._inputDirty;this.commitButtonNode.hidden=!e||!this._inputDirty}}_evtBlur(e){if(!this._inputDirty&&this._dataDirty){this._setValue()}}_evtClick(e){const t=e.target;if(this.revertButtonNode.contains(t)){this._setValue()}else if(this.commitButtonNode.contains(t)){if(!this.commitButtonNode.hidden&&!this.hasClass(m)){this._changeGuard=true;this._mergeContent();this._changeGuard=false;this._setValue()}}else if(this.editorHostNode.contains(t)){this.editor.focus()}}_mergeContent(){const e=this.editor.model;const t=this._originalValue;const i=JSON.parse(e.sharedModel.getSource());const s=this.source;if(!s){return}for(const o in i){if(!h.JSONExt.deepEqual(i[o],t[o]||null)){s.set(o,i[o])}}for(const o in t){if(!(o in i)){s.delete(o)}}}_setValue(){this._dataDirty=false;this._inputDirty=false;this.revertButtonNode.hidden=true;this.commitButtonNode.hidden=true;this.removeClass(m);const e=this.editor.model;const t=this._source?this._source.toJSON():{};this._changeGuard=true;if(t===void 0){e.sharedModel.setSource(this._trans.__("No data!"));this._originalValue=h.JSONExt.emptyObject}else{const i=JSON.stringify(t,null,4);e.sharedModel.setSource(i);this._originalValue=t;if(i.length>1&&i[0]==="{"){this.editor.setCursorPosition({line:0,column:1})}}this._changeGuard=false;this.commitButtonNode.hidden=true;this.revertButtonNode.hidden=true}}var v=i(53825);var f=i(37900);var y=i.n(f);var C=i(87447);class D extends y().Component{constructor(e){super(e);this._handleChange=e=>{this.setState({value:e.currentTarget.value})};this._handleSubmit=e=>{e.preventDefault();const t=parseInt(this._textInput.value,10);if(!isNaN(t)&&isFinite(t)&&1<=t&&t<=this.props.maxLine){this.props.handleSubmit(t)}return false};this._handleFocus=()=>{this.setState({hasFocus:true})};this._handleBlur=()=>{this.setState({hasFocus:false})};this._textInput=null;this.translator=e.translator||d.nullTranslator;this._trans=this.translator.load("jupyterlab");this.state={value:"",hasFocus:false,textInputId:C.DOMUtils.createDomID()+"-line-number-input"}}componentDidMount(){this._textInput.focus()}render(){return y().createElement("div",{className:"jp-lineFormSearch"},y().createElement("form",{name:"lineColumnForm",onSubmit:this._handleSubmit,noValidate:true},y().createElement("div",{className:(0,l.classes)("jp-lineFormWrapper","lm-lineForm-wrapper",this.state.hasFocus?"jp-lineFormWrapperFocusWithin":undefined)},y().createElement("input",{type:"text",id:this.state.textInputId,className:"jp-lineFormInput",onChange:this._handleChange,onFocus:this._handleFocus,onBlur:this._handleBlur,value:this.state.value,ref:e=>{this._textInput=e}}),y().createElement("div",{className:"jp-baseLineForm jp-lineFormButtonContainer"},y().createElement(l.lineFormIcon.react,{className:"jp-baseLineForm jp-lineFormButtonIcon",elementPosition:"center"}),y().createElement("input",{type:"submit",className:"jp-baseLineForm jp-lineFormButton",value:""}))),y().createElement("label",{className:"jp-lineFormCaption",htmlFor:this.state.textInputId},this._trans.__("Go to line number between 1 and %1",this.props.maxLine))))}}function S(e){const t=e.translator||d.nullTranslator;const i=t.load("jupyterlab");const s=t=>{if(t.key==="Enter"||t.key==="Spacebar"||t.key===" "){t.preventDefault();t.stopPropagation();e.handleClick()}else{return}};return y().createElement(v.TextItem,{onClick:e.handleClick,source:i.__("Ln %1, Col %2",e.line,e.column),title:i.__("Go to line numberâ€¦"),tabIndex:0,onKeyDown:s})}class E extends l.VDomRenderer{constructor(e){super(new E.Model);this._popup=null;this.addClass("jp-mod-highlighted");this.translator=e||d.nullTranslator}render(){if(this.model===null){return null}else{return y().createElement(S,{line:this.model.line,column:this.model.column,translator:this.translator,handleClick:()=>this._handleClick()})}}_handleClick(){if(this._popup){this._popup.dispose()}const e=l.ReactWidget.create(y().createElement(D,{handleSubmit:e=>this._handleSubmit(e),currentLine:this.model.line,maxLine:this.model.editor.lineCount,translator:this.translator}));this._popup=(0,v.showPopup)({body:e,anchor:this,align:"right"})}_handleSubmit(e){this.model.editor.setCursorPosition({line:e-1,column:0});this._popup.dispose();this.model.editor.focus()}}(function(e){class t extends l.VDomModel{constructor(){super(...arguments);this._onSelectionChanged=()=>{const e=this._getAllState();const t=this.editor.getCursorPosition();this._line=t.line+1;this._column=t.column+1;this._triggerChange(e,this._getAllState())};this._line=1;this._column=1;this._editor=null}get editor(){return this._editor}set editor(e){var t;const i=this._editor;if((t=i===null||i===void 0?void 0:i.model)===null||t===void 0?void 0:t.selections){i.model.selections.changed.disconnect(this._onSelectionChanged)}const s=this._getAllState();this._editor=e;if(!this._editor){this._column=1;this._line=1}else{this._editor.model.selections.changed.connect(this._onSelectionChanged);const e=this._editor.getCursorPosition();this._column=e.column+1;this._line=e.line+1}this._triggerChange(s,this._getAllState())}get line(){return this._line}get column(){return this._column}_getAllState(){return[this._line,this._column]}_triggerChange(e,t){if(e[0]!==t[0]||e[1]!==t[1]){this.stateChanged.emit(void 0)}}}e.Model=t})(E||(E={}));const N="jp-mod-completer-enabled";const b="jp-mod-completer-active";const T=new h.Token("@jupyterlab/codeeditor:IEditorServices",`A service for the text editor provider\n  for the application. Use this to create new text editors and host them in your\n  UI elements.`);const x=new h.Token("@jupyterlab/codeeditor:IPositionModel",`A service to handle an code editor cursor position.`);const O="jp-mod-has-primary-selection";const M="jp-mod-in-leading-whitespace";const L="jp-mod-dropTarget";const j=/^\s+$/;class k extends c.Widget{constructor(e){super();const{factory:t,model:i,editorOptions:s}=e;const o=this.editor=t({host:this.node,model:i,...s});o.model.selections.changed.connect(this._onSelectionsChanged,this)}get model(){return this.editor.model}dispose(){if(this.isDisposed){return}this.editor.dispose();super.dispose()}handleEvent(e){switch(e.type){case"lm-dragenter":this._evtDragEnter(e);break;case"lm-dragleave":this._evtDragLeave(e);break;case"lm-dragover":this._evtDragOver(e);break;case"lm-drop":this._evtDrop(e);break;default:break}}onActivateRequest(e){this.editor.focus()}onAfterAttach(e){super.onAfterAttach(e);const t=this.node;t.addEventListener("lm-dragenter",this);t.addEventListener("lm-dragleave",this);t.addEventListener("lm-dragover",this);t.addEventListener("lm-drop",this)}onBeforeDetach(e){const t=this.node;t.removeEventListener("lm-dragenter",this);t.removeEventListener("lm-dragleave",this);t.removeEventListener("lm-dragover",this);t.removeEventListener("lm-drop",this)}_onSelectionsChanged(){const{start:e,end:t}=this.editor.getSelection();if(e.column!==t.column||e.line!==t.line){this.addClass(O);this.removeClass(M)}else{this.removeClass(O);if(this.editor.getLine(t.line).slice(0,t.column).match(j)){this.addClass(M)}else{this.removeClass(M)}}}_evtDragEnter(e){if(this.editor.getOption("readOnly")===true){return}const t=F.findTextData(e.mimeData);if(t===undefined){return}e.preventDefault();e.stopPropagation();this.addClass("jp-mod-dropTarget")}_evtDragLeave(e){this.removeClass(L);if(this.editor.getOption("readOnly")===true){return}const t=F.findTextData(e.mimeData);if(t===undefined){return}e.preventDefault();e.stopPropagation()}_evtDragOver(e){this.removeClass(L);if(this.editor.getOption("readOnly")===true){return}const t=F.findTextData(e.mimeData);if(t===undefined){return}e.preventDefault();e.stopPropagation();e.dropAction="copy";this.addClass(L)}_evtDrop(e){if(this.editor.getOption("readOnly")===true){return}const t=F.findTextData(e.mimeData);if(t===undefined){return}const i={top:e.y,bottom:e.y,left:e.x,right:e.x,x:e.x,y:e.y,width:0,height:0};const s=this.editor.getPositionForCoordinate(i);if(s===null){return}this.removeClass(L);e.preventDefault();e.stopPropagation();if(e.proposedAction==="none"){e.dropAction="none";return}const o=this.editor.getOffsetAt(s);this.model.sharedModel.updateSource(o,o,t)}}var F;(function(e){function t(e){const t=e.types();const i=t.find((e=>e.indexOf("text")===0));if(i===undefined){return undefined}return e.getData(i)}e.findTextData=t})(F||(F={}));class B extends c.Widget{constructor(e){var t;super();this.model=e.model;const i=new k({factory:e.factory,model:this.model,editorOptions:{...e.editorOptions,config:{...(t=e.editorOptions)===null||t===void 0?void 0:t.config,readOnly:true}}});this.editor=i.editor;const s=this.layout=new c.StackedLayout;s.addWidget(i)}static createCodeViewer(e){const{content:t,mimeType:i,...s}=e;const o=new a.Model({mimeType:i});o.sharedModel.setSource(t);const n=new B({...s,model:o});n.disposed.connect((()=>{o.dispose()}));return n}get content(){return this.model.sharedModel.getSource()}get mimeType(){return this.model.mimeType}}}}]);
//# sourceMappingURL=6219.6346fe252c919bf0dd16.js.map?v=6346fe252c919bf0dd16