"use strict";(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[2240],{32240:(e,t,r)=>{r.r(t);r.d(t,{default:()=>L});var n=r(49655);var i=r.n(n);var o=r(87447);var a=r.n(o);var s=r(34548);var c=r(47922);var d=r(80379);var l=r.n(d);var h=r(95009);var u=r.n(h);var g=r(68299);var _=r.n(g);var m=r(50724);var v=r.n(m);const p="CSVTable";const y="TSVTable";var f;(function(e){e.CSVGoToLine="csv:go-to-line";e.TSVGoToLine="tsv:go-to-line"})(f||(f={}));const w={activate:T,id:"@jupyterlab/csvviewer-extension:csv",description:"Adds viewer for CSV file types",requires:[m.ITranslator],optional:[n.ILayoutRestorer,o.IThemeManager,h.IMainMenu,d.ISearchProviderRegistry,g.ISettingRegistry,o.IToolbarWidgetRegistry],autoStart:true};const C={activate:b,id:"@jupyterlab/csvviewer-extension:tsv",description:"Adds viewer for TSV file types.",requires:[m.ITranslator],optional:[n.ILayoutRestorer,o.IThemeManager,h.IMainMenu,d.ISearchProviderRegistry,g.ISettingRegistry,o.IToolbarWidgetRegistry],autoStart:true};function T(e,t,n,i,a,d,l,h){const{commands:u,shell:g}=e;let _;if(h){h.addFactory(p,"delimiter",(e=>new c.p({widget:e.content,translator:t})));if(l){_=(0,o.createToolbarFactory)(h,l,p,w.id,t)}}const m=t.load("jupyterlab");const v=new s.LT({name:p,label:m.__("CSV Viewer"),fileTypes:["csv"],defaultFor:["csv"],readOnly:true,toolbarFactory:_,translator:t});const y=new o.WidgetTracker({namespace:"csvviewer"});let C=F.LIGHT_STYLE;let T=F.LIGHT_TEXT_CONFIG;if(n){void n.restore(y,{command:"docmanager:open",args:e=>({path:e.context.path,factory:p}),name:e=>e.context.path})}e.docRegistry.addWidgetFactory(v);const b=e.docRegistry.getFileType("csv");let S=false;v.widgetCreated.connect((async(e,t)=>{void y.add(t);t.context.pathChanged.connect((()=>{void y.save(t)}));if(b){t.title.icon=b.icon;t.title.iconClass=b.iconClass;t.title.iconLabel=b.iconLabel}if(d&&!S){const{CSVSearchProvider:e}=await r.e(5077).then(r.bind(r,85077));d.add("csv",e);S=true}await t.content.ready;t.content.style=C;t.content.rendererConfig=T}));const L=()=>{const e=i&&i.theme?i.isLight(i.theme):true;C=e?F.LIGHT_STYLE:F.DARK_STYLE;T=e?F.LIGHT_TEXT_CONFIG:F.DARK_TEXT_CONFIG;y.forEach((async e=>{await e.content.ready;e.content.style=C;e.content.rendererConfig=T}))};if(i){i.themeChanged.connect(L)}const G=()=>y.currentWidget!==null&&y.currentWidget===g.currentWidget;u.addCommand(f.CSVGoToLine,{label:m.__("Go to Line"),execute:async()=>{const e=y.currentWidget;if(e===null){return}const t=await o.InputDialog.getNumber({title:m.__("Go to Line"),value:0});if(t.button.accept&&t.value!==null){e.content.goToLine(t.value)}},isEnabled:G});if(a){a.editMenu.goToLiners.add({id:f.CSVGoToLine,isEnabled:G})}}function b(e,t,n,i,a,d,l,h){const{commands:u,shell:g}=e;let _;if(h){h.addFactory(y,"delimiter",(e=>new c.p({widget:e.content,translator:t})));if(l){_=(0,o.createToolbarFactory)(h,l,y,C.id,t)}}const m=t.load("jupyterlab");const v=new s._d({name:y,label:m.__("TSV Viewer"),fileTypes:["tsv"],defaultFor:["tsv"],readOnly:true,toolbarFactory:_,translator:t});const p=new o.WidgetTracker({namespace:"tsvviewer"});let w=F.LIGHT_STYLE;let T=F.LIGHT_TEXT_CONFIG;if(n){void n.restore(p,{command:"docmanager:open",args:e=>({path:e.context.path,factory:y}),name:e=>e.context.path})}e.docRegistry.addWidgetFactory(v);const b=e.docRegistry.getFileType("tsv");let S=false;v.widgetCreated.connect((async(e,t)=>{void p.add(t);t.context.pathChanged.connect((()=>{void p.save(t)}));if(b){t.title.icon=b.icon;t.title.iconClass=b.iconClass;t.title.iconLabel=b.iconLabel}if(d&&!S){const{CSVSearchProvider:e}=await r.e(5077).then(r.bind(r,85077));d.add("tsv",e);S=true}await t.content.ready;t.content.style=w;t.content.rendererConfig=T}));const L=()=>{const e=i&&i.theme?i.isLight(i.theme):true;w=e?F.LIGHT_STYLE:F.DARK_STYLE;T=e?F.LIGHT_TEXT_CONFIG:F.DARK_TEXT_CONFIG;p.forEach((async e=>{await e.content.ready;e.content.style=w;e.content.rendererConfig=T}))};if(i){i.themeChanged.connect(L)}const G=()=>p.currentWidget!==null&&p.currentWidget===g.currentWidget;u.addCommand(f.TSVGoToLine,{label:m.__("Go to Line"),execute:async()=>{const e=p.currentWidget;if(e===null){return}const t=await o.InputDialog.getNumber({title:m.__("Go to Line"),value:0});if(t.button.accept&&t.value!==null){e.content.goToLine(t.value)}},isEnabled:G});if(a){a.editMenu.goToLiners.add({id:f.TSVGoToLine,isEnabled:G})}}const S=[w,C];const L=S;var F;(function(e){e.LIGHT_STYLE={voidColor:"#F3F3F3",backgroundColor:"white",headerBackgroundColor:"#EEEEEE",gridLineColor:"rgba(20, 20, 20, 0.15)",headerGridLineColor:"rgba(20, 20, 20, 0.25)",rowBackgroundColor:e=>e%2===0?"#F5F5F5":"white"};e.DARK_STYLE={voidColor:"black",backgroundColor:"#111111",headerBackgroundColor:"#424242",gridLineColor:"rgba(235, 235, 235, 0.15)",headerGridLineColor:"rgba(235, 235, 235, 0.25)",rowBackgroundColor:e=>e%2===0?"#212121":"#111111"};e.LIGHT_TEXT_CONFIG={textColor:"#111111",matchBackgroundColor:"#FFFFE0",currentMatchBackgroundColor:"#FFFF00",horizontalAlignment:"right"};e.DARK_TEXT_CONFIG={textColor:"#F5F5F5",matchBackgroundColor:"#838423",currentMatchBackgroundColor:"#A3807A",horizontalAlignment:"right"}})(F||(F={}))},47922:(e,t,r)=>{r.d(t,{p:()=>u});var n=r(50724);var i=r.n(n);var o=r(27425);var a=r.n(o);var s=r(65178);var c=r.n(s);const d="jp-CSVDelimiter";const l="jp-CSVDelimiter-label";const h="jp-CSVDelimiter-dropdown";class u extends s.Widget{constructor(e){super({node:g.createNode(e.widget.delimiter,e.translator)});this._widget=e.widget;this.addClass(d)}get selectNode(){return this.node.getElementsByTagName("select")[0]}handleEvent(e){switch(e.type){case"change":this._widget.delimiter=this.selectNode.value;break;default:break}}onAfterAttach(e){this.selectNode.addEventListener("change",this)}onBeforeDetach(e){this.selectNode.removeEventListener("change",this)}}var g;(function(e){function t(e,t){t=t||n.nullTranslator;const r=t===null||t===void 0?void 0:t.load("jupyterlab");const i=[[",",","],[";",";"],["\t",r.__("tab")],["|",r.__("pipe")],["#",r.__("hash")]];const a=document.createElement("div");const s=document.createElement("span");const c=document.createElement("select");s.textContent=r.__("Delimiter: ");s.className=l;for(const[n,o]of i){const t=document.createElement("option");t.value=n;t.textContent=o;if(n===e){t.selected=true}c.appendChild(t)}a.appendChild(s);const d=o.Styling.wrapSelect(c);d.classList.add(h);a.appendChild(d);return a}e.createNode=t})(g||(g={}))},34548:(e,t,r)=>{r.d(t,{A9:()=>f,B0:()=>p,JZ:()=>y,LT:()=>C,_d:()=>T,kw:()=>w});var n=r(78098);var i=r.n(n);var o=r(35627);var a=r.n(o);var s=r(55172);var c=r.n(s);var d=r(19289);var l=r.n(d);var h=r(65178);var u=r.n(h);var g=r(47922);const _="jp-CSVViewer";const m="jp-CSVViewer-grid";const v=1e3;class p{}class y{constructor(e){this._looping=true;this._changed=new d.Signal(this);this._grid=e;this._query=null;this._row=0;this._column=-1}get changed(){return this._changed}cellBackgroundColorRendererFunc(e){return({value:t,row:r,column:n})=>{if(this._query){if(t.match(this._query)){if(this._row===r&&this._column===n){return e.currentMatchBackgroundColor}return e.matchBackgroundColor}}return""}}clear(){this._query=null;this._row=0;this._column=-1;this._changed.emit(undefined)}find(e,t=false){const r=this._grid.dataModel;const n=r.rowCount("body");const i=r.columnCount("body");if(this._query!==e){this._row=0;this._column=-1}this._query=e;const o=this._grid.scrollY/this._grid.defaultSizes.rowHeight;const a=(this._grid.scrollY+this._grid.pageHeight)/this._grid.defaultSizes.rowHeight;const s=this._grid.scrollX/this._grid.defaultSizes.columnHeaderHeight;const c=(this._grid.scrollX+this._grid.pageWidth)/this._grid.defaultSizes.columnHeaderHeight;const d=(e,t)=>e>=o&&e<=a&&t>=s&&t<=c;const l=t?-1:1;this._column+=l;for(let h=this._row;t?h>=0:h<n;h+=l){for(let n=this._column;t?n>=0:n<i;n+=l){const t=r.data("body",h,n);if(t.match(e)){this._changed.emit(undefined);if(!d(h,n)){this._grid.scrollToRow(h)}this._row=h;this._column=n;return true}}this._column=t?i-1:0}if(this._looping){this._looping=false;this._row=t?0:n-1;this._wrapRows(t);try{return this.find(e,t)}finally{this._looping=true}}return false}_wrapRows(e=false){const t=this._grid.dataModel;const r=t.rowCount("body");const n=t.columnCount("body");if(e&&this._row<=0){this._row=r-1;this._column=n}else if(!e&&this._row>=r-1){this._row=0;this._column=-1}}get query(){return this._query}}class f extends h.Widget{constructor(e){super();this._monitor=null;this._delimiter=",";this._revealed=new s.PromiseDelegate;this._baseRenderer=null;this._context=e.context;this.layout=new h.PanelLayout;this.addClass(_);this._ready=this.initialize()}get ready(){return this._ready}async initialize(){const e=this.layout;if(this.isDisposed||!e){return}const{BasicKeyHandler:t,BasicMouseHandler:r,DataGrid:i}=await b.ensureDataGrid();this._defaultStyle=i.defaultStyle;this._grid=new i({defaultSizes:{rowHeight:24,columnWidth:144,rowHeaderWidth:64,columnHeaderHeight:36}});this._grid.addClass(m);this._grid.headerVisibility="all";this._grid.keyHandler=new t;this._grid.mouseHandler=new r;this._grid.copyConfig={separator:"\t",format:i.copyFormatGeneric,headers:"all",warningThreshold:1e6};e.addWidget(this._grid);this._searchService=new y(this._grid);this._searchService.changed.connect(this._updateRenderer,this);await this._context.ready;await this._updateGrid();this._revealed.resolve(undefined);this._monitor=new n.ActivityMonitor({signal:this._context.model.contentChanged,timeout:v});this._monitor.activityStopped.connect(this._updateGrid,this)}get context(){return this._context}get revealed(){return this._revealed.promise}get delimiter(){return this._delimiter}set delimiter(e){if(e===this._delimiter){return}this._delimiter=e;void this._updateGrid()}get style(){return this._grid.style}set style(e){this._grid.style={...this._defaultStyle,...e}}set rendererConfig(e){this._baseRenderer=e;void this._updateRenderer()}get searchService(){return this._searchService}dispose(){if(this._monitor){this._monitor.dispose()}super.dispose()}goToLine(e){this._grid.scrollToRow(e)}onActivateRequest(e){this.node.tabIndex=-1;this.node.focus()}async _updateGrid(){const{BasicSelectionModel:e}=await b.ensureDataGrid();const{DSVModel:t}=await b.ensureDSVModel();const r=this._context.model.toString();const n=this._delimiter;const i=this._grid.dataModel;const o=this._grid.dataModel=new t({data:r,delimiter:n});this._grid.selectionModel=new e({dataModel:o});if(i){i.dispose()}}async _updateRenderer(){if(this._baseRenderer===null){return}const{TextRenderer:e}=await b.ensureDataGrid();const t=this._baseRenderer;const r=new e({textColor:t.textColor,horizontalAlignment:t.horizontalAlignment,backgroundColor:this._searchService.cellBackgroundColorRendererFunc(t)});this._grid.cellRenderers.update({body:r,"column-header":r,"corner-header":r,"row-header":r})}}class w extends o.DocumentWidget{constructor(e){let{content:t,context:r,delimiter:n,reveal:i,...o}=e;t=t||b.createContent(r);i=Promise.all([i,t.revealed]);super({content:t,context:r,reveal:i,...o});if(n){t.delimiter=n}}setFragment(e){const t=e.split("=");if(t[0]!=="#row"){return}let r=t[1].split(";")[0];r=r.split("-")[0];void this.context.ready.then((()=>{this.content.goToLine(Number(r))}))}}class C extends o.ABCWidgetFactory{createNewWidget(e){const t=this.translator;return new w({context:e,translator:t})}defaultToolbarFactory(e){return[{name:"delimiter",widget:new g.p({widget:e.content,translator:this.translator})}]}}class T extends C{createNewWidget(e){const t="\t";return new w({context:e,delimiter:t,translator:this.translator})}}var b;(function(e){let t=null;let n=null;async function i(){if(t==null){t=new s.PromiseDelegate;t.resolve(await r.e(6221).then(r.t.bind(r,76221,23)))}return t.promise}e.ensureDataGrid=i;async function o(){if(n==null){n=new s.PromiseDelegate;n.resolve(await Promise.all([r.e(6221),r.e(7535)]).then(r.bind(r,37535)))}return n.promise}e.ensureDSVModel=o;function a(e){return new f({context:e})}e.createContent=a})(b||(b={}))}}]);
//# sourceMappingURL=2240.71dc674aa3191d2e527f.js.map?v=71dc674aa3191d2e527f