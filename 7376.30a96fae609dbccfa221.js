"use strict";(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[7376],{77376:(e,t,i)=>{i.r(t);i.d(t,{BaseSettings:()=>y,DefaultSchemaValidator:()=>m,ISettingRegistry:()=>w,SettingRegistry:()=>f,Settings:()=>g});var n=i(22635);var s=i(55172);var r=i(82524);var o=i(19289);var a=i(27991);var c=i.n(a);var d=i(96111);const l=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema","title":"JupyterLab Plugin Settings/Preferences Schema","description":"JupyterLab plugin settings/preferences schema","version":"1.0.0","type":"object","additionalProperties":true,"properties":{"jupyter.lab.internationalization":{"type":"object","properties":{"selectors":{"type":"array","items":{"type":"string","minLength":1}},"domain":{"type":"string","minLength":1}}},"jupyter.lab.menus":{"type":"object","properties":{"main":{"title":"Main menu entries","description":"List of menu items to add to the main menubar.","items":{"$ref":"#/definitions/menu"},"type":"array","default":[]},"context":{"title":"The application context menu.","description":"List of context menu items.","items":{"allOf":[{"$ref":"#/definitions/menuItem"},{"properties":{"selector":{"description":"The CSS selector for the context menu item.","type":"string"}}}]},"type":"array","default":[]}},"additionalProperties":false},"jupyter.lab.metadataforms":{"items":{"$ref":"#/definitions/metadataForm"},"type":"array","default":[]},"jupyter.lab.setting-deprecated":{"type":"boolean","default":false},"jupyter.lab.setting-icon":{"type":"string","default":""},"jupyter.lab.setting-icon-class":{"type":"string","default":""},"jupyter.lab.setting-icon-label":{"type":"string","default":"Plugin"},"jupyter.lab.shortcuts":{"items":{"$ref":"#/definitions/shortcut"},"type":"array","default":[]},"jupyter.lab.toolbars":{"properties":{"^\\\\w[\\\\w-\\\\.]*$":{"items":{"$ref":"#/definitions/toolbarItem"},"type":"array","default":[]}},"type":"object","default":{}},"jupyter.lab.transform":{"type":"boolean","default":false}},"definitions":{"menu":{"properties":{"disabled":{"description":"Whether the menu is disabled or not","type":"boolean","default":false},"icon":{"description":"Menu icon id","type":"string"},"id":{"description":"Menu unique id","oneOf":[{"type":"string","enum":["jp-menu-file","jp-menu-file-new","jp-menu-edit","jp-menu-help","jp-menu-kernel","jp-menu-run","jp-menu-settings","jp-menu-view","jp-menu-tabs"]},{"type":"string","pattern":"[a-z][a-z0-9\\\\-_]+"}]},"items":{"description":"Menu items","type":"array","items":{"$ref":"#/definitions/menuItem"}},"label":{"description":"Menu label","type":"string"},"mnemonic":{"description":"Mnemonic index for the label","type":"number","minimum":-1,"default":-1},"rank":{"description":"Menu rank","type":"number","minimum":0}},"required":["id"],"type":"object"},"menuItem":{"properties":{"args":{"description":"Command arguments","type":"object"},"command":{"description":"Command id","type":"string"},"disabled":{"description":"Whether the item is disabled or not","type":"boolean","default":false},"type":{"description":"Item type","type":"string","enum":["command","submenu","separator"],"default":"command"},"rank":{"description":"Item rank","type":"number","minimum":0},"submenu":{"oneOf":[{"$ref":"#/definitions/menu"},{"type":"null"}]}},"type":"object"},"shortcut":{"properties":{"args":{"title":"The arguments for the command","type":"object"},"command":{"title":"The command id","description":"The command executed when the binding is matched.","type":"string"},"disabled":{"description":"Whether this shortcut is disabled or not.","type":"boolean","default":false},"keys":{"title":"The key sequence for the binding","description":"The key shortcut like `Accel A` or the sequence of shortcuts to press like [`Accel A`, `B`]","items":{"type":"string"},"type":"array"},"macKeys":{"title":"The key sequence for the binding on macOS","description":"The key shortcut like `Cmd A` or the sequence of shortcuts to press like [`Cmd A`, `B`]","items":{"type":"string"},"type":"array"},"winKeys":{"title":"The key sequence for the binding on Windows","description":"The key shortcut like `Ctrl A` or the sequence of shortcuts to press like [`Ctrl A`, `B`]","items":{"type":"string"},"type":"array"},"linuxKeys":{"title":"The key sequence for the binding on Linux","description":"The key shortcut like `Ctrl A` or the sequence of shortcuts to press like [`Ctrl A`, `B`]","items":{"type":"string"},"type":"array"},"selector":{"title":"CSS selector","type":"string"}},"required":["command","keys","selector"],"type":"object"},"toolbarItem":{"properties":{"name":{"title":"Unique name","type":"string"},"args":{"title":"Command arguments","type":"object"},"command":{"title":"Command id","type":"string","default":""},"disabled":{"title":"Whether the item is ignored or not","type":"boolean","default":false},"icon":{"title":"Item icon id","description":"If defined, it will override the command icon","type":"string"},"label":{"title":"Item label","description":"If defined, it will override the command label","type":"string"},"caption":{"title":"Item caption","description":"If defined, it will override the command caption","type":"string"},"type":{"title":"Item type","type":"string","enum":["command","spacer"]},"rank":{"title":"Item rank","type":"number","minimum":0,"default":50}},"required":["name"],"additionalProperties":false,"type":"object"},"metadataForm":{"type":"object","properties":{"id":{"type":"string","description":"The section ID"},"metadataSchema":{"type":"object","items":{"$ref":"#/definitions/metadataSchema"}},"uiSchema":{"type":"object"},"metadataOptions":{"type":"object","items":{"$ref":"#/definitions/metadataOptions"}},"label":{"type":"string","description":"The section label"},"rank":{"type":"integer","description":"The rank of the section in the right panel"},"showModified":{"type":"boolean","description":"Whether to show modified values from defaults"}},"required":["id","metadataSchema"]},"metadataSchema":{"properties":{"properties":{"type":"object","description":"The property set up by extension","properties":{"title":{"type":"string"},"description":{"type":"string"},"type":{"type":"string"}}}},"type":"object","required":["properties"]},"metadataOptions":{"properties":{"customRenderer":{"type":"string"},"metadataLevel":{"type":"string","enum":["cell","notebook"],"default":"cell"},"cellTypes":{"type":"array","items":{"type":"string","enum":["code","markdown","raw"]}},"writeDefault":{"type":"boolean"}},"type":"object"}}}');const u=s.JSONExt.deepCopy;const p={strict:false};const h=String.fromCharCode(30);class m{constructor(){this._composer=new(c())({useDefaults:true,...p});this._validator=new(c())({...p});this._composer.addSchema(l,"jupyterlab-plugin-schema");this._validator.addSchema(l,"jupyterlab-plugin-schema")}validateData(e,t=true){const i=this._validator.getSchema(e.id);const n=this._composer.getSchema(e.id);if(!i||!n){if(e.schema.type!=="object"){const t="schema";const i=`Setting registry schemas' root-level type must be `+`'object', rejecting type: ${e.schema.type}`;return[{instancePath:"type",keyword:t,schemaPath:"",message:i}]}const t=this._addSchema(e.id,e.schema);return t||this.validateData(e)}let s;try{s=d.parse(e.raw)}catch(o){if(o instanceof SyntaxError){return[{instancePath:"",keyword:"syntax",schemaPath:"",message:o.message}]}const{column:e,description:t}=o;const i=o.lineNumber;return[{instancePath:"",keyword:"parse",schemaPath:"",message:`${t} (line ${i} column ${e})`}]}if(!i(s)){return i.errors}const r=u(s);if(!n(r)){return n.errors}if(t){e.data={composite:r,user:s}}return null}_addSchema(e,t){const i=this._composer;const n=this._validator;const s=n.getSchema("jupyterlab-plugin-schema");if(!s(t)){return s.errors}if(!n.validateSchema(t)){return n.errors}i.removeSchema(e);n.removeSchema(e);i.addSchema(t,e);n.addSchema(t,e);return null}}class f{constructor(e){this.schema=l;this.plugins=Object.create(null);this._pluginChanged=new o.Signal(this);this._ready=Promise.resolve();this._transformers=Object.create(null);this._unloadedPlugins=new Map;this.connector=e.connector;this.validator=e.validator||new m;if(e.plugins){e.plugins.filter((e=>e.schema["jupyter.lab.transform"])).forEach((e=>this._unloadedPlugins.set(e.id,e)));this._ready=this._preload(e.plugins)}}get pluginChanged(){return this._pluginChanged}async get(e,t){await this._ready;const i=this.plugins;if(e in i){const{composite:n,user:s}=i[e].data;return{composite:n[t]!==undefined?u(n[t]):undefined,user:s[t]!==undefined?u(s[t]):undefined}}return this.load(e).then((()=>this.get(e,t)))}async load(e,t=false){await this._ready;const i=this.plugins;const n=this;if(e in i){if(t){i[e].data={composite:{},user:{}};await this._load(await this._transform("fetch",i[e]));this._pluginChanged.emit(e)}return new g({plugin:i[e],registry:n})}if(this._unloadedPlugins.has(e)&&e in this._transformers){await this._load(await this._transform("fetch",this._unloadedPlugins.get(e)));if(e in i){this._pluginChanged.emit(e);this._unloadedPlugins.delete(e);return new g({plugin:i[e],registry:n})}}return this.reload(e)}async reload(e){await this._ready;const t=await this.connector.fetch(e);const i=this.plugins;const n=this;if(t===undefined){throw[{instancePath:"",keyword:"id",message:`Could not fetch settings for ${e}.`,schemaPath:""}]}await this._load(await this._transform("fetch",t));this._pluginChanged.emit(e);return new g({plugin:i[e],registry:n})}async remove(e,t){await this._ready;const i=this.plugins;if(!(e in i)){return}const n=d.parse(i[e].raw);delete n[t];delete n[`// ${t}`];i[e].raw=b.annotatedPlugin(i[e],n);return this._save(e)}async set(e,t,i){await this._ready;const n=this.plugins;if(!(e in n)){return this.load(e).then((()=>this.set(e,t,i)))}const s=d.parse(n[e].raw);n[e].raw=b.annotatedPlugin(n[e],{...s,[t]:i});return this._save(e)}transform(e,t){const i=this._transformers;if(e in i){const t=new Error(`${e} already has a transformer.`);t.name="TransformError";throw t}i[e]={fetch:t.fetch||(e=>e),compose:t.compose||(e=>e)};return new r.DisposableDelegate((()=>{delete i[e]}))}async upload(e,t){await this._ready;const i=this.plugins;if(!(e in i)){return this.load(e).then((()=>this.upload(e,t)))}i[e].raw=t;return this._save(e)}async _load(e){const t=e.id;try{await this._validate(e)}catch(i){const e=[`Validating ${t} failed:`];i.forEach(((t,i)=>{const{instancePath:n,schemaPath:s,keyword:r,message:o}=t;if(n||s){e.push(`${i} - schema @ ${s}, data @ ${n}`)}e.push(`{${r}} ${o}`)}));console.warn(e.join("\n"));throw i}}async _preload(e){await Promise.all(e.map((async e=>{var t;try{await this._load(await this._transform("fetch",e))}catch(i){if(((t=i[0])===null||t===void 0?void 0:t.keyword)!=="unset"){console.warn("Ignored setting registry preload errors.",i)}}})))}async _save(e){const t=this.plugins;if(!(e in t)){throw new Error(`${e} does not exist in setting registry.`)}try{await this._validate(t[e])}catch(n){console.warn(`${e} validation errors:`,n);throw new Error(`${e} failed to validate; check console.`)}await this.connector.save(e,t[e].raw);const i=await this.connector.fetch(e);if(i===undefined){throw[{instancePath:"",keyword:"id",message:`Could not fetch settings for ${e}.`,schemaPath:""}]}await this._load(await this._transform("fetch",i));this._pluginChanged.emit(e)}async _transform(e,t){const i=t.id;const n=this._transformers;if(!t.schema["jupyter.lab.transform"]){return t}if(i in n){const s=n[i][e].call(null,t);if(s.id!==i){throw[{instancePath:"",keyword:"id",message:"Plugin transformations cannot change plugin IDs.",schemaPath:""}]}return s}throw[{instancePath:"",keyword:"unset",message:`${t.id} has no transformers yet.`,schemaPath:""}]}async _validate(e){const t=this.validator.validateData(e);if(t){throw t}this.plugins[e.id]=await this._transform("compose",e)}}class y{constructor(e){this._schema=e.schema}get schema(){return this._schema}isDefault(e){for(const t in this.schema.properties){const i=e[t];const n=this.default(t);if(i===undefined||n===undefined||s.JSONExt.deepEqual(i,s.JSONExt.emptyObject)||s.JSONExt.deepEqual(i,s.JSONExt.emptyArray)){continue}if(!s.JSONExt.deepEqual(i,n)){return false}}return true}default(e){return b.reifyDefault(this.schema,e)}}class g extends y{constructor(e){super({schema:e.plugin.schema});this._changed=new o.Signal(this);this._isDisposed=false;this.id=e.plugin.id;this.registry=e.registry;this.registry.pluginChanged.connect(this._onPluginChanged,this)}get changed(){return this._changed}get composite(){return this.plugin.data.composite}get isDisposed(){return this._isDisposed}get plugin(){return this.registry.plugins[this.id]}get raw(){return this.plugin.raw}get isModified(){return!this.isDefault(this.user)}get user(){return this.plugin.data.user}get version(){return this.plugin.version}annotatedDefaults(){return b.annotatedDefaults(this.schema,this.id)}dispose(){if(this._isDisposed){return}this._isDisposed=true;o.Signal.clearData(this)}get(e){const{composite:t,user:i}=this;return{composite:t[e]!==undefined?u(t[e]):undefined,user:i[e]!==undefined?u(i[e]):undefined}}remove(e){return this.registry.remove(this.plugin.id,e)}save(e){return this.registry.upload(this.plugin.id,e)}set(e,t){return this.registry.set(this.plugin.id,e,t)}validate(e){const t={composite:{},user:{}};const{id:i,schema:n}=this.plugin;const s=this.registry.validator;const r=this.version;return s.validateData({data:t,id:i,raw:e,schema:n,version:r},false)}_onPluginChanged(e,t){if(t===this.plugin.id){this._changed.emit(undefined)}}}(function(e){function t(e,t,n=false,r=true){if(!e){return t&&r?s.JSONExt.deepCopy(t):[]}if(!t){return s.JSONExt.deepCopy(e)}const o=s.JSONExt.deepCopy(e);t.forEach((e=>{const t=o.findIndex((t=>t.id===e.id));if(t>=0){o[t]={...o[t],...e,items:i(o[t].items,e.items,n,r)}}else{if(r){o.push(e)}}}));return o}e.reconcileMenus=t;function i(e,i,n=false,r=true){if(!e){return i?s.JSONExt.deepCopy(i):undefined}if(!i){return s.JSONExt.deepCopy(e)}const o=s.JSONExt.deepCopy(e);i.forEach((e=>{var i;switch((i=e.type)!==null&&i!==void 0?i:"command"){case"separator":if(r){o.push({...e})}break;case"submenu":if(e.submenu){const i=o.findIndex((t=>{var i,n;return t.type==="submenu"&&((i=t.submenu)===null||i===void 0?void 0:i.id)===((n=e.submenu)===null||n===void 0?void 0:n.id)}));if(i<0){if(r){o.push(s.JSONExt.deepCopy(e))}}else{o[i]={...o[i],...e,submenu:t(o[i].submenu?[o[i].submenu]:null,[e.submenu],n,r)[0]}}}break;case"command":if(e.command){const t=o.findIndex((t=>{var i,n;return t.command===e.command&&t.selector===e.selector&&s.JSONExt.deepEqual((i=t.args)!==null&&i!==void 0?i:{},(n=e.args)!==null&&n!==void 0?n:{})}));if(t<0){if(r){o.push({...e})}}else{if(n){console.warn(`Menu entry for command '${e.command}' is duplicated.`)}o[t]={...o[t],...e}}}}}));return o}e.reconcileItems=i;function r(e){return e.reduce(((e,t)=>{var i;const n={...t};if(!n.disabled){if(n.type==="submenu"){const{submenu:e}=n;if(e&&!e.disabled){n.submenu={...e,items:r((i=e.items)!==null&&i!==void 0?i:[])}}}e.push(n)}return e}),[])}e.filterDisabledItems=r;function o(e,t){const i={};t=t.filter((e=>{const t=n.CommandRegistry.normalizeKeys(e).join(h);if(!t){console.warn("Skipping this shortcut because there are no actionable keys on this platform",e);return false}if(!(t in i)){i[t]={}}const{selector:s}=e;if(!(s in i[t])){i[t][s]=false;return true}console.warn("Skipping this shortcut because it collides with another shortcut.",e);return false}));e=[...e.filter((e=>!!e.disabled)),...e.filter((e=>!e.disabled))].filter((e=>{const t=n.CommandRegistry.normalizeKeys(e).join(h);if(!t){return false}if(!(t in i)){i[t]={}}const{disabled:s,selector:r}=e;if(!(r in i[t])){i[t][r]=!s;return true}if(i[t][r]){console.warn("Skipping this default shortcut because it collides with another default shortcut.",e)}return false}));return b.upgradeShortcuts(t.concat(e).filter((e=>!e.disabled)).map((e=>({args:{},...e}))))}e.reconcileShortcuts=o;function a(e,t,i=false){if(!e){return t?s.JSONExt.deepCopy(t):undefined}if(!t){return s.JSONExt.deepCopy(e)}const n=s.JSONExt.deepCopy(e);t.forEach((e=>{const t=n.findIndex((t=>t.name===e.name));if(t<0){n.push({...e})}else{if(i&&s.JSONExt.deepEqual(Object.keys(e),Object.keys(n[t]))){console.warn(`Toolbar item '${e.name}' is duplicated.`)}n[t]={...n[t],...e}}}));return n}e.reconcileToolbarItems=a})(f||(f={}));var b;(function(e){const t="    ";const i="[missing schema description]";const n="[missing schema title]";function r(e,t){const{description:s,properties:r,title:o}=e;const c=r?Object.keys(r).sort(((e,t)=>e.localeCompare(t))):[];const u=Math.max((s||i).length,t.length);return["{",l(`${o||n}`),l(t),l(s||i),l("*".repeat(u)),"",d(c.map((t=>a(e,t)))),"}"].join("\n")}e.annotatedDefaults=r;function o(e,t){const{description:s,title:r}=e.schema;const o=Object.keys(t).sort(((e,t)=>e.localeCompare(t)));const a=Math.max((s||i).length,e.id.length);return["{",l(`${r||n}`),l(e.id),l(s||i),l("*".repeat(a)),"",d(o.map((i=>c(e.schema,i,t[i])))),"}"].join("\n")}e.annotatedPlugin=o;function a(e,n){const s=e.properties&&e.properties[n]||{};const r=s["type"];const o=s["description"]||i;const a=s["title"]||"";const c=u(e,n);const d=t.length;const p=c!==undefined?l(`"${n}": ${JSON.stringify(c,null,d)}`,t):l(`"${n}": ${r}`);return[l(a),l(o),p].filter((e=>e.length)).join("\n")}function c(e,s,r){const o=e.properties&&e.properties[s];const a=o&&o["description"]||i;const c=o&&o["title"]||n;const d=t.length;const u=l(`"${s}": ${JSON.stringify(r,null,d)}`,t);return[l(c),l(a),u].join("\n")}function d(e){return e.reduce(((t,i,n)=>{const s=i.split("\n");const r=s[s.length-1];const o=r.trim().indexOf("//")===0;const a=o||n===e.length-1?"":",";const c=n===e.length-1?"":"\n\n";return t+i+a+c}),"")}function l(e,i=`${t}// `){return i+e.split("\n").join(`\n${i}`)}function u(e,t,i,n){var r,o,a,c,d,l,p;i=i!==null&&i!==void 0?i:e.definitions;n=t?e.required instanceof Array&&((r=e.required)===null||r===void 0?void 0:r.includes(t)):n;e=(t?(o=e.properties)===null||o===void 0?void 0:o[t]:e)||{};if(e.type==="object"){const t=s.JSONExt.deepCopy(e.default);const n=e.properties||{};for(const s in n){t[s]=u(n[s],undefined,i,e.required instanceof Array&&((a=e.required)===null||a===void 0?void 0:a.includes(s)))}return t}else if(e.type==="array"){const t=typeof e.default!=="undefined";const r=t||n;if(!r){return undefined}const o=t?s.JSONExt.deepCopy(e.default):[];let a=e.items||{};if(a["$ref"]&&i){const e=a["$ref"].replace("#/definitions/","");a=(c=i[e])!==null&&c!==void 0?c:{}}for(const e in o){if(a.type==="object"){const t=(l=(d=u(a,undefined,i))!==null&&d!==void 0?d:o[e])!==null&&l!==void 0?l:{};for(const i in t){if((p=o[e])===null||p===void 0?void 0:p[i]){t[i]=o[e][i]}}o[e]=t}}return o}else{return e.default}}e.reifyDefault=u;const p=new Set;function h(e){const t=new Set;const i=[{old:".jp-Notebook:focus.jp-mod-commandMode",new:".jp-Notebook.jp-mod-commandMode :focus:not(:read-write)",versionDeprecated:"JupyterLab 4.1"},{old:".jp-Notebook:focus",new:".jp-Notebook.jp-mod-commandMode :focus:not(:read-write)",versionDeprecated:"JupyterLab 4.1"},{old:"[data-jp-traversable]:focus",new:".jp-Notebook.jp-mod-commandMode :focus:not(:read-write)",versionDeprecated:"JupyterLab 4.1"},{old:"[data-jp-kernel-user]:focus",new:"[data-jp-kernel-user] :focus:not(:read-write)",versionDeprecated:"JupyterLab 4.1"}];const n=e.map((e=>{const n=e.selector;let s=n;for(const r of i){if(n.includes(r.old)&&!p.has(n)){s=n.replace(r.old,r.new);t.add(`"${r.old}" was replaced with "${r.new}" in ${r.versionDeprecated} (present in "${n}")`);p.add(n)}}e.selector=s;return e}));if(t.size>0){console.warn("Deprecated shortcut selectors: "+[...t].join("\n")+"\n\nThe selectors will be substituted transparently this time, but need to be updated at source before next major release.")}return n}e.upgradeShortcuts=h})(b||(b={}));const w=new s.Token("@jupyterlab/coreutils:ISettingRegistry",`A service for the JupyterLab settings system.\n  Use this if you want to store settings for your application.\n  See "schemaDir" for more information.`)}}]);
//# sourceMappingURL=7376.30a96fae609dbccfa221.js.map?v=30a96fae609dbccfa221