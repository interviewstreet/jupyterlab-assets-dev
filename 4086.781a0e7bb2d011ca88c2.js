"use strict";(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[4086],{14086:(t,e,s)=>{s.r(e);s.d(e,{IJSONSettingEditorTracker:()=>A.g,ISettingEditorTracker:()=>A.O,JsonSettingEditor:()=>W,SettingsEditor:()=>b});var i=s(87447);var r=s(50724);var n=s(27425);var a=s(19289);var o=s(65178);var l=s(37900);var d=s.n(l);var h=s(10535);const c="jupyter.lab.setting-icon";const u="jupyter.lab.setting-icon-class";const p="jupyter.lab.setting-icon-label";class g extends i.ReactWidget{constructor(t){var e;super();this._changed=new a.Signal(this);this._handleSelectSignal=new a.Signal(this);this._updateFilterSignal=new a.Signal(this);this._allPlugins=[];this._settings={};this._scrollTop=0;this._selection="";this.registry=t.registry;this.translator=t.translator||r.nullTranslator;this.addClass("jp-PluginList");this._confirm=t.confirm;this.registry.pluginChanged.connect((()=>{this.update()}),this);this.mapPlugins=this.mapPlugins.bind(this);this.setFilter=this.setFilter.bind(this);this.setFilter(t.query?(0,n.updateFilterFunction)(t.query,false,false):null);this.setError=this.setError.bind(this);this._evtMousedown=this._evtMousedown.bind(this);this._query=(e=t.query)!==null&&e!==void 0?e:"";this._allPlugins=g.sortPlugins(this.registry).filter((e=>{var s;const{schema:i}=e;const r=i["jupyter.lab.setting-deprecated"]===true;const n=Object.keys(i.properties||{}).length>0;const a=i.additionalProperties!==false;const o=this._confirm||!this._confirm&&!((s=t.toSkip)!==null&&s!==void 0?s:[]).includes(e.id);return!r&&o&&(n||a)}));const s=async()=>{for(const t of this._allPlugins){const e=await this.registry.load(t.id);this._settings[t.id]=e}this.update()};void s();this._errors={}}get changed(){return this._changed}get scrollTop(){var t;return(t=this.node.querySelector("ul"))===null||t===void 0?void 0:t.scrollTop}get hasErrors(){for(const t in this._errors){if(this._errors[t]){return true}}return false}get filter(){return this._filter}get selection(){return this._selection}set selection(t){this._selection=t;this.update()}get updateFilterSignal(){return this._updateFilterSignal}get handleSelectSignal(){return this._handleSelectSignal}onUpdateRequest(t){const e=this.node.querySelector("ul");if(e&&this._scrollTop!==undefined){e.scrollTop=this._scrollTop}super.onUpdateRequest(t)}_evtMousedown(t){const e=t.currentTarget;const s=e.getAttribute("data-id");if(!s){return}if(this._confirm){this._confirm(s).then((()=>{this.selection=s;this._changed.emit(undefined);this.update()})).catch((()=>{}))}else{this._scrollTop=this.scrollTop;this._selection=s;this._handleSelectSignal.emit(s);this._changed.emit(undefined);this.update()}}getHint(t,e,s){let i=s.data.user[t];if(!i){i=s.data.composite[t]}if(!i){i=s.schema[t]}if(!i){const{properties:s}=e.schema;i=s&&s[t]&&s[t].default}return typeof i==="string"?i:""}getFilterString(t,e,s,i){var r;if(i&&s){i=i.replace("#/definitions/","");e=(r=s[i])!==null&&r!==void 0?r:{}}if(e.properties){e=e.properties}else if(e.items){e=e.items}else{return[]}if(e["$ref"]){return this.getFilterString(t,e,s,e["$ref"])}if(Object.keys(e).length===0){return[]}return Object.keys(e).reduce(((i,r)=>{var n,a;const o=e[r];if(!o){if(t((n=e.title)!==null&&n!==void 0?n:"")){return e.title}if(t(r)){return r}}if(t((a=o.title)!==null&&a!==void 0?a:"")){i.push(o.title)}if(t(r)){i.push(r)}i.concat(this.getFilterString(t,o,s,o["$ref"]));return i}),[])}setFilter(t,e){if(t){this._filter=e=>{var s,i;if(!t||t((s=e.schema.title)!==null&&s!==void 0?s:"")){return null}const r=this.getFilterString(t,(i=e.schema)!==null&&i!==void 0?i:{},e.schema.definitions);return r}}else{this._filter=null}this._query=e;this._updateFilterSignal.emit(this._filter);this.update()}setError(t,e){if(this._errors[t]!==e){this._errors[t]=e;this.update()}else{this._errors[t]=e}}mapPlugins(t){var e,s,i,r;const{id:a,schema:o,version:l}=t;const g=this.translator.load("jupyterlab");const _=typeof o.title==="string"?g._p("schema",o.title):a;const f=h.StringExt.matchSumOfSquares(_.toLocaleLowerCase(),(s=(e=this._query)===null||e===void 0?void 0:e.toLocaleLowerCase())!==null&&s!==void 0?s:"");const m=h.StringExt.highlight(_,(i=f===null||f===void 0?void 0:f.indices)!==null&&i!==void 0?i:[],(t=>d().createElement("mark",null,t)));const v=typeof o.description==="string"?g._p("schema",o.description):"";const S=`${v}\n${a}\n${l}`;const y=this.getHint(c,this.registry,t);const E=this.getHint(u,this.registry,t);const w=this.getHint(p,this.registry,t);const b=this._filter?(r=this._filter(t))===null||r===void 0?void 0:r.map((t=>{var e,s,i;const r=h.StringExt.matchSumOfSquares(t.toLocaleLowerCase(),(s=(e=this._query)===null||e===void 0?void 0:e.toLocaleLowerCase())!==null&&s!==void 0?s:"");const n=h.StringExt.highlight(t,(i=r===null||r===void 0?void 0:r.indices)!==null&&i!==void 0?i:[],(t=>d().createElement("mark",null,t)));return d().createElement("li",{key:`${a}-${t}`}," ",n," ")})):undefined;return d().createElement("div",{onClick:this._evtMousedown,className:`${a===this.selection?"jp-mod-selected jp-PluginList-entry":"jp-PluginList-entry"} ${this._errors[a]?"jp-ErrorPlugin":""}`,"data-id":a,key:a,title:S},d().createElement("div",{className:"jp-PluginList-entry-label",role:"tab"},d().createElement("div",{className:"jp-SelectedIndicator"}),d().createElement(n.LabIcon.resolveReact,{icon:y||(E?undefined:n.settingsIcon),iconClass:(0,n.classes)(E,"jp-Icon"),title:w,tag:"span",stylesheet:"settingsEditor"}),d().createElement("span",{className:"jp-PluginList-entry-label-text"},m)),d().createElement("ul",null,b))}render(){const t=this.translator.load("jupyterlab");const e=this._allPlugins.filter((t=>{if(!this._filter){return false}const e=this._filter(t);return e===null||e.length>0}));const s=e.filter((t=>{var e;return(e=this._settings[t.id])===null||e===void 0?void 0:e.isModified}));const i=s.map(this.mapPlugins);const r=e.filter((t=>!s.includes(t))).map(this.mapPlugins);return d().createElement("div",{className:"jp-PluginList-wrapper"},d().createElement(n.FilterBox,{updateFilter:this.setFilter,useFuzzyFilter:false,placeholder:t.__("Search settingsâ€¦"),forceRefresh:false,caseSensitive:false,initialQuery:this._query}),i.length>0&&d().createElement("div",null,d().createElement("h1",{className:"jp-PluginList-header"},t.__("Modified")),d().createElement("ul",null,i)),r.length>0&&d().createElement("div",null,d().createElement("h1",{className:"jp-PluginList-header"},t.__("Settings")),d().createElement("ul",null,r)),i.length===0&&r.length===0&&d().createElement("p",{className:"jp-PluginList-noResults"},t.__("No items match your search.")))}}(function(t){function e(t){return Object.keys(t.plugins).map((e=>t.plugins[e])).sort(((t,e)=>(t.schema.title||t.id).localeCompare(e.schema.title||e.id)))}t.sortPlugins=e})(g||(g={}));var _=s(55172);var f=s(65061);var m=s(64173);var v=s.n(m);const S=4;class y extends d().Component{constructor(t){super(t);this.reset=async t=>{t.stopPropagation();for(const e in this.props.settings.user){await this.props.settings.remove(e)}this._formData=this.props.settings.composite;this.setState({isModified:false})};this._onChange=t=>{this.props.hasError(t.errors.length!==0);this._formData=t.formData;if(t.errors.length===0){this.props.updateDirtyState(true);void this._debouncer.invoke()}this.props.onSelect(this.props.settings.id)};const{settings:e}=t;this._formData=e.composite;this.state={isModified:e.isModified,uiSchema:{},filteredSchema:this.props.settings.schema,formContext:{defaultFormData:this.props.settings.default(),settings:this.props.settings}};this.handleChange=this.handleChange.bind(this);this._debouncer=new f.Debouncer(this.handleChange)}componentDidMount(){this._setUiSchema();this._setFilteredSchema()}componentDidUpdate(t){this._setUiSchema(t.renderers[t.settings.id]);this._setFilteredSchema(t.filteredValues);if(t.settings!==this.props.settings){this.setState({formContext:{settings:this.props.settings,defaultFormData:this.props.settings.default()}})}}componentWillUnmount(){this._debouncer.dispose()}handleChange(){if(!this.props.settings.isModified&&this._formData&&this.props.settings.isDefault(this._formData)){this.props.updateDirtyState(false);return}this.props.settings.save(JSON.stringify(this._formData,undefined,S)).then((()=>{this.props.updateDirtyState(false);this.setState({isModified:this.props.settings.isModified})})).catch((t=>{this.props.updateDirtyState(false);const e=this.props.translator.load("jupyterlab");void(0,i.showErrorMessage)(e.__("Error saving settings."),t)}))}render(){const t=this.props.translator.load("jupyterlab");return d().createElement(d().Fragment,null,d().createElement("div",{className:"jp-SettingsHeader"},d().createElement("h2",{className:"jp-SettingsHeader-title",title:this.props.settings.schema.description},this.props.settings.schema.title),d().createElement("div",{className:"jp-SettingsHeader-buttonbar"},this.state.isModified&&d().createElement(n.Button,{className:"jp-RestoreButton",onClick:this.reset},t.__("Restore to Defaults"))),d().createElement("div",{className:"jp-SettingsHeader-description"},this.props.settings.schema.description)),d().createElement(n.FormComponent,{validator:v(),schema:this.state.filteredSchema,formData:this._getFilteredFormData(this.state.filteredSchema),uiSchema:this.state.uiSchema,fields:this.props.renderers[this.props.settings.id],formContext:this.state.formContext,liveValidate:true,idPrefix:`jp-SettingsEditor-${this.props.settings.id}`,onChange:this._onChange,translator:this.props.translator,experimental_defaultFormStateBehavior:{emptyObjectFields:"populateRequiredDefaults"}}))}_setUiSchema(t){var e;const s=this.props.renderers[this.props.settings.id];if(!_.JSONExt.deepEqual(Object.keys(t!==null&&t!==void 0?t:{}).sort(),Object.keys(s!==null&&s!==void 0?s:{}).sort())){const t={};for(const s in this.props.renderers[this.props.settings.id]){if(Object.keys((e=this.props.settings.schema.properties)!==null&&e!==void 0?e:{}).includes(s)){t[s]={"ui:field":s}}}this.setState({uiSchema:t})}}_setFilteredSchema(t){var e,s,i,r;if(t===undefined||!_.JSONExt.deepEqual(t,this.props.filteredValues)){const t=_.JSONExt.deepCopy(this.props.settings.schema);if((s=(e=this.props.filteredValues)===null||e===void 0?void 0:e.length)!==null&&s!==void 0?s:0>0){for(const e in t.properties){if(!((i=this.props.filteredValues)===null||i===void 0?void 0:i.includes((r=t.properties[e].title)!==null&&r!==void 0?r:e))){delete t.properties[e]}}}this.setState({filteredSchema:t})}}_getFilteredFormData(t){if(!(t===null||t===void 0?void 0:t.properties)){return this._formData}const e=_.JSONExt.deepCopy(this._formData);for(const s in e){if(!t.properties[s]){delete e[s]}}return e}}const E=({translator:t})=>{const e=t.load("jupyterlab");return d().createElement("div",{className:"jp-SettingsEditor-placeholder"},d().createElement("div",{className:"jp-SettingsEditor-placeholderContent"},d().createElement("h3",null,e.__("No Plugin Selected")),d().createElement("p",null,e.__("Select a plugin from the list to view and edit its preferences."))))};const w=({settings:t,editorRegistry:e,onSelect:s,handleSelectSignal:i,hasError:r,updateDirtyState:n,updateFilterSignal:a,translator:o,initialFilter:h})=>{const[c,u]=(0,l.useState)(null);const[p,g]=(0,l.useState)(h?()=>h:null);const _=d().useRef(null);const f=d().useRef({});(0,l.useEffect)((()=>{var t;const e=(t,e)=>{e?g((()=>e)):g(null)};a.connect(e);const s=(t,e)=>{u(e)};(t=i===null||i===void 0?void 0:i.connect)===null||t===void 0?void 0:t.call(i,s);return()=>{var t;a.disconnect(e);(t=i===null||i===void 0?void 0:i.disconnect)===null||t===void 0?void 0:t.call(i,s)}}),[]);const m=d().useCallback(((t,e)=>{if(f.current){f.current[t]=e;for(const t in f.current){if(f.current[t]){n(true);return}}}n(false)}),[f,n]);const v=d().useMemo((()=>Object.entries(e.renderers).reduce(((t,[e,s])=>{const i=e.lastIndexOf(".");const r=e.substring(0,i);const n=e.substring(i+1);if(!t[r]){t[r]={}}if(!t[r][n]&&s.fieldRenderer){t[r][n]=s.fieldRenderer}return t}),{})),[e]);if(!c&&!p){return d().createElement(E,{translator:o})}return d().createElement("div",{className:"jp-SettingsPanel",ref:_},t.map((t=>{const e=p?p(t.plugin):null;if(c&&c!==t.id||e!==null&&e.length===0){return undefined}return d().createElement("div",{className:"jp-SettingsForm",key:`${t.id}SettingsEditor`},d().createElement(y,{filteredValues:e,settings:t,renderers:v,hasError:e=>{r(t.id,e)},updateDirtyState:e=>{m(t.id,e)},onSelect:s,translator:o}))})))};class b extends o.SplitPanel{constructor(t){super({orientation:"horizontal",renderer:o.SplitPanel.defaultRenderer,spacing:1});this._clearDirty=null;this._dirty=false;this._saveStateChange=new a.Signal(this);this.translator=t.translator||r.nullTranslator;this._status=t.status;const e=this._list=new g({registry:t.registry,toSkip:t.toSkip,translator:this.translator,query:t.query});this.addWidget(e);this.setDirtyState=this.setDirtyState.bind(this);void Promise.all(g.sortPlugins(t.registry).filter((t=>{const{schema:e}=t;const s=e["jupyter.lab.setting-deprecated"]===true;const i=Object.keys(e.properties||{}).length>0;const r=e.additionalProperties!==false;return!s&&(i||r)})).map((async e=>await t.registry.load(e.id)))).then((e=>{const s=n.ReactWidget.create(d().createElement(w,{settings:e.filter((e=>{var s;return!((s=t.toSkip)!==null&&s!==void 0?s:[]).includes(e.id)})),editorRegistry:t.editorRegistry,handleSelectSignal:this._list.handleSelectSignal,onSelect:t=>this._list.selection=t,hasError:this._list.setError,updateFilterSignal:this._list.updateFilterSignal,updateDirtyState:this.setDirtyState,translator:this.translator,initialFilter:this._list.filter}));this.addWidget(s)})).catch((t=>{console.error(`Fail to load the setting plugins:\n${t}`)}))}get saveStateChanged(){return this._saveStateChange}setDirtyState(t){this._dirty=t;if(this._dirty&&!this._clearDirty){this._clearDirty=this._status.setDirty()}else if(!this._dirty&&this._clearDirty){this._clearDirty.dispose();this._clearDirty=null}if(t){if(!this.title.className.includes("jp-mod-dirty")){this.title.className+=" jp-mod-dirty"}}else{this.title.className=this.title.className.replace("jp-mod-dirty","")}this._saveStateChange.emit(t?"started":"completed")}onCloseRequest(t){const e=this.translator.load("jupyterlab");if(this._list.hasErrors){void(0,i.showDialog)({title:e.__("Warning"),body:e.__("Unsaved changes due to validation error. Continue without saving?")}).then((e=>{if(e.button.accept){this.dispose();super.onCloseRequest(t)}}))}else if(this._dirty){void(0,i.showDialog)({title:e.__("Warning"),body:e.__("Some changes have not been saved. Continue without saving?")}).then((e=>{if(e.button.accept){this.dispose();super.onCloseRequest(t)}}))}else{this.dispose();super.onCloseRequest(t)}}}var C=s(52959);var j=s(96773);var D=s(59238);var P=s(26375);function F(t,e,s){s=s||r.nullTranslator;const i=s.load("jupyterlab");const n=new R(t,s);const a=new j.InspectorPanel({initialContent:i.__("Any errors will be listed here"),translator:s});const o=new j.InspectionHandler({connector:n,rendermime:e||new D.RenderMimeRegistry({initialFactories:D.standardRendererFactories,translator:s})});a.addClass("jp-SettingsDebug");a.source=o;o.editor=t.source;return a}class R extends P.DataConnector{constructor(t,e){super();this._current=0;this._editor=t;this._trans=(e!==null&&e!==void 0?e:r.nullTranslator).load("jupyterlab")}fetch(t){return new Promise((e=>{const s=this._current=window.setTimeout((()=>{if(s!==this._current){return e(undefined)}const i=this._validate(t.text);if(!i){return e({data:{"text/markdown":this._trans.__("No errors found")},metadata:{}})}e({data:this.render(i),metadata:{}})}),100)}))}render(t){return{"text/markdown":t.map(this.renderError.bind(this)).join("")}}renderError(t){var e;switch(t.keyword){case"additionalProperties":return`**\`[${this._trans.__("additional property error")}]\`**\n          ${this._trans.__("`%1` is not a valid property",(e=t.params)===null||e===void 0?void 0:e.additionalProperty)}`;case"syntax":return`**\`[${this._trans.__("syntax error")}]\`** *${t.message}*`;case"type":return`**\`[${this._trans.__("type error")}]\`**\n          \`${t.instancePath}\` ${t.message}`;default:return`**\`[${this._trans.__("error")}]\`** *${t.message}*`}}_validate(t){const e=this._editor;if(!e.settings){return null}const{id:s,schema:i,version:r}=e.settings;const n={composite:{},user:{}};const a=e.registry.validator;return a.validateData({data:n,id:s,raw:t,schema:i,version:r},false)}}const x="jp-SettingsRawEditor";const T="jp-SettingsRawEditor-user";const k="jp-mod-error";class N extends o.SplitPanel{constructor(t){super({orientation:"horizontal",renderer:o.SplitPanel.defaultRenderer,spacing:1});this._canRevert=false;this._canSave=false;this._commandsChanged=new a.Signal(this);this._settings=null;this._toolbar=new n.Toolbar;const{commands:e,editorFactory:s,registry:i,translator:l}=t;this.registry=i;this.translator=l||r.nullTranslator;this._commands=e;const d=this._defaults=new C.CodeEditorWrapper({editorOptions:{config:{readOnly:true}},model:new C.CodeEditor.Model({mimeType:"text/javascript"}),factory:s});const h=this._user=new C.CodeEditorWrapper({editorOptions:{config:{lineNumbers:true}},model:new C.CodeEditor.Model({mimeType:"text/javascript"}),factory:s});h.addClass(T);h.editor.model.sharedModel.changed.connect(this._onTextChanged,this);this._inspector=F(this,t.rendermime,this.translator);this.addClass(x);this._onSaveError=t.onSaveError;this.addWidget(M.defaultsEditor(d,this.translator));this.addWidget(M.userEditor(h,this._toolbar,this._inspector,this.translator))}get canRevert(){return this._canRevert}get canSave(){return this._canSave}get commandsChanged(){return this._commandsChanged}get isDirty(){var t,e;return(e=this._user.editor.model.sharedModel.getSource()!==((t=this._settings)===null||t===void 0?void 0:t.raw))!==null&&e!==void 0?e:""}get settings(){return this._settings}set settings(t){if(!t&&!this._settings){return}const e=t&&this._settings&&t.plugin===this._settings.plugin;if(e){return}const s=this._defaults;const i=this._user;if(this._settings){this._settings.changed.disconnect(this._onSettingsChanged,this)}if(t){this._settings=t;this._settings.changed.connect(this._onSettingsChanged,this);this._onSettingsChanged()}else{this._settings=null;s.editor.model.sharedModel.setSource("");i.editor.model.sharedModel.setSource("")}this.update()}get sizes(){return this.relativeSizes()}set sizes(t){this.setRelativeSizes(t)}get source(){return this._user.editor}dispose(){if(this.isDisposed){return}this._defaults.model.dispose();this._defaults.dispose();this._user.model.dispose();this._user.dispose();super.dispose()}revert(){var t,e;this._user.editor.model.sharedModel.setSource((e=(t=this.settings)===null||t===void 0?void 0:t.raw)!==null&&e!==void 0?e:"");this._updateToolbar(false,false)}save(){if(!this.isDirty||!this._settings){return Promise.resolve(undefined)}const t=this._settings;const e=this._user.editor.model.sharedModel.getSource();return t.save(e).then((()=>{this._updateToolbar(false,false)})).catch((t=>{this._updateToolbar(true,false);this._onSaveError(t,this.translator)}))}onAfterAttach(t){M.populateToolbar(this._commands,this._toolbar);this.update()}_onTextChanged(){const t=this._user.editor.model.sharedModel.getSource();const e=this._settings;this.removeClass(k);if(!e||e.raw===t){this._updateToolbar(false,false);return}const s=e.validate(t);if(s){this.addClass(k);this._updateToolbar(true,false);return}this._updateToolbar(true,true)}_onSettingsChanged(){var t,e;const s=this._settings;const i=this._defaults;const r=this._user;i.editor.model.sharedModel.setSource((t=s===null||s===void 0?void 0:s.annotatedDefaults())!==null&&t!==void 0?t:"");r.editor.model.sharedModel.setSource((e=s===null||s===void 0?void 0:s.raw)!==null&&e!==void 0?e:"")}_updateToolbar(t=this._canRevert,e=this._canSave){const s=this._commands;this._canRevert=t;this._canSave=e;this._commandsChanged.emit([s.revert,s.save])}}var M;(function(t){function e(t,e){e=e||r.nullTranslator;const s=e.load("jupyterlab");const i=new o.Widget;const a=i.layout=new o.BoxLayout({spacing:0});const l=new o.Widget;const d=new n.Toolbar;const h=s.__("System Defaults");l.node.innerText=h;d.insertItem(0,"banner",l);a.addWidget(d);a.addWidget(t);return i}t.defaultsEditor=e;function s(t,e){const{registry:s,revert:i,save:r}=t;e.addItem("spacer",n.Toolbar.createSpacerItem());[i,r].forEach((t=>{const i=new n.CommandToolbarButton({commands:s,id:t});e.addItem(t,i)}))}t.populateToolbar=s;function i(t,e,s,i){i=i||r.nullTranslator;const n=i.load("jupyterlab");const a=n.__("User Preferences");const l=new o.Widget;const d=l.layout=new o.BoxLayout({spacing:0});const h=new o.Widget;h.node.innerText=a;e.insertItem(0,"banner",h);d.addWidget(e);d.addWidget(t);d.addWidget(s);return l}t.userEditor=i})(M||(M={}));const O="jp-PluginEditor";class z extends o.Widget{constructor(t){super();this._settings=null;this._stateChanged=new a.Signal(this);this.addClass(O);const{commands:e,editorFactory:s,registry:i,rendermime:n,translator:l}=t;this.translator=l||r.nullTranslator;this._trans=this.translator.load("jupyterlab");const d=this.layout=new o.StackedLayout;const{onSaveError:h}=q;this.raw=this._rawEditor=new N({commands:e,editorFactory:s,onSaveError:h,registry:i,rendermime:n,translator:l});this._rawEditor.handleMoved.connect(this._onStateChanged,this);d.addWidget(this._rawEditor)}get isDirty(){return this._rawEditor.isDirty}get settings(){return this._settings}set settings(t){if(this._settings===t){return}const e=this._rawEditor;this._settings=e.settings=t;this.update()}get state(){const t=this._settings?this._settings.id:"";const{sizes:e}=this._rawEditor;return{plugin:t,sizes:e}}set state(t){if(_.JSONExt.deepEqual(this.state,t)){return}this._rawEditor.sizes=t.sizes;this.update()}get stateChanged(){return this._stateChanged}confirm(){if(this.isHidden||!this.isAttached||!this.isDirty){return Promise.resolve(undefined)}return(0,i.showDialog)({title:this._trans.__("You have unsaved changes."),body:this._trans.__("Do you want to leave without saving?"),buttons:[i.Dialog.cancelButton({label:this._trans.__("Cancel")}),i.Dialog.okButton({label:this._trans.__("Ok")})]}).then((t=>{if(!t.button.accept){throw new Error("User canceled.")}}))}dispose(){if(this.isDisposed){return}super.dispose();this._rawEditor.dispose()}onAfterAttach(t){this.update()}onUpdateRequest(t){const e=this._rawEditor;const s=this._settings;if(!s){this.hide();return}this.show();e.show()}_onStateChanged(){this.stateChanged.emit(undefined)}}var q;(function(t){function e(t,e){e=e||r.nullTranslator;const s=e.load("jupyterlab");console.error(`Saving setting editor value failed: ${t.message}`);void(0,i.showErrorMessage)(s.__("Your changes were not saved."),t)}t.onSaveError=e})(q||(q={}));const L={sizes:[1,3],container:{editor:"raw",plugin:"",sizes:[1,1]}};class W extends o.SplitPanel{constructor(t){super({orientation:"horizontal",renderer:o.SplitPanel.defaultRenderer,spacing:1});this._fetching=null;this._saving=false;this._state=_.JSONExt.deepCopy(L);this.translator=t.translator||r.nullTranslator;this.addClass("jp-SettingEditor");this.key=t.key;this.state=t.state;const{commands:e,editorFactory:s,rendermime:i}=t;const a=this.registry=t.registry;const d=this._instructions=n.ReactWidget.create(l.createElement(E,{translator:this.translator}));d.addClass("jp-SettingEditorInstructions");const h=this._editor=new z({commands:e,editorFactory:s,registry:a,rendermime:i,translator:this.translator});const c=()=>h.confirm();const u=this._list=new g({confirm:c,registry:a,translator:this.translator});const p=t.when;if(p){this._when=Array.isArray(p)?Promise.all(p):p}this.addWidget(u);this.addWidget(d);o.SplitPanel.setStretch(u,0);o.SplitPanel.setStretch(d,1);o.SplitPanel.setStretch(h,1);h.stateChanged.connect(this._onStateChanged,this);u.changed.connect(this._onStateChanged,this);this.handleMoved.connect(this._onStateChanged,this)}get canRevertRaw(){return this._editor.raw.canRevert}get canSaveRaw(){return this._editor.raw.canSave}get commandsChanged(){return this._editor.raw.commandsChanged}get settings(){return this._editor.settings}get source(){return this._editor.raw.source}dispose(){if(this.isDisposed){return}super.dispose();this._editor.dispose();this._instructions.dispose();this._list.dispose()}revert(){this._editor.raw.revert()}save(){return this._editor.raw.save()}onAfterAttach(t){super.onAfterAttach(t);this.hide();this._fetchState().then((()=>{this.show();this._setState()})).catch((t=>{console.error("Fetching setting editor state failed",t);this.show();this._setState()}))}onCloseRequest(t){this._editor.confirm().then((()=>{super.onCloseRequest(t);this.dispose()})).catch((()=>{}))}_fetchState(){if(this._fetching){return this._fetching}const{key:t,state:e}=this;const s=[e.fetch(t),this._when];return this._fetching=Promise.all(s).then((([t])=>{this._fetching=null;if(this._saving){return}this._state=$.normalizeState(t,this._state)}))}async _onStateChanged(){this._state.sizes=this.relativeSizes();this._state.container=this._editor.state;this._state.container.plugin=this._list.selection;try{await this._saveState()}catch(t){console.error("Saving setting editor state failed",t)}this._setState()}async _saveState(){const{key:t,state:e}=this;const s=this._state;this._saving=true;try{await e.save(t,s);this._saving=false}catch(i){this._saving=false;throw i}}_setLayout(){const t=this._editor;const e=this._state;t.state=e.container;requestAnimationFrame((()=>{this.setRelativeSizes(e.sizes)}))}_setState(){const t=this._editor;const e=this._list;const{container:s}=this._state;if(!s.plugin){t.settings=null;e.selection="";this._setLayout();return}if(t.settings&&t.settings.id===s.plugin){this._setLayout();return}const i=this._instructions;this.registry.load(s.plugin).then((r=>{if(i.isAttached){i.parent=null}if(!t.isAttached){this.addWidget(t)}t.settings=r;e.selection=s.plugin;this._setLayout()})).catch((i=>{console.error(`Loading ${s.plugin} settings failed.`,i);e.selection=this._state.container.plugin="";t.settings=null;this._setLayout()}))}}var $;(function(t){function e(t,e){if(!t){return _.JSONExt.deepCopy(L)}if(!("sizes"in t)||!s(t.sizes)){t.sizes=_.JSONExt.deepCopy(L.sizes)}if(!("container"in t)){t.container=_.JSONExt.deepCopy(L.container);return t}const i="container"in t&&t.container&&typeof t.container==="object"?t.container:{};t.container={plugin:typeof i.plugin==="string"?i.plugin:L.container.plugin,sizes:s(i.sizes)?i.sizes:_.JSONExt.deepCopy(L.container.sizes)};return t}t.normalizeState=e;function s(t){return Array.isArray(t)&&t.every((t=>typeof t==="number"))}})($||($={}));var A=s(73808)}}]);
//# sourceMappingURL=4086.781a0e7bb2d011ca88c2.js.map?v=781a0e7bb2d011ca88c2