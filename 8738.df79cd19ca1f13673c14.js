"use strict";(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[8738],{78738:(e,t,n)=>{n.r(t);n.d(t,{IPluginManager:()=>E,PluginListModel:()=>g,Plugins:()=>_});var i=n(87447);var a=n(78098);var s=n(4702);var r=n(27425);var l=n(19289);var o=n(55172);var d=n(50724);var u=n(37900);function c(e){return u.createElement(u.Fragment,null,e.trans.__('The plugin "%1" cannot be disabled as it is required by other plugins:',e.plugin.id),u.createElement("ul",null,e.dependants.map((e=>u.createElement("li",{key:"dependantsDialog-"+e.id},e.id)))),e.trans.__("Please disable the dependant plugins first."))}function h(e){return u.createElement("div",{className:"jp-pluginmanager-PluginInUseMessage"},e.trans.__('While the plugin "%1" is not required by other enabled plugins, some plugins provide optional features depending on it. These plugins are:',e.plugin.id),u.createElement("ul",null,e.optionalDependants.map((e=>u.createElement("li",{key:"optionalDependantsDialog-"+e.id},e.id)))),e.trans.__("Do you want to disable it anyway?"))}const p="lab/api/plugins";class g extends r.VDomModel{constructor(e){var t,n,i;super();this.statusError=null;this.actionError=null;this._trackerDataChanged=new l.Signal(this);this._isLoading=false;this._pendingActions=[];this._ready=new o.PromiseDelegate;this._pluginData=e.pluginData;this._serverSettings=e.serverSettings||s.ServerConnection.makeSettings();this._query=e.query||"";this._isDisclaimed=(t=e.isDisclaimed)!==null&&t!==void 0?t:false;this._extraLockedPlugins=(n=e.extraLockedPlugins)!==null&&n!==void 0?n:[];this.refresh().then((()=>this._ready.resolve())).catch((e=>this._ready.reject(e)));this._trans=((i=e.translator)!==null&&i!==void 0?i:d.nullTranslator).load("jupyterlab")}get available(){return[...this._available.values()]}get isLoading(){return this._isLoading}get isDisclaimed(){return this._isDisclaimed}set isDisclaimed(e){if(e!==this._isDisclaimed){this._isDisclaimed=e;this.stateChanged.emit();this._trackerDataChanged.emit(void 0)}}get query(){return this._query}set query(e){if(this._query!==e){this._query=e;this.stateChanged.emit();this._trackerDataChanged.emit(void 0)}}get trackerDataChanged(){return this._trackerDataChanged}get ready(){return this._ready.promise}async enable(e){if(!this.isDisclaimed){throw new Error("User has not confirmed the disclaimer")}await this._performAction("enable",e);e.enabled=true}async disable(e){if(!this.isDisclaimed){throw new Error("User has not confirmed the disclaimer")}const{dependants:t,optionalDependants:n}=this.getDependants(e);if(t.length>0){void(0,i.showDialog)({title:this._trans.__("This plugin is required by other plugins"),body:c({plugin:e,dependants:t,trans:this._trans}),buttons:[i.Dialog.okButton()]});return}if(n.length>0){const t=await(0,i.showDialog)({title:this._trans.__("This plugin is used by other plugins"),body:h({plugin:e,optionalDependants:n,trans:this._trans}),buttons:[i.Dialog.okButton({label:this._trans.__("Disable anyway")}),i.Dialog.cancelButton()]});if(!t.button.accept){return}}await this._performAction("disable",e);if(this.actionError){return}e.enabled=false}getDependants(e){const t=[];const n=[];if(e.provides){const i=e.provides.name;for(const e of this._available.values()){if(!e.enabled){continue}if(e.requires.filter((e=>!!e)).some((e=>e.name===i))){t.push(e)}if(e.optional.filter((e=>!!e)).some((e=>e.name===i))){n.push(e)}}}return{dependants:t,optionalDependants:n}}hasPendingActions(){return this._pendingActions.length>0}_performAction(e,t){this.actionError=null;const n=this._requestAPI({},{method:"POST",body:JSON.stringify({cmd:e,plugin_name:t.id})});n.catch((e=>{this.actionError=e.toString()}));this._addPendingAction(n);return n}_addPendingAction(e){this._pendingActions.push(e);const t=()=>{const t=this._pendingActions.indexOf(e);this._pendingActions.splice(t,1);this.stateChanged.emit(undefined)};e.then(t,t);this.stateChanged.emit(undefined)}async refresh(){var e;this.statusError=null;this._isLoading=true;this.stateChanged.emit();try{const t={allLocked:true,lockRules:[]};const n=(e=await this._requestAPI())!==null&&e!==void 0?e:t;this._available=new Map(this._pluginData.availablePlugins.map((e=>{let t=e.provides?e.provides.name.split(":")[1]:undefined;if(e.provides&&!t){t=e.provides.name}return[e.id,{...e,locked:this._isLocked(e.id,n),tokenLabel:t}]})))}catch(t){this.statusError=t.toString()}finally{this._isLoading=false;this.stateChanged.emit()}}_isLocked(e,t){if(t.allLocked){return true}if(this._extraLockedPlugins.includes(e)){return true}const n=e.split(":")[0];if(t.lockRules.includes(n)){return true}if(t.lockRules.includes(e)){return true}return false}async _requestAPI(e={},t={}){const n=this._serverSettings;const i=a.URLExt.join(n.baseUrl,p);let r;try{r=await s.ServerConnection.makeRequest(i+a.URLExt.objectToQueryString(e),t,n)}catch(o){throw new s.ServerConnection.NetworkError(o)}let l=await r.text();if(l.length>0){try{l=JSON.parse(l)}catch(o){console.log("Not a JSON response body.",r)}}if(!r.ok){throw new s.ServerConnection.ResponseError(r,l.message||l)}return l}}var m=n(65178);class _ extends m.Panel{constructor(e){const{model:t,translator:n}=e;super();this.model=t;this.addClass("jp-pluginmanager");this.trans=n.load("jupyterlab");this.addWidget(new f(t,this.trans));const i=new y(t,this.trans);this.addWidget(i);const a=new b(t,this.trans);this.addWidget(a)}}class b extends i.VDomRenderer{constructor(e,t){super(e);this.trans=t;this.addClass("jp-pluginmanager-AvailableList")}render(){return u.createElement(u.Fragment,null,this.model.statusError!==null?u.createElement(v,null,this.trans.__("Error querying installed extensions%1",this.model.statusError?`: ${this.model.statusError}`:".")):this.model.isLoading?u.createElement("div",{className:"jp-pluginmanager-loader"},this.trans.__("Updating plugin listâ€¦")):u.createElement(r.Table,{blankIndicator:()=>u.createElement("div",null,this.trans.__("No entries")),sortKey:"plugin-id",rows:this.model.available.filter((e=>{const t=new RegExp(this.model.query,"i");return t.test(e.id)||t.test(e.extension)||e.tokenLabel&&t.test(e.tokenLabel)})).map((e=>({data:e,key:e.id}))),columns:[{id:"plugin-id",label:this.trans.__("Plugin"),renderCell:e=>u.createElement(u.Fragment,null,u.createElement("code",null,e.id),u.createElement("br",null),e.description),sort:(e,t)=>e.id.localeCompare(t.id)},{id:"description",label:this.trans.__("Description"),renderCell:e=>u.createElement(u.Fragment,null,e.description),sort:(e,t)=>e.description&&t.description?e.description.localeCompare(t.description):undefined,isHidden:true},{id:"autostart",label:this.trans.__("Autostart?"),renderCell:e=>{switch(e.autoStart){case"defer":return this.trans.__("Defer");case true:return this.trans.__("Yes");case false:case undefined:return this.trans.__("No");default:const t=e.autoStart;throw new Error(`Unknown value: ${t}`)}},sort:(e,t)=>e.autoStart===t.autoStart?0:e.autoStart?-1:1},{id:"requires",label:this.trans.__("Depends on"),renderCell:e=>u.createElement(u.Fragment,null,e.requires.map((e=>e.name)).join("\n")),sort:(e,t)=>(e.requires||[]).length-(t.requires||[]).length,isHidden:true},{id:"extension",label:this.trans.__("Extension"),renderCell:e=>u.createElement(u.Fragment,null,e.extension),sort:(e,t)=>e.extension.localeCompare(t.extension)},{id:"provides",label:this.trans.__("Provides"),renderCell:e=>u.createElement(u.Fragment,null,e.provides?u.createElement("code",{title:e.provides.name},e.tokenLabel):"-"),sort:(e,t)=>(e.tokenLabel||"").localeCompare(t.tokenLabel||"")},{id:"enabled",label:this.trans.__("Enabled"),renderCell:e=>u.createElement(u.Fragment,null,u.createElement("input",{type:"checkbox",checked:e.enabled,disabled:e.locked||!this.model.isDisclaimed,title:e.locked||!this.model.isDisclaimed?e.locked?this.trans.__("This plugin is locked."):this.trans.__("To enable/disable, please acknowledge the disclaimer."):e.enabled?this.trans.__("Disable %1 plugin",e.id):this.trans.__("Enable %1 plugin",e.id),onChange:t=>{if(!this.model.isDisclaimed){return}if(t.target.checked){void this.onAction("enable",e)}else{void this.onAction("disable",e)}}}),e.locked?u.createElement(r.lockIcon.react,{tag:"span",title:this.trans.__("This plugin was locked by system administrator or is a critical dependency and cannot be enabled/disabled.")}):""),sort:(e,t)=>+e.enabled-+t.enabled}]}))}onAction(e,t){switch(e){case"enable":return this.model.enable(t);case"disable":return this.model.disable(t);default:throw new Error(`Invalid action: ${e}`)}}}class f extends i.VDomRenderer{constructor(e,t){super(e);this.trans=t;this.addClass("jp-pluginmanager-Disclaimer")}render(){return u.createElement("div",null,u.createElement("div",null,this.trans.__("Customise your experience/improve performance by disabling plugins you do not need. To disable or uninstall an entire extension use the Extension Manager instead. Changes will apply after reloading JupyterLab.")),u.createElement("label",null,u.createElement("input",{type:"checkbox",className:"jp-mod-styled jp-pluginmanager-Disclaimer-checkbox",defaultChecked:this.model.isDisclaimed,onChange:e=>{this.model.isDisclaimed=e.target.checked}}),this.trans.__("I understand that disabling core application plugins may render features and parts of the user interface unavailable and recovery using `jupyter labextension enable <plugin-name>` command may be required")))}}class y extends i.VDomRenderer{constructor(e,t){super(e);this.trans=t;this.addClass("jp-pluginmanager-Header")}render(){return u.createElement(u.Fragment,null,u.createElement(r.FilterBox,{placeholder:this.trans.__("Filter"),updateFilter:(e,t)=>{this.model.query=t!==null&&t!==void 0?t:""},initialQuery:this.model.query,useFuzzyFilter:false}),u.createElement("div",{className:`jp-pluginmanager-pending ${this.model.hasPendingActions()?"jp-mod-hasPending":""}`}),this.model.actionError&&u.createElement(v,null,u.createElement("p",null,this.trans.__("Error when performing an action.")),u.createElement("p",null,this.trans.__("Reason given:")),u.createElement("pre",null,this.model.actionError)))}}function v(e){return u.createElement("div",{className:"jp-pluginmanager-error"},e.children)}const E=new o.Token("@jupyterlab/pluginmanager:IPluginManager",`A canary for plugin manager presence, with a method to open the plugin manager widget.`)}}]);
//# sourceMappingURL=8738.df79cd19ca1f13673c14.js.map?v=df79cd19ca1f13673c14