"use strict";(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[8284],{28284:(e,t,n)=>{n.r(t);n.d(t,{ITableOfContentsRegistry:()=>d,ITableOfContentsTracker:()=>u,TableOfContents:()=>g,TableOfContentsFactory:()=>r,TableOfContentsItem:()=>_,TableOfContentsModel:()=>f,TableOfContentsPanel:()=>w,TableOfContentsRegistry:()=>y,TableOfContentsTracker:()=>H,TableOfContentsTree:()=>C,TableOfContentsUtils:()=>i,TableOfContentsWidget:()=>b});var s={};n.r(s);n.d(s,{getHeadingId:()=>D,getHeadings:()=>P,isMarkdown:()=>q});var i={};n.r(i);n.d(i,{Markdown:()=>s,NUMBERING_CLASS:()=>A,addPrefix:()=>S,clearNumbering:()=>N,filterHeadings:()=>k,getHTMLHeadings:()=>O,getPrefix:()=>j,isHTML:()=>E});var a=n(78098);const l=1e3;class r{constructor(e){this.tracker=e}isApplicable(e){if(!this.tracker.has(e)){return false}return true}createNew(e,t){const n=this._createNew(e,t);const s=e.context;const i=()=>{n.refresh().catch((e=>{console.error("Failed to update the table of contents.",e)}))};const r=new a.ActivityMonitor({signal:s.model.contentChanged,timeout:l});r.activityStopped.connect(i);const o=()=>{n.title=a.PathExt.basename(s.localPath)};s.pathChanged.connect(o);s.ready.then((()=>{o();i()})).catch((e=>{console.error(`Failed to initiate headings for ${s.localPath}.`)}));e.disposed.connect((()=>{r.activityStopped.disconnect(i);s.pathChanged.disconnect(o)}));return n}}var o=n(27425);var c=n(55172);var h=n(19289);const d=new c.Token("@jupyterlab/toc:ITableOfContentsRegistry","A service to register table of content factory.");const u=new c.Token("@jupyterlab/toc:ITableOfContentsTracker","A widget tracker for table of contents.");var g;(function(e){e.defaultConfig={baseNumbering:1,maximalDepth:4,numberingH1:true,numberHeaders:false,includeOutput:true,syncCollapseState:false}})(g||(g={}));class f extends o.VDomModel{constructor(e,t){super();this.widget=e;this._activeHeading=null;this._activeHeadingChanged=new h.Signal(this);this._collapseChanged=new h.Signal(this);this._configuration=t!==null&&t!==void 0?t:{...g.defaultConfig};this._headings=new Array;this._headingsChanged=new h.Signal(this);this._isActive=false;this._isRefreshing=false;this._needsRefreshing=false}get activeHeading(){return this._activeHeading}get activeHeadingChanged(){return this._activeHeadingChanged}get collapseChanged(){return this._collapseChanged}get configuration(){return this._configuration}get headings(){return this._headings}get headingsChanged(){return this._headingsChanged}get isActive(){return this._isActive}set isActive(e){this._isActive=e;if(this._isActive&&!this.isAlwaysActive){this.refresh().catch((e=>{console.error("Failed to refresh ToC model.",e)}))}}get isAlwaysActive(){return false}get supportedOptions(){return["maximalDepth"]}get title(){return this._title}set title(e){if(e!==this._title){this._title=e;this.stateChanged.emit()}}async refresh(){if(this._isRefreshing){this._needsRefreshing=true;return Promise.resolve()}this._isRefreshing=true;try{const e=await this.getHeadings();if(this._needsRefreshing){this._needsRefreshing=false;this._isRefreshing=false;return this.refresh()}if(e&&!p.areHeadingsEqual(e,this._headings)){this._headings=e;this.stateChanged.emit();this._headingsChanged.emit()}}finally{this._isRefreshing=false}}setActiveHeading(e,t=true){if(this._activeHeading!==e){this._activeHeading=e;this.stateChanged.emit()}if(t){this._activeHeadingChanged.emit(this._activeHeading)}}setConfiguration(e){const t={...this._configuration,...e};if(!c.JSONExt.deepEqual(this._configuration,t)){this._configuration=t;this.refresh().catch((e=>{console.error("Failed to update the table of contents.",e)}))}}toggleCollapse(e){var t,n;if(e.heading){e.heading.collapsed=(t=e.collapsed)!==null&&t!==void 0?t:!e.heading.collapsed;this.stateChanged.emit();this._collapseChanged.emit(e.heading)}else{const t=(n=e.collapsed)!==null&&n!==void 0?n:!this.headings.some((e=>{var t;return!((t=e.collapsed)!==null&&t!==void 0?t:false)}));this.headings.forEach((e=>e.collapsed=t));this.stateChanged.emit();this._collapseChanged.emit(null)}}}var p;(function(e){function t(e,t){if(e.length===t.length){for(let n=0;n<e.length;n++){if(e[n].level!==t[n].level||e[n].text!==t[n].text||e[n].prefix!==t[n].prefix){return false}}return true}return false}e.areHeadingsEqual=t})(p||(p={}));var m=n(65178);var v=n(37900);class _ extends v.PureComponent{render(){const{children:e,isActive:t,heading:n,onCollapse:s,onMouseDown:i}=this.props;return v.createElement("li",{className:"jp-tocItem"},v.createElement("div",{className:`jp-tocItem-heading ${t?"jp-tocItem-active":""}`,onMouseDown:e=>{if(!e.defaultPrevented){e.preventDefault();i(n)}}},v.createElement("button",{className:"jp-tocItem-collapser",onClick:e=>{e.preventDefault();s(n)},style:{visibility:e?"visible":"hidden"}},n.collapsed?v.createElement(o.caretRightIcon.react,{tag:"span",width:"20px"}):v.createElement(o.caretDownIcon.react,{tag:"span",width:"20px"})),v.createElement("span",{className:"jp-tocItem-content",title:n.text,...n.dataset},n.prefix,n.text)),e&&!n.collapsed&&v.createElement("ol",null,e))}}class C extends v.PureComponent{render(){const{documentType:e}=this.props;return v.createElement("ol",{className:"jp-TableOfContents-content","data-document-type":e},this.buildTree())}buildTree(){if(this.props.headings.length===0){return[]}const e=t=>{const n=this.props.headings;const s=new Array;const i=n[t];let a=t+1;while(a<n.length){const t=n[a];if(t.level<=i.level){break}const[l,r]=e(a);s.push(l);a=r}const l=v.createElement(_,{key:`${i.level}-${t}-${i.text}`,isActive:!!this.props.activeHeading&&i===this.props.activeHeading,heading:i,onMouseDown:this.props.setActiveHeading,onCollapse:this.props.onCollapseChange},s.length?s:null);return[l,a]};const t=new Array;let n=0;while(n<this.props.headings.length){const[s,i]=e(n);t.push(s);n=i}return t}}class b extends o.VDomRenderer{constructor(e){super(e.model);this._placeholderHeadline=e.placeholderHeadline;this._placeholderText=e.placeholderText}render(){if(!this.model||this.model.headings.length===0){return v.createElement("div",{className:"jp-TableOfContents-placeholder"},v.createElement("div",{className:"jp-TableOfContents-placeholderContent"},v.createElement("h3",null,this._placeholderHeadline),v.createElement("p",null,this._placeholderText)))}return v.createElement(C,{activeHeading:this.model.activeHeading,documentType:this.model.documentType,headings:this.model.headings,onCollapseChange:e=>{this.model.toggleCollapse({heading:e})},setActiveHeading:e=>{this.model.setActiveHeading(e)}})}}class w extends o.SidePanel{constructor(e){super({content:new m.Panel,translator:e});this._model=null;this.addClass("jp-TableOfContents");this._title=new T.Header(this._trans.__("Table of Contents"));this.header.addWidget(this._title);this._treeview=new b({placeholderHeadline:this._trans.__("No Headings"),placeholderText:this._trans.__("The table of contents shows headings in notebooks and supported files.")});this._treeview.addClass("jp-TableOfContents-tree");this.content.addWidget(this._treeview)}get model(){return this._model}set model(e){var t,n;if(this._model!==e){(t=this._model)===null||t===void 0?void 0:t.stateChanged.disconnect(this._onTitleChanged,this);this._model=e;if(this._model){this._model.isActive=this.isVisible}(n=this._model)===null||n===void 0?void 0:n.stateChanged.connect(this._onTitleChanged,this);this._onTitleChanged();this._treeview.model=this._model}}onAfterHide(e){super.onAfterHide(e);if(this._model){this._model.isActive=false}}onBeforeShow(e){super.onBeforeShow(e);if(this._model){this._model.isActive=true}}_onTitleChanged(){var e,t;this._title.setTitle((t=(e=this._model)===null||e===void 0?void 0:e.title)!==null&&t!==void 0?t:this._trans.__("Table of Contents"))}}var T;(function(e){class t extends m.Widget{constructor(e){const t=document.createElement("h2");t.textContent=e;t.classList.add("jp-text-truncated");super({node:t});this._title=t}setTitle(e){this._title.textContent=e}}e.Header=t})(T||(T={}));var x=n(82524);class y{constructor(){this._generators=new Map;this._idCounter=0}getModel(e,t){for(const n of this._generators.values()){if(n.isApplicable(e)){return n.createNew(e,t)}}}add(e){const t=this._idCounter++;this._generators.set(t,e);return new x.DisposableDelegate((()=>{this._generators.delete(t)}))}}class H{constructor(){this.modelMapping=new WeakMap}add(e,t){this.modelMapping.set(e,t)}get(e){const t=this.modelMapping.get(e);return!t||t.isDisposed?null:t}}const A="numbering-entry";function k(e,t,n=[]){const s={...g.defaultConfig,...t};const i=n;let a=i.length;const l=new Array;for(const r of e){if(r.skip){continue}const e=r.level;if(e>0&&e<=s.maximalDepth){const t=j(e,a,i,s);a=e;l.push({...r,prefix:t})}}return l}function E(e){return e==="text/html"}function O(e,t=true){var n;const s=document.createElement("div");s.innerHTML=e;const i=new Array;const a=s.querySelectorAll("h1, h2, h3, h4, h5, h6");for(const l of a){const e=parseInt(l.tagName[1],10);i.push({text:(n=l.textContent)!==null&&n!==void 0?n:"",level:e,id:l===null||l===void 0?void 0:l.getAttribute("id"),skip:l.classList.contains("jp-toc-ignore")||l.classList.contains("tocSkip")})}return i}function S(e,t,n){let s=e.querySelector(t);if(!s){return null}if(!s.querySelector(`span.${A}`)){M(s,n)}else{const i=e.querySelectorAll(t);for(const e of i){if(!e.querySelector(`span.${A}`)){s=e;M(e,n);break}}}return s}function j(e,t,n,s){const{baseNumbering:i,numberingH1:a,numberHeaders:l}=s;let r="";if(l){const s=a?1:2;if(e>t){for(let s=t;s<e-1;s++){n[s]=0}n[e-1]=e===s?i:1}else{n[e-1]+=1;if(e<t){n.splice(e)}}if(a){r=n.map((e=>e!==null&&e!==void 0?e:0)).join(".")+". "}else{if(n.length>1){r=n.slice(1).map((e=>e!==null&&e!==void 0?e:0)).join(".")+". "}}}return r}function M(e,t){e.insertAdjacentHTML("afterbegin",`<span class="${A}">${t}</span>`)}function N(e){e===null||e===void 0?void 0:e.querySelectorAll(`span.${A}`).forEach((e=>{e.remove()}))}var I=n(87447);var R=n(59238);async function D(e,t,n,s){try{const i=document.createElement("div");await(0,R.renderMarkdown)({markdownParser:e,host:i,source:t,trusted:false,sanitizer:s!==null&&s!==void 0?s:new I.Sanitizer,shouldTypeset:false,resolver:null,linkHandler:null,latexTypesetter:null});const a=i.querySelector(`h${n}`);if(!a){return null}return a.id}catch(i){console.error("Failed to parse a heading.",i)}return null}function P(e){const t=e.split("\n");const n=new Array;let s;let i=0;if(t[i]==="---"){for(let e=i+1;e<t.length;e++){if(t[e]==="---"){i=e+1;break}}}for(;i<t.length;i++){const e=t[i];if(e===""){continue}if(e.startsWith("```")){s=!s}if(s){continue}const a=L(e,t[i+1]);if(a){n.push({...a,line:i})}}return n}const $=["text/x-ipythongfm","text/x-markdown","text/x-gfm","text/markdown"];function q(e){return $.includes(e)}function L(e,t){let n=e.match(/^([#]{1,6}) (.*)/);if(n){return{text:F(n[2]),level:n[1].length,raw:e,skip:W.test(n[0])}}if(t){n=t.match(/^ {0,3}([=]{2,}|[-]{2,})\s*$/);if(n){return{text:F(e),level:n[1][0]==="="?1:2,raw:[e,t].join("\n"),skip:W.test(e)}}}n=e.match(/<h([1-6]).*>(.*)<\/h\1>/i);if(n){return{text:n[2],level:parseInt(n[1],10),skip:W.test(n[0]),raw:e}}return null}function F(e){return e.replace(/\[(.+)\]\(.+\)/g,"$1")}const W=/<\w+\s(.*?\s)?class="(.*?\s)?(jp-toc-ignore|tocSkip)(\s.*?)?"(\s.*?)?>/}}]);
//# sourceMappingURL=8284.807c98adbad38a8066bb.js.map?v=807c98adbad38a8066bb