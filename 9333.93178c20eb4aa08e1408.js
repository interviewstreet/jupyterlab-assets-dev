/*! For license information please see 9333.93178c20eb4aa08e1408.js.LICENSE.txt */
(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[9333],{56139:(t,e,n)=>{"use strict";n.r(e);n.d(e,{factory:()=>at,getGlobalVars:()=>ot,registerAnalytics:()=>ft,resetGlobalVars:()=>it,settings:()=>st});var r=n(99413);var i=n(5216);var o=function(t,e){o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n]};return o(t,e)};function s(t,e){o(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var a=function(){a=Object.assign||function t(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o))e[o]=n[o]}return e};return a.apply(this,arguments)};function u(t,e){var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0)n[r]=t[r];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++){if(e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i]))n[r[i]]=t[r[i]]}return n}function c(t,e,n,r){var i=arguments.length,o=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,s;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)if(s=t[a])o=(i<3?s(o):i>3?s(e,n,o):s(e,n))||o;return i>3&&o&&Object.defineProperty(e,n,o),o}function h(t,e){return function(n,r){e(n,r,t)}}function f(t,e){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(t,e)}function l(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function p(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(t){return function(e){return u([t,e])}}function u(s){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=s[0]&2?i["return"]:s[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;if(i=0,o)s=[s[0]&2,o.value];switch(s[0]){case 0:case 1:o=s;break;case 4:n.label++;return{value:s[1],done:false};case 5:n.label++;i=s[1];s=[0];continue;case 7:s=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){n.label=s[1];break}if(s[0]===6&&n.label<o[1]){n.label=o[1];o=s;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(s);break}if(o[2])n.ops.pop();n.trys.pop();continue}s=e.call(t,n)}catch(a){s=[6,a];i=0}finally{r=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}}function d(t,e){for(var n in t)if(!e.hasOwnProperty(n))e[n]=t[n]}function v(t){var e=typeof Symbol==="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length==="number")return{next:function(){if(t&&r>=t.length)t=void 0;return{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(t,e){var n=typeof Symbol==="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],s;try{while((e===void 0||e-- >0)&&!(i=r.next()).done)o.push(i.value)}catch(a){s={error:a}}finally{try{if(i&&!i.done&&(n=r["return"]))n.call(r)}finally{if(s)throw s.error}}return o}function m(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(y(arguments[e]));return t}function g(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function w(t){return this instanceof w?(this.v=t,this):new w(t)}function b(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(t){if(r[t])i[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||a(t,e)}))}}function a(t,e){try{u(r[t](e))}catch(n){f(o[0][3],n)}}function u(t){t.value instanceof w?Promise.resolve(t.value.v).then(c,h):f(o[0][2],t)}function c(t){a("next",t)}function h(t){a("throw",t)}function f(t,e){if(t(e),o.shift(),o.length)a(o[0][0],o[0][1])}}function _(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:w(t[r](e)),done:r==="return"}:i?i(e):e}:i}}function E(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof v==="function"?v(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(e){n[e]=t[e]&&function(n){return new Promise((function(r,o){n=t[e](n),i(r,o,n.done,n.value)}))}}function i(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}}function I(t,e){if(Object.defineProperty){Object.defineProperty(t,"raw",{value:e})}else{t.raw=e}return t}function T(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)if(Object.hasOwnProperty.call(t,n))e[n]=t[n];e.default=t;return e}function S(t){return t&&t.__esModule?t:{default:t}}function N(t,e){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return e.get(t)}function A(t,e,n){if(!e.has(t)){throw new TypeError("attempted to set private field on non-instance")}e.set(t,n);return n}var O=n(13936);var k=n(71470);var R=n(56630);var C="measurementId";var D="firebase_id";var P="origin";var x="https://www.googletagmanager.com/gtag/js";var L;(function(t){t["EVENT"]="event";t["SET"]="set";t["CONFIG"]="config"})(L||(L={}));var U;(function(t){t["ADD_PAYMENT_INFO"]="add_payment_info";t["ADD_TO_CART"]="add_to_cart";t["ADD_TO_WISHLIST"]="add_to_wishlist";t["BEGIN_CHECKOUT"]="begin_checkout";t["CHECKOUT_PROGRESS"]="checkout_progress";t["EXCEPTION"]="exception";t["GENERATE_LEAD"]="generate_lead";t["LOGIN"]="login";t["PAGE_VIEW"]="page_view";t["PURCHASE"]="purchase";t["REFUND"]="refund";t["REMOVE_FROM_CART"]="remove_from_cart";t["SCREEN_VIEW"]="screen_view";t["SEARCH"]="search";t["SELECT_CONTENT"]="select_content";t["SET_CHECKOUT_OPTION"]="set_checkout_option";t["SHARE"]="share";t["SIGN_UP"]="sign_up";t["TIMING_COMPLETE"]="timing_complete";t["VIEW_ITEM"]="view_item";t["VIEW_ITEM_LIST"]="view_item_list";t["VIEW_PROMOTION"]="view_promotion";t["VIEW_SEARCH_RESULTS"]="view_search_results"})(U||(U={}));function M(t,e,n,r,i){var o=r||{};if(!i||!i.global){o=a(a({},r),{send_to:e})}t(L.EVENT,n,o||{})}function j(t,e,n,r){if(r&&r.global){t(L.SET,{screen_name:n})}else{t(L.CONFIG,e,{update:true,screen_name:n})}}function F(t,e,n,r){if(r&&r.global){t(L.SET,{user_id:n})}else{t(L.CONFIG,e,{update:true,user_id:n})}}function q(t,e,n,r){if(r&&r.global){var i={};for(var o=0,s=Object.keys(n);o<s.length;o++){var a=s[o];i["user_properties."+a]=n[a]}t(L.SET,i)}else{t(L.CONFIG,e,{update:true,user_properties:n})}}function G(t,e){window["ga-disable-"+t]=!e}var V=new O.Logger("@firebase/analytics");function B(t,e,n){return l(this,void 0,void 0,(function(){var r;var i;return p(this,(function(o){switch(o.label){case 0:return[4,e.getId()];case 1:r=o.sent();n("js",new Date);n(L.CONFIG,t.options[C],(i={},i[D]=r,i[P]="firebase",i.update=true,i));return[2]}}))}))}function z(t){var e=document.createElement("script");e.src=x+"?l="+t;e.async=true;document.head.appendChild(e)}function H(t){var e=[];if(Array.isArray(window[t])){e=window[t]}else{window[t]=e}return e}function W(t,e){return function(n,r,i){if(n===L.EVENT){var o=[];if(i&&i["send_to"]){var s=i["send_to"];if(!Array.isArray(s)){s=[s]}for(var a=0,u=s;a<u.length;a++){var c=u[a];var h=e[c];if(h){o.push(h)}else{o=[];break}}}if(o.length===0){for(var f=0,l=Object.values(e);f<l.length;f++){var p=l[f];o.push(p)}}Promise.all(o).then((function(){return t(L.EVENT,r,i||{})})).catch((function(t){return V.error(t)}))}else if(n===L.CONFIG){var d=e[r]||Promise.resolve();d.then((function(){t(L.CONFIG,r,i)})).catch((function(t){return V.error(t)}))}else{t(L.SET,r)}}}function K(t,e,n){var r=function(){var t=[];for(var n=0;n<arguments.length;n++){t[n]=arguments[n]}window[e].push(arguments)};if(window[n]&&typeof window[n]==="function"){r=window[n]}window[n]=W(r,t);return{gtagCore:r,wrappedGtag:window[n]}}function Q(){var t=window.document.getElementsByTagName("script");for(var e=0,n=Object.values(t);e<n.length;e++){var r=n[e];if(r.src&&r.src.includes(x)){return r}}return null}var Y;var J=(Y={},Y["no-ga-id"]='"'+C+'" field is empty in '+"Firebase config. Firebase Analytics "+"requires this field to contain a valid measurement ID.",Y["already-exists"]="A Firebase Analytics instance with the measurement ID ${id} "+" already exists. "+"Only one Firebase Analytics instance can be created for each measurement ID.",Y["already-initialized"]="Firebase Analytics has already been initialized."+"settings() must be called before initializing any Analytics instance"+"or it will have no effect.",Y["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate",Y);var X=new k.ErrorFactory("analytics","Analytics",J);var $={};var Z="dataLayer";var tt="gtag";var et;var nt;var rt=false;function it(t,e){if(t===void 0){t=false}if(e===void 0){e={}}rt=t;$=e;Z="dataLayer";tt="gtag"}function ot(){return{initializedIdPromisesMap:$}}function st(t){if(rt){throw X.create("already-initialized")}if(t.dataLayerName){Z=t.dataLayerName}if(t.gtagName){tt=t.gtagName}}function at(t,e){var n=t.options[C];if(!n){throw X.create("no-ga-id")}if($[n]!=null){throw X.create("already-exists",{id:n})}if(!rt){if(!Q()){z(Z)}H(Z);var r=K($,Z,tt),i=r.wrappedGtag,o=r.gtagCore;nt=i;et=o;rt=true}$[n]=B(t,e,et);var s={app:t,logEvent:function(t,e,r){return M(nt,n,t,e,r)},setCurrentScreen:function(t,e){return j(nt,n,t,e)},setUserId:function(t,e){return F(nt,n,t,e)},setUserProperties:function(t,e){return q(nt,n,t,e)},setAnalyticsCollectionEnabled:function(t){return G(n,t)}};return s}var ut="@firebase/analytics";var ct="0.2.18";var ht="analytics";function ft(t){t.INTERNAL.registerComponent(new R.Component(ht,(function(t){var e=t.getProvider("app").getImmediate();var n=t.getProvider("installations").getImmediate();return at(e,n)}),"PUBLIC").setServiceProps({settings:st,EventName:U}));t.INTERNAL.registerComponent(new R.Component("analytics-internal",e,"PRIVATE"));t.registerVersion(ut,ct);function e(t){try{var e=t.getProvider(ht).getImmediate();return{logEvent:e.logEvent}}catch(n){throw X.create("interop-component-reg-failed",{reason:n})}}}ft(r.default)},91779:(t,e,n)=>{"use strict";var r=n(34406);Object.defineProperty(e,"__esModule",{value:true});function i(t){return t&&typeof t==="object"&&"default"in t?t["default"]:t}var o=i(n(99413));var s=n(40154);var a=n(13936);var u=n(71470);var c=n(56630);var h=n(49713);var f=o.SDK_VERSION,l=new a.Logger("@firebase/firestore");function p(){return l.logLevel===a.LogLevel.DEBUG?0:l.logLevel===a.LogLevel.SILENT?2:1}function d(t){switch(t){case 0:l.logLevel=a.LogLevel.DEBUG;break;case 1:l.logLevel=a.LogLevel.ERROR;break;case 2:l.logLevel=a.LogLevel.SILENT;break;default:l.error("Firestore ("+f+"): Invalid value passed to `setLogLevel`")}}function v(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(l.logLevel<=a.LogLevel.DEBUG){var i=n.map(m);l.debug.apply(l,s.__spreadArrays(["Firestore ("+f+") ["+t+"]: "+e],i))}}function y(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(l.logLevel<=a.LogLevel.ERROR){var r=e.map(m);l.error.apply(l,s.__spreadArrays(["Firestore ("+f+"): "+t],r))}}function m(t){if("string"==typeof t)return t;var e=cn.t();try{return e.i(t)}catch(e){return t}}function g(t){var e="FIRESTORE ("+f+") INTERNAL ASSERTION FAILED: "+t;throw y(e),new Error(e)}function w(t,e){t||g(e)}var b=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return w(20===e.length,"Invalid auto ID: "+e),e},t}();function _(t,e){return t<e?-1:t>e?1:0}function E(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].isEqual(e[n]))return!1;return!0}function I(t){return t+"\0"}var T=function(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i},S=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.h=function(t){return _(this.projectId,t.projectId)||_(this.database,t.database)},t}(),N=function(){function t(t){this.uid=t}return t.prototype.l=function(){return null!=this.uid},t.prototype.v=function(){return this.l()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t.UNAUTHENTICATED=new t(null),t.m=new t("google-credentials-uid"),t.p=new t("first-party-uid"),t}(),A={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},O=function(t){function e(e,n){var r=t.call(this,n)||this;return r.code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return s.__extends(e,t),e}(Error),k=function(t,e){this.user=e,this.type="OAuth",this.g={},this.g.Authorization="Bearer "+t},R=function(){function t(){this._=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.I=function(){},t.prototype.T=function(t){w(!this._,"Can only call setChangeListener() once."),this._=t,t(N.UNAUTHENTICATED)},t.prototype.D=function(){w(null!==this._,"removeChangeListener() when no listener registered"),this._=null},t}(),C=function(){function t(t){var e=this;this.S=null,this.currentUser=N.UNAUTHENTICATED,this.R=!1,this.C=0,this._=null,this.forceRefresh=!1,this.S=function(){e.C++,e.currentUser=e.A(),e.R=!0,e._&&e._(e.currentUser)},this.C=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.S):(this.S(null),t.get().then((function(t){e.auth=t,e.S&&e.auth.addAuthTokenListener(e.S)}),(function(){})))}return t.prototype.getToken=function(){var t=this;w(null!=this.S,"getToken cannot be called after listener removed.");var e=this.C,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){if(t.C!==e)throw new O(A.ABORTED,"getToken aborted due to token change.");return n?(w("string"==typeof n.accessToken,"Invalid tokenData returned from getToken():"+n),new k(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.I=function(){this.forceRefresh=!0},t.prototype.T=function(t){w(!this._,"Can only call setChangeListener() once."),this._=t,this.R&&t(this.currentUser)},t.prototype.D=function(){w(null!=this.S,"removeChangeListener() called twice"),w(null!==this._,"removeChangeListener() called when no listener registered"),this.auth&&this.auth.removeAuthTokenListener(this.S),this.S=null,this._=null},t.prototype.A=function(){var t=this.auth&&this.auth.getUid();return w(null===t||"string"==typeof t,"Received invalid UID: "+t),new N(t)},t}(),D=function(){function t(t,e){this.P=t,this.k=e,this.type="FirstParty",this.user=N.p}return Object.defineProperty(t.prototype,"g",{get:function(){var t={"X-Goog-AuthUser":this.k},e=this.P.auth.N([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),t}(),P=function(){function t(t,e){this.P=t,this.k=e}return t.prototype.getToken=function(){return Promise.resolve(new D(this.P,this.k))},t.prototype.T=function(t){t(N.p)},t.prototype.D=function(){},t.prototype.I=function(){},t}();function x(t){if(!t)return new R;switch(t.type){case"gapi":var e=t.O;return w(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new P(e,t.k||"0");case"provider":return t.O;default:throw new O(A.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}function L(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function U(t,e){return void 0!==t?t:e}function M(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=Number(n);isNaN(r)||e(r,t[n])}}function j(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function F(t){for(var e in w(null!=t&&"object"==typeof t,"isEmpty() expects object parameter."),t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function q(t,e){if(0!==e.length)throw new O(A.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+st(e.length,"argument")+".")}function G(t,e,n){if(e.length!==n)throw new O(A.INVALID_ARGUMENT,"Function "+t+"() requires "+st(n,"argument")+", but was called with "+st(e.length,"argument")+".")}function V(t,e,n){if(e.length<n)throw new O(A.INVALID_ARGUMENT,"Function "+t+"() requires at least "+st(n,"argument")+", but was called with "+st(e.length,"argument")+".")}function B(t,e,n,r){if(e.length<n||e.length>r)throw new O(A.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+st(e.length,"argument")+".")}function z(t,e,n,r){if(!(e instanceof Array)||e.length<r)throw new O(A.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" argument to be an array with at least "+st(r,"element")+".")}function H(t,e,n,r){$(t,e,ot(n)+" argument",r)}function W(t,e,n,r){void 0!==r&&H(t,e,n,r)}function K(t,e,n,r){$(t,e,n+" option",r)}function Q(t,e,n,r){void 0!==r&&K(t,e,n,r)}function Y(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new O(A.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+tt(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new O(A.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be "+n+", but the value at index "+o+" was: "+tt(r[o]))}(t,e,n,r,i)}function J(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],s=0,a=i;s<a.length;s++){var u=a[s];if(u===r)return;o.push(tt(u))}var c=tt(r);throw new O(A.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(t,0,n,r,i)}function X(t,e,n,r){if(!e.some((function(t){return t===r})))throw new O(A.INVALID_ARGUMENT,"Invalid value "+tt(r)+" provided to function "+t+"() for its "+ot(n)+" argument. Acceptable values: "+e.join(", "))}function $(t,e,n,r){if(!("object"===e?Z(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=tt(r);throw new O(A.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Z(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function tt(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":g("Unknown wrong type: "+typeof t)}function et(t,e,n){if(void 0===n)throw new O(A.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+ot(e)+" argument, but it was undefined.")}function nt(t,e,n){j(e,(function(e,r){if(n.indexOf(e)<0)throw new O(A.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))}))}function rt(t,e,n,r){var i=tt(r);return new O(A.INVALID_ARGUMENT,"Function "+t+"() requires its "+ot(n)+" argument to be a "+e+", but it was: "+i)}function it(t,e,n){if(n<=0)throw new O(A.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+ot(e)+" argument to be a positive number, but it was: "+n+".")}function ot(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function st(t,e){return t+" "+e+(1===t?"":"s")}var at=function(){function t(t,e){if(G("GeoPoint",arguments,2),H("GeoPoint","number",1,t),H("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new O(A.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new O(A.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.F=t,this.V=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.F},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.V},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this.F===t.F&&this.V===t.V},t.prototype.U=function(t){return _(this.F,t.F)||_(this.V,t.V)},t}(),ut=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new O(A.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new O(A.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new O(A.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new O(A.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.U=function(t){return this.seconds===t.seconds?_(this.nanoseconds,t.nanoseconds):_(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),ct=function(){function t(t){this.timestamp=t}return t.j=function(e){var n=Math.floor(e/1e6);return new t(new ut(n,e%1e6*1e3))},t.L=function(e){return new t(e)},t.q=function(){return t.MIN},t.prototype.h=function(t){return this.timestamp.U(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.B=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.M=function(){return this.timestamp},t.MIN=new t(new ut(0,0)),t}(),ht=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&g("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&g("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.G(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.W(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.K=function(t){return t=void 0===t?1:t,w(this.length>=t,"Can't call popFirst() with less segments"),this.W(this.segments,this.offset+t,this.length-t)},t.prototype.H=function(){return w(!this.J(),"Can't call popLast() on empty path"),this.W(this.segments,this.offset,this.length-1)},t.prototype.Y=function(){return w(!this.J(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},t.prototype.X=function(){return this.get(this.length-1)},t.prototype.get=function(t){return w(t<this.length,"Index out of range"),this.segments[this.offset+t]},t.prototype.J=function(){return 0===this.length},t.prototype.$=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.Z=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.tt=function(){return this.segments.slice(this.offset,this.limit())},t.G=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.W=function(t,n,r){return new e(t,n,r)},e.prototype.nt=function(){return this.tt().join("/")},e.prototype.toString=function(){return this.nt()},e.it=function(t){if(t.indexOf("//")>=0)throw new O(A.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter((function(t){return t.length>0})))},e.et=new e([]),e}(ht),lt=/^[_a-zA-Z][_a-zA-Z0-9]*$/,pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.W=function(t,n,r){return new e(t,n,r)},e.rt=function(t){return lt.test(t)},e.prototype.nt=function(){return this.tt().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.rt(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.nt()},e.prototype.ut=function(){return 1===this.length&&"__name__"===this.get(0)},e.st=function(){return new e(["__name__"])},e.ot=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new O(A.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new O(A.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new O(A.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new O(A.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.et=new e([]),e}(ht),dt=function(){function t(e){this.path=e,w(t.ht(e),"Invalid DocumentKey with an odd number of segments: "+e.tt().join("/"))}return t.prototype.ct=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===ft.G(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.G=function(t,e){return ft.G(t.path,e.path)},t.ht=function(t){return t.length%2==0},t.at=function(e){return new t(new ft(e.slice()))},t.ft=function(e){return new t(ft.it(e))},t.EMPTY=new t(new ft([])),t}(),vt=function(){function t(t,e){this.G=t,this.root=e||mt.EMPTY}return t.prototype.lt=function(e,n){return new t(this.G,this.root.lt(e,n,this.G).copy(null,null,mt.dt,null,null))},t.prototype.remove=function(e){return new t(this.G,this.root.remove(e,this.G).copy(null,null,mt.dt,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.J();){var n=this.G(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.J();){var r=this.G(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.J=function(){return this.root.J()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.vt=function(){return this.root.vt()},t.prototype.wt=function(){return this.root.wt()},t.prototype.pt=function(t){return this.root.pt(t)},t.prototype.forEach=function(t){this.pt((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.pt((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.gt=function(t){return this.root.gt(t)},t.prototype.bt=function(){return new yt(this.root,null,this.G,!1)},t.prototype.yt=function(t){return new yt(this.root,t,this.G,!1)},t.prototype._t=function(){return new yt(this.root,null,this.G,!0)},t.prototype.It=function(t){return new yt(this.root,t,this.G,!0)},t}(),yt=function(){function t(t,e,n,r){this.Tt=r,this.Et=[];for(var i=1;!t.J();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Tt?t.left:t.right;else{if(0===i){this.Et.push(t);break}this.Et.push(t),t=this.Tt?t.right:t.left}}return t.prototype.Dt=function(){w(this.Et.length>0,"getNext() called on iterator when hasNext() is false.");var t=this.Et.pop(),e={key:t.key,value:t.value};if(this.Tt)for(t=t.left;!t.J();)this.Et.push(t),t=t.right;else for(t=t.right;!t.J();)this.Et.push(t),t=t.left;return e},t.prototype.St=function(){return this.Et.length>0},t.prototype.Rt=function(){if(0===this.Et.length)return null;var t=this.Et[this.Et.length-1];return{key:t.key,value:t.value}},t}(),mt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.J=function(){return!1},t.prototype.pt=function(t){return this.left.pt(t)||t(this.key,this.value)||this.right.pt(t)},t.prototype.gt=function(t){return this.right.gt(t)||t(this.key,this.value)||this.left.gt(t)},t.prototype.min=function(){return this.left.J()?this:this.left.min()},t.prototype.vt=function(){return this.min().key},t.prototype.wt=function(){return this.right.J()?this.key:this.right.wt()},t.prototype.lt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.lt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.lt(t,e,n))).Ct()},t.prototype.At=function(){if(this.left.J())return t.EMPTY;var e=this;return e.left.Pt()||e.left.left.Pt()||(e=e.kt()),(e=e.copy(null,null,null,e.left.At(),null)).Ct()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.J()||i.left.Pt()||i.left.left.Pt()||(i=i.kt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.Pt()&&(i=i.Nt()),i.right.J()||i.right.Pt()||i.right.left.Pt()||(i=i.Ot()),0===n(e,i.key)){if(i.right.J())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.At())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.Ct()},t.prototype.Pt=function(){return this.color},t.prototype.Ct=function(){var t=this;return t.right.Pt()&&!t.left.Pt()&&(t=t.Ft()),t.left.Pt()&&t.left.left.Pt()&&(t=t.Nt()),t.left.Pt()&&t.right.Pt()&&(t=t.Vt()),t},t.prototype.kt=function(){var t=this.Vt();return t.right.left.Pt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Nt())).Ft()).Vt()),t},t.prototype.Ot=function(){var t=this.Vt();return t.left.left.Pt()&&(t=(t=t.Nt()).Vt()),t},t.prototype.Ft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.Nt=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Vt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ut=function(){var t=this.xt();return Math.pow(2,t)<=this.size+1},t.prototype.xt=function(){if(this.Pt()&&this.left.Pt())throw g("Red node has red child("+this.key+","+this.value+")");if(this.right.Pt())throw g("Right child of ("+this.key+","+this.value+") is red");var t=this.left.xt();if(t!==this.right.xt())throw g("Black depths differ");return t+(this.Pt()?0:1)},t.EMPTY=null,t.RED=!0,t.dt=!1,t}(),gt=function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw g("LLRBEmptyNode has no key.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw g("LLRBEmptyNode has no value.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw g("LLRBEmptyNode has no color.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw g("LLRBEmptyNode has no left child.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw g("LLRBEmptyNode has no right child.")},enumerable:!0,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.lt=function(t,e,n){return new mt(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.J=function(){return!0},t.prototype.pt=function(t){return!1},t.prototype.gt=function(t){return!1},t.prototype.vt=function(){return null},t.prototype.wt=function(){return null},t.prototype.Pt=function(){return!1},t.prototype.Ut=function(){return!0},t.prototype.xt=function(){return 0},t}();mt.EMPTY=new gt;var wt=function(){function t(t){this.G=t,this.data=new vt(this.G)}return t.jt=function(e){var n=new t(e.G);return e.forEach((function(t){n=n.add(t)})),n},t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.vt()},t.prototype.last=function(){return this.data.wt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.pt((function(e,n){return t(e),!1}))},t.prototype.Lt=function(t,e){for(var n=this.data.yt(t[0]);n.St();){var r=n.Dt();if(this.G(r.key,t[1])>=0)return;e(r.key)}},t.prototype.qt=function(t,e){var n;for(n=void 0!==e?this.data.yt(e):this.data.bt();n.St();){if(!t(n.Dt().key))return}},t.prototype.Bt=function(t){var e=this.data.yt(t);return e.St()?e.Dt().key:null},t.prototype.bt=function(){return new bt(this.data.bt())},t.prototype.yt=function(t){return new bt(this.data.yt(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).lt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.J=function(){return this.data.J()},t.prototype.Mt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.bt(),r=e.data.bt();n.St();){var i=n.Dt().key,o=r.Dt().key;if(0!==this.G(i,o))return!1}return!0},t.prototype.tt=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.G);return n.data=e,n},t}(),bt=function(){function t(t){this.Qt=t}return t.prototype.Dt=function(){return this.Qt.Dt().key},t.prototype.St=function(){return this.Qt.St()},t}(),_t=function(){function t(){}return t.prototype.Gt=function(t,e){return new Wt(e,t)},t.prototype.Wt=function(t,e){return e},t.prototype.zt=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t},t.instance=new t,t}(),Et=function(){function t(t){this.elements=t}return t.prototype.Gt=function(t,e){return this.apply(t)},t.prototype.Wt=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=St(t),n=function(t){e.find((function(e){return e.isEqual(t)}))||e.push(t)},r=0,i=this.elements;r<i.length;r++){n(i[r])}return new $t(e)},t.prototype.zt=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&E(e.elements,this.elements)},t}(),It=function(){function t(t){this.elements=t}return t.prototype.Gt=function(t,e){return this.apply(t)},t.prototype.Wt=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=St(t),n=function(t){e=e.filter((function(e){return!e.isEqual(t)}))},r=0,i=this.elements;r<i.length;r++){n(i[r])}return new $t(e)},t.prototype.zt=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&E(e.elements,this.elements)},t}(),Tt=function(){function t(t){this.Kt=t}return t.prototype.Gt=function(t,e){var n=this.zt(t);if(n instanceof Vt&&this.Kt instanceof Vt){var r=n.Ht+this.Kt.Ht;return new Vt(r)}r=n.Ht+this.Kt.Ht;return new Bt(r)},t.prototype.Wt=function(t,e){return w(null!==e,"Didn't receive transformResult for NUMERIC_ADD transform"),e},t.prototype.zt=function(t){return t instanceof qt?t:new Vt(0)},t.prototype.isEqual=function(e){return e instanceof t&&this.Kt.isEqual(e.Kt)},t}();function St(t){return t instanceof $t?t.Ht.slice():[]}var Nt=function(){function t(t){this.fields=t}return t.Jt=function(e){return new t(e)},t.Yt=function(e){var n=new wt(pt.G);return e.forEach((function(t){return n=n.add(t)})),new t(n)},t.prototype.Xt=function(t){var e=!1;return this.fields.forEach((function(n){n.$(t)&&(e=!0)})),e},t.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},t}(),At=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),Ot=function(t,e){this.version=t,this.transformResults=e},kt=function(){function t(t,e){this.updateTime=t,this.exists=e,w(void 0===t||void 0===e,'Precondition can specify "exists" or "updateTime" but not both')}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"$t",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.Zt=function(t){return void 0!==this.updateTime?t instanceof te&&t.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===t instanceof te:(w(this.$t,"Precondition should be empty"),!0)},t.prototype.isEqual=function(t){return e=this.updateTime,n=t.updateTime,(null!=e?!(!n||!e.isEqual(n)):e===n)&&this.exists===t.exists;var e,n},t.NONE=new t,t}(),Rt=function(){function t(){}return t.prototype.tn=function(t){null!=t&&w(t.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},t.nn=function(t){return t instanceof te?t.version:ct.MIN},t}(),Ct=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.value=n,i.in=r,i.type=0,i}return s.__extends(e,t),e.prototype.Wt=function(t,e){this.tn(t),w(null==e.transformResults,"Transform results received by SetMutation.");var n=e.version;return new te(this.key,n,{hasCommittedMutations:!0},this.value)},e.prototype.Gt=function(t,e,n){if(this.tn(t),!this.in.Zt(t))return t;var r=Rt.nn(t);return new te(this.key,r,{en:!0},this.value)},e.prototype.rn=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.in.isEqual(t.in)},e}(Rt),Dt=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.key=e,o.data=n,o.un=r,o.in=i,o.type=1,o}return s.__extends(e,t),e.prototype.Wt=function(t,e){if(this.tn(t),w(null==e.transformResults,"Transform results received by PatchMutation."),!this.in.Zt(t))return new ne(this.key,e.version);var n=this.sn(t);return new te(this.key,e.version,{hasCommittedMutations:!0},n)},e.prototype.Gt=function(t,e,n){if(this.tn(t),!this.in.Zt(t))return t;var r=Rt.nn(t),i=this.sn(t);return new te(this.key,r,{en:!0},i)},e.prototype.rn=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.un.isEqual(t.un)&&this.in.isEqual(t.in)},e.prototype.sn=function(t){var e;return e=t instanceof te?t.data():Jt.EMPTY,this.on(e)},e.prototype.on=function(t){var e=this,n=t.hn();return this.un.fields.forEach((function(t){if(!t.J()){var r=e.data.field(t);null!==r?n.set(t,r):n.delete(t)}})),n.cn()},e}(Rt),Pt=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.fieldTransforms=n,r.type=2,r.in=kt.exists(!0),r}return s.__extends(e,t),e.prototype.Wt=function(t,e){if(this.tn(t),w(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.in.Zt(t))return new ne(this.key,e.version);var n=this.an(t),r=this.fn(t,e.transformResults),i=e.version,o=this.ln(n.data(),r);return new te(this.key,i,{hasCommittedMutations:!0},o)},e.prototype.Gt=function(t,e,n){if(this.tn(t),!this.in.Zt(t))return t;var r=this.an(t),i=this.dn(n,t,e),o=this.ln(r.data(),i);return new te(this.key,r.version,{en:!0},o)},e.prototype.rn=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof te?t.field(i.field):void 0,s=i.transform.zt(o||null);null!=s&&(e=null==e?Jt.vn().set(i.field,s):e.set(i.field,s))}return e?e.cn():null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&E(this.fieldTransforms,t.fieldTransforms)&&this.in.isEqual(t.in)},e.prototype.an=function(t){return w(t instanceof te,"Unknown MaybeDocument type "+t),w(t.key.isEqual(this.key),"Can only transform a document with the same key"),t},e.prototype.fn=function(t,e){var n=[];w(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,s=null;t instanceof te&&(s=t.field(i.field)),n.push(o.Wt(s,e[r]))}return n},e.prototype.dn=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var s=o[i],a=s.transform,u=null;e instanceof te&&(u=e.field(s.field)),null===u&&n instanceof te&&(u=n.field(s.field)),r.push(a.Gt(u,t))}return r},e.prototype.ln=function(t,e){w(e.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=t.hn(),r=0;r<this.fieldTransforms.length;r++){var i=this.fieldTransforms[r].field;n.set(i,e[r])}return n.cn()},e}(Rt),xt=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.in=n,r.type=3,r}return s.__extends(e,t),e.prototype.Wt=function(t,e){return this.tn(t),w(null==e.transformResults,"Transform results received by DeleteMutation."),new ee(this.key,e.version,{hasCommittedMutations:!0})},e.prototype.Gt=function(t,e,n){return this.tn(t),this.in.Zt(t)?(t&&w(t.key.isEqual(this.key),"Can only apply mutation to document with same key"),new ee(this.key,ct.q())):t},e.prototype.rn=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.in.isEqual(t.in)},e}(Rt),Lt=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.in=n,r.type=4,r}return s.__extends(e,t),e.prototype.Wt=function(t,e){g("VerifyMutation should only be used in Transactions.")},e.prototype.Gt=function(t,e,n){g("VerifyMutation should only be used in Transactions.")},e.prototype.rn=function(t){g("VerifyMutation should only be used in Transactions.")},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.in.isEqual(t.in)},e}(Rt),Ut=function(){function t(t,e){this.wn=t,this.timestampsInSnapshots=e}return t.mn=function(e,n){switch(e.serverTimestamps){case"estimate":return new t(1,n);case"previous":return new t(2,n);case"none":case void 0:return new t(0,n);default:return g("fromSnapshotOptions() called with invalid options.")}},t}(),Mt=function(){function t(){}return t.prototype.toString=function(){var t=this.value();return null===t?"null":t.toString()},t.prototype.pn=function(t){return w(this.gn!==t.gn,"Default compareTo should not be used for values of same type."),_(this.gn,t.gn)},t}(),jt=function(t){function e(){var e=t.call(this)||this;return e.gn=0,e.Ht=null,e}return s.__extends(e,t),e.prototype.value=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e},e.prototype.h=function(t){return t instanceof e?0:this.pn(t)},e.prototype.bn=function(){return 4},e.yn=new e,e}(Mt),Ft=function(t){function e(e){var n=t.call(this)||this;return n.Ht=e,n.gn=1,n}return s.__extends(e,t),e.prototype.value=function(t){return this.Ht},e.prototype.isEqual=function(t){return t instanceof e&&this.Ht===t.Ht},e.prototype.h=function(t){return t instanceof e?_(this.Ht,t.Ht):this.pn(t)},e.prototype.bn=function(){return 4},e.of=function(t){return t?e._n:e.In},e._n=new e(!0),e.In=new e(!1),e}(Mt),qt=function(t){function e(e){var n=t.call(this)||this;return n.Ht=e,n.gn=2,n}return s.__extends(e,t),e.prototype.value=function(t){return this.Ht},e.prototype.h=function(t){return t instanceof e?(n=this.Ht,r=t.Ht,n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1):this.pn(t);var n,r},e.prototype.bn=function(){return 8},e}(Mt);function Gt(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}var Vt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.isEqual=function(t){return t instanceof e&&Gt(this.Ht,t.Ht)},e}(qt),Bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.isEqual=function(t){return t instanceof e&&Gt(this.Ht,t.Ht)},e.Tn=new e(NaN),e.POSITIVE_INFINITY=new e(1/0),e.NEGATIVE_INFINITY=new e(-1/0),e}(qt),zt=function(t){function e(e){var n=t.call(this)||this;return n.Ht=e,n.gn=4,n}return s.__extends(e,t),e.prototype.value=function(t){return this.Ht},e.prototype.isEqual=function(t){return t instanceof e&&this.Ht===t.Ht},e.prototype.h=function(t){return t instanceof e?_(this.Ht,t.Ht):this.pn(t)},e.prototype.bn=function(){return 2*this.Ht.length},e}(Mt),Ht=function(t){function e(e){var n=t.call(this)||this;return n.Ht=e,n.gn=3,n}return s.__extends(e,t),e.prototype.value=function(t){return!t||t.timestampsInSnapshots?this.Ht:this.Ht.toDate()},e.prototype.isEqual=function(t){return t instanceof e&&this.Ht.isEqual(t.Ht)},e.prototype.h=function(t){return t instanceof e?this.Ht.U(t.Ht):t instanceof Wt?-1:this.pn(t)},e.prototype.bn=function(){return 16},e}(Mt),Wt=function(t){function e(e,n){var r=t.call(this)||this;return r.En=e,r.previousValue=n,r.gn=3,r}return s.__extends(e,t),e.prototype.value=function(t){return t&&1===t.wn?new Ht(this.En).value(t):t&&2===t.wn&&this.previousValue?this.previousValue.value(t):null},e.prototype.isEqual=function(t){return t instanceof e&&this.En.isEqual(t.En)},e.prototype.h=function(t){return t instanceof e?this.En.U(t.En):t instanceof Ht?1:this.pn(t)},e.prototype.toString=function(){return"<ServerTimestamp localTime="+this.En.toString()+">"},e.prototype.bn=function(){return 16+(this.previousValue?this.previousValue.bn():0)},e}(Mt),Kt=function(t){function e(e){var n=t.call(this)||this;return n.Ht=e,n.gn=5,n}return s.__extends(e,t),e.prototype.value=function(t){return this.Ht},e.prototype.isEqual=function(t){return t instanceof e&&this.Ht.isEqual(t.Ht)},e.prototype.h=function(t){return t instanceof e?this.Ht.U(t.Ht):this.pn(t)},e.prototype.bn=function(){return this.Ht.Dn()},e}(Mt),Qt=function(t){function e(e,n){var r=t.call(this)||this;return r.s=e,r.key=n,r.gn=6,r}return s.__extends(e,t),e.prototype.value=function(t){return this.key},e.prototype.isEqual=function(t){return t instanceof e&&(this.key.isEqual(t.key)&&this.s.isEqual(t.s))},e.prototype.h=function(t){if(t instanceof e){var n=this.s.h(t.s);return 0!==n?n:dt.G(this.key,t.key)}return this.pn(t)},e.prototype.bn=function(){return this.s.projectId.length+this.s.database.length+this.key.toString().length},e}(Mt),Yt=function(t){function e(e){var n=t.call(this)||this;return n.Ht=e,n.gn=7,n}return s.__extends(e,t),e.prototype.value=function(t){return this.Ht},e.prototype.isEqual=function(t){return t instanceof e&&this.Ht.isEqual(t.Ht)},e.prototype.h=function(t){return t instanceof e?this.Ht.U(t.Ht):this.pn(t)},e.prototype.bn=function(){return 16},e}(Mt),Jt=function(t){function e(e){var n=t.call(this)||this;return n.Ht=e,n.gn=9,n}return s.__extends(e,t),e.vn=function(){return new Xt(e.EMPTY.Ht)},e.prototype.value=function(t){var e={};return this.Ht.pt((function(n,r){e[n]=r.value(t)})),e},e.prototype.forEach=function(t){this.Ht.pt(t)},e.prototype.isEqual=function(t){if(t instanceof e){for(var n=this.Ht.bt(),r=t.Ht.bt();n.St()&&r.St();){var i=n.Dt(),o=r.Dt();if(i.key!==o.key||!i.value.isEqual(o.value))return!1}return!n.St()&&!r.St()}return!1},e.prototype.h=function(t){if(t instanceof e){for(var n=this.Ht.bt(),r=t.Ht.bt();n.St()&&r.St();){var i=n.Dt(),o=r.Dt(),s=_(i.key,o.key)||i.value.h(o.value);if(s)return s}return _(n.St(),r.St())}return this.pn(t)},e.prototype.contains=function(t){return null!==this.field(t)},e.prototype.field=function(t){w(!t.J(),"Can't get field of empty path");var n=this;return t.forEach((function(t){n=n instanceof e?n.Ht.get(t):null})),n},e.prototype.un=function(){var t=new wt(pt.G);return this.Ht.forEach((function(n,r){var i=new pt([n]);if(r instanceof e){var o=r.un().fields;o.J()?t=t.add(i):o.forEach((function(e){t=t.add(i.child(e))}))}else t=t.add(i)})),Nt.Jt(t)},e.prototype.bn=function(){var t=0;return this.Ht.pt((function(e,n){t+=e.length+n.bn()})),t},e.prototype.toString=function(){return this.Ht.toString()},e.prototype.hn=function(){return new Xt(this.Ht)},e.EMPTY=new e(new vt(_)),e}(Mt),Xt=function(){function t(t){this.Ht=t}return t.prototype.set=function(t,e){w(!t.J(),"Cannot set field for empty path on ObjectValue");var n=t.Y();if(1===t.length)this.Ht=this.Ht.lt(n,e);else{var r=this.Ht.get(n),i=(r instanceof Jt?r:Jt.EMPTY).hn().set(t.K(),e).cn();this.Ht=this.Ht.lt(n,i)}return this},t.prototype.delete=function(t){w(!t.J(),"Cannot delete field for empty path on ObjectValue");var e=t.Y();if(1===t.length)this.Ht=this.Ht.remove(e);else{var n=this.Ht.get(e);if(n instanceof Jt){var r=n.hn().delete(t.K()).cn();this.Ht=this.Ht.lt(t.Y(),r)}}return this},t.prototype.cn=function(){return new Jt(this.Ht)},t}(),$t=function(t){function e(e){var n=t.call(this)||this;return n.Ht=e,n.gn=8,n}return s.__extends(e,t),e.prototype.value=function(t){return this.Ht.map((function(e){return e.value(t)}))},e.prototype.contains=function(t){for(var e=0,n=this.Ht;e<n.length;e++){if(n[e].isEqual(t))return!0}return!1},e.prototype.forEach=function(t){this.Ht.forEach(t)},e.prototype.isEqual=function(t){if(t instanceof e){if(this.Ht.length!==t.Ht.length)return!1;for(var n=0;n<this.Ht.length;n++)if(!this.Ht[n].isEqual(t.Ht[n]))return!1;return!0}return!1},e.prototype.h=function(t){if(t instanceof e){for(var n=Math.min(this.Ht.length,t.Ht.length),r=0;r<n;r++){var i=this.Ht[r].h(t.Ht[r]);if(i)return i}return _(this.Ht.length,t.Ht.length)}return this.pn(t)},e.prototype.bn=function(){return this.Ht.reduce((function(t,e){return t+e.bn()}),0)},e.prototype.toString=function(){return"["+this.Ht.map((function(t){return t.toString()})).join(",")+"]"},e}(Mt),Zt=function(){function t(t,e){this.key=t,this.version=e}return t.Sn=function(t,e){return dt.G(t.key,e.key)},t}(),te=function(t){function e(e,n,r,i,o,s){var a=t.call(this,e,n)||this;return a.Rn=i,a.proto=o,a.converter=s,w(void 0!==a.Rn||void 0!==a.proto&&void 0!==a.converter,"If objectValue is not defined, proto and converter need to be set."),a.en=!!r.en,a.hasCommittedMutations=!!r.hasCommittedMutations,a}return s.__extends(e,t),e.prototype.field=function(t){if(this.Rn)return this.Rn.field(t);this.Cn||(this.Cn=new Map);var e=t.nt(),n=this.Cn.get(e);if(void 0===n){var r=this.An(t);n=void 0===r?null:this.converter(r),this.Cn.set(e,n)}return n},e.prototype.data=function(){var t=this;if(!this.Rn){var e=Jt.vn();j(this.proto.fields||{},(function(n,r){e.set(new pt([n]),t.converter(r))})),this.Rn=e.cn(),this.Cn=void 0}return this.Rn},e.prototype.value=function(){return this.data().value()},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.en===t.en&&this.hasCommittedMutations===t.hasCommittedMutations&&this.data().isEqual(t.data())},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data().toString()+", {hasLocalMutations: "+this.en+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.en||this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.An=function(t){w(void 0!==this.proto,"Can only call getProtoField() when proto is defined");for(var e=this.proto.fields?this.proto.fields[t.Y()]:void 0,n=1;n<t.length;++n){if(!e||!e.mapValue||!e.mapValue.fields)return;e=e.mapValue.fields[t.get(n)]}return e},e.Pn=function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?r.h(i):g("Trying to compare documents on fields that don't exist")},e}(Zt),ee=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i.hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return s.__extends(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Zt),ne=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Zt);function re(t){return null==t}function ie(t){return-0===t&&1/t==-1/0}function oe(t){return"number"==typeof t&&Number.isInteger(t)&&!ie(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var se=function(){function t(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.kn=null}return t.prototype.canonicalId=function(){if(null===this.kn){var t=this.path.nt();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:";for(var e=0,n=this.filters;e<n.length;e++){t+=n[e].canonicalId(),t+=","}t+="|ob:";for(var r=0,i=this.orderBy;r<i.length;r++){t+=i[r].canonicalId(),t+=","}re(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.kn=t}return this.kn},t.prototype.toString=function(){var t=this.path.nt();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),this.filters.length>0&&(t+=", filters: ["+this.filters.join(", ")+"]"),re(this.limit)||(t+=", limit: "+this.limit),this.orderBy.length>0&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(e=0;e<this.filters.length;e++)if(!this.filters[e].isEqual(t.filters[e]))return!1;return this.collectionGroup===t.collectionGroup&&(!!this.path.isEqual(t.path)&&(!(null!==this.startAt?!this.startAt.isEqual(t.startAt):null!==t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)))},t.prototype.Nn=function(){return dt.ht(this.path)&&null===this.collectionGroup&&0===this.filters.length},t}(),ae=function(){function t(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.On=n,this.filters=r,this.limit=i,this.Fn=o,this.startAt=s,this.endAt=a,this.Vn=null,this.Un=null,this.startAt&&this.xn(this.startAt),this.endAt&&this.xn(this.endAt)}return t.jn=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){if(null===this.Vn){var t=this.Ln(),e=this.qn();if(null!==t&&null===e)t.ut()?this.Vn=[we]:this.Vn=[new ge(t),we];else{w(null===t||null!==e&&t.isEqual(e),"First orderBy should match inequality field."),this.Vn=[];for(var n=!1,r=0,i=this.On;r<i.length;r++){var o=i[r];this.Vn.push(o),o.field.ut()&&(n=!0)}if(!n){var s=this.On.length>0?this.On[this.On.length-1].dir:ye.ASCENDING;this.Vn.push(s===ye.ASCENDING?we:be)}}}return this.Vn},enumerable:!0,configurable:!0}),t.prototype.Bn=function(e){w(null==this.Ln()||!(e instanceof he)||!e.Mn()||e.field.isEqual(this.Ln()),"Query must only have one inequality field."),w(!this.Nn(),"No filtering allowed for document query");var n=this.filters.concat([e]);return new t(this.path,this.collectionGroup,this.On.slice(),n,this.limit,this.Fn,this.startAt,this.endAt)},t.prototype.Qn=function(e){w(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.On.concat([e]);return new t(this.path,this.collectionGroup,n,this.filters.slice(),this.limit,this.Fn,this.startAt,this.endAt)},t.prototype.Gn=function(e){return new t(this.path,this.collectionGroup,this.On.slice(),this.filters.slice(),e,"F",this.startAt,this.endAt)},t.prototype.Wn=function(e){return new t(this.path,this.collectionGroup,this.On.slice(),this.filters.slice(),e,"L",this.startAt,this.endAt)},t.prototype.zn=function(e){return new t(this.path,this.collectionGroup,this.On.slice(),this.filters.slice(),this.limit,this.Fn,e,this.endAt)},t.prototype.Kn=function(e){return new t(this.path,this.collectionGroup,this.On.slice(),this.filters.slice(),this.limit,this.Fn,this.startAt,e)},t.prototype.Hn=function(e){return new t(e,null,this.On.slice(),this.filters.slice(),this.limit,this.Fn,this.startAt,this.endAt)},t.prototype.Jn=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.On.length||1===this.On.length&&this.On[0].field.ut())},t.prototype.canonicalId=function(){return this.Yn().canonicalId()+"|lt:"+this.Fn},t.prototype.toString=function(){return"Query(target="+this.Yn().toString()+"; limitType="+this.Fn+")"},t.prototype.isEqual=function(t){return this.Yn().isEqual(t.Yn())&&this.Fn===t.Fn},t.prototype.Xn=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.ut()}return w(n,"orderBy used that doesn't compare on key field"),0},t.prototype.matches=function(t){return this.$n(t)&&this.Zn(t)&&this.ti(t)&&this.ni(t)},t.prototype.ii=function(){return!re(this.limit)&&"F"===this.Fn},t.prototype.ei=function(){return!re(this.limit)&&"L"===this.Fn},t.prototype.qn=function(){return this.On.length>0?this.On[0].field:null},t.prototype.Ln=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof he&&n.Mn())return n.field}return null},t.prototype.ri=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof he&&t.indexOf(r.op)>=0)return r.op}return null},t.prototype.Nn=function(){return this.Yn().Nn()},t.prototype.ui=function(){return null!==this.collectionGroup},t.prototype.Yn=function(){if(!this.Un)if("F"===this.Fn)this.Un=new se(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i=r.dir===ye.DESCENDING?ye.ASCENDING:ye.DESCENDING;t.push(new ge(r.field,i))}var o=this.endAt?new me(this.endAt.position,!this.endAt.before):null,s=this.startAt?new me(this.startAt.position,!this.startAt.before):null;this.Un=new se(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.Un},t.prototype.$n=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.ct(this.collectionGroup)&&this.path.$(e):dt.ht(this.path)?this.path.isEqual(e):this.path.Z(e)},t.prototype.Zn=function(t){for(var e=0,n=this.On;e<n.length;e++){var r=n[e];if(!r.field.ut()&&null===t.field(r.field))return!1}return!0},t.prototype.ti=function(t){for(var e=0,n=this.filters;e<n.length;e++){if(!n[e].matches(t))return!1}return!0},t.prototype.ni=function(t){return!(this.startAt&&!this.startAt.si(this.orderBy,t))&&(!this.endAt||!this.endAt.si(this.orderBy,t))},t.prototype.xn=function(t){w(t.position.length<=this.orderBy.length,"Bound is longer than orderBy")},t}(),ue=function(){},ce=function(){function t(t){this.name=t}return t.it=function(e){switch(e){case"<":return t.LESS_THAN;case"<=":return t.LESS_THAN_OR_EQUAL;case"==":return t.EQUAL;case">=":return t.GREATER_THAN_OR_EQUAL;case">":return t.GREATER_THAN;case"array-contains":return t.ARRAY_CONTAINS;case"in":return t.IN;case"array-contains-any":return t.ARRAY_CONTAINS_ANY;default:return g("Unknown FieldFilter operator: "+e)}},t.prototype.toString=function(){return this.name},t.prototype.isEqual=function(t){return this.name===t.name},t.LESS_THAN=new t("<"),t.LESS_THAN_OR_EQUAL=new t("<="),t.EQUAL=new t("=="),t.GREATER_THAN=new t(">"),t.GREATER_THAN_OR_EQUAL=new t(">="),t.ARRAY_CONTAINS=new t("array-contains"),t.IN=new t("in"),t.ARRAY_CONTAINS_ANY=new t("array-contains-any"),t}(),he=function(t){function e(e,n,r){var i=t.call(this)||this;return i.field=e,i.op=n,i.value=r,i}return s.__extends(e,t),e.create=function(t,n,r){if(t.ut())return n===ce.IN?(w(r instanceof $t,"Comparing on key with IN, but filter value not an ArrayValue"),w(r.Ht.every((function(t){return t instanceof Qt})),"Comparing on key with IN, but an array value was not a RefValue"),new le(t,r)):(w(r instanceof Qt,"Comparing on key, but filter value not a RefValue"),w(n!==ce.ARRAY_CONTAINS&&n!==ce.ARRAY_CONTAINS_ANY,"'"+n.toString()+"' queries don't make sense on document keys."),new fe(t,n,r));if(r.isEqual(jt.yn)){if(n!==ce.EQUAL)throw new O(A.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new e(t,n,r)}if(r.isEqual(Bt.Tn)){if(n!==ce.EQUAL)throw new O(A.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new e(t,n,r)}return n===ce.ARRAY_CONTAINS?new pe(t,r):n===ce.IN?(w(r instanceof $t,"IN filter has invalid value: "+r.toString()),new de(t,r)):n===ce.ARRAY_CONTAINS_ANY?(w(r instanceof $t,"ARRAY_CONTAINS_ANY filter has invalid value: "+r.toString()),new ve(t,r)):new e(t,n,r)},e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&this.value.gn===e.gn&&this.oi(e.h(this.value))},e.prototype.oi=function(t){switch(this.op){case ce.LESS_THAN:return t<0;case ce.LESS_THAN_OR_EQUAL:return t<=0;case ce.EQUAL:return 0===t;case ce.GREATER_THAN:return t>0;case ce.GREATER_THAN_OR_EQUAL:return t>=0;default:return g("Unknown FieldFilter operator: "+this.op)}},e.prototype.Mn=function(){return[ce.LESS_THAN,ce.LESS_THAN_OR_EQUAL,ce.GREATER_THAN,ce.GREATER_THAN_OR_EQUAL].indexOf(this.op)>=0},e.prototype.canonicalId=function(){return this.field.nt()+this.op.toString()+this.value.toString()},e.prototype.isEqual=function(t){return t instanceof e&&(this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&this.value.isEqual(t.value))},e.prototype.toString=function(){return this.field.nt()+" "+this.op+" "+this.value.value()},e}(ue),fe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.matches=function(t){var e=this.value,n=dt.G(t.key,e.key);return this.oi(n)},e}(he),le=function(t){function e(e,n){var r=t.call(this,e,ce.IN,n)||this;return r.value=n,r}return s.__extends(e,t),e.prototype.matches=function(t){return this.value.Ht.some((function(e){return t.key.isEqual(e.key)}))},e}(he),pe=function(t){function e(e,n){return t.call(this,e,ce.ARRAY_CONTAINS,n)||this}return s.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return e instanceof $t&&e.contains(this.value)},e}(he),de=function(t){function e(e,n){var r=t.call(this,e,ce.IN,n)||this;return r.value=n,r}return s.__extends(e,t),e.prototype.matches=function(t){var e=this.value,n=t.field(this.field);return null!==n&&e.contains(n)},e}(he),ve=function(t){function e(e,n){var r=t.call(this,e,ce.ARRAY_CONTAINS_ANY,n)||this;return r.value=n,r}return s.__extends(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return n instanceof $t&&n.Ht.some((function(t){return e.value.contains(t)}))},e}(he),ye=function(){function t(t){this.name=t}return t.prototype.toString=function(){return this.name},t.ASCENDING=new t("asc"),t.DESCENDING=new t("desc"),t}(),me=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){for(var t=this.before?"b:":"a:",e=0,n=this.position;e<n.length;e++){t+=n[e].toString()}return t},t.prototype.si=function(t,e){w(this.position.length<=t.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(i.field.ut())w(o instanceof Qt,"Bound has a non-key value where the key path is being used."),n=dt.G(o.key,e.key);else{var s=e.field(i.field);w(null!==s,"Field should exist since document matched the orderBy already."),n=o.h(s)}if(i.dir===ye.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++){var n=this.position[e],r=t.position[e];if(!n.isEqual(r))return!1}return!0},t}(),ge=function(){function t(t,e){this.field=t,void 0===e&&(e=ye.ASCENDING),this.dir=e,this.hi=t.ut()}return t.prototype.compare=function(t,e){var n=this.hi?te.Sn(t,e):te.Pn(this.field,t,e);switch(this.dir){case ye.ASCENDING:return n;case ye.DESCENDING:return-1*n;default:return g("Unknown direction: "+this.dir)}},t.prototype.canonicalId=function(){return this.field.nt()+this.dir.toString()},t.prototype.toString=function(){return this.field.nt()+" ("+this.dir+")"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),we=new ge(pt.st(),ye.ASCENDING),be=new ge(pt.st(),ye.DESCENDING),_e=function(){function t(t){this.ci=t}return t.fromBase64String=function(e){return new t(cn.t().atob(e))},t.fromUint8Array=function(e){return new t(Ee(e))},t.prototype.toBase64=function(){return cn.t().btoa(this.ci)},t.prototype.toUint8Array=function(){return Ie(this.ci)},t.prototype.bn=function(){return 2*this.ci.length},t.prototype.isEqual=function(t){return this.ci===t.ci},t.ai=new t(""),t}();function Ee(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}function Ie(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}var Te,Se,Ne=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=ct.MIN),void 0===o&&(o=ct.MIN),void 0===s&&(s=_e.ai),this.target=t,this.targetId=e,this.fi=n,this.sequenceNumber=r,this.li=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.di=function(e){return new t(this.target,this.targetId,this.fi,e,this.li,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.vi=function(e,n){return new t(this.target,this.targetId,this.fi,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.wi=function(e){return new t(this.target,this.targetId,this.fi,this.sequenceNumber,this.li,e,this.resumeToken)},t.prototype.isEqual=function(t){return this.targetId===t.targetId&&this.fi===t.fi&&this.sequenceNumber===t.sequenceNumber&&this.li.isEqual(t.li)&&this.lastLimboFreeSnapshotVersion.isEqual(t.lastLimboFreeSnapshotVersion)&&this.resumeToken.isEqual(t.resumeToken)&&this.target.isEqual(t.target)},t}(),Ae=function(){function t(t){this.count=t}return t.prototype.isEqual=function(t){return t&&t.count===this.count},t}();function Oe(t){switch(t){case A.OK:return g("Treated status OK as error");case A.CANCELLED:case A.UNKNOWN:case A.DEADLINE_EXCEEDED:case A.RESOURCE_EXHAUSTED:case A.INTERNAL:case A.UNAVAILABLE:case A.UNAUTHENTICATED:return!1;case A.INVALID_ARGUMENT:case A.NOT_FOUND:case A.ALREADY_EXISTS:case A.PERMISSION_DENIED:case A.FAILED_PRECONDITION:case A.ABORTED:case A.OUT_OF_RANGE:case A.UNIMPLEMENTED:case A.DATA_LOSS:return!0;default:return g("Unknown status code: "+t)}}function ke(t){if(void 0===t)return y("GRPC error has no .code"),A.UNKNOWN;switch(t){case Te.OK:return A.OK;case Te.CANCELLED:return A.CANCELLED;case Te.UNKNOWN:return A.UNKNOWN;case Te.DEADLINE_EXCEEDED:return A.DEADLINE_EXCEEDED;case Te.RESOURCE_EXHAUSTED:return A.RESOURCE_EXHAUSTED;case Te.INTERNAL:return A.INTERNAL;case Te.UNAVAILABLE:return A.UNAVAILABLE;case Te.UNAUTHENTICATED:return A.UNAUTHENTICATED;case Te.INVALID_ARGUMENT:return A.INVALID_ARGUMENT;case Te.NOT_FOUND:return A.NOT_FOUND;case Te.ALREADY_EXISTS:return A.ALREADY_EXISTS;case Te.PERMISSION_DENIED:return A.PERMISSION_DENIED;case Te.FAILED_PRECONDITION:return A.FAILED_PRECONDITION;case Te.ABORTED:return A.ABORTED;case Te.OUT_OF_RANGE:return A.OUT_OF_RANGE;case Te.UNIMPLEMENTED:return A.UNIMPLEMENTED;case Te.DATA_LOSS:return A.DATA_LOSS;default:return g("Unknown status code: "+t)}}function Re(t){if(void 0===t)return Te.OK;switch(t){case A.OK:return Te.OK;case A.CANCELLED:return Te.CANCELLED;case A.UNKNOWN:return Te.UNKNOWN;case A.DEADLINE_EXCEEDED:return Te.DEADLINE_EXCEEDED;case A.RESOURCE_EXHAUSTED:return Te.RESOURCE_EXHAUSTED;case A.INTERNAL:return Te.INTERNAL;case A.UNAVAILABLE:return Te.UNAVAILABLE;case A.UNAUTHENTICATED:return Te.UNAUTHENTICATED;case A.INVALID_ARGUMENT:return Te.INVALID_ARGUMENT;case A.NOT_FOUND:return Te.NOT_FOUND;case A.ALREADY_EXISTS:return Te.ALREADY_EXISTS;case A.PERMISSION_DENIED:return Te.PERMISSION_DENIED;case A.FAILED_PRECONDITION:return Te.FAILED_PRECONDITION;case A.ABORTED:return Te.ABORTED;case A.OUT_OF_RANGE:return Te.OUT_OF_RANGE;case A.UNIMPLEMENTED:return Te.UNIMPLEMENTED;case A.DATA_LOSS:return Te.DATA_LOSS;default:return g("Unknown status code: "+t)}}(Se=Te||(Te={}))[Se.OK=0]="OK",Se[Se.CANCELLED=1]="CANCELLED",Se[Se.UNKNOWN=2]="UNKNOWN",Se[Se.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Se[Se.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Se[Se.NOT_FOUND=5]="NOT_FOUND",Se[Se.ALREADY_EXISTS=6]="ALREADY_EXISTS",Se[Se.PERMISSION_DENIED=7]="PERMISSION_DENIED",Se[Se.UNAUTHENTICATED=16]="UNAUTHENTICATED",Se[Se.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Se[Se.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Se[Se.ABORTED=10]="ABORTED",Se[Se.OUT_OF_RANGE=11]="OUT_OF_RANGE",Se[Se.UNIMPLEMENTED=12]="UNIMPLEMENTED",Se[Se.INTERNAL=13]="INTERNAL",Se[Se.UNAVAILABLE=14]="UNAVAILABLE",Se[Se.DATA_LOSS=15]="DATA_LOSS";var Ce=new vt(dt.G);function De(){return Ce}function Pe(){return De()}var xe=new vt(dt.G);function Le(){return xe}var Ue=new vt(dt.G);function Me(){return Ue}var je=new wt(dt.G);function Fe(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=je,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var qe=new wt(_);function Ge(){return qe}var Ve=function(){function t(t){this.G=t?function(e,n){return t(e,n)||dt.G(e.key,n.key)}:function(t,e){return dt.G(t.key,e.key)},this.mi=Le(),this.pi=new vt(this.G)}return t.gi=function(e){return new t(e.G)},t.prototype.has=function(t){return null!=this.mi.get(t)},t.prototype.get=function(t){return this.mi.get(t)},t.prototype.first=function(){return this.pi.vt()},t.prototype.last=function(){return this.pi.wt()},t.prototype.J=function(){return this.pi.J()},t.prototype.indexOf=function(t){var e=this.mi.get(t);return e?this.pi.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.pi.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.pi.pt((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.mi.lt(t.key,t),e.pi.lt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.mi.remove(t),this.pi.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.pi.bt(),r=e.pi.bt();n.St();){var i=n.Dt().key,o=r.Dt().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.G=this.G,r.mi=e,r.pi=n,r},t}(),Be=function(){function t(){this.bi=new vt(dt.G)}return t.prototype.track=function(t){var e=t.doc.key,n=this.bi.get(e);n?0!==t.type&&3===n.type?this.bi=this.bi.lt(e,t):3===t.type&&1!==n.type?this.bi=this.bi.lt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.bi=this.bi.lt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.bi=this.bi.lt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.bi=this.bi.remove(e):1===t.type&&2===n.type?this.bi=this.bi.lt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.bi=this.bi.lt(e,{type:2,doc:t.doc}):g("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n)):this.bi=this.bi.lt(e,t)},t.prototype.yi=function(){var t=[];return this.bi.pt((function(e,n){t.push(n)})),t},t}(),ze=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this._i=n,this.docChanges=r,this.Ii=i,this.fromCache=o,this.Ti=s,this.Ei=a}return t.Di=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Ve.gi(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Ii.J()},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Ti===t.Ti&&this.Ii.isEqual(t.Ii)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this._i.isEqual(t._i)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),He=function(){function t(t,e,n,r,i){this.li=t,this.Si=e,this.Ri=n,this.Ci=r,this.Ai=i}return t.Pi=function(e,n){var r,i=((r={})[e]=We.ki(e,n),r);return new t(ct.MIN,i,Ge(),De(),Fe())},t}(),We=function(){function t(t,e,n,r,i){this.resumeToken=t,this.Ni=e,this.Oi=n,this.Fi=r,this.Vi=i}return t.ki=function(e,n){return new t(_e.ai,n,Fe(),Fe(),Fe())},t}(),Ke=function(t,e,n,r){this.Ui=t,this.removedTargetIds=e,this.key=n,this.xi=r},Qe=function(t,e){this.targetId=t,this.ji=e},Ye=function(t,e,n,r){void 0===n&&(n=_e.ai),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Je=function(){function t(){this.Li=0,this.qi=Ze(),this.Bi=_e.ai,this.Mi=!1,this.Qi=!0}return Object.defineProperty(t.prototype,"Ni",{get:function(){return this.Mi},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Bi},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Gi",{get:function(){return 0!==this.Li},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Wi",{get:function(){return this.Qi},enumerable:!0,configurable:!0}),t.prototype.zi=function(t){t.bn()>0&&(this.Qi=!0,this.Bi=t)},t.prototype.Ki=function(){var t=Fe(),e=Fe(),n=Fe();return this.qi.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:g("Encountered invalid change type: "+i)}})),new We(this.Bi,this.Mi,t,e,n)},t.prototype.Hi=function(){this.Qi=!1,this.qi=Ze()},t.prototype.Ji=function(t,e){this.Qi=!0,this.qi=this.qi.lt(t,e)},t.prototype.Yi=function(t){this.Qi=!0,this.qi=this.qi.remove(t)},t.prototype.Xi=function(){this.Li+=1},t.prototype.$i=function(){this.Li-=1},t.prototype.Zi=function(){this.Qi=!0,this.Mi=!0},t}(),Xe=function(){function t(t){this.te=t,this.ne={},this.ie=De(),this.ee=$e(),this.re=new wt(_)}return t.prototype.ue=function(t){for(var e=0,n=t.Ui;e<n.length;e++){var r=n[e];t.xi instanceof te?this.se(r,t.xi):t.xi instanceof ee&&this.oe(r,t.key,t.xi)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){r=o[i];this.oe(r,t.key,t.xi)}},t.prototype.he=function(t){var e=this;this.ce(t,(function(n){var r=e.ae(n);switch(t.state){case 0:e.fe(n)&&r.zi(t.resumeToken);break;case 1:r.$i(),r.Gi||r.Hi(),r.zi(t.resumeToken);break;case 2:r.$i(),r.Gi||e.removeTarget(n),w(!t.cause,"WatchChangeAggregator does not handle errored targets");break;case 3:e.fe(n)&&(r.Zi(),r.zi(t.resumeToken));break;case 4:e.fe(n)&&(e.le(n),r.zi(t.resumeToken));break;default:g("Unknown target watch change state: "+t.state)}}))},t.prototype.ce=function(t,e){t.targetIds.length>0?t.targetIds.forEach(e):M(this.ne,e)},t.prototype.de=function(t){var e=t.targetId,n=t.ji.count,r=this.ve(e);if(r){var i=r.target;if(i.Nn())if(0===n){var o=new dt(i.path);this.oe(e,o,new ee(o,ct.q()))}else w(1===n,"Single document existence filter with count: "+n);else this.we(e)!==n&&(this.le(e),this.re=this.re.add(e))}},t.prototype.me=function(t){var e=this,n={};M(this.ne,(function(r,i){var o=e.ve(r);if(o){if(i.Ni&&o.target.Nn()){var s=new dt(o.target.path);null!==e.ie.get(s)||e.pe(r,s)||e.oe(r,s,new ee(s,t))}i.Wi&&(n[r]=i.Ki(),i.Hi())}}));var r=Fe();this.ee.forEach((function(t,n){var i=!0;n.qt((function(t){var n=e.ve(t);return!n||2===n.fi||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new He(t,n,this.re,this.ie,r);return this.ie=De(),this.ee=$e(),this.re=new wt(_),i},t.prototype.se=function(t,e){if(this.fe(t)){var n=this.pe(t,e.key)?2:0;this.ae(t).Ji(e.key,n),this.ie=this.ie.lt(e.key,e),this.ee=this.ee.lt(e.key,this.ge(e.key).add(t))}},t.prototype.oe=function(t,e,n){if(this.fe(t)){var r=this.ae(t);this.pe(t,e)?r.Ji(e,1):r.Yi(e),this.ee=this.ee.lt(e,this.ge(e).delete(t)),n&&(this.ie=this.ie.lt(e,n))}},t.prototype.removeTarget=function(t){delete this.ne[t]},t.prototype.we=function(t){var e=this.ae(t).Ki();return this.te.be(t).size+e.Oi.size-e.Vi.size},t.prototype.Xi=function(t){this.ae(t).Xi()},t.prototype.ae=function(t){return this.ne[t]||(this.ne[t]=new Je),this.ne[t]},t.prototype.ge=function(t){var e=this.ee.get(t);return e||(e=new wt(_),this.ee=this.ee.lt(t,e)),e},t.prototype.fe=function(t){var e=null!==this.ve(t);return e||v("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ve=function(t){var e=this.ne[t];return e&&e.Gi?null:this.te.ye(t)},t.prototype.le=function(t){var e=this;w(!this.ne[t].Gi,"Should only reset active targets"),this.ne[t]=new Je,this.te.be(t).forEach((function(n){e.oe(t,n,null)}))},t.prototype.pe=function(t,e){return this.te.be(t).has(e)},t}();function $e(){return new vt(dt.G)}function Ze(){return new vt(dt.G)}var tn,en,nn=((tn={})[ye.ASCENDING.name]="ASCENDING",tn[ye.DESCENDING.name]="DESCENDING",tn),rn=((en={})[ce.LESS_THAN.name]="LESS_THAN",en[ce.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",en[ce.GREATER_THAN.name]="GREATER_THAN",en[ce.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",en[ce.EQUAL.name]="EQUAL",en[ce.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",en[ce.IN.name]="IN",en[ce.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",en),on=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function sn(t,e){w(!re(t),e+" is missing")}function an(t){return"number"==typeof t?t:"string"==typeof t?Number(t):g("can't parse "+t)}var un=function(){function t(t,e){this.s=t,this.options=e}return t.prototype._e=function(t){var e=void 0===t.code?A.UNKNOWN:ke(t.code);return new O(e,t.message||"")},t.prototype.Ie=function(t){return this.options.Te||re(t)?t:{value:t}},t.prototype.Ee=function(t){var e;return re(e="object"==typeof t?t.value:t)?null:e},t.prototype.M=function(t){return this.options.Te?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},t.prototype.L=function(t){if("string"==typeof t)return this.De(t);w(!!t,"Cannot deserialize null or undefined timestamp.");var e=an(t.seconds||"0"),n=t.nanos||0;return new ut(e,n)},t.prototype.De=function(t){var e=0,n=on.exec(t);if(w(!!n,"invalid timestamp: "+t),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t),o=Math.floor(i.getTime()/1e3);return new ut(o,e)},t.prototype.Se=function(t){return this.options.Te?t.toBase64():t.toUint8Array()},t.prototype.Re=function(t){return this.options.Te?(w(void 0===t||"string"==typeof t,"value must be undefined or a string when using proto3 Json"),_e.fromBase64String(t||"")):(w(void 0===t||t instanceof Uint8Array,"value must be undefined or Uint8Array"),_e.fromUint8Array(t||new Uint8Array))},t.prototype.Ce=function(t){return"string"==typeof t?(w(this.options.Te,"Expected bytes to be passed in as Uint8Array, but got a string instead."),pn.fromBase64String(t)):(w(!this.options.Te,"Expected bytes to be passed in as Uint8Array, but got a string instead."),pn.fromUint8Array(t))},t.prototype.toVersion=function(t){return this.M(t.M())},t.prototype.fromVersion=function(t){return w(!!t,"Trying to deserialize version that isn't set"),ct.L(this.L(t))},t.prototype.Ae=function(t,e){return this.Pe(t).child("documents").child(e).nt()},t.prototype.ke=function(t){var e=ft.it(t);return w(this.Ne(e),"Tried to deserialize invalid key "+e.toString()),e},t.prototype.Oe=function(t){return this.Ae(this.s,t.path)},t.prototype.Fe=function(t){var e=this.ke(t);return w(e.get(1)===this.s.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.s.projectId),w(!e.get(3)&&!this.s.database||e.get(3)===this.s.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.s.database),new dt(this.Ve(e))},t.prototype.Ue=function(t){return this.Ae(this.s,t)},t.prototype.xe=function(t){var e=this.ke(t);return 4===e.length?ft.et:this.Ve(e)},Object.defineProperty(t.prototype,"je",{get:function(){return new ft(["projects",this.s.projectId,"databases",this.s.database]).nt()},enumerable:!0,configurable:!0}),t.prototype.Pe=function(t){return new ft(["projects",t.projectId,"databases",t.database])},t.prototype.Ve=function(t){return w(t.length>4&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.K(5)},t.prototype.Ne=function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)},t.prototype.Le=function(t){if(t instanceof jt)return{nullValue:"NULL_VALUE"};if(t instanceof Ft)return{booleanValue:t.value()};if(t instanceof Vt)return{integerValue:""+t.value()};if(t instanceof Bt){var e=t.value();if(this.options.Te){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"};if(ie(e))return{doubleValue:"-0"}}return{doubleValue:t.value()}}return t instanceof zt?{stringValue:t.value()}:t instanceof Jt?{mapValue:this.qe(t)}:t instanceof $t?{arrayValue:this.Be(t)}:t instanceof Ht?{timestampValue:this.M(t.Ht)}:t instanceof Yt?{geoPointValue:{latitude:t.value().latitude,longitude:t.value().longitude}}:t instanceof Kt?{bytesValue:this.Se(t.value())}:t instanceof Qt?{referenceValue:this.Ae(t.s,t.key.path)}:g("Unknown FieldValue "+JSON.stringify(t))},t.prototype.Me=function(t){var e=this;if("nullValue"in t)return jt.yn;if("booleanValue"in t)return Ft.of(t.booleanValue);if("integerValue"in t)return new Vt(an(t.integerValue));if("doubleValue"in t){if(this.options.Te){if("NaN"===t.doubleValue)return Bt.Tn;if("Infinity"===t.doubleValue)return Bt.POSITIVE_INFINITY;if("-Infinity"===t.doubleValue)return Bt.NEGATIVE_INFINITY;if("-0"===t.doubleValue)return new Bt(-0)}return new Bt(t.doubleValue)}if("stringValue"in t)return new zt(t.stringValue);if("mapValue"in t)return this.Qe(t.mapValue.fields||{});if("arrayValue"in t){sn(t.arrayValue,"arrayValue");var n=t.arrayValue.values||[];return new $t(n.map((function(t){return e.Me(t)})))}if("timestampValue"in t)return sn(t.timestampValue,"timestampValue"),new Ht(this.L(t.timestampValue));if("geoPointValue"in t){sn(t.geoPointValue,"geoPointValue");var r=t.geoPointValue.latitude||0,i=t.geoPointValue.longitude||0;return new Yt(new at(r,i))}if("bytesValue"in t){sn(t.bytesValue,"bytesValue");var o=this.Ce(t.bytesValue);return new Kt(o)}if("referenceValue"in t){sn(t.referenceValue,"referenceValue");var s=this.ke(t.referenceValue),a=new S(s.get(1),s.get(3)),u=new dt(this.Ve(s));return new Qt(a,u)}return g("Unknown Value proto "+JSON.stringify(t))},t.prototype.Ge=function(t,e){return{name:this.Oe(t),fields:this.We(e)}},t.prototype.ze=function(t){return w(!t.en,"Can't serialize documents with mutations."),{name:this.Oe(t.key),fields:this.We(t.data()),updateTime:this.M(t.version.M())}},t.prototype.Ke=function(t,e){var n=this,r=this.Fe(t.name),i=this.fromVersion(t.updateTime);return new te(r,i,{hasCommittedMutations:!!e},void 0,t,(function(t){return n.Me(t)}))},t.prototype.We=function(t){var e=this,n={};return t.forEach((function(t,r){n[t]=e.Le(r)})),n},t.prototype.Qe=function(t){var e=this,n=t,r=Jt.vn();return j(n,(function(t,n){r.set(new pt([t]),e.Me(n))})),r.cn()},t.prototype.qe=function(t){return{fields:this.We(t)}},t.prototype.Be=function(t){var e=this,n=[];return t.forEach((function(t){n.push(e.Le(t))})),{values:n}},t.prototype.He=function(t){var e=this;w(!!t.found,"Tried to deserialize a found document from a missing document."),sn(t.found.name,"doc.found.name"),sn(t.found.updateTime,"doc.found.updateTime");var n=this.Fe(t.found.name),r=this.fromVersion(t.found.updateTime);return new te(n,r,{},void 0,t.found,(function(t){return e.Me(t)}))},t.prototype.Je=function(t){w(!!t.missing,"Tried to deserialize a missing document from a found document."),w(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.Fe(t.missing),n=this.fromVersion(t.readTime);return new ee(e,n)},t.prototype.Ye=function(t){return"found"in t?this.He(t):"missing"in t?this.Je(t):g("invalid batch get response: "+JSON.stringify(t))},t.prototype.Xe=function(t){switch(t){case 1:return"ADD";case 3:return"CURRENT";case 0:return"NO_CHANGE";case 2:return"REMOVE";case 4:return"RESET";default:return g("Unknown WatchTargetChangeState: "+t)}},t.prototype.$e=function(t){if(t instanceof Qe)return{filter:{count:t.ji.count,targetId:t.targetId}};if(t instanceof Ke){if(t.xi instanceof te){var e=t.xi;return{documentChange:{document:{name:this.Oe(e.key),fields:this.We(e.data()),updateTime:this.toVersion(e.version)},targetIds:t.Ui,removedTargetIds:t.removedTargetIds}}}if(t.xi instanceof ee){e=t.xi;return{documentDelete:{document:this.Oe(e.key),readTime:this.toVersion(e.version),removedTargetIds:t.removedTargetIds}}}if(null===t.xi)return{documentRemove:{document:this.Oe(t.key),removedTargetIds:t.removedTargetIds}}}if(t instanceof Ye){var n=void 0;return t.cause&&(n={code:Re(t.cause.code),message:t.cause.message}),{targetChange:{targetChangeType:this.Xe(t.state),targetIds:t.targetIds,resumeToken:this.Se(t.resumeToken),cause:n}}}return g("Unrecognized watch change: "+JSON.stringify(t))},t.prototype.Ze=function(t){var e,n=this;if("targetChange"in t){sn(t.targetChange,"targetChange");var r=this.tr(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=this.Re(t.targetChange.resumeToken),s=t.targetChange.cause,a=s&&this._e(s);e=new Ye(r,i,o,a||null)}else if("documentChange"in t){sn(t.documentChange,"documentChange");var u=t.documentChange;sn(u.document,"documentChange.name"),sn(u.document.name,"documentChange.document.name"),sn(u.document.updateTime,"documentChange.document.updateTime");var c=this.Fe(u.document.name),h=this.fromVersion(u.document.updateTime),f=new te(c,h,{},void 0,u.document,(function(t){return n.Me(t)})),l=u.targetIds||[],p=u.removedTargetIds||[];e=new Ke(l,p,f.key,f)}else if("documentDelete"in t){sn(t.documentDelete,"documentDelete");var d=t.documentDelete;sn(d.document,"documentDelete.document");c=this.Fe(d.document),h=d.readTime?this.fromVersion(d.readTime):ct.q(),f=new ee(c,h),p=d.removedTargetIds||[];e=new Ke([],p,f.key,f)}else if("documentRemove"in t){sn(t.documentRemove,"documentRemove");var v=t.documentRemove;sn(v.document,"documentRemove");c=this.Fe(v.document),p=v.removedTargetIds||[];e=new Ke([],p,c,null)}else{if(!("filter"in t))return g("Unknown change type "+JSON.stringify(t));sn(t.filter,"filter");var y=t.filter;sn(y.targetId,"filter.targetId");var m=y.count||0,w=new Ae(m),b=y.targetId;e=new Qe(b,w)}return e},t.prototype.tr=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:g("Got unexpected TargetChange.state: "+t)},t.prototype.nr=function(t){if(!("targetChange"in t))return ct.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?ct.MIN:e.readTime?this.fromVersion(e.readTime):ct.MIN},t.prototype.ir=function(t){var e,n=this;if(t instanceof Ct)e={update:this.Ge(t.key,t.value)};else if(t instanceof xt)e={delete:this.Oe(t.key)};else if(t instanceof Dt)e={update:this.Ge(t.key,t.data),updateMask:this.er(t.un)};else if(t instanceof Pt)e={transform:{document:this.Oe(t.key),fieldTransforms:t.fieldTransforms.map((function(t){return n.rr(t)}))}};else{if(!(t instanceof Lt))return g("Unknown mutation type "+t.type);e={verify:this.Oe(t.key)}}return t.in.$t||(e.currentDocument=this.ur(t.in)),e},t.prototype.sr=function(t){var e=this,n=t.currentDocument?this.or(t.currentDocument):kt.NONE;if(t.update){sn(t.update.name,"name");var r=this.Fe(t.update.name),i=this.Qe(t.update.fields||{});if(t.updateMask){var o=this.hr(t.updateMask);return new Dt(r,i,o,n)}return new Ct(r,i,n)}if(t.delete){r=this.Fe(t.delete);return new xt(r,n)}if(t.transform){r=this.Fe(t.transform.document);var s=t.transform.fieldTransforms.map((function(t){return e.cr(t)}));return w(!0===n.exists,'Transforms only support precondition "exists == true"'),new Pt(r,s)}if(t.verify){r=this.Fe(t.verify);return new Lt(r,n)}return g("unknown mutation proto: "+JSON.stringify(t))},t.prototype.ur=function(t){return w(!t.$t,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:g("Unknown precondition")},t.prototype.or=function(t){return void 0!==t.updateTime?kt.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?kt.exists(t.exists):kt.NONE},t.prototype.ar=function(t,e){var n=this,r=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);r.isEqual(ct.MIN)&&(r=this.fromVersion(e));var i=null;return t.transformResults&&t.transformResults.length>0&&(i=t.transformResults.map((function(t){return n.Me(t)}))),new Ot(r,i)},t.prototype.lr=function(t,e){var n=this;return t&&t.length>0?(w(void 0!==e,"Received a write result without a commit time"),t.map((function(t){return n.ar(t,e)}))):[]},t.prototype.rr=function(t){var e=this,n=t.transform;if(n instanceof _t)return{fieldPath:t.field.nt(),setToServerValue:"REQUEST_TIME"};if(n instanceof Et)return{fieldPath:t.field.nt(),appendMissingElements:{values:n.elements.map((function(t){return e.Le(t)}))}};if(n instanceof It)return{fieldPath:t.field.nt(),removeAllFromArray:{values:n.elements.map((function(t){return e.Le(t)}))}};if(n instanceof Tt)return{fieldPath:t.field.nt(),increment:this.Le(n.Kt)};throw g("Unknown transform: "+t.transform)},t.prototype.cr=function(t){var e=this,n=null;if("setToServerValue"in t)w("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),n=_t.instance;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new Et(r.map((function(t){return e.Me(t)})))}else if("removeAllFromArray"in t){r=t.removeAllFromArray.values||[];n=new It(r.map((function(t){return e.Me(t)})))}else if("increment"in t){var i=this.Me(t.increment);w(i instanceof qt,"NUMERIC_ADD transform requires a NumberValue"),n=new Tt(i)}else g("Unknown transform proto: "+JSON.stringify(t));var o=pt.ot(t.fieldPath);return new At(o,n)},t.prototype.dr=function(t){return{documents:[this.Ue(t.path)]}},t.prototype.vr=function(t){var e=t.documents.length;w(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return ae.jn(this.xe(n)).Yn()},t.prototype.wr=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(w(n.length%2==0,"Collection Group queries should be within a document path or root."),e.parent=this.Ue(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(w(n.length%2!=0,"Document queries with filters are not supported."),e.parent=this.Ue(n.H()),e.structuredQuery.from=[{collectionId:n.X()}]);var r=this.mr(t.filters);r&&(e.structuredQuery.where=r);var i=this.pr(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.Ie(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.gr(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.gr(t.endAt)),e},t.prototype.br=function(t){var e=this.xe(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){w(1===r,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.yr(n.where));var a=[];n.orderBy&&(a=this._r(n.orderBy));var u=null;n.limit&&(u=this.Ee(n.limit));var c=null;n.startAt&&(c=this.Ir(n.startAt));var h=null;return n.endAt&&(h=this.Ir(n.endAt)),new ae(e,i,a,s,u,"F",c,h).Yn()},t.prototype.Tr=function(t){var e=this.Er(t.fi);return null==e?null:{"goog-listen-tags":e}},t.prototype.Er=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return g("Unrecognized query purpose: "+t)}},t.prototype.Yn=function(t){var e,n=t.target;return(e=n.Nn()?{documents:this.dr(n)}:{query:this.wr(n)}).targetId=t.targetId,t.resumeToken.bn()>0&&(e.resumeToken=this.Se(t.resumeToken)),e},t.prototype.mr=function(t){var e=this;if(0!==t.length){var n=t.map((function(t){return t instanceof he?e.Dr(t):g("Unrecognized filter: "+JSON.stringify(t))}));return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},t.prototype.yr=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.Sr(t)]:void 0!==t.fieldFilter?[this.Rr(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return e.yr(t)})).reduce((function(t,e){return t.concat(e)})):g("Unknown filter: "+JSON.stringify(t)):[]},t.prototype.pr=function(t){var e=this;if(0!==t.length)return t.map((function(t){return e.Cr(t)}))},t.prototype._r=function(t){var e=this;return t.map((function(t){return e.Ar(t)}))},t.prototype.gr=function(t){var e=this;return{before:t.before,values:t.position.map((function(t){return e.Le(t)}))}},t.prototype.Ir=function(t){var e=this,n=!!t.before,r=t.values.map((function(t){return e.Me(t)}));return new me(r,n)},t.prototype.Pr=function(t){return nn[t.name]},t.prototype.kr=function(t){switch(t){case"ASCENDING":return ye.ASCENDING;case"DESCENDING":return ye.DESCENDING;default:return}},t.prototype.Nr=function(t){return rn[t.name]},t.prototype.Or=function(t){switch(t){case"EQUAL":return ce.EQUAL;case"GREATER_THAN":return ce.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return ce.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return ce.LESS_THAN;case"LESS_THAN_OR_EQUAL":return ce.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return ce.ARRAY_CONTAINS;case"IN":return ce.IN;case"ARRAY_CONTAINS_ANY":return ce.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return g("Unspecified operator");default:return g("Unknown operator")}},t.prototype.Fr=function(t){return{fieldPath:t.nt()}},t.prototype.Vr=function(t){return pt.ot(t.fieldPath)},t.prototype.Cr=function(t){return{field:this.Fr(t.field),direction:this.Pr(t.dir)}},t.prototype.Ar=function(t){return new ge(this.Vr(t.field),this.kr(t.direction))},t.prototype.Rr=function(t){return he.create(this.Vr(t.fieldFilter.field),this.Or(t.fieldFilter.op),this.Me(t.fieldFilter.value))},t.prototype.Dr=function(t){if(t.op===ce.EQUAL){if(t.value.isEqual(Bt.Tn))return{unaryFilter:{field:this.Fr(t.field),op:"IS_NAN"}};if(t.value.isEqual(jt.yn))return{unaryFilter:{field:this.Fr(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.Fr(t.field),op:this.Nr(t.op),value:this.Le(t.value)}}},t.prototype.Sr=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.Vr(t.unaryFilter.field);return he.create(e,ce.EQUAL,Bt.Tn);case"IS_NULL":var n=this.Vr(t.unaryFilter.field);return he.create(n,ce.EQUAL,jt.yn);case"OPERATOR_UNSPECIFIED":return g("Unspecified filter");default:return g("Unknown filter")}},t.prototype.er=function(t){var e=[];return t.fields.forEach((function(t){return e.push(t.nt())})),{fieldPaths:e}},t.prototype.hr=function(t){var e=(t.fieldPaths||[]).map((function(t){return pt.ot(t)}));return Nt.Yt(e)},t}(),cn=function(){function t(){}return t.Ur=function(e){t.platform&&g("Platform already defined"),t.platform=e},t.t=function(){return t.platform||g("Platform not set"),t.platform},t}();function hn(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new O(A.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}function fn(){if("undefined"==typeof Uint8Array)throw new O(A.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function ln(){if(!cn.t().xr)throw new O(A.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var pn=function(){function t(t){ln(),this.ci=t}return t.fromBase64String=function(e){G("Blob.fromBase64String",arguments,1),H("Blob.fromBase64String","string",1,e),ln();try{var n=cn.t().atob(e);return new t(n)}catch(t){throw new O(A.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},t.fromUint8Array=function(e){if(G("Blob.fromUint8Array",arguments,1),fn(),!(e instanceof Uint8Array))throw rt("Blob.fromUint8Array","Uint8Array",1,e);var n=Ee(e);return new t(n)},t.prototype.toBase64=function(){return G("Blob.toBase64",arguments,0),ln(),cn.t().btoa(this.ci)},t.prototype.toUint8Array=function(){G("Blob.toUint8Array",arguments,0),fn();var t=Ie(this.ci);return t},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.ci===t.ci},t.prototype.Dn=function(){return 2*this.ci.length},t.prototype.U=function(t){return _(this.ci,t.ci)},t}(),dn=hn(pn,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),vn=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.jr=function(t){return n.Lr(t)},this.qr=function(t){return e.Br(t)})}return t.prototype.Lr=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.qr&&this.qr(t),t},t.Mr=-1,t}(),yn=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},mn=function(){function t(t,e,n,r,i){this.Qr=t,this.Gr=e,this.Wr=n,this.op=r,this.zr=i,this.Kr=new yn,this.then=this.Kr.promise.then.bind(this.Kr.promise),this.catch=this.Kr.promise.catch.bind(this.Kr.promise),this.Kr.promise.catch((function(t){}))}return t.Hr=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.Jr=setTimeout((function(){return e.Yr()}),t)},t.prototype.Xr=function(){return this.Yr()},t.prototype.cancel=function(t){null!==this.Jr&&(this.clearTimeout(),this.Kr.reject(new O(A.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Yr=function(){var t=this;this.Qr.$r((function(){return null!==t.Jr?(t.clearTimeout(),t.op().then((function(e){return t.Kr.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.Jr&&(this.zr(this),clearTimeout(this.Jr),this.Jr=null)},t}(),gn=function(){function t(){this.Zr=Promise.resolve(),this.tu=!1,this.nu=[],this.iu=null,this.eu=!1,this.ru=[]}return Object.defineProperty(t.prototype,"uu",{get:function(){return this.tu},enumerable:!0,configurable:!0}),t.prototype.$r=function(t){this.enqueue(t)},t.prototype.su=function(t){this.ou(),this.hu(t)},t.prototype.cu=function(t){return this.ou(),this.hu(t)},t.prototype.au=function(t){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(e){switch(e.label){case 0:return this.ou(),this.tu?[3,2]:(this.tu=!0,[4,this.cu(t)]);case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.enqueue=function(t){return this.ou(),this.tu?new Promise((function(t){})):this.hu(t)},t.prototype.hu=function(t){var e=this,n=this.Zr.then((function(){return e.eu=!0,t().catch((function(t){e.iu=t,e.eu=!1;var n=t.stack||t.message||"";throw y("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout((function(){throw t}),0),t})).then((function(t){return e.eu=!1,t}))}));return this.Zr=n,n},t.prototype.fu=function(t,e,n){var r=this;this.ou(),w(e>=0,"Attempted to schedule an operation with a negative delay of "+e),this.ru.indexOf(t)>-1&&(e=0);var i=mn.Hr(this,t,e,n,(function(t){return r.lu(t)}));return this.nu.push(i),i},t.prototype.ou=function(){this.iu&&g("AsyncQueue is already failed: "+(this.iu.stack||this.iu.message))},t.prototype.du=function(){w(this.eu,"verifyOpInProgress() called when no op in progress on this queue.")},t.prototype.vu=function(){return s.__awaiter(this,void 0,void 0,(function(){var t;return s.__generator(this,(function(e){switch(e.label){case 0:return[4,t=this.Zr];case 1:e.sent(),e.label=2;case 2:if(t!==this.Zr)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.wu=function(t){for(var e=0,n=this.nu;e<n.length;e++){if(n[e].Gr===t)return!0}return!1},t.prototype.mu=function(t){var e=this;return this.vu().then((function(){w("all"===t||e.wu(t),"Attempted to drain to missing operation "+t),e.nu.sort((function(t,e){return t.Wr-e.Wr}));for(var n=0,r=e.nu;n<r.length;n++){var i=r[n];if(i.Xr(),"all"!==t&&i.Gr===t)break}return e.vu()}))},t.prototype.pu=function(t){this.ru.push(t)},t.prototype.lu=function(t){var e=this.nu.indexOf(t);w(e>=0,"Delayed operation not found."),this.nu.splice(e,1)},t}();function wn(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=_n(e)),e=bn(t.get(n),e);return _n(e)}function bn(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function _n(t){return t+""}function En(t){var e=t.length;if(w(e>=2,"Invalid path "+t),2===e)return w(""===t.charAt(0)&&""===t.charAt(1),"Non-empty path "+t+" had length 2"),ft.et;for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&g('Invalid encoded resource path: "'+t+'"'),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:g('Invalid encoded resource path: "'+t+'"')}o=s+2}return new ft(r)}var In=function(){function t(t,e,n,r){this.batchId=t,this.En=e,this.baseMutations=n,this.mutations=r,w(r.length>0,"Cannot create an empty mutation batch")}return t.prototype.Wt=function(t,e,n){e&&w(e.key.isEqual(t),"applyToRemoteDocument: key "+t+" should match maybeDoc key\n        "+e.key);var r=n.gu;w(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var s=r[i];e=o.Wt(e,s)}}return e},t.prototype.Gt=function(t,e){e&&w(e.key.isEqual(t),"applyToLocalDocument: key "+t+" should match maybeDoc key\n        "+e.key);for(var n=0,r=this.baseMutations;n<r.length;n++){(a=r[n]).key.isEqual(t)&&(e=a.Gt(e,e,this.En))}for(var i=e,o=0,s=this.mutations;o<s.length;o++){var a;(a=s[o]).key.isEqual(t)&&(e=a.Gt(e,i,this.En))}return e},t.prototype.bu=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.Gt(r.key,t.get(r.key));i&&(n=n.lt(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Fe())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&E(this.mutations,t.mutations)&&E(this.baseMutations,t.baseMutations)},t}(),Tn=function(){function t(t,e,n,r,i){this.batch=t,this.yu=e,this.gu=n,this.streamToken=r,this._u=i}return t.from=function(e,n,r,i){w(e.mutations.length===r.length,"Mutations sent "+e.mutations.length+" must equal results received "+r.length);for(var o=Me(),s=e.mutations,a=0;a<s.length;a++)o=o.lt(s[a].key,r[a].version);return new t(e,n,r,i,o)},t}(),Sn=function(){function t(){this.Iu=new wt(Nn.Sn),this.Tu=new wt(Nn.Eu)}return t.prototype.J=function(){return this.Iu.J()},t.prototype.Du=function(t,e){var n=new Nn(t,e);this.Iu=this.Iu.add(n),this.Tu=this.Tu.add(n)},t.prototype.Su=function(t,e){var n=this;t.forEach((function(t){return n.Du(t,e)}))},t.prototype.Ru=function(t,e){this.Cu(new Nn(t,e))},t.prototype.Au=function(t,e){var n=this;t.forEach((function(t){return n.Ru(t,e)}))},t.prototype.Pu=function(t){var e=this,n=dt.EMPTY,r=new Nn(n,t),i=new Nn(n,t+1),o=[];return this.Tu.Lt([r,i],(function(t){e.Cu(t),o.push(t.key)})),o},t.prototype.ku=function(){var t=this;this.Iu.forEach((function(e){return t.Cu(e)}))},t.prototype.Cu=function(t){this.Iu=this.Iu.delete(t),this.Tu=this.Tu.delete(t)},t.prototype.Nu=function(t){var e=dt.EMPTY,n=new Nn(e,t),r=new Nn(e,t+1),i=Fe();return this.Tu.Lt([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.Ou=function(t){var e=new Nn(t,0),n=this.Iu.Bt(e);return null!==n&&t.isEqual(n.key)},t}(),Nn=function(){function t(t,e){this.key=t,this.Fu=e}return t.Sn=function(t,e){return dt.G(t.key,e.key)||_(t.Fu,e.Fu)},t.Eu=function(t,e){return _(t.Fu,e.Fu)||dt.G(t.key,e.key)},t}(),An=function(){function t(t){this.Vu=t,this.Uu={}}return t.prototype.get=function(t){var e=this.Vu(t),n=this.Uu[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(s.isEqual(t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.Vu(t),r=this.Uu[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.Uu[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.Vu(t),n=this.Uu[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.Uu[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){j(this.Uu,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.J=function(){return F(this.Uu)},t}(),On=function(){function t(t){var e=this;this.xu=null,this.ju=null,this.result=void 0,this.error=void 0,this.Lu=!1,this.qu=!1,t((function(t){e.Lu=!0,e.result=t,e.xu&&e.xu(t)}),(function(t){e.Lu=!0,e.error=t,e.ju&&e.ju(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.qu&&g("Called next() or catch() twice for PersistencePromise"),this.qu=!0,this.Lu?this.error?this.Bu(n,this.error):this.Mu(e,this.result):new t((function(t,i){r.xu=function(n){r.Mu(e,n).next(t,i)},r.ju=function(e){r.Bu(n,e).next(t,i)}}))},t.prototype.Qu=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.Gu=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.Mu=function(e,n){return e?this.Gu((function(){return e(n)})):t.resolve(n)},t.prototype.Bu=function(e,n){return e?this.Gu((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.Wu=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.zu=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++){r(o[i])}return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.Wu(r)},t}(),kn=function(){function t(){this.Ku=new An((function(t){return t.toString()})),this.Hu=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return w(void 0!==this.Ju,"Read time is not set. All removeEntry() calls must include a readTime if `trackRemovals` is used."),this.Ju},set:function(t){w(void 0===this.Ju||this.Ju.isEqual(t),"All changes in a RemoteDocumentChangeBuffer must have the same read time"),this.Ju=t},enumerable:!0,configurable:!0}),t.prototype.Yu=function(t,e){this.Xu(),this.readTime=e,this.Ku.set(t.key,t)},t.prototype.$u=function(t,e){this.Xu(),e&&(this.readTime=e),this.Ku.set(t,null)},t.prototype.Zu=function(t,e){this.Xu();var n=this.Ku.get(e);return void 0!==n?On.resolve(n):this.ts(t,e)},t.prototype.getEntries=function(t,e){return this.ns(t,e)},t.prototype.apply=function(t){return this.Xu(),this.Hu=!0,this.es(t)},t.prototype.Xu=function(){w(!this.Hu,"Changes have already been applied.")},t}(),Rn="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Cn=function(){function t(){this.rs=[]}return t.prototype.us=function(t){this.rs.push(t)},t.prototype.ss=function(){this.rs.forEach((function(t){return t()}))},t}(),Dn=function(){function t(e){this.db=e,12.2===t.os(u.getUA())&&y("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.hs=function(e,n,r){return w(t.cs(),"IndexedDB not supported in current environment."),v("SimpleDb","Opening database:",e),new On((function(i,o){var s=window.indexedDB.open(e,n);s.onsuccess=function(e){var n=e.target.result;i(new t(n))},s.onblocked=function(){o(new O(A.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=function(t){var e=t.target.error;"VersionError"===e.name?o(new O(A.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o(e)},s.onupgradeneeded=function(t){v("SimpleDb",'Database "'+e+'" requires upgrade from version:',t.oldVersion);var n=t.target.result;r.createOrUpgrade(n,s.transaction,t.oldVersion,dr).next((function(){v("SimpleDb","Database upgrade to version "+dr+" complete")}))}})).Qu()},t.delete=function(t){return v("SimpleDb","Removing database:",t),Un(window.indexedDB.deleteDatabase(t)).Qu()},t.cs=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(t.as())return!0;if(void 0===window.navigator)return!1;var e=u.getUA(),n=t.os(e),r=0<n&&n<10,i=t.fs(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.as=function(){var t;return"undefined"!=typeof r&&"YES"===(null===(t=r.env)||void 0===t?void 0:t.ls)},t.ds=function(t,e){return t.store(e)},t.os=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.fs=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.vs=function(t){this.db.onversionchange=function(e){return t(e)}},t.prototype.runTransaction=function(t,e,n){return s.__awaiter(this,void 0,void 0,(function(){var r,i,o,a,u,c;return s.__generator(this,(function(h){switch(h.label){case 0:r=t.startsWith("readonly"),i=t.endsWith("idempotent"),o=0,a=function(){var t,a,c,h;return s.__generator(this,(function(s){switch(s.label){case 0:++o,t=xn.open(u.db,r?"readonly":"readwrite",e),s.label=1;case 1:return s.trys.push([1,3,,4]),(a=n(t).catch((function(e){return t.abort(e),On.reject(e)})).Qu()).catch((function(){})),[4,t.ws];case 2:return s.sent(),[2,{value:a}];case 3:return c=s.sent(),h=i&&"FirebaseError"!==c.name&&o<3,v("SimpleDb","Transaction failed with error: %s. Retrying: %s.",c.message,h),h?[3,4]:[2,{value:Promise.reject(c)}];case 4:return[2]}}))},u=this,h.label=1;case 1:return[5,a()];case 2:return"object"==typeof(c=h.sent())?[2,c.value]:[3,1];case 3:return[2]}}))}))},t.prototype.close=function(){this.db.close()},t}(),Pn=function(){function t(t){this.ms=t,this.ps=!1,this.gs=null}return Object.defineProperty(t.prototype,"Lu",{get:function(){return this.ps},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bs",{get:function(){return this.gs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.ms=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.ps=!0},t.prototype.ys=function(t){this.gs=t},t.prototype.delete=function(){return Un(this.ms.delete())},t}(),xn=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this._s=new yn,this.transaction.oncomplete=function(){e._s.resolve()},this.transaction.onabort=function(){t.error?e._s.reject(t.error):e._s.resolve()},this.transaction.onerror=function(t){var n=jn(t.target.error);e._s.reject(n)}}return t.open=function(e,n,r){return new t(e.transaction(r,n))},Object.defineProperty(t.prototype,"ws",{get:function(){return this._s.promise},enumerable:!0,configurable:!0}),t.prototype.abort=function(t){t&&this._s.reject(t),this.aborted||(v("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return w(!!e,"Object store not part of transaction: "+t),new Ln(e)},t}(),Ln=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(v("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(v("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Un(n)},t.prototype.add=function(t){return v("SimpleDb","ADD",this.store.name,t,t),Un(this.store.add(t))},t.prototype.get=function(t){var e=this;return Un(this.store.get(t)).next((function(n){return void 0===n&&(n=null),v("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return v("SimpleDb","DELETE",this.store.name,t),Un(this.store.delete(t))},t.prototype.count=function(){return v("SimpleDb","COUNT",this.store.name),Un(this.store.count())},t.prototype.Is=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.Ts(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.Es=function(t,e){v("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Ds=!1;var r=this.cursor(n);return this.Ts(r,(function(t,e,n){return n.delete()}))},t.prototype.Ss=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.Ts(r,e)},t.prototype.Rs=function(t){var e=this.cursor({});return new On((function(n,r){e.onerror=function(t){var e=jn(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.Ts=function(t,e){var n=[];return new On((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Pn(i),s=e(i.primaryKey,i.value,o);if(s instanceof On){var a=s.catch((function(t){return o.done(),On.reject(t)}));n.push(a)}o.Lu?r():null===o.bs?i.continue():i.continue(o.bs)}else r()}})).next((function(){return On.Wu(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:(w(void 0===e,"3rd argument must not be defined if 2nd is a range."),e=t)),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Ds?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Un(t){return new On((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=jn(t.target.error);n(e)}}))}var Mn=!1;function jn(t){var e=Dn.os(u.getUA());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new O("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Mn||(Mn=!0,setTimeout((function(){throw r}),0)),r}}return t}var Fn=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.Cs=n,this.As=r,this.Ps={}}return t.ks=function(e,n,r,i){return w(""!==e.uid,"UserID must not be an empty string."),new t(e.l()?e.uid:"",n,r,i)},t.prototype.Ns=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Vn(t).Ss({index:wr.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.Os=function(t,e,n){return this.Fs(t).next((function(e){return e.lastStreamToken=n.toBase64(),zn(t).put(e)}))},t.prototype.Vs=function(t){return this.Fs(t).next((function(t){return _e.fromBase64String(t.lastStreamToken)}))},t.prototype.Us=function(t,e){return this.Fs(t).next((function(n){return n.lastStreamToken=e.toBase64(),zn(t).put(n)}))},t.prototype.xs=function(t,e,n,r){var i=this,o=Bn(t),s=Vn(t);return s.add({}).next((function(a){w("number"==typeof a,"Auto-generated key is not a number");for(var u=new In(a,e,n,r),c=i.serializer.js(i.userId,u),h=[],f=new wt((function(t,e){return _(t.nt(),e.nt())})),l=0,p=r;l<p.length;l++){var d=p[l],v=br.key(i.userId,d.key.path,a);f=f.add(d.key.path.H()),h.push(s.put(c)),h.push(o.put(v,br.PLACEHOLDER))}return f.forEach((function(e){h.push(i.Cs.Ls(t,e))})),t.us((function(){i.Ps[a]=u.keys()})),On.Wu(h).next((function(){return u}))}))},t.prototype.qs=function(t,e){var n=this;return Vn(t).get(e).next((function(t){return t?(w(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),n.serializer.Bs(t)):null}))},t.prototype.Ms=function(t,e){var n=this;return this.Ps[e]?On.resolve(this.Ps[e]):this.qs(t,e).next((function(t){if(t){var r=t.keys();return n.Ps[e]=r,r}return null}))},t.prototype.Qs=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Vn(t).Ss({index:wr.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(w(e.batchId>=r,"Should have found mutation after "+r),o=n.serializer.Bs(e)),i.done()})).next((function(){return o}))},t.prototype.Gs=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Vn(t).Ss({index:wr.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.Ws=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Vn(t).Is(wr.userMutationsIndex,n).next((function(t){return t.map((function(t){return e.serializer.Bs(t)}))}))},t.prototype.zs=function(t,e){var n=this,r=br.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Bn(t).Ss({range:i},(function(r,i,s){var a=r[0],u=r[1],c=r[2],h=En(u);if(a===n.userId&&e.path.isEqual(h))return Vn(t).get(c).next((function(t){if(!t)throw g("Dangling document-mutation reference found: "+r+" which points to "+c);w(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+c),o.push(n.serializer.Bs(t))}));s.done()})).next((function(){return o}))},t.prototype.Ks=function(t,e){var n=this,r=new wt(_),i=[];return e.forEach((function(e){var o=br.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=Bn(t).Ss({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],c=En(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(a)})),On.Wu(i).next((function(){return n.Hs(t,r)}))},t.prototype.Js=function(t,e){var n=this;w(!e.Nn(),"Document queries shouldn't go down this path"),w(!e.ui(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=e.path,i=r.length+1,o=br.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new wt(_);return Bn(t).Ss({range:s},(function(t,e,o){var s=t[0],u=t[1],c=t[2],h=En(u);s===n.userId&&r.$(h)?h.length===i&&(a=a.add(c)):o.done()})).next((function(){return n.Hs(t,a)}))},t.prototype.Hs=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Vn(t).get(e).next((function(t){if(null===t)throw g("Dangling document-mutation reference found, which points to "+e);w(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),r.push(n.serializer.Bs(t))})))})),On.Wu(i).next((function(){return r}))},t.prototype.Ys=function(t,e){var n=this;return Gn(t.Xs,this.userId,e).next((function(r){return t.us((function(){n.$s(e.batchId)})),On.forEach(r,(function(e){return n.As.Zs(t,e)}))}))},t.prototype.$s=function(t){delete this.Ps[t]},t.prototype.to=function(t){var e=this;return this.Ns(t).next((function(n){if(!n)return On.resolve();var r=IDBKeyRange.lowerBound(br.prefixForUser(e.userId)),i=[];return Bn(t).Ss({range:r},(function(t,n,r){if(t[0]===e.userId){var o=En(t[1]);i.push(o)}else r.done()})).next((function(){w(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map((function(t){return t.nt()})))}))}))},t.prototype.Ou=function(t,e){return qn(t,this.userId,e)},t.prototype.Fs=function(t){var e=this;return zn(t).get(this.userId).next((function(t){return t||new gr(e.userId,-1,"")}))},t}();function qn(t,e,n){var r=br.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Bn(t).Ss({range:o,Ds:!0},(function(t,n,r){var o=t[0],a=t[1];t[2];o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function Gn(t,e,n){var r=t.store(wr.store),i=t.store(br.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.Ss({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){w(1===a,"Dangling document-mutation reference found: Missing batch "+n.batchId)})));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=br.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return On.Wu(o).next((function(){return c}))}function Vn(t){return qr.ds(t,wr.store)}function Bn(t){return qr.ds(t,br.store)}function zn(t){return qr.ds(t,gr.store)}var Hn=function(){function t(t,e){this.no=t,w((1&t)===t,"Generator ID "+t+" contains more than 1 reserved bits"),this.io(void 0!==e?e:this.no)}return t.prototype.next=function(){var t=this.eo;return this.eo+=2,t},t.prototype.after=function(t){return this.io(t+2),this.next()},t.prototype.io=function(t){w((1&t)===this.no,"Cannot supply target ID from different generator ID"),this.eo=t},t.ro=function(){return new t(0,2)},t.uo=function(){return new t(1)},t}(),Wn=function(){function t(t,e,n){this.so=t,this.oo=e,this.Cs=n}return t.prototype.ho=function(t,e){var n=this;return this.oo.zs(t,e).next((function(r){return n.co(t,e,r)}))},t.prototype.co=function(t,e,n){return this.so.Zu(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++){t=i[r].Gt(e,t)}return t}))},t.prototype.ao=function(t,e,n){var r=Pe();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++){e=o[i].Gt(t,e)}r=r.lt(t,e)})),r},t.prototype.fo=function(t,e){var n=this;return this.so.getEntries(t,e).next((function(e){return n.lo(t,e)}))},t.prototype.lo=function(t,e){var n=this;return this.oo.Ks(t,e).next((function(r){var i=n.ao(t,e,r),o=De();return i.forEach((function(t,e){e||(e=new ee(t,ct.q())),o=o.lt(t,e)})),o}))},t.prototype.do=function(t,e,n){return e.Nn()?this.vo(t,e.path):e.ui()?this.wo(t,e,n):this.mo(t,e,n)},t.prototype.vo=function(t,e){return this.ho(t,new dt(e)).next((function(t){var e=Le();return t instanceof te&&(e=e.lt(t.key,t)),e}))},t.prototype.wo=function(t,e,n){var r=this;w(e.path.J(),"Currently we only support collection group queries at the root.");var i=e.collectionGroup,o=Le();return this.Cs.po(t,i).next((function(s){return On.forEach(s,(function(s){var a=e.Hn(s.child(i));return r.mo(t,a,n).next((function(t){t.forEach((function(t,e){o=o.lt(t,e)}))}))})).next((function(){return o}))}))},t.prototype.mo=function(t,e,n){var r,i,o=this;return this.so.do(t,e,n).next((function(n){return r=n,o.oo.Js(t,e)})).next((function(e){return i=e,o.bo(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c),f=u.Gt(h,h,o.En);r=f instanceof te?r.lt(c,f):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){e.matches(n)||(r=r.remove(t))})),r}))},t.prototype.bo=function(t,e,n){for(var r=Fe(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof Dt&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.so.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof te&&(c=c.lt(t,e))})),c}))},t}(),Kn=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.yo=n,this._o=r}return t.Io=function(e,n){for(var r=Fe(),i=Fe(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Qn=function(){function t(t,e,n){this.persistence=t,this.To=e,this.Eo=new Sn,this.Do=new vt(_),this.So=new An((function(t){return t.canonicalId()})),this.Ro=ct.MIN,w(t.Co,"LocalStore was passed an unstarted persistence implementation"),this.persistence.As.Ao(this.Eo),this.oo=t.Po(n),this.ko=t.No(),this.Oo=t.Fo(),this.Vo=new Wn(this.ko,this.oo,this.persistence.Uo()),this.To.xo(this.Vo)}return t.prototype.start=function(){return this.jo()},t.prototype.Lo=function(t){return s.__awaiter(this,void 0,void 0,(function(){var e,n,r,i=this;return s.__generator(this,(function(o){switch(o.label){case 0:return e=this.oo,n=this.Vo,[4,this.persistence.runTransaction("Handle user change","readonly-idempotent",(function(r){var o;return i.oo.Ws(r).next((function(s){return o=s,e=i.persistence.Po(t),n=new Wn(i.ko,e,i.persistence.Uo()),e.Ws(r)})).next((function(t){for(var e=[],i=[],s=Fe(),a=0,u=o;a<u.length;a++){var c=u[a];e.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++){var l=f[h];s=s.add(l.key)}}for(var p=0,d=t;p<d.length;p++){c=d[p];i.push(c.batchId);for(var v=0,y=c.mutations;v<y.length;v++){l=y[v];s=s.add(l.key)}}return n.fo(r,s).next((function(t){return{qo:t,Bo:e,Mo:i}}))}))}))];case 1:return r=o.sent(),this.oo=e,this.Vo=n,this.To.xo(this.Vo),[2,r]}}))}))},t.prototype.Qo=function(t){var e,n=this,r=ut.now(),i=t.reduce((function(t,e){return t.add(e.key)}),Fe());return this.persistence.runTransaction("Locally write mutations","readwrite-idempotent",(function(o){return n.Vo.fo(o,i).next((function(i){e=i;for(var s=[],a=0,u=t;a<u.length;a++){var c=u[a],h=c.rn(e.get(c.key));null!=h&&s.push(new Dt(c.key,h,h.un(),kt.exists(!0)))}return n.oo.xs(o,r,s,t)}))})).then((function(t){var n=t.bu(e);return{batchId:t.batchId,Ku:n}}))},t.prototype.Go=function(t){var e=this;return this.persistence.runTransaction("Lookup mutation documents","readonly-idempotent",(function(n){return e.oo.Ms(n,t).next((function(t){return t?e.Vo.fo(n,t):On.resolve(null)}))}))},t.prototype.Os=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary-idempotent",(function(n){var r=t.batch.keys(),i=e.ko.Wo({zo:!0});return e.oo.Os(n,t.batch,t.streamToken).next((function(){return e.Ko(n,t,i)})).next((function(){return i.apply(n)})).next((function(){return e.oo.to(n)})).next((function(){return e.Vo.fo(n,r)}))}))},t.prototype.Ho=function(t){var e=this;return this.persistence.runTransaction("Reject batch","readwrite-primary-idempotent",(function(n){var r;return e.oo.qs(n,t).next((function(t){return w(null!==t,"Attempt to reject nonexistent batch!"),r=t.keys(),e.oo.Ys(n,t)})).next((function(){return e.oo.to(n)})).next((function(){return e.Vo.fo(n,r)}))}))},t.prototype.Gs=function(){var t=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly-idempotent",(function(e){return t.oo.Gs(e)}))},t.prototype.Vs=function(){var t=this;return this.persistence.runTransaction("Get last stream token","readonly-idempotent",(function(e){return t.oo.Vs(e)}))},t.prototype.Us=function(t){var e=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary-idempotent",(function(n){return e.oo.Us(n,t)}))},t.prototype.Jo=function(){var t=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly-idempotent",(function(e){return t.Oo.Jo(e)}))},t.prototype.Yo=function(e){var n=this,r=e.li,i=this.Do;return this.persistence.runTransaction("Apply remote event","readwrite-primary-idempotent",(function(o){var s=n.ko.Wo({zo:!0});i=n.Do;var a=[];M(e.Si,(function(e,s){var u=i.get(e);if(u){a.push(n.Oo.Xo(o,s.Vi,e).next((function(){return n.Oo.$o(o,s.Oi,e)})));var c=s.resumeToken;if(c.bn()>0){var h=u.vi(c,r).di(o.Zo);i=i.lt(e,h),t.th(u,h,s)&&a.push(n.Oo.nh(o,h))}}}));var u=De(),c=Fe();if(e.Ci.forEach((function(t,e){c=c.add(t)})),a.push(s.getEntries(o,c).next((function(t){e.Ci.forEach((function(i,c){var h=t.get(i);c instanceof ee&&c.version.isEqual(ct.MIN)?(s.$u(i,r),u=u.lt(i,c)):null==h||c.version.h(h.version)>0||0===c.version.h(h.version)&&h.hasPendingWrites?(w(!ct.MIN.isEqual(r),"Cannot add a document when the remote version is zero"),s.Yu(c,r),u=u.lt(i,c)):v("LocalStore","Ignoring outdated watch update for ",i,". Current version:",h.version," Watch version:",c.version),e.Ai.has(i)&&a.push(n.persistence.As.ih(o,i))}))}))),!r.isEqual(ct.MIN)){var h=n.Oo.Jo(o).next((function(t){return w(r.h(t)>=0,"Watch stream reverted to previous snapshot?? "+r+" < "+t),n.Oo.eh(o,o.Zo,r)}));a.push(h)}return On.Wu(a).next((function(){return s.apply(o)})).next((function(){return n.Vo.lo(o,u)}))})).then((function(t){return n.Do=i,t}))},t.th=function(t,e,n){return w(e.resumeToken.bn()>0,"Attempted to persist target data with no resume token"),0===t.resumeToken.bn()||(e.li.B()-t.li.B()>=this.rh||n.Oi.size+n.Fi.size+n.Vi.size>0)},t.prototype.uh=function(t){for(var e=this,n=0,r=t;n<r.length;n++){var i=r[n],o=i.targetId;if(this.Eo.Su(i.yo,o),this.Eo.Au(i._o,o),!i.fromCache){var s=this.Do.get(o);w(null!==s,"Can't set limbo-free snapshot version for unknown target: "+o);var a=s.li,u=s.wi(a);this.Do=this.Do.lt(o,u)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite-idempotent",(function(n){return On.forEach(t,(function(t){return On.forEach(t._o,(function(t){return e.persistence.As.Ru(n,t)}))}))}))},t.prototype.sh=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch","readonly-idempotent",(function(n){return void 0===t&&(t=-1),e.oo.Qs(n,t)}))},t.prototype.oh=function(t){var e=this;return this.persistence.runTransaction("read document","readonly-idempotent",(function(n){return e.Vo.ho(n,t)}))},t.prototype.hh=function(t){var e=this;return this.persistence.runTransaction("Allocate target","readwrite-idempotent",(function(n){var r;return e.Oo.ah(n,t).next((function(i){return i?(r=i,On.resolve(r)):e.Oo.fh(n).next((function(i){return r=new Ne(t,i,0,n.Zo),e.Oo.lh(n,r).next((function(){return r}))}))}))})).then((function(n){return null===e.Do.get(n.targetId)&&(e.Do=e.Do.lt(n.targetId,n),e.So.set(t,n.targetId)),n}))},t.prototype.ah=function(t,e){var n=this.So.get(e);return void 0!==n?On.resolve(this.Do.get(n)):this.Oo.ah(t,e)},t.prototype.dh=function(t,e){var n=this,r=this.Do.get(t);w(null!==r,"Tried to release nonexistent target: "+t);var i=e?"readwrite-idempotent":"readwrite-primary-idempotent";return this.persistence.runTransaction("Release target",i,(function(i){var o=n.Eo.Pu(t);return e?On.resolve():On.forEach(o,(function(t){return n.persistence.As.Ru(i,t)})).next((function(){n.persistence.As.removeTarget(i,r)}))})).then((function(){n.Do=n.Do.remove(t),n.So.delete(r.target)}))},t.prototype.vh=function(t,e){var n=this,r=ct.MIN,i=Fe();return this.persistence.runTransaction("Execute query","readonly-idempotent",(function(o){return n.ah(o,t.Yn()).next((function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,n.Oo.wh(o,t.targetId).next((function(t){i=t}))})).next((function(){return n.To.do(o,t,e?r:ct.MIN,e?i:Fe())})).next((function(t){return{documents:t,mh:i}}))}))},t.prototype.ph=function(t){var e=this;return this.persistence.runTransaction("Remote document keys","readonly-idempotent",(function(n){return e.Oo.wh(n,t)}))},t.prototype.gh=function(){return this.persistence.gh()},t.prototype.bh=function(t){this.oo.$s(t)},t.prototype.yh=function(t){this.persistence.yh(t)},t.prototype.Ko=function(t,e,n){var r=this,i=e.batch,o=i.keys(),s=On.resolve();return o.forEach((function(r){s=s.next((function(){return n.Zu(t,r)})).next((function(t){var o=t,s=e._u.get(r);w(null!==s,"ackVersions should contain every doc in the write."),(!o||o.version.h(s)<0)&&((o=i.Wt(r,o,e))?n.Yu(o,e.yu):w(!t,"Mutation batch "+i+" applied to document "+t+" resulted in null"))}))})),s.next((function(){return r.oo.Ys(t,i)}))},t.prototype._h=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary-idempotent",(function(n){return t.Ih(n,e.Do)}))},t.prototype.Th=function(t){var e=this,n=this.Do.get(t);return n?Promise.resolve(n.target):this.persistence.runTransaction("Get target data","readonly-idempotent",(function(n){return e.Oo.ye(n,t).next((function(t){return t?t.target:null}))}))},t.prototype.Eh=function(){var t=this;return this.persistence.runTransaction("Get new document changes","readonly-idempotent",(function(e){return t.ko.Eh(e,t.Ro)})).then((function(e){var n=e.Dh,r=e.readTime;return t.Ro=r,n}))},t.prototype.jo=function(){return s.__awaiter(this,void 0,void 0,(function(){var t,e=this;return s.__generator(this,(function(n){switch(n.label){case 0:return t=this,[4,this.persistence.runTransaction("Synchronize last document change read time","readonly-idempotent",(function(t){return e.ko.Sh(t)}))];case 1:return t.Ro=n.sent(),[2]}}))}))},t.rh=3e8,t}();function Yn(t){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(e){if(t.code!==A.FAILED_PRECONDITION||t.message!==Rn)throw t;return v("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}function Jn(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=_(n,i);return 0===s?_(r,o):s}var Xn=function(){function t(t){this.Rh=t,this.buffer=new wt(Jn),this.Ch=0}return t.prototype.Ah=function(){return++this.Ch},t.prototype.Ph=function(t){var e=[t,this.Ah()];if(this.buffer.size<this.Rh)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Jn(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),t}(),$n={kh:!1,Nh:0,Oh:0,Fh:0},Zn=function(){function t(t,e,n){this.Vh=t,this.Uh=e,this.xh=n}return t.jh=function(e){return new t(e,t.Lh,t.qh)},t.Bh=-1,t.Mh=1048576,t.Qh=41943040,t.Lh=10,t.qh=1e3,t.Gh=new t(t.Qh,t.Lh,t.qh),t.DISABLED=new t(t.Bh,0,0),t}(),tr=function(){function t(t,e,n){this.Wh=t,this.Qr=e,this.zh=n,this.Kh=!1,this.Hh=null}return t.prototype.start=function(){w(null===this.Hh,"Cannot start an already started LruScheduler"),this.Wh.params.Vh!==Zn.Bh&&this.Jh()},t.prototype.stop=function(){this.Hh&&(this.Hh.cancel(),this.Hh=null)},Object.defineProperty(t.prototype,"Co",{get:function(){return null!==this.Hh},enumerable:!0,configurable:!0}),t.prototype.Jh=function(){var t=this;w(null===this.Hh,"Cannot schedule GC while a task is pending");var e=this.Kh?3e5:6e4;v("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.Hh=this.Qr.fu("lru_garbage_collection",e,(function(){return t.Hh=null,t.Kh=!0,t.zh._h(t.Wh).then((function(){return t.Jh()})).catch(Yn)}))},t}(),er=function(){function t(t,e){this.Yh=t,this.params=e}return t.prototype.Xh=function(t,e){return this.Yh.$h(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.Zh=function(t,e){var n=this;if(0===e)return On.resolve(vn.Mr);var r=new Xn(e);return this.Yh.ce(t,(function(t){return r.Ph(t.sequenceNumber)})).next((function(){return n.Yh.tc(t,(function(t){return r.Ph(t)}))})).next((function(){return r.maxValue}))},t.prototype.nc=function(t,e,n){return this.Yh.nc(t,e,n)},t.prototype.ic=function(t,e){return this.Yh.ic(t,e)},t.prototype.Ih=function(t,e){var n=this;return this.params.Vh===Zn.Bh?(v("LruGarbageCollector","Garbage collection skipped; disabled"),On.resolve($n)):this.ec(t).next((function(r){return r<n.params.Vh?(v("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Vh),$n):n.rc(t,e)}))},t.prototype.ec=function(t){return this.Yh.ec(t)},t.prototype.rc=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.Xh(t,this.params.Uh).next((function(e){return e>c.params.xh?(v("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.xh+" from "+e),r=c.params.xh):r=e,o=Date.now(),c.Zh(t,r)})).next((function(r){return n=r,s=Date.now(),c.nc(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.ic(t,n)})).next((function(t){(u=Date.now(),p()<=0)&&v("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms");return On.resolve({kh:!0,Nh:r,Oh:i,Fh:t})}))},t}(),nr=function(){function t(t,e){this.As=t,this.serializer=e,this.uc=Hn.ro()}return t.prototype.fh=function(t){var e=this;return this.sc(t).next((function(n){return n.highestTargetId=e.uc.after(n.highestTargetId),e.oc(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Jo=function(t){return this.sc(t).next((function(t){return ct.L(new ut(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.hc=function(t){return or(t.Xs)},t.prototype.eh=function(t,e,n){var r=this;return this.sc(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.M()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.oc(t,i)}))},t.prototype.lh=function(t,e){var n=this;return this.cc(t,e).next((function(){return n.sc(t).next((function(r){return r.targetCount+=1,n.ac(e,r),n.oc(t,r)}))}))},t.prototype.nh=function(t,e){return this.cc(t,e)},t.prototype.fc=function(t,e){var n=this;return this.lc(t,e.targetId).next((function(){return rr(t).delete(e.targetId)})).next((function(){return n.sc(t)})).next((function(e){return w(e.targetCount>0,"Removing from an empty target cache"),e.targetCount-=1,n.oc(t,e)}))},t.prototype.nc=function(t,e,n){var r=this,i=0,o=[];return rr(t).Ss((function(s,a){var u=r.serializer.dc(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.fc(t,u)))})).next((function(){return On.Wu(o)})).next((function(){return i}))},t.prototype.ce=function(t,e){var n=this;return rr(t).Ss((function(t,r){var i=n.serializer.dc(r);e(i)}))},t.prototype.sc=function(t){return ir(t.Xs)},t.prototype.oc=function(t,e){return(n=t,qr.ds(n,Ar.store)).put(Ar.key,e);var n},t.prototype.cc=function(t,e){return rr(t).put(this.serializer.vc(e))},t.prototype.ac=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.wc=function(t){return this.sc(t).next((function(t){return t.targetCount}))},t.prototype.ah=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return rr(t).Ss({range:i,index:Sr.queryTargetsIndexName},(function(t,r,i){var s=n.serializer.dc(r);e.isEqual(s.target)&&(o=s,i.done())})).next((function(){return o}))},t.prototype.$o=function(t,e,n){var r=this,i=[],o=sr(t);return e.forEach((function(e){var s=wn(e.path);i.push(o.put(new Nr(n,s))),i.push(r.As.Du(t,e))})),On.Wu(i)},t.prototype.Xo=function(t,e,n){var r=this,i=sr(t);return On.forEach(e,(function(e){var o=wn(e.path);return On.Wu([i.delete([n,o]),r.As.Ru(t,e)])}))},t.prototype.lc=function(t,e){var n=sr(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.wh=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=sr(t),i=Fe();return r.Ss({range:n,Ds:!0},(function(t,e,n){var r=En(t[1]),o=new dt(r);i=i.add(o)})).next((function(){return i}))},t.prototype.Ou=function(t,e){var n=wn(e.path),r=IDBKeyRange.bound([n],[I(n)],!1,!0),i=0;return sr(t).Ss({index:Nr.documentTargetsIndex,Ds:!0,range:r},(function(t,e,n){var r=t[0];t[1];0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.ye=function(t,e){var n=this;return rr(t).get(e).next((function(t){return t?n.serializer.dc(t):null}))},t}();function rr(t){return qr.ds(t,Sr.store)}function ir(t){return Dn.ds(t,Ar.store).get(Ar.key).next((function(t){return w(null!==t,"Missing metadata row."),t}))}function or(t){return ir(t).next((function(t){return t.highestListenSequenceNumber}))}function sr(t){return qr.ds(t,Nr.store)}var ar=function(){function t(t,e){this.serializer=t,this.Cs=e}return t.prototype.Yu=function(t,e,n){return cr(t).put(hr(e),n)},t.prototype.$u=function(t,e){var n=cr(t),r=hr(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.mc(t,r)}))},t.prototype.Zu=function(t,e){var n=this;return cr(t).get(hr(e)).next((function(t){return n.pc(t)}))},t.prototype.gc=function(t,e){var n=this;return cr(t).get(hr(e)).next((function(t){var e=n.pc(t);return e?{bc:e,size:fr(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=Pe();return this.yc(t,e,(function(t,e){var i=n.pc(e);r=r.lt(t,i)})).next((function(){return r}))},t.prototype._c=function(t,e){var n=this,r=Pe(),i=new vt(dt.G);return this.yc(t,e,(function(t,e){var o=n.pc(e);o?(r=r.lt(t,o),i=i.lt(t,fr(e))):(r=r.lt(t,null),i=i.lt(t,0))})).next((function(){return{Ic:r,Tc:i}}))},t.prototype.yc=function(t,e,n){if(e.J())return On.resolve();var r=IDBKeyRange.bound(e.first().path.tt(),e.last().path.tt()),i=e.bt(),o=i.Dt();return cr(t).Ss({range:r},(function(t,e,r){for(var s=dt.at(t);o&&dt.G(o,s)<0;)n(o,null),o=i.Dt();o&&o.isEqual(s)&&(n(o,e),o=i.St()?i.Dt():null),o?r.ys(o.path.tt()):r.done()})).next((function(){for(;o;)n(o,null),o=i.St()?i.Dt():null}))},t.prototype.do=function(t,e,n){var r=this;w(!e.ui(),"CollectionGroup queries should be handled in LocalDocumentsView");var i=Le(),o=e.path.length+1,s={};if(n.isEqual(ct.MIN)){var a=e.path.tt();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.tt(),c=this.serializer.Ec(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=Ir.collectionReadTimeIndex}return cr(t).Ss(s,(function(t,n,s){if(t.length===o){var a=r.serializer.Dc(n);e.path.$(a.key.path)?a instanceof te&&e.matches(a)&&(i=i.lt(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.Eh=function(t,e){var n=this,r=De(),i=this.serializer.Ec(e),o=cr(t),s=IDBKeyRange.lowerBound(i,!0);return o.Ss({index:Ir.readTimeIndex,range:s},(function(t,e){var o=n.serializer.Dc(e);r=r.lt(o.key,o),i=e.readTime})).next((function(){return{Dh:r,readTime:n.serializer.Sc(i)}}))},t.prototype.Sh=function(t){var e=this,n=cr(t),r=ct.MIN;return n.Ss({index:Ir.readTimeIndex,reverse:!0},(function(t,n,i){n.readTime&&(r=e.serializer.Sc(n.readTime)),i.done()})).next((function(){return r}))},t.prototype.Wo=function(e){return new t.Rc(this,!!e&&e.zo)},t.prototype.Cc=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return ur(t).get(Tr.key).next((function(t){return w(!!t,"Missing document cache metadata"),t}))},t.prototype.mc=function(t,e){return ur(t).put(Tr.key,e)},t.prototype.pc=function(t){if(t){var e=this.serializer.Dc(t);return e instanceof ee&&e.version.isEqual(ct.q())?null:e}return null},t.Rc=function(t){function e(e,n){var r=t.call(this)||this;return r.Ac=e,r.zo=n,r.Pc=new An((function(t){return t.toString()})),r}return s.__extends(e,t),e.prototype.es=function(t){var e=this,n=[],r=0,i=new wt((function(t,e){return _(t.nt(),e.nt())}));return this.Ku.forEach((function(o,s){var a=e.Pc.get(o);if(w(void 0!==a,"Cannot modify a document that wasn't read (for "+o+")"),s){w(!e.readTime.isEqual(ct.MIN),"Cannot add a document with a read time of zero");var u=e.Ac.serializer.kc(s,e.readTime);i=i.add(o.path.H());var c=fr(u);r+=c-a,n.push(e.Ac.Yu(t,o,u))}else if(r-=a,e.zo){var h=e.Ac.serializer.kc(new ee(o,ct.q()),e.readTime);n.push(e.Ac.Yu(t,o,h))}else n.push(e.Ac.$u(t,o))})),i.forEach((function(r){n.push(e.Ac.Cs.Ls(t,r))})),n.push(this.Ac.updateMetadata(t,r)),On.Wu(n)},e.prototype.ts=function(t,e){var n=this;return this.Ac.gc(t,e).next((function(t){return null===t?(n.Pc.set(e,0),null):(n.Pc.set(e,t.size),t.bc)}))},e.prototype.ns=function(t,e){var n=this;return this.Ac._c(t,e).next((function(t){var e=t.Ic;return t.Tc.forEach((function(t,e){n.Pc.set(t,e)})),e}))},e}(kn),t}();function ur(t){return qr.ds(t,Tr.store)}function cr(t){return qr.ds(t,Ir.store)}function hr(t){return t.path.tt()}function fr(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw g("Unknown remote document type");e=t.noDocument}return JSON.stringify(e).length}var lr=function(){function t(){this.Nc=new pr}return t.prototype.Ls=function(t,e){return this.Nc.add(e),On.resolve()},t.prototype.po=function(t,e){return On.resolve(this.Nc.getEntries(e))},t}(),pr=function(){function t(){this.index={}}return t.prototype.add=function(t){w(t.length%2==1,"Expected a collection path.");var e=t.X(),n=t.H(),r=this.index[e]||new wt(ft.G),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.X(),n=t.H(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new wt(ft.G)).tt()},t}(),dr=9,vr=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;w(n<r&&n>=0&&r<=dr,"Unexpected schema upgrade from v"+n+" to v{toVersion}.");var o=new xn(e);n<1&&r>=1&&(function(t){t.createObjectStore(mr.store)}(t),function(t){t.createObjectStore(gr.store,{keyPath:gr.keyPath}),t.createObjectStore(wr.store,{keyPath:wr.keyPath,autoIncrement:!0}).createIndex(wr.userMutationsIndex,wr.userMutationsKeyPath,{unique:!0}),t.createObjectStore(br.store)}(t),kr(t),function(t){t.createObjectStore(Ir.store)}(t));var s=On.resolve();return n<3&&r>=3&&(0!==n&&(!function(t){t.deleteObjectStore(Nr.store),t.deleteObjectStore(Sr.store),t.deleteObjectStore(Ar.store)}(t),kr(t)),s=s.next((function(){return function(t){var e=t.store(Ar.store),n=new Ar(0,0,ct.MIN.M(),0);return e.put(Ar.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(wr.store).Is().next((function(n){t.deleteObjectStore(wr.store),t.createObjectStore(wr.store,{keyPath:wr.keyPath,autoIncrement:!0}).createIndex(wr.userMutationsIndex,wr.userMutationsKeyPath,{unique:!0});var r=e.store(wr.store),i=n.map((function(t){return r.put(t)}));return On.Wu(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Rr.store,{keyPath:Rr.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(Tr.store)}(t),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Ir.store);e.createIndex(Ir.readTimeIndex,Ir.readTimeIndexPath,{unique:!1}),e.createIndex(Ir.collectionReadTimeIndex,Ir.collectionReadTimeIndexPath,{unique:!1})}(e)}))),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Ir.store).Ss((function(t,n){e+=fr(n)})).next((function(){var n=new Tr(e);return t.store(Tr.store).put(Tr.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(gr.store),r=t.store(wr.store);return n.Is().next((function(n){return On.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Is(wr.userMutationsIndex,i).next((function(r){return On.forEach(r,(function(r){w(r.userId===n.userId,"Cannot process batch "+r.batchId+" from unexpected user");var i=e.serializer.Bs(r);return Gn(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(Nr.store),n=t.store(Ir.store);return or(t).next((function(t){var r=[];return n.Ss((function(n,i){var o=new ft(n),s=function(t){return[0,wn(t)]}(o);r.push(e.get(s).next((function(n){return n?On.resolve():function(n){return e.put(new Nr(0,wn(n),t))}(o)})))})).next((function(){return On.Wu(r)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Or.store,{keyPath:Or.keyPath});var n=e.store(Or.store),r=new pr,i=function(t){if(r.add(t)){var e=t.X(),i=t.H();return n.put({collectionId:e,parent:wn(i)})}};return e.store(Ir.store).Ss({Ds:!0},(function(t,e){var n=new ft(t);return i(n.H())})).next((function(){return e.store(br.store).Ss({Ds:!0},(function(t,e){t[0];var n=t[1],r=(t[2],En(n));return i(r.H())}))}))},t}();var yr=function(t,e){this.seconds=t,this.nanoseconds=e},mr=function(){function t(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}return t.store="owner",t.key="owner",t}();var gr=function(){function t(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}return t.store="mutationQueues",t.keyPath="userId",t}(),wr=function(){function t(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}return t.store="mutations",t.keyPath="batchId",t.userMutationsIndex="userMutationsIndex",t.userMutationsKeyPath=["userId","batchId"],t}();var br=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,wn(e)]},t.key=function(t,e,n){return[t,wn(e),n]},t.store="documentMutations",t.PLACEHOLDER=new t,t}();var _r=function(t,e){this.path=t,this.readTime=e},Er=function(t,e){this.path=t,this.version=e},Ir=function(){function t(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o}return t.store="remoteDocuments",t.readTimeIndex="readTimeIndex",t.readTimeIndexPath="readTime",t.collectionReadTimeIndex="collectionReadTimeIndex",t.collectionReadTimeIndexPath=["parentPath","readTime"],t}(),Tr=function(){function t(t){this.byteSize=t}return t.store="remoteDocumentGlobal",t.key="remoteDocumentGlobalKey",t}();var Sr=function(){function t(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s}return t.store="targets",t.keyPath="targetId",t.queryTargetsIndexName="queryTargetsIndex",t.queryTargetsKeyPath=["canonicalId","targetId"],t}(),Nr=function(){function t(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n,w(0===t==(void 0!==n),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")}return t.store="targetDocuments",t.keyPath=["targetId","path"],t.documentTargetsIndex="documentTargetsIndex",t.documentTargetsKeyPath=["path","targetId"],t}(),Ar=function(){function t(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}return t.key="targetGlobalKey",t.store="targetGlobal",t}(),Or=function(){function t(t,e){this.collectionId=t,this.parent=e}return t.store="collectionParents",t.keyPath=["collectionId","parent"],t}();function kr(t){t.createObjectStore(Nr.store,{keyPath:Nr.keyPath}).createIndex(Nr.documentTargetsIndex,Nr.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Sr.store,{keyPath:Sr.keyPath}).createIndex(Sr.queryTargetsIndexName,Sr.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ar.store)}var Rr=function(){function t(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}return t.store="clientMetadata",t.keyPath="clientId",t}();var Cr=[gr.store,wr.store,br.store,Ir.store,Sr.store,mr.store,Ar.store,Nr.store],Dr=s.__spreadArrays(Cr,[Rr.store]),Pr=s.__spreadArrays(Dr,[Tr.store]),xr=s.__spreadArrays(Pr,[Or.store]),Lr=function(){function t(){this.Oc=new pr}return t.prototype.Ls=function(t,e){var n=this;if(w(e.length%2==1,"Expected a collection path."),!this.Oc.has(e)){var r=e.X(),i=e.H();t.us((function(){n.Oc.add(e)}));var o={collectionId:r,parent:wn(i)};return Ur(t).put(o)}return On.resolve()},t.prototype.po=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[I(e),""],!1,!0);return Ur(t).Is(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(En(o.parent))}return n}))},t}();function Ur(t){return qr.ds(t,Or.store)}var Mr=function(){function t(t){this.Fc=t}return t.prototype.Dc=function(t){if(t.document)return this.Fc.Ke(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=dt.at(t.noDocument.path),n=this.Vc(t.noDocument.readTime);return new ee(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}if(t.unknownDocument){e=dt.at(t.unknownDocument.path),n=this.Vc(t.unknownDocument.version);return new ne(e,n)}return g("Unexpected DbRemoteDocument")},t.prototype.kc=function(t,e){var n=this.Ec(e),r=t.key.path.H().tt();if(t instanceof te){var i=t.proto?t.proto:this.Fc.ze(t),o=t.hasCommittedMutations;return new Ir(null,null,i,o,n,r)}if(t instanceof ee){var s=t.key.path.tt(),a=this.Uc(t.version);o=t.hasCommittedMutations;return new Ir(null,new _r(s,a),null,o,n,r)}if(t instanceof ne){s=t.key.path.tt();var u=this.Uc(t.version);return new Ir(new Er(s,u),null,null,!0,n,r)}return g("Unexpected MaybeDocument")},t.prototype.Ec=function(t){var e=t.M();return[e.seconds,e.nanoseconds]},t.prototype.Sc=function(t){var e=new ut(t[0],t[1]);return ct.L(e)},t.prototype.Uc=function(t){var e=t.M();return new yr(e.seconds,e.nanoseconds)},t.prototype.Vc=function(t){var e=new ut(t.seconds,t.nanoseconds);return ct.L(e)},t.prototype.js=function(t,e){var n=this,r=e.baseMutations.map((function(t){return n.Fc.ir(t)})),i=e.mutations.map((function(t){return n.Fc.ir(t)}));return new wr(t,e.batchId,e.En.toMillis(),r,i)},t.prototype.Bs=function(t){var e=this,n=(t.baseMutations||[]).map((function(t){return e.Fc.sr(t)})),r=t.mutations.map((function(t){return e.Fc.sr(t)})),i=ut.fromMillis(t.localWriteTimeMs);return new In(t.batchId,i,n,r)},t.prototype.xc=function(t){var e=[];return t.forEach((function(t){e.push(wn(t.path))})),e},t.prototype.jc=function(t){for(var e=Fe(),n=0,r=t;n<r.length;n++){var i=r[n];e=e.add(new dt(En(i)))}return e},t.prototype.dc=function(t){var e,n=this.Vc(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?this.Vc(t.lastLimboFreeSnapshotVersion):ct.MIN;return e=void 0!==t.query.documents?this.Fc.vr(t.query):this.Fc.br(t.query),new Ne(e,t.targetId,0,t.lastListenSequenceNumber,n,r,_e.fromBase64String(t.resumeToken))},t.prototype.vc=function(t){w(0===t.fi,"Only queries with purpose 0 may be stored, got "+t.fi);var e,n=this.Uc(t.li),r=this.Uc(t.lastLimboFreeSnapshotVersion);e=t.target.Nn()?this.Fc.dr(t.target):this.Fc.wr(t.target);var i=t.resumeToken.toBase64();return new Sr(t.targetId,t.target.canonicalId(),n,i,t.sequenceNumber,r,e)},t}();var jr="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",Fr=function(t){function e(e,n){var r=t.call(this)||this;return r.Xs=e,r.Zo=n,r}return s.__extends(e,t),e}(Cn),qr=function(){function t(e,n,r,i,o,s,a,u){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Lc=s,this.qc=u,this.Bc=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Mc=null,this.inForeground=!1,this.Qc=null,this.Gc=null,this.Wc=Number.NEGATIVE_INFINITY,this.zc=function(t){return Promise.resolve()},this.As=new Br(this,o),this.Kc=n+t.Hc,this.serializer=new Mr(a),this.document=i.document,this.Oo=new nr(this.As,this.serializer),this.Cs=new Lr,this.so=new ar(this.serializer,this.Cs),!i.window||!i.window.localStorage)throw new O(A.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=i.window,this.Jc=this.window.localStorage}return t.ds=function(t,e){if(t instanceof Fr)return Dn.ds(t.Xs,e);throw g("IndexedDbPersistence must use instances of IndexedDbTransaction")},t.Yc=function(e){return s.__awaiter(this,void 0,void 0,(function(){var n;return s.__generator(this,(function(r){switch(r.label){case 0:if(!t.cs())throw new O(A.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");return[4,(n=new t(e.allowTabSynchronization,e.persistenceKey,e.clientId,e.platform,e.Xc,e.Lc,e.serializer,e.qc)).start()];case 1:return r.sent(),[2,n]}}))}))},t.prototype.start=function(){var t=this;return w(!this.Co,"IndexedDbPersistence double-started!"),w(null!==this.window,"Expected 'window' to be defined"),Dn.hs(this.Kc,dr,new vr(this.serializer)).then((function(e){return t.$c=e,t.Zc()})).then((function(){return t.ta(),t.na(),t.ia(),t.$c.runTransaction("readonly-idempotent",[Ar.store],(function(t){return or(t)}))})).then((function(e){t.ea=new vn(e,t.qc)})).then((function(){t.Bc=!0})).catch((function(e){return t.$c&&t.$c.close(),Promise.reject(e)}))},t.prototype.ra=function(t){var e=this;return this.zc=function(n){return s.__awaiter(e,void 0,void 0,(function(){return s.__generator(this,(function(e){return this.Co?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.ua=function(t){var e=this;this.$c.vs((function(n){return s.__awaiter(e,void 0,void 0,(function(){return s.__generator(this,(function(e){switch(e.label){case 0:return null!==n.newVersion?[3,2]:[4,t()];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.yh=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Lc.$r((function(){return s.__awaiter(e,void 0,void 0,(function(){return s.__generator(this,(function(t){switch(t.label){case 0:return this.Co?[4,this.Zc()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.Zc=function(){var t=this;return this.$c.runTransaction("readwrite-idempotent",xr,(function(e){return Vr(e).put(new Rr(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.sa(e).next((function(e){e||(t.isPrimary=!1,t.Lc.$r((function(){return t.zc(!1)})))}))})).next((function(){return t.oa(e)})).next((function(n){return t.isPrimary&&!n?t.ha(e).next((function(){return!1})):!!n&&t.ca(e).next((function(){return!0}))}))})).catch((function(e){if(!t.allowTabSynchronization)throw e;return v("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Lc.$r((function(){return t.zc(e)})),t.isPrimary=e}))},t.prototype.sa=function(t){var e=this;return Gr(t).get(mr.key).next((function(t){return On.resolve(e.aa(t))}))},t.prototype.fa=function(t){return Vr(t).delete(this.clientId)},t.prototype.la=function(){return s.__awaiter(this,void 0,void 0,(function(){var e=this;return s.__generator(this,(function(n){switch(n.label){case 0:return!this.isPrimary||this.da(this.Wc,18e5)?[3,2]:(this.Wc=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary-idempotent",(function(n){var r=t.ds(n,Rr.store);return r.Is().next((function(t){var n=e.va(t,18e5),i=t.filter((function(t){return-1===n.indexOf(t)}));return On.forEach(i,(function(t){return r.delete(t.clientId)})).next((function(){return i}))}))})).catch((function(){return[]}))]);case 1:n.sent().forEach((function(t){e.window.localStorage.removeItem(e.wa(t.clientId))})),n.label=2;case 2:return[2]}}))}))},t.prototype.ia=function(){var t=this;this.Gc=this.Lc.fu("client_metadata_refresh",4e3,(function(){return t.Zc().then((function(){return t.la()})).then((function(){return t.ia()}))}))},t.prototype.aa=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.oa=function(t){var e=this;return Gr(t).get(mr.key).next((function(n){if(null!==n&&e.da(n.leaseTimestampMs,5e3)&&!e.ma(n.ownerId)){if(e.aa(n)&&e.networkEnabled)return!0;if(!e.aa(n)){if(!n.allowTabSynchronization)throw new O(A.FAILED_PRECONDITION,jr);return!1}}return!(!e.networkEnabled||!e.inForeground)||Vr(t).Is().next((function(t){return void 0===e.va(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&v("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return s.__awaiter(this,void 0,void 0,(function(){var t=this;return s.__generator(this,(function(e){switch(e.label){case 0:return this.Bc=!1,this.pa(),this.Gc&&(this.Gc.cancel(),this.Gc=null),this.ga(),this.ba(),[4,this.$c.runTransaction("readwrite-idempotent",[mr.store,Rr.store],(function(e){return t.ha(e).next((function(){return t.fa(e)}))}))];case 1:return e.sent(),this.$c.close(),this.ya(),[2]}}))}))},t.prototype.va=function(t,e){var n=this;return t.filter((function(t){return n.da(t.updateTimeMs,e)&&!n.ma(t.clientId)}))},t.prototype.gh=function(){var t=this;return this.$c.runTransaction("readonly-idempotent",[Rr.store],(function(e){return Vr(e).Is().next((function(e){return t.va(e,18e5).map((function(t){return t.clientId}))}))}))},t.clearPersistence=function(e){return s.__awaiter(this,void 0,void 0,(function(){var n;return s.__generator(this,(function(r){switch(r.label){case 0:return t.cs()?(n=e+t.Hc,[4,Dn.delete(n)]):[2,Promise.resolve()];case 1:return r.sent(),[2]}}))}))},Object.defineProperty(t.prototype,"Co",{get:function(){return this.Bc},enumerable:!0,configurable:!0}),t.prototype.Po=function(t){return w(this.Co,"Cannot initialize MutationQueue before persistence is started."),Fn.ks(t,this.serializer,this.Cs,this.As)},t.prototype.Fo=function(){return w(this.Co,"Cannot initialize TargetCache before persistence is started."),this.Oo},t.prototype.No=function(){return w(this.Co,"Cannot initialize RemoteDocumentCache before persistence is started."),this.so},t.prototype.Uo=function(){return w(this.Co,"Cannot initialize IndexManager before persistence is started."),this.Cs},t.prototype.runTransaction=function(t,e,n){var r=this;v("IndexedDbPersistence","Starting transaction:",t);var i,o=e.endsWith("idempotent"),s=e.startsWith("readonly")?o?"readonly-idempotent":"readonly":o?"readwrite-idempotent":"readwrite";return this.$c.runTransaction(s,xr,(function(o){return i=new Fr(o,r.ea.next()),"readwrite-primary"===e||"readwrite-primary-idempotent"===e?r.sa(o).next((function(t){return!!t||r.oa(o)})).next((function(e){if(!e)throw y("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Lc.$r((function(){return r.zc(!1)})),new O(A.FAILED_PRECONDITION,Rn);return n(i)})).next((function(t){return r.ca(o).next((function(){return t}))})):r._a(o).next((function(){return n(i)}))})).then((function(t){return i.ss(),t}))},t.prototype._a=function(t){var e=this;return Gr(t).get(mr.key).next((function(t){if(null!==t&&e.da(t.leaseTimestampMs,5e3)&&!e.ma(t.ownerId)&&!e.aa(t)&&!t.allowTabSynchronization)throw new O(A.FAILED_PRECONDITION,jr)}))},t.prototype.ca=function(t){var e=new mr(this.clientId,this.allowTabSynchronization,Date.now());return Gr(t).put(mr.key,e)},t.cs=function(){return Dn.cs()},t.Ia=function(t){var e=t.s.projectId;return t.s.o||(e+="."+t.s.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.ha=function(t){var e=this,n=Gr(t);return n.get(mr.key).next((function(t){return e.aa(t)?(v("IndexedDbPersistence","Releasing primary lease."),n.delete(mr.key)):On.resolve()}))},t.prototype.da=function(t,e){var n=Date.now();return!(t<n-e)&&(!(t>n)||(y("Detected an update time that is in the future: "+t+" > "+n),!1))},t.prototype.ta=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Qc=function(){t.Lc.$r((function(){return t.inForeground="visible"===t.document.visibilityState,t.Zc()}))},this.document.addEventListener("visibilitychange",this.Qc),this.inForeground="visible"===this.document.visibilityState)},t.prototype.ga=function(){this.Qc&&(w(null!==this.document&&"function"==typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.Qc),this.Qc=null)},t.prototype.na=function(){var t=this;"function"==typeof this.window.addEventListener&&(this.Mc=function(){t.pa(),t.Lc.$r((function(){return t.shutdown()}))},this.window.addEventListener("unload",this.Mc))},t.prototype.ba=function(){this.Mc&&(w("function"==typeof this.window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.Mc),this.Mc=null)},t.prototype.ma=function(t){try{var e=null!==this.Jc.getItem(this.wa(t));return v("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return y("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.pa=function(){try{this.Jc.setItem(this.wa(this.clientId),String(Date.now()))}catch(t){y("Failed to set zombie client id.",t)}},t.prototype.ya=function(){try{this.Jc.removeItem(this.wa(this.clientId))}catch(t){}},t.prototype.wa=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t.Hc="main",t}();function Gr(t){return t.store(mr.store)}function Vr(t){return t.store(Rr.store)}var Br=function(){function t(t,e){this.db=t,this.Ta=null,this.Wh=new er(this,e)}return t.prototype.$h=function(t){var e=this.Ea(t);return this.db.Fo().wc(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.Ea=function(t){var e=0;return this.tc(t,(function(t){e++})).next((function(){return e}))},t.prototype.ce=function(t,e){return this.db.Fo().ce(t,e)},t.prototype.tc=function(t,e){return this.Da(t,(function(t,n){return e(n)}))},t.prototype.Ao=function(t){this.Ta=t},t.prototype.Du=function(t,e){return zr(t,e)},t.prototype.Ru=function(t,e){return zr(t,e)},t.prototype.nc=function(t,e,n){return this.db.Fo().nc(t,e,n)},t.prototype.Zs=function(t,e){return zr(t,e)},t.prototype.Sa=function(t,e){return this.Ta.Ou(e)?On.resolve(!0):function(t,e){var n=!1;return zn(t).Rs((function(r){return qn(t,r,e).next((function(t){return t&&(n=!0),On.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.ic=function(t,e){var n=this,r=this.db.No().Wo(),i=[],o=0;return this.Da(t,(function(s,a){if(a<=e){var u=n.Sa(t,s).next((function(e){if(!e)return o++,r.Zu(t,s).next((function(){return r.$u(s),sr(t).delete([0,wn(s.path)])}))}));i.push(u)}})).next((function(){return On.Wu(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.di(t.Zo);return this.db.Fo().nh(t,n)},t.prototype.ih=function(t,e){return zr(t,e)},t.prototype.Da=function(t,e){var n,r=sr(t),i=vn.Mr;return r.Ss({index:Nr.documentTargetsIndex},(function(t,r){var o=t[0],s=(t[1],r.path),a=r.sequenceNumber;0===o?(i!==vn.Mr&&e(new dt(En(n)),i),i=a,n=s):i=vn.Mr})).next((function(){i!==vn.Mr&&e(new dt(En(n)),i)}))},t.prototype.ec=function(t){return this.db.No().Cc(t)},t}();function zr(t,e){return sr(t).put(function(t,e){return new Nr(0,wn(t.path),e)}(e,t.Zo))}var Hr=function(){function t(){}return t.prototype.xo=function(t){this.Ra=t},t.prototype.do=function(t,e,n,r){var i=this;return w(void 0!==this.Ra,"setLocalDocumentsView() not called"),e.Jn()||n.isEqual(ct.MIN)?this.Ca(t,e):this.Ra.fo(t,r).next((function(o){var s=i.Aa(e,o);return(e.ii()||e.ei())&&i.Pa(e.Fn,s,r,n)?i.Ca(t,e):(p()<=0&&v("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),e.toString()),i.Ra.do(t,e,n).next((function(t){return s.forEach((function(e){t=t.lt(e.key,e)})),t})))}))},t.prototype.Aa=function(t,e){var n=new wt((function(e,n){return t.Xn(e,n)}));return e.forEach((function(e,r){r instanceof te&&t.matches(r)&&(n=n.add(r))})),n},t.prototype.Pa=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.h(r)>0)},t.prototype.Ca=function(t,e){return p()<=0&&v("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.Ra.do(t,e,ct.MIN)},t}(),Wr=function(){function t(t,e){this.Cs=t,this.As=e,this.oo=[],this.ka=1,this.lastStreamToken=_e.ai,this.Na=new wt(Nn.Sn)}return t.prototype.Ns=function(t){return On.resolve(0===this.oo.length)},t.prototype.Os=function(t,e,n){var r=e.batchId,i=this.Oa(r,"acknowledged");w(0===i,"Can only acknowledge the first batch in the mutation queue");var o=this.oo[i];return w(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),this.lastStreamToken=n,On.resolve()},t.prototype.Vs=function(t){return On.resolve(this.lastStreamToken)},t.prototype.Us=function(t,e){return this.lastStreamToken=e,On.resolve()},t.prototype.xs=function(t,e,n,r){w(0!==r.length,"Mutation batches should not be empty");var i=this.ka;(this.ka++,this.oo.length>0)&&w(this.oo[this.oo.length-1].batchId<i,"Mutation batchIDs must be monotonically increasing order");var o=new In(i,e,n,r);this.oo.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.Na=this.Na.add(new Nn(u.key,i)),this.Cs.Ls(t,u.key.path.H())}return On.resolve(o)},t.prototype.qs=function(t,e){return On.resolve(this.Fa(e))},t.prototype.Ms=function(t,e){var n=this.Fa(e);return w(null!=n,"Failed to find local mutation batch."),On.resolve(n.keys())},t.prototype.Qs=function(t,e){var n=e+1,r=this.Va(n),i=r<0?0:r;return On.resolve(this.oo.length>i?this.oo[i]:null)},t.prototype.Gs=function(){return On.resolve(0===this.oo.length?-1:this.ka-1)},t.prototype.Ws=function(t){return On.resolve(this.oo.slice())},t.prototype.zs=function(t,e){var n=this,r=new Nn(e,0),i=new Nn(e,Number.POSITIVE_INFINITY),o=[];return this.Na.Lt([r,i],(function(t){w(e.isEqual(t.key),"Should only iterate over a single key's batches");var r=n.Fa(t.Fu);w(null!==r,"Batches in the index must exist in the main table"),o.push(r)})),On.resolve(o)},t.prototype.Ks=function(t,e){var n=this,r=new wt(_);return e.forEach((function(t){var e=new Nn(t,0),i=new Nn(t,Number.POSITIVE_INFINITY);n.Na.Lt([e,i],(function(e){w(t.isEqual(e.key),"For each key, should only iterate over a single key's batches"),r=r.add(e.Fu)}))})),On.resolve(this.Ua(r))},t.prototype.Js=function(t,e){w(!e.ui(),"CollectionGroup queries should be handled in LocalDocumentsView");var n=e.path,r=n.length+1,i=n;dt.ht(i)||(i=i.child(""));var o=new Nn(new dt(i),0),s=new wt(_);return this.Na.qt((function(t){var e=t.key.path;return!!n.$(e)&&(e.length===r&&(s=s.add(t.Fu)),!0)}),o),On.resolve(this.Ua(s))},t.prototype.Ua=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.Fa(t);null!==r&&n.push(r)})),n},t.prototype.Ys=function(t,e){var n=this;w(0===this.Oa(e.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.oo.shift();var r=this.Na;return On.forEach(e.mutations,(function(i){var o=new Nn(i.key,e.batchId);return r=r.delete(o),n.As.Zs(t,i.key)})).next((function(){n.Na=r}))},t.prototype.$s=function(t){},t.prototype.Ou=function(t,e){var n=new Nn(e,0),r=this.Na.Bt(n);return On.resolve(e.isEqual(r&&r.key))},t.prototype.to=function(t){return 0===this.oo.length&&w(this.Na.J(),"Document leak -- detected dangling mutation references when queue is empty."),On.resolve()},t.prototype.Oa=function(t,e){var n=this.Va(t);return w(n>=0&&n<this.oo.length,"Batches must exist to be "+e),n},t.prototype.Va=function(t){return 0===this.oo.length?0:t-this.oo[0].batchId},t.prototype.Fa=function(t){var e=this.Va(t);if(e<0||e>=this.oo.length)return null;var n=this.oo[e];return w(n.batchId===t,"If found batch must match"),n},t}();var Kr=function(){function t(t,e){this.Cs=t,this.xa=e,this.docs=new vt(dt.G),this.size=0}return t.prototype.Yu=function(t,e,n){w(!n.isEqual(ct.MIN),"Cannot add a document with a read time of zero");var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.xa(e);return this.docs=this.docs.lt(r,{bc:e,size:s,readTime:n}),this.size+=s-o,this.Cs.Ls(t,r.path.H())},t.prototype.$u=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Zu=function(t,e){var n=this.docs.get(e);return On.resolve(n?n.bc:null)},t.prototype.getEntries=function(t,e){var n=this,r=Pe();return e.forEach((function(t){var e=n.docs.get(t);r=r.lt(t,e?e.bc:null)})),On.resolve(r)},t.prototype.do=function(t,e,n){w(!e.ui(),"CollectionGroup queries should be handled in LocalDocumentsView");for(var r=Le(),i=new dt(e.path.child("")),o=this.docs.yt(i);o.St();){var s=o.Dt(),a=s.key,u=s.value,c=u.bc,h=u.readTime;if(!e.path.$(a.path))break;h.h(n)<=0||c instanceof te&&e.matches(c)&&(r=r.lt(c.key,c))}return On.resolve(r)},t.prototype.ja=function(t,e){return On.forEach(this.docs,(function(t){return e(t)}))},t.prototype.Eh=function(t,e){throw new Error("getNewDocumentChanges() is not supported with MemoryPersistence")},t.prototype.Sh=function(t){return On.resolve(ct.MIN)},t.prototype.Wo=function(e){return new t.Rc(this)},t.prototype.Cc=function(t){return On.resolve(this.size)},t.Rc=function(t){function e(e){var n=t.call(this)||this;return n.Ac=e,n}return s.__extends(e,t),e.prototype.es=function(t){var e=this,n=[];return this.Ku.forEach((function(r,i){i?n.push(e.Ac.Yu(t,i,e.readTime)):e.Ac.$u(r)})),On.Wu(n)},e.prototype.ts=function(t,e){return this.Ac.Zu(t,e)},e.prototype.ns=function(t,e){return this.Ac.getEntries(t,e)},e}(kn),t}(),Qr=function(){function t(t){this.persistence=t,this.La=new An((function(t){return t.canonicalId()})),this.lastRemoteSnapshotVersion=ct.MIN,this.highestTargetId=0,this.qa=0,this.Ba=new Sn,this.targetCount=0,this.uc=Hn.ro()}return t.prototype.ce=function(t,e){return this.La.forEach((function(t,n){return e(n)})),On.resolve()},t.prototype.Jo=function(t){return On.resolve(this.lastRemoteSnapshotVersion)},t.prototype.hc=function(t){return On.resolve(this.qa)},t.prototype.fh=function(t){var e=this.uc.after(this.highestTargetId);return this.highestTargetId=e,On.resolve(e)},t.prototype.eh=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.qa&&(this.qa=e),On.resolve()},t.prototype.cc=function(t){this.La.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.highestTargetId=e),t.sequenceNumber>this.qa&&(this.qa=t.sequenceNumber)},t.prototype.lh=function(t,e){return w(!this.La.has(e.target),"Adding a target that already exists"),this.cc(e),this.targetCount+=1,On.resolve()},t.prototype.nh=function(t,e){return w(this.La.has(e.target),"Updating a non-existent target"),this.cc(e),On.resolve()},t.prototype.fc=function(t,e){return w(this.targetCount>0,"Removing a target from an empty cache"),w(this.La.has(e.target),"Removing a non-existent target from the cache"),this.La.delete(e.target),this.Ba.Pu(e.targetId),this.targetCount-=1,On.resolve()},t.prototype.nc=function(t,e,n){var r=this,i=0,o=[];return this.La.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.La.delete(s),o.push(r.lc(t,a.targetId)),i++)})),On.Wu(o).next((function(){return i}))},t.prototype.wc=function(t){return On.resolve(this.targetCount)},t.prototype.ah=function(t,e){var n=this.La.get(e)||null;return On.resolve(n)},t.prototype.ye=function(t,e){return g("Not yet implemented.")},t.prototype.$o=function(t,e,n){this.Ba.Su(e,n);var r=this.persistence.As,i=[];return r&&e.forEach((function(e){i.push(r.Du(t,e))})),On.Wu(i)},t.prototype.Xo=function(t,e,n){this.Ba.Au(e,n);var r=this.persistence.As,i=[];return r&&e.forEach((function(e){i.push(r.Ru(t,e))})),On.Wu(i)},t.prototype.lc=function(t,e){return this.Ba.Pu(e),On.resolve()},t.prototype.wh=function(t,e){var n=this.Ba.Nu(e);return On.resolve(n)},t.prototype.Ou=function(t,e){return On.resolve(this.Ba.Ou(e))},t}(),Yr=function(){function t(t,e){var n=this;this.clientId=t,this.Ma={},this.ea=new vn(0),this.Bc=!1,this.Bc=!0,this.As=e(this),this.Oo=new Qr(this);this.Cs=new lr,this.so=new Kr(this.Cs,(function(t){return n.As.Qa(t)}))}return t.Ga=function(e,n){return new t(e,(function(t){return new $r(t,n)}))},t.Wa=function(e){return new t(e,(function(t){return new Xr(t)}))},t.prototype.shutdown=function(){return this.Bc=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Co",{get:function(){return this.Bc},enumerable:!0,configurable:!0}),t.prototype.gh=function(){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(t){return[2,[this.clientId]]}))}))},t.prototype.ra=function(t){return t(!0)},t.prototype.ua=function(){},t.prototype.yh=function(t){},t.prototype.Uo=function(){return this.Cs},t.prototype.Po=function(t){var e=this.Ma[t.v()];return e||(e=new Wr(this.Cs,this.As),this.Ma[t.v()]=e),e},t.prototype.Fo=function(){return this.Oo},t.prototype.No=function(){return this.so},t.prototype.runTransaction=function(t,e,n){var r=this;v("MemoryPersistence","Starting transaction:",t);var i=new Jr(this.ea.next());return this.As.za(),n(i).next((function(t){return r.As.Ka(i).next((function(){return t}))})).Qu().then((function(t){return i.ss(),t}))},t.prototype.Ha=function(t,e){return On.zu((n=this.Ma,r=[],j(n,(function(t,e){return r.push(e)})),r).map((function(n){return function(){return n.Ou(t,e)}})));var n,r},t}(),Jr=function(t){function e(e){var n=t.call(this)||this;return n.Zo=e,n}return s.__extends(e,t),e}(Cn),Xr=function(){function t(t){this.persistence=t,this.Ta=null,this.Ja=null}return Object.defineProperty(t.prototype,"Ya",{get:function(){if(this.Ja)return this.Ja;throw g("orphanedDocuments is only valid during a transaction.")},enumerable:!0,configurable:!0}),t.prototype.Ao=function(t){this.Ta=t},t.prototype.Du=function(t,e){return this.Ya.delete(e),On.resolve()},t.prototype.Ru=function(t,e){return this.Ya.add(e),On.resolve()},t.prototype.Zs=function(t,e){return this.Ya.add(e),On.resolve()},t.prototype.removeTarget=function(t,e){var n=this,r=this.persistence.Fo();return r.wh(t,e.targetId).next((function(t){t.forEach((function(t){return n.Ya.add(t)}))})).next((function(){return r.fc(t,e)}))},t.prototype.za=function(){this.Ja=new Set},t.prototype.Ka=function(t){var e=this,n=this.persistence.No().Wo();return On.forEach(this.Ya,(function(r){return e.Xa(t,r).next((function(t){t||n.$u(r)}))})).next((function(){return e.Ja=null,n.apply(t)}))},t.prototype.ih=function(t,e){var n=this;return this.Xa(t,e).next((function(t){t?n.Ya.delete(e):n.Ya.add(e)}))},t.prototype.Qa=function(t){return 0},t.prototype.Xa=function(t,e){var n=this;return On.zu([function(){return n.persistence.Fo().Ou(t,e)},function(){return n.persistence.Ha(t,e)},function(){return On.resolve(n.Ta.Ou(e))}])},t}(),$r=function(){function t(t,e){this.persistence=t,this.Ta=null,this.$a=new An((function(t){return wn(t.path)})),this.Wh=new er(this,e)}return t.prototype.za=function(){},t.prototype.Ka=function(t){return On.resolve()},t.prototype.ce=function(t,e){return this.persistence.Fo().ce(t,e)},t.prototype.$h=function(t){var e=this.Za(t);return this.persistence.Fo().wc(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.Za=function(t){var e=0;return this.tc(t,(function(t){e++})).next((function(){return e}))},t.prototype.tc=function(t,e){var n=this;return On.forEach(this.$a,(function(r,i){return n.Sa(t,r,i).next((function(t){return t?On.resolve():e(i)}))}))},t.prototype.Ao=function(t){this.Ta=t},t.prototype.nc=function(t,e,n){return this.persistence.Fo().nc(t,e,n)},t.prototype.ic=function(t,e){var n=this,r=0,i=this.persistence.No(),o=i.Wo();return i.ja(t,(function(i){return n.Sa(t,i,e).next((function(t){t||(r++,o.$u(i))}))})).next((function(){return o.apply(t)})).next((function(){return r}))},t.prototype.Zs=function(t,e){return this.$a.set(e,t.Zo),On.resolve()},t.prototype.removeTarget=function(t,e){var n=e.di(t.Zo);return this.persistence.Fo().nh(t,n)},t.prototype.Du=function(t,e){return this.$a.set(e,t.Zo),On.resolve()},t.prototype.Ru=function(t,e){return this.$a.set(e,t.Zo),On.resolve()},t.prototype.ih=function(t,e){return this.$a.set(e,t.Zo),On.resolve()},t.prototype.Qa=function(t){var e=t.key.toString().length;return t instanceof te&&(e+=t.data().bn()),e},t.prototype.Sa=function(t,e,n){var r=this;return On.zu([function(){return r.persistence.Ha(t,e)},function(){return On.resolve(r.Ta.Ou(e))},function(){return r.persistence.Fo().Ou(t,e)},function(){var t=r.$a.get(e);return On.resolve(void 0!==t&&t>n)}])},t.prototype.ec=function(t){return this.persistence.No().Cc(t)},t}(),Zr=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Lc=t,this.Gr=e,this.tf=n,this.nf=r,this.if=i,this.ef=0,this.rf=null,this.uf=Date.now(),this.reset()}return t.prototype.reset=function(){this.ef=0},t.prototype.sf=function(){this.ef=this.if},t.prototype.hf=function(t){var e=this;this.cancel();var n=Math.floor(this.ef+this.cf()),r=Math.max(0,Date.now()-this.uf),i=Math.max(0,n-r);this.ef>0&&v("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.ef+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.rf=this.Lc.fu(this.Gr,i,(function(){return e.uf=Date.now(),t()})),this.ef*=this.nf,this.ef<this.tf&&(this.ef=this.tf),this.ef>this.if&&(this.ef=this.if)},t.prototype.cancel=function(){null!==this.rf&&(this.rf.cancel(),this.rf=null)},t.prototype.cf=function(){return(Math.random()-.5)*this.ef},t}(),ti=function(){function t(t,e,n,r,i,o){this.Lc=t,this.af=n,this.connection=r,this.ff=i,this.listener=o,this.state=0,this.lf=0,this.df=null,this.stream=null,this.vf=new Zr(t,e)}return t.prototype.wf=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.mf=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?(w(0===this.state,"Already started"),this.auth()):this.pf()},t.prototype.stop=function(){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(t){switch(t.label){case 0:return this.wf()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.gf=function(){w(!this.wf(),"Can only inhibit backoff in a stopped state"),this.state=0,this.vf.reset()},t.prototype.bf=function(){var t=this;this.mf()&&null===this.df&&(this.df=this.Lc.fu(this.af,6e4,(function(){return t.yf()})))},t.prototype._f=function(t){this.If(),this.stream.send(t)},t.prototype.yf=function(){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(t){return this.mf()?[2,this.close(0)]:[2]}))}))},t.prototype.If=function(){this.df&&(this.df.cancel(),this.df=null)},t.prototype.close=function(t,e){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(n){switch(n.label){case 0:return w(this.wf(),"Only started streams should be closed."),w(3===t||re(e),"Can't provide an error when not in an error state."),this.If(),this.vf.cancel(),this.lf++,3!==t?this.vf.reset():e&&e.code===A.RESOURCE_EXHAUSTED?(y(e.toString()),y("Using maximum backoff delay to prevent overloading the backend."),this.vf.sf()):e&&e.code===A.UNAUTHENTICATED&&this.ff.I(),null!==this.stream&&(this.Tf(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ef(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.Tf=function(){},t.prototype.auth=function(){var t=this;w(0===this.state,"Must be in initial state to auth"),this.state=1;var e=this.Df(this.lf),n=this.lf;this.ff.getToken().then((function(e){t.lf===n&&t.Sf(e)}),(function(n){e((function(){var e=new O(A.UNKNOWN,"Fetching auth token failed: "+n.message);return t.Rf(e)}))}))},t.prototype.Sf=function(t){var e=this;w(1===this.state,"Trying to start stream in a non-starting state");var n=this.Df(this.lf);this.stream=this.Cf(t),this.stream.Af((function(){n((function(){return w(1===e.state,"Expected stream to be in state Starting, but was "+e.state),e.state=2,e.listener.Af()}))})),this.stream.Ef((function(t){n((function(){return e.Rf(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.pf=function(){var t=this;w(3===this.state,"Should only perform backoff when in Error state"),this.state=4,this.vf.hf((function(){return s.__awaiter(t,void 0,void 0,(function(){return s.__generator(this,(function(t){return w(4===this.state,"Backoff elapsed but state is now: "+this.state),this.state=0,this.start(),w(this.wf(),"PersistentStream should have started"),[2]}))}))}))},t.prototype.Rf=function(t){return w(this.wf(),"Can't handle server close on non-started stream"),v("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.Df=function(t){var e=this;return function(n){e.Lc.$r((function(){return e.lf===t?n():(v("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),ei=function(t){function e(e,n,r,i,o){var s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this;return s.serializer=i,s}return s.__extends(e,t),e.prototype.Cf=function(t){return this.connection.Pf("Listen",t)},e.prototype.onMessage=function(t){this.vf.reset();var e=this.serializer.Ze(t),n=this.serializer.nr(t);return this.listener.kf(e,n)},e.prototype.watch=function(t){var e={};e.database=this.serializer.je,e.addTarget=this.serializer.Yn(t);var n=this.serializer.Tr(t);n&&(e.labels=n),this._f(e)},e.prototype.Nf=function(t){var e={};e.database=this.serializer.je,e.removeTarget=t,this._f(e)},e}(ti),ni=function(t){function e(e,n,r,i,o){var s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this;return s.serializer=i,s.Of=!1,s.lastStreamToken=_e.ai,s}return s.__extends(e,t),Object.defineProperty(e.prototype,"Ff",{get:function(){return this.Of},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.Of=!1,t.prototype.start.call(this)},e.prototype.Tf=function(){this.Of&&this.Vf([])},e.prototype.Cf=function(t){return this.connection.Pf("Write",t)},e.prototype.onMessage=function(t){if(w(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=this.serializer.Re(t.streamToken),this.Of){this.vf.reset();var e=this.serializer.lr(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.Uf(n,e)}return w(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.Of=!0,this.listener.xf()},e.prototype.jf=function(){w(this.mf(),"Writing handshake requires an opened stream"),w(!this.Of,"Handshake already completed");var t={};t.database=this.serializer.je,this._f(t)},e.prototype.Vf=function(t){var e=this;w(this.mf(),"Writing mutations requires an opened stream"),w(this.Of,"Handshake must be complete before writing mutations"),w(this.lastStreamToken.bn()>0,"Trying to write mutation without a token");var n={streamToken:this.serializer.Se(this.lastStreamToken),writes:t.map((function(t){return e.serializer.ir(t)}))};this._f(n)},e}(ti),ri=function(){function t(t,e,n,r){this.Lc=t,this.connection=e,this.credentials=n,this.serializer=r}return t.prototype.Lf=function(t){return new ni(this.Lc,this.connection,this.credentials,this.serializer,t)},t.prototype.qf=function(t){return new ei(this.Lc,this.connection,this.credentials,this.serializer,t)},t.prototype.commit=function(t){var e=this,n={database:this.serializer.je,writes:t.map((function(t){return e.serializer.ir(t)}))};return this.Bf("Commit",n).then((function(t){return e.serializer.lr(t.writeResults,t.commitTime)}))},t.prototype.lookup=function(t){var e=this,n={database:this.serializer.je,documents:t.map((function(t){return e.serializer.Oe(t)}))};return this.Mf("BatchGetDocuments",n).then((function(n){var r=De();n.forEach((function(t){var n=e.serializer.Ye(t);r=r.lt(n.key,n)}));var i=[];return t.forEach((function(t){var e=r.get(t);w(!!e,"Missing entity in write response for "+t),i.push(e)})),i}))},t.prototype.Bf=function(t,e){var n=this;return this.credentials.getToken().then((function(r){return n.connection.Bf(t,e,r)})).catch((function(t){throw t.code===A.UNAUTHENTICATED&&n.credentials.I(),t}))},t.prototype.Mf=function(t,e){var n=this;return this.credentials.getToken().then((function(r){return n.connection.Mf(t,e,r)})).catch((function(t){throw t.code===A.UNAUTHENTICATED&&n.credentials.I(),t}))},t}(),ii=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];z("FieldPath",t,"fieldNames",1);for(var n=0;n<t.length;++n)if(H("FieldPath","string",n,t[n]),0===t[n].length)throw new O(A.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Qf=new pt(t)}return t.documentId=function(){return t.Gf},t.prototype.isEqual=function(e){if(!(e instanceof t))throw rt("isEqual","FieldPath",1,e);return this.Qf.isEqual(e.Qf)},t.Gf=new t(pt.st().nt()),t}(),oi=new RegExp("[~\\*/\\[\\]]");var si=function(){function t(t){this.Wf=t}return t.delete=function(){return q("FieldValue.delete",arguments),ai.instance},t.serverTimestamp=function(){return q("FieldValue.serverTimestamp",arguments),ui.instance},t.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return V("FieldValue.arrayUnion",arguments,1),new ci(t)},t.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return V("FieldValue.arrayRemove",arguments,1),new hi(t)},t.increment=function(t){return H("FieldValue.increment","number",1,t),G("FieldValue.increment",arguments,1),new fi(t)},t.prototype.isEqual=function(t){return this===t},t}(),ai=function(t){function e(){return t.call(this,"FieldValue.delete")||this}return s.__extends(e,t),e.instance=new e,e}(si),ui=function(t){function e(){return t.call(this,"FieldValue.serverTimestamp")||this}return s.__extends(e,t),e.instance=new e,e}(si),ci=function(t){function e(e){var n=t.call(this,"FieldValue.arrayUnion")||this;return n.zf=e,n}return s.__extends(e,t),e}(si),hi=function(t){function e(e){var n=t.call(this,"FieldValue.arrayRemove")||this;return n.zf=e,n}return s.__extends(e,t),e}(si),fi=function(t){function e(e){var n=t.call(this,"FieldValue.increment")||this;return n.Kf=e,n}return s.__extends(e,t),e}(si),li=hn(si,"Use FieldValue.<field>() instead."),pi=/^__.*__$/,di=function(){function t(t,e,n){this.data=t,this.un=e,this.fieldTransforms=n}return t.prototype.Hf=function(t,e){var n=[];return null!==this.un?n.push(new Dt(t,this.data,this.un,e)):n.push(new Ct(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Pt(t,this.fieldTransforms)),n},t}(),vi=function(){function t(t,e,n){this.data=t,this.un=e,this.fieldTransforms=n}return t.prototype.Hf=function(t,e){var n=[new Dt(t,this.data,this.un,e)];return this.fieldTransforms.length>0&&n.push(new Pt(t,this.fieldTransforms)),n},t}();function yi(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw g("Unexpected case for UserDataSource: "+t)}}var mi=function(){function t(t,e,n,r,i,o){this.Jf=t,this.methodName=e,this.path=n,this.Yf=r,void 0===i&&this.Xf(),this.Yf=void 0!==r&&r,this.fieldTransforms=i||[],this.un=o||[]}return t.prototype.$f=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.Jf,this.methodName,n,!1,this.fieldTransforms,this.un);return r.Zf(e),r},t.prototype.tl=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.Jf,this.methodName,n,!1,this.fieldTransforms,this.un);return r.Xf(),r},t.prototype.nl=function(e){return new t(this.Jf,this.methodName,null,!0,this.fieldTransforms,this.un)},t.prototype.il=function(t){var e=null===this.path||this.path.J()?"":" (found in field "+this.path.toString()+")";return new O(A.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},t.prototype.contains=function(t){return void 0!==this.un.find((function(e){return t.$(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.$(e.field)}))},t.prototype.Xf=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.Zf(this.path.get(t))},t.prototype.Zf=function(t){if(0===t.length)throw this.il("Document fields must not be empty");if(yi(this.Jf)&&pi.test(t))throw this.il('Document fields cannot begin and end with "__"')},t}(),gi=function(t,e){this.s=t,this.key=e},wi=function(){function t(t){this.el=t}return t.prototype.rl=function(t,e){var n=new mi(0,t,pt.et);_i("Data must be an object, but it was:",n,e);var r=this.ul(e,n);return new di(r,null,n.fieldTransforms)},t.prototype.sl=function(t,e,n){var r=new mi(2,t,pt.et);_i("Data must be an object, but it was:",r,e);var i,o,s=this.ul(e,r);if(n){for(var a=new wt(pt.G),u=0,c=n;u<c.length;u++){var h=c[u],f=void 0;if(h instanceof ii)f=h.Qf;else{if("string"!=typeof h)throw g("Expected stringOrFieldPath to be a string or a FieldPath");f=Ii(t,h)}if(!r.contains(f))throw new O(A.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");a=a.add(f)}i=Nt.Jt(a),o=r.fieldTransforms.filter((function(t){return i.Xt(t.field)}))}else i=Nt.Yt(r.un),o=r.fieldTransforms;return new di(s,i,o)},t.prototype.ol=function(t,e){var n=this,r=new mi(1,t,pt.et);_i("Data must be an object, but it was:",r,e);var i=new wt(pt.G),o=Jt.vn();j(e,(function(e,s){var a=Ii(t,e),u=r.tl(a);if((s=n.hl(s,u))instanceof ai)i=i.add(a);else{var c=n.ul(s,u);null!=c&&(i=i.add(a),o.set(a,c))}}));var s=Nt.Jt(i);return new vi(o.cn(),s,r.fieldTransforms)},t.prototype.cl=function(t,e,n,r){var i=new mi(1,t,pt.et),o=[Ei(t,e)],s=[n];if(r.length%2!=0)throw new O(A.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var a=0;a<r.length;a+=2)o.push(Ei(t,r[a])),s.push(r[a+1]);var u=new wt(pt.G),c=Jt.vn();for(a=0;a<o.length;++a){var h=o[a],f=i.tl(h),l=this.hl(s[a],f);if(l instanceof ai)u=u.add(h);else{var p=this.ul(l,f);null!=p&&(u=u.add(h),c.set(h,p))}}var d=Nt.Jt(u);return new vi(c.cn(),d,i.fieldTransforms)},t.prototype.al=function(t,e,n){void 0===n&&(n=!1);var r=new mi(n?4:3,t,pt.et),i=this.ul(e,r);return w(null!=i,"Parsed data should not be null."),w(0===r.fieldTransforms.length,"Field transforms should have been disallowed."),i},t.prototype.hl=function(t,e){try{return this.el(t)}catch(t){var n=Ti(t);throw e.il(n)}},t.prototype.ul=function(t,e){if(bi(t=this.hl(t,e)))return _i("Unsupported field value:",e,t),this.fl(t,e);if(t instanceof si)return this.ll(t,e),null;if(e.path&&e.un.push(e.path),t instanceof Array){if(e.Yf&&4!==e.Jf)throw e.il("Nested arrays are not supported");return this.dl(t,e)}return this.vl(t,e)},t.prototype.fl=function(t,e){var n=this,r=new vt(_);return F(t)?e.path&&e.path.length>0&&e.un.push(e.path):j(t,(function(t,i){var o=n.ul(i,e.$f(t));null!=o&&(r=r.lt(t,o))})),new Jt(r)},t.prototype.dl=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=o[i],a=this.ul(s,e.nl(r));null==a&&(a=jt.yn),n.push(a),r++}return new $t(n)},t.prototype.ll=function(t,e){if(!yi(e.Jf))throw e.il(t.Wf+"() can only be used with update() and set()");if(null===e.path)throw e.il(t.Wf+"() is not currently supported inside arrays");if(t instanceof ai){if(2!==e.Jf)throw 1===e.Jf?(w(e.path.length>0,"FieldValue.delete() at the top level should have already been handled."),e.il("FieldValue.delete() can only appear at the top level of your update data")):e.il("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.un.push(e.path)}else if(t instanceof ui)e.fieldTransforms.push(new At(e.path,_t.instance));else if(t instanceof ci){var n=this.wl(t.Wf,t.zf),r=new Et(n);e.fieldTransforms.push(new At(e.path,r))}else if(t instanceof hi){n=this.wl(t.Wf,t.zf);var i=new It(n);e.fieldTransforms.push(new At(e.path,i))}else if(t instanceof fi){var o=this.al("FieldValue.increment",t.Kf),s=new Tt(o);e.fieldTransforms.push(new At(e.path,s))}else g("Unknown FieldValue type: "+t)},t.prototype.vl=function(t,e){if(null===t)return jt.yn;if("number"==typeof t)return oe(t)?new Vt(t):new Bt(t);if("boolean"==typeof t)return Ft.of(t);if("string"==typeof t)return new zt(t);if(t instanceof Date)return new Ht(ut.fromDate(t));if(t instanceof ut)return new Ht(new ut(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)));if(t instanceof at)return new Yt(t);if(t instanceof pn)return new Kt(t);if(t instanceof gi)return new Qt(t.s,t.key);throw e.il("Unsupported field value: "+tt(t))},t.prototype.wl=function(t,e){var n=this;return e.map((function(e,r){var i=new mi(3,t,pt.et);return n.ul(e,i.nl(r))}))},t}();function bi(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ut||t instanceof at||t instanceof pn||t instanceof gi||t instanceof si)}function _i(t,e,n){if(!bi(n)||!Z(n)){var r=tt(n);throw"an object"===r?e.il(t+" a custom object"):e.il(t+" "+r)}}function Ei(t,e){if(e instanceof ii)return e.Qf;if("string"==typeof e)return Ii(t,e);throw new O(A.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Ii(t,e){try{return function(t){if(t.search(oi)>=0)throw new O(A.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(ii.bind.apply(ii,s.__spreadArrays([void 0],t.split("."))))}catch(e){throw new O(A.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Qf}catch(r){var n=Ti(r);throw new O(A.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function Ti(t){return t instanceof Error?t.message:t.toString()}var Si=function(){function t(t){this.ml=t,this.pl=Me(),this.mutations=[],this.gl=!1,this.bl=null,this.yl=new Set}return t.prototype.lookup=function(t){return s.__awaiter(this,void 0,void 0,(function(){var e,n=this;return s.__generator(this,(function(r){switch(r.label){case 0:if(this._l(),this.mutations.length>0)throw new O(A.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.ml.lookup(t)];case 1:return(e=r.sent()).forEach((function(t){t instanceof ee||t instanceof te?n.Il(t):g("Document in a transaction was a "+t.constructor.name)})),[2,e]}}))}))},t.prototype.set=function(t,e){this.write(e.Hf(t,this.in(t))),this.yl.add(t)},t.prototype.update=function(t,e){try{this.write(e.Hf(t,this.Tl(t)))}catch(t){this.bl=t}this.yl.add(t)},t.prototype.delete=function(t){this.write([new xt(t,this.in(t))]),this.yl.add(t)},t.prototype.commit=function(){return s.__awaiter(this,void 0,void 0,(function(){var t,e=this;return s.__generator(this,(function(n){switch(n.label){case 0:if(this._l(),this.bl)throw this.bl;return t=this.pl,this.mutations.forEach((function(e){t=t.remove(e.key)})),t.forEach((function(t,n){e.mutations.push(new Lt(t,e.in(t)))})),[4,this.ml.commit(this.mutations)];case 1:return n.sent(),this.gl=!0,[2]}}))}))},t.prototype.Il=function(t){var e;if(t instanceof te)e=t.version;else{if(!(t instanceof ee))throw g("Document in a transaction was a "+t.constructor.name);e=ct.q()}var n=this.pl.get(t.key);if(null!==n){if(!e.isEqual(n))throw new O(A.ABORTED,"Document version changed between two reads.")}else this.pl=this.pl.lt(t.key,e)},t.prototype.in=function(t){var e=this.pl.get(t);return!this.yl.has(t)&&e?kt.updateTime(e):kt.NONE},t.prototype.Tl=function(t){var e=this.pl.get(t);if(!this.yl.has(t)&&e){if(e.isEqual(ct.q()))throw new O(A.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return kt.updateTime(e)}return kt.exists(!0)},t.prototype.write=function(t){this._l(),this.mutations=this.mutations.concat(t)},t.prototype._l=function(){w(!this.gl,"A transaction object cannot be used after its update callback has been invoked.")},t}(),Ni=function(){function t(t,e){this.Qr=t,this.El=e,this.state="Unknown",this.Dl=0,this.Sl=null,this.Rl=!0}return t.prototype.Cl=function(){var t=this;0===this.Dl&&(this.Al("Unknown"),w(null===this.Sl,"onlineStateTimer shouldn't be started yet"),this.Sl=this.Qr.fu("online_state_timeout",1e4,(function(){return t.Sl=null,w("Unknown"===t.state,"Timer should be canceled if we transitioned to a different state."),t.Pl("Backend didn't respond within 10 seconds."),t.Al("Offline"),Promise.resolve()})))},t.prototype.kl=function(t){"Online"===this.state?(this.Al("Unknown"),w(0===this.Dl,"watchStreamFailures must be 0"),w(null===this.Sl,"onlineStateTimer must be null")):(this.Dl++,this.Dl>=1&&(this.Nl(),this.Pl("Connection failed 1 times. Most recent error: "+t.toString()),this.Al("Offline")))},t.prototype.set=function(t){this.Nl(),this.Dl=0,"Online"===t&&(this.Rl=!1),this.Al(t)},t.prototype.Al=function(t){t!==this.state&&(this.state=t,this.El(t))},t.prototype.Pl=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Rl?(y(e),this.Rl=!1):v("OnlineStateTracker",e)},t.prototype.Nl=function(){null!==this.Sl&&(this.Sl.cancel(),this.Sl=null)},t}(),Ai=function(){function t(t,e,n,r,i){var o=this;this.zh=t,this.ml=e,this.Ol=[],this.Fl={},this.Vl=null,this.networkEnabled=!1,this.isPrimary=!1,this.Ul=i,this.Ul.xl((function(t){n.$r((function(){return s.__awaiter(o,void 0,void 0,(function(){return s.__generator(this,(function(t){switch(t.label){case 0:return this.jl()?(v("RemoteStore","Restarting streams for network reachability change."),[4,this.Ll()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.ql=new Ni(n,r),this.Bl=this.ml.qf({Af:this.Ml.bind(this),Ef:this.Ql.bind(this),kf:this.Gl.bind(this)}),this.Wl=this.ml.Lf({Af:this.zl.bind(this),Ef:this.Kl.bind(this),xf:this.Hl.bind(this),Uf:this.Uf.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return s.__awaiter(this,void 0,void 0,(function(){var t;return s.__generator(this,(function(e){switch(e.label){case 0:return this.networkEnabled=!0,this.jl()?(t=this.Wl,[4,this.zh.Vs()]):[3,3];case 1:return t.lastStreamToken=e.sent(),this.Jl()?this.Yl():this.ql.set("Unknown"),[4,this.Xl()];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},t.prototype.disableNetwork=function(){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.$l()];case 1:return t.sent(),this.ql.set("Offline"),[2]}}))}))},t.prototype.$l=function(){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(t){switch(t.label){case 0:return[4,this.Wl.stop()];case 1:return t.sent(),[4,this.Bl.stop()];case 2:return t.sent(),this.Ol.length>0&&(v("RemoteStore","Stopping write stream with "+this.Ol.length+" pending writes"),this.Ol=[]),this.Zl(),[2]}}))}))},t.prototype.shutdown=function(){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(t){switch(t.label){case 0:return v("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.$l()];case 1:return t.sent(),this.Ul.shutdown(),this.ql.set("Unknown"),[2]}}))}))},t.prototype.listen=function(t){L(this.Fl,t.targetId)||(this.Fl[t.targetId]=t,this.Jl()?this.Yl():this.Bl.mf()&&this.td(t))},t.prototype.nd=function(t){w(L(this.Fl,t),"unlisten called on target no currently watched: "+t),delete this.Fl[t],this.Bl.mf()&&this.ed(t),F(this.Fl)&&(this.Bl.mf()?this.Bl.bf():this.jl()&&this.ql.set("Unknown"))},t.prototype.ye=function(t){return this.Fl[t]||null},t.prototype.be=function(t){return this.rd.be(t)},t.prototype.td=function(t){this.Vl.Xi(t.targetId),this.Bl.watch(t)},t.prototype.ed=function(t){this.Vl.Xi(t),this.Bl.Nf(t)},t.prototype.Yl=function(){w(this.Jl(),"startWatchStream() called when shouldStartWatchStream() is false."),this.Vl=new Xe(this),this.Bl.start(),this.ql.Cl()},t.prototype.Jl=function(){return this.jl()&&!this.Bl.wf()&&!F(this.Fl)},t.prototype.jl=function(){return this.isPrimary&&this.networkEnabled},t.prototype.Zl=function(){this.Vl=null},t.prototype.Ml=function(){return s.__awaiter(this,void 0,void 0,(function(){var t=this;return s.__generator(this,(function(e){return M(this.Fl,(function(e,n){t.td(n)})),[2]}))}))},t.prototype.Ql=function(t){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(e){return void 0===t&&w(!this.Jl(),"Watch stream was stopped gracefully while still needed."),this.Zl(),this.Jl()?(this.ql.kl(t),this.Yl()):this.ql.set("Unknown"),[2]}))}))},t.prototype.Gl=function(t,e){return s.__awaiter(this,void 0,void 0,(function(){var n;return s.__generator(this,(function(r){switch(r.label){case 0:return this.ql.set("Online"),t instanceof Ye&&2===t.state&&t.cause?[2,this.ud(t)]:(t instanceof Ke?this.Vl.ue(t):t instanceof Qe?this.Vl.de(t):(w(t instanceof Ye,"Expected watchChange to be an instance of WatchTargetChange"),this.Vl.he(t)),e.isEqual(ct.MIN)?[3,3]:[4,this.zh.Jo()]);case 1:return n=r.sent(),e.h(n)>=0?[4,this.sd(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},t.prototype.sd=function(t){var e=this;w(!t.isEqual(ct.MIN),"Can't raise event for unknown SnapshotVersion");var n=this.Vl.me(t);return M(n.Si,(function(n,r){if(r.resumeToken.bn()>0){var i=e.Fl[n];i&&(e.Fl[n]=i.vi(r.resumeToken,t))}})),n.Ri.forEach((function(t){var n=e.Fl[t];if(n){e.Fl[t]=n.vi(_e.ai,n.li),e.ed(t);var r=new Ne(n.target,t,1,n.sequenceNumber);e.td(r)}})),this.rd.Yo(n)},t.prototype.ud=function(t){var e=this;w(!!t.cause,"Handling target error without a cause");var n=t.cause,r=Promise.resolve();return t.targetIds.forEach((function(t){r=r.then((function(){return s.__awaiter(e,void 0,void 0,(function(){return s.__generator(this,(function(e){return L(this.Fl,t)?(delete this.Fl[t],this.Vl.removeTarget(t),[2,this.rd.od(t,n)]):[2]}))}))}))})),r},t.prototype.Xl=function(){return s.__awaiter(this,void 0,void 0,(function(){var t,e;return s.__generator(this,(function(n){switch(n.label){case 0:return this.hd()?(t=this.Ol.length>0?this.Ol[this.Ol.length-1].batchId:-1,[4,this.zh.sh(t)]):[3,4];case 1:return null!==(e=n.sent())?[3,2]:(0===this.Ol.length&&this.Wl.bf(),[3,4]);case 2:return this.ad(e),[4,this.Xl()];case 3:n.sent(),n.label=4;case 4:return this.fd()&&this.ld(),[2]}}))}))},t.prototype.hd=function(){return this.jl()&&this.Ol.length<10},t.prototype.dd=function(){return this.Ol.length},t.prototype.ad=function(t){w(this.hd(),"addToWritePipeline called when pipeline is full"),this.Ol.push(t),this.Wl.mf()&&this.Wl.Ff&&this.Wl.Vf(t.mutations)},t.prototype.fd=function(){return this.jl()&&!this.Wl.wf()&&this.Ol.length>0},t.prototype.ld=function(){w(this.fd(),"startWriteStream() called when shouldStartWriteStream() is false."),this.Wl.start()},t.prototype.zl=function(){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(t){return this.Wl.jf(),[2]}))}))},t.prototype.Hl=function(){var t=this;return this.zh.Us(this.Wl.lastStreamToken).then((function(){for(var e=0,n=t.Ol;e<n.length;e++){var r=n[e];t.Wl.Vf(r.mutations)}})).catch(Yn)},t.prototype.Uf=function(t,e){var n=this;w(this.Ol.length>0,"Got result for empty write pipeline");var r=this.Ol.shift(),i=Tn.from(r,t,e,this.Wl.lastStreamToken);return this.rd.vd(i).then((function(){return n.Xl()}))},t.prototype.Kl=function(t){return s.__awaiter(this,void 0,void 0,(function(){var e=this;return s.__generator(this,(function(n){return void 0===t&&w(!this.fd(),"Write stream was stopped gracefully while still needed."),t&&this.Ol.length>0?[2,(this.Wl.Ff?this.wd(t):this.md(t)).then((function(){e.fd()&&e.ld()}))]:[2]}))}))},t.prototype.md=function(t){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(e){return Oe(t.code)?(v("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.Wl.lastStreamToken),this.Wl.lastStreamToken=_e.ai,[2,this.zh.Us(_e.ai).catch(Yn)]):[2]}))}))},t.prototype.wd=function(t){return s.__awaiter(this,void 0,void 0,(function(){var e,n=this;return s.__generator(this,(function(r){return Oe(i=t.code)&&i!==A.ABORTED?(e=this.Ol.shift(),this.Wl.gf(),[2,this.rd.pd(e.batchId,t).then((function(){return n.Xl()}))]):[2];var i}))}))},t.prototype.gd=function(){return new Si(this.ml)},t.prototype.Ll=function(){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.$l()];case 1:return t.sent(),this.ql.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}}))}))},t.prototype.bd=function(){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(t){switch(t.label){case 0:return this.jl()?(v("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.Ll()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.yd=function(t){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(e){switch(e.label){case 0:return this.isPrimary=t,t&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return e.sent(),[3,4];case 2:return t?[3,4]:[4,this.$l()];case 3:e.sent(),this.ql.set("Unknown"),e.label=4;case 4:return[2]}}))}))},t}();function Oi(t,e){return w(-1===e.indexOf("_"),"Client key cannot contain '_', but was '"+e+"'"),"firestore_clients_"+t+"_"+e}function ki(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.l()&&(r+="_"+e.uid),r}function Ri(t,e){return"firestore_targets_"+t+"_"+e}var Ci=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r,w(void 0!==r==("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}return t._d=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new O(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(y("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Id=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Di=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n,w(void 0!==n==("rejected"===e),"QueryTargetMetadata must contain an error iff state is 'rejected'")}return t._d=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new O(r.error.code,r.error.message)),i?new t(e,r.state,o):(y("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Id=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Pi=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t._d=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Ge(),s=0;i&&s<r.activeTargetIds.length;++s)i=oe(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(y("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),xi=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t._d=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(y("SharedClientState","Failed to parse online state: "+e),null)},t}(),Li=function(){function t(){this.activeTargetIds=Ge()}return t.prototype.Td=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Ed=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Id=function(){var t={activeTargetIds:this.activeTargetIds.tt(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Ui=function(){function t(e,n,r,i,o){if(this.Lc=e,this.platform=n,this.persistenceKey=r,this.Dd=i,this.rd=null,this.El=null,this.jr=null,this.Sd={},this.Rd=this.Cd.bind(this),this.Co=!1,this.Ad=[],!t.cs(this.platform))throw new O(A.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=o,this.Pd=Oi(this.persistenceKey,this.Dd),this.kd=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Sd[this.Dd]=new Li,this.Nd=new RegExp("^firestore_clients_"+s+"_([^_]*)$"),this.Od=new RegExp("^firestore_mutations_"+s+"_(\\d+)(?:_(.*))?$"),this.Fd=new RegExp("^firestore_targets_"+s+"_(\\d+)$"),this.Vd=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.platform.window.addEventListener("storage",this.Rd)}return t.cs=function(t){return!(!t.window||null==t.window.localStorage)},t.prototype.start=function(){return s.__awaiter(this,void 0,void 0,(function(){var t,e,n,r,i,o,a,u,c,h,f,l=this;return s.__generator(this,(function(s){switch(s.label){case 0:return w(!this.Co,"WebStorageSharedClientState already started"),w(null!==this.rd,"syncEngine property must be set before calling start()"),w(null!==this.El,"onlineStateHandler property must be set before calling start()"),[4,this.rd.gh()];case 1:for(t=s.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Dd&&(i=this.getItem(Oi(this.persistenceKey,r)))&&(o=Pi._d(r,i))&&(this.Sd[o.clientId]=o);for(this.Ud(),(a=this.storage.getItem(this.Vd))&&(u=this.xd(a))&&this.jd(u),c=0,h=this.Ad;c<h.length;c++)f=h[c],this.Cd(f);return this.Ad=[],this.platform.window.addEventListener("unload",(function(){return l.shutdown()})),this.Co=!0,[2]}}))}))},t.prototype.Br=function(t){this.setItem(this.kd,JSON.stringify(t))},t.prototype.Ld=function(){var t=Ge();return j(this.Sd,(function(e,n){t=t.Mt(n.activeTargetIds)})),t},t.prototype.qd=function(t){for(var e in this.Sd)if(this.Sd.hasOwnProperty(e)&&this.Sd[e].activeTargetIds.has(t))return!0;return!1},t.prototype.Bd=function(t){this.Md(t,"pending")},t.prototype.Qd=function(t,e,n){this.Md(t,e,n),this.Gd(t)},t.prototype.Wd=function(t){var e="not-current";if(this.qd(t)){var n=this.storage.getItem(Ri(this.persistenceKey,t));if(n){var r=Di._d(t,n);r&&(e=r.state)}}return this.zd.Td(t),this.Ud(),e},t.prototype.Kd=function(t){this.zd.Ed(t),this.Ud()},t.prototype.Hd=function(t){return this.zd.activeTargetIds.has(t)},t.prototype.Jd=function(t){this.removeItem(Ri(this.persistenceKey,t))},t.prototype.Yd=function(t,e,n){this.Xd(t,e,n)},t.prototype.Lo=function(t,e,n){var r=this;e.forEach((function(t){r.Gd(t)})),this.currentUser=t,n.forEach((function(t){r.Bd(t)}))},t.prototype.$d=function(t){this.Zd(t)},t.prototype.shutdown=function(){this.Co&&(this.platform.window.removeEventListener("storage",this.Rd),this.removeItem(this.Pd),this.Co=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return v("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){v("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){v("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Cd=function(t){var e=this;if(t.storageArea===this.storage){if(v("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Pd)return void y("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Lc.$r((function(){return s.__awaiter(e,void 0,void 0,(function(){var e,n,r,i,o,a;return s.__generator(this,(function(s){if(!this.Co)return this.Ad.push(t),[2];if(null===t.key)return[2];if(this.Nd.test(t.key)){if(null==t.newValue)return n=this.tv(t.key),[2,this.nv(n,null)];if(e=this.iv(t.key,t.newValue))return[2,this.nv(e.clientId,e)]}else if(this.Od.test(t.key)){if(null!==t.newValue&&(r=this.ev(t.key,t.newValue)))return[2,this.rv(r)]}else if(this.Fd.test(t.key)){if(null!==t.newValue&&(i=this.uv(t.key,t.newValue)))return[2,this.sv(i)]}else if(t.key===this.Vd){if(null!==t.newValue&&(o=this.xd(t.newValue)))return[2,this.jd(o)]}else t.key===this.kd&&(w(!!this.jr,"Missing sequenceNumberHandler"),(a=function(t){var e=vn.Mr;if(null!=t)try{var n=JSON.parse(t);w("number"==typeof n,"Found non-numeric sequence number"),e=n}catch(t){y("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(t.newValue))!==vn.Mr&&this.jr(a));return[2]}))}))}))}},Object.defineProperty(t.prototype,"zd",{get:function(){return this.Sd[this.Dd]},enumerable:!0,configurable:!0}),t.prototype.Ud=function(){this.setItem(this.Pd,this.zd.Id())},t.prototype.Md=function(t,e,n){var r=new Ci(this.currentUser,t,e,n),i=ki(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Id())},t.prototype.Gd=function(t){var e=ki(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Zd=function(t){var e={clientId:this.Dd,onlineState:t};this.storage.setItem(this.Vd,JSON.stringify(e))},t.prototype.Xd=function(t,e,n){var r=Ri(this.persistenceKey,t),i=new Di(t,e,n);this.setItem(r,i.Id())},t.prototype.tv=function(t){var e=this.Nd.exec(t);return e?e[1]:null},t.prototype.iv=function(t,e){var n=this.tv(t);return w(null!==n,"Cannot parse client state key '"+t+"'"),Pi._d(n,e)},t.prototype.ev=function(t,e){var n=this.Od.exec(t);w(null!==n,"Cannot parse mutation batch key '"+t+"'");var r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Ci._d(new N(i),r,e)},t.prototype.uv=function(t,e){var n=this.Fd.exec(t);w(null!==n,"Cannot parse query target key '"+t+"'");var r=Number(n[1]);return Di._d(r,e)},t.prototype.xd=function(t){return xi._d(t)},t.prototype.rv=function(t){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(e){return t.user.uid!==this.currentUser.uid?(v("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2]):[2,this.rd.ov(t.batchId,t.state,t.error)]}))}))},t.prototype.sv=function(t){return this.rd.hv(t.targetId,t.state,t.error)},t.prototype.nv=function(t,e){var n=this,r=this.Ld();e?this.Sd[t]=e:delete this.Sd[t];var i=this.Ld(),o=[],a=[];return i.forEach((function(t){return s.__awaiter(n,void 0,void 0,(function(){return s.__generator(this,(function(e){return r.has(t)||o.push(t),[2]}))}))})),r.forEach((function(t){return s.__awaiter(n,void 0,void 0,(function(){return s.__generator(this,(function(e){return i.has(t)||a.push(t),[2]}))}))})),this.rd.cv(o,a)},t.prototype.jd=function(t){this.Sd[t.clientId]&&this.El(t.onlineState)},t}();var Mi=function(){function t(){this.av=new Li,this.fv={},this.rd=null,this.El=null,this.jr=null}return t.prototype.Bd=function(t){},t.prototype.Qd=function(t,e,n){},t.prototype.Wd=function(t){return this.av.Td(t),this.fv[t]||"not-current"},t.prototype.Yd=function(t,e,n){this.fv[t]=e},t.prototype.Kd=function(t){this.av.Ed(t)},t.prototype.Hd=function(t){return this.av.activeTargetIds.has(t)},t.prototype.Jd=function(t){delete this.fv[t]},t.prototype.Ld=function(){return this.av.activeTargetIds},t.prototype.qd=function(t){return this.av.activeTargetIds.has(t)},t.prototype.start=function(){return this.av=new Li,Promise.resolve()},t.prototype.Lo=function(t,e,n){},t.prototype.$d=function(t){},t.prototype.shutdown=function(){},t.prototype.Br=function(t){},t}(),ji=function(t){this.key=t},Fi=function(t){this.key=t},qi=function(){function t(t,e){this.query=t,this.lv=e,this.dv=null,this.Ni=!1,this.vv=Fe(),this.Ii=Fe(),this.wv=new Ve(t.Xn.bind(t))}return Object.defineProperty(t.prototype,"mv",{get:function(){return this.lv},enumerable:!0,configurable:!0}),t.prototype.pv=function(t,e){var n=this,r=e?e.gv:new Be,i=e?e.wv:this.wv,o=e?e.Ii:this.Ii,s=i,a=!1,u=this.query.ii()&&i.size===this.query.limit?i.last():null,c=this.query.ei()&&i.size===this.query.limit?i.first():null;if(t.pt((function(t,e){var h=i.get(t),f=e instanceof te?e:null;f&&(w(t.isEqual(f.key),"Mismatching keys found in document changes: "+t+" != "+f.key),f=n.query.matches(f)?f:null);var l=!!h&&n.Ii.has(h.key),p=!!f&&(f.en||n.Ii.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.bv(h,f)||(r.track({type:2,doc:f}),d=!0,(u&&n.query.Xn(f,u)>0||c&&n.query.Xn(f,c)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(u||c)&&(a=!0));d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),this.query.ii()||this.query.ei())for(;s.size>this.query.limit;){var h=this.query.ii()?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return w(!a||!e,"View was refilled using docs that themselves needed refilling."),{wv:s,gv:r,Pa:a,Ii:o}},t.prototype.bv=function(t,e){return t.en&&e.hasCommittedMutations&&!e.en},t.prototype.es=function(t,e,n){var r=this;w(!t.Pa,"Cannot apply changes that need a refill");var i=this.wv;this.wv=t.wv,this.Ii=t.Ii;var o=t.gv.yi();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return g("Unknown ChangeType: "+t)}};return n(t)-n(e)}(t.type,e.type)||r.query.Xn(t.doc,e.doc)})),this.yv(n);var s=e?this._v():[],a=0===this.vv.size&&this.Ni?1:0,u=a!==this.dv;return this.dv=a,0!==o.length||u?{snapshot:new ze(this.query,t.wv,i,o,t.Ii,0===a,u,!1),Iv:s}:{Iv:s}},t.prototype.Tv=function(t){return this.Ni&&"Offline"===t?(this.Ni=!1,this.es({wv:this.wv,gv:new Be,Ii:this.Ii,Pa:!1},!1)):{Iv:[]}},t.prototype.Ev=function(t){return!this.lv.has(t)&&(!!this.wv.has(t)&&!this.wv.get(t).en)},t.prototype.yv=function(t){var e=this;t&&(t.Oi.forEach((function(t){return e.lv=e.lv.add(t)})),t.Fi.forEach((function(t){return w(e.lv.has(t),"Modified document "+t+" not found in view.")})),t.Vi.forEach((function(t){return e.lv=e.lv.delete(t)})),this.Ni=t.Ni)},t.prototype._v=function(){var t=this;if(!this.Ni)return[];var e=this.vv;this.vv=Fe(),this.wv.forEach((function(e){t.Ev(e.key)&&(t.vv=t.vv.add(e.key))}));var n=[];return e.forEach((function(e){t.vv.has(e)||n.push(new Fi(e))})),this.vv.forEach((function(t){e.has(t)||n.push(new ji(t))})),n},t.prototype.Dv=function(t){this.lv=t.mh,this.vv=Fe();var e=this.pv(t.documents);return this.es(e,!0)},t.prototype.Sv=function(){return ze.Di(this.query,this.wv,this.Ii,0===this.dv)},t}();var Gi=function(){function t(t,e,n,r){this.Qr=t,this.Rv=e,this.updateFunction=n,this.Kr=r,this.Cv=5,this.vf=new Zr(this.Qr,"retry_transaction")}return t.prototype.run=function(){this.Av()},t.prototype.Av=function(){var t=this;this.vf.hf((function(){return s.__awaiter(t,void 0,void 0,(function(){var t,e,n=this;return s.__generator(this,(function(r){return t=this.Rv.gd(),(e=this.Pv(t))&&e.then((function(e){n.Qr.$r((function(){return t.commit().then((function(){n.Kr.resolve(e)})).catch((function(t){n.kv(t)}))}))})).catch((function(t){n.kv(t)})),[2]}))}))}))},t.prototype.Pv=function(t){try{var e=this.updateFunction(t);return!re(e)&&e.catch&&e.then?e:(this.Kr.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Kr.reject(t),null}},t.prototype.kv=function(t){var e=this;this.Cv>0&&this.Nv(t)?(this.Cv-=1,this.Qr.$r((function(){return e.Av(),Promise.resolve()}))):this.Kr.reject(t)},t.prototype.Nv=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Oe(e)}return!1},t}(),Vi=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Bi=function(t){this.key=t,this.Ov=!1},zi=function(){function t(t,e,n,r){this.zh=t,this.Rv=e,this.Fv=n,this.currentUser=r,this.Vv=null,this.Uv=new An((function(t){return t.canonicalId()})),this.xv={},this.jv=new vt(dt.G),this.Lv={},this.qv=new Sn,this.Bv={},this.Mv=new Map,this.Qv=Hn.uo(),this.isPrimary=void 0,this.onlineState="Unknown"}return Object.defineProperty(t.prototype,"Gv",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t){w(null!==t,"SyncEngine listener cannot be null"),w(null===this.Vv,"SyncEngine already has a subscriber."),this.Vv=t},t.prototype.listen=function(t){return s.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,o;return s.__generator(this,(function(s){switch(s.label){case 0:return this.Wv("listen()"),(r=this.Uv.get(t))?(e=r.targetId,this.Fv.Wd(e),n=r.view.Sv(),[3,4]):[3,1];case 1:return[4,this.zh.hh(t.Yn())];case 2:return i=s.sent(),o=this.Fv.Wd(i.targetId),e=i.targetId,[4,this.zv(t,e,"current"===o)];case 3:n=s.sent(),this.isPrimary&&this.Rv.listen(i),s.label=4;case 4:return this.Vv.kf([n]),[2,e]}}))}))},t.prototype.zv=function(t,e,n){return s.__awaiter(this,void 0,void 0,(function(){var r,i,o,a,u,c;return s.__generator(this,(function(s){switch(s.label){case 0:return[4,this.zh.vh(t,!0)];case 1:return r=s.sent(),i=new qi(t,r.mh),o=i.pv(r.documents),a=We.ki(e,n&&"Offline"!==this.onlineState),w(0===(u=i.es(o,!0===this.isPrimary,a)).Iv.length,"View returned limbo docs before target ack from the server."),w(!!u.snapshot,"applyChanges for new view should always return a snapshot"),c=new Vi(t,e,i),this.Uv.set(t,c),this.xv[e]||(this.xv[e]=[]),this.xv[e].push(t),[2,u.snapshot]}}))}))},t.prototype.Kv=function(t){return s.__awaiter(this,void 0,void 0,(function(){var e,n;return s.__generator(this,(function(r){switch(r.label){case 0:return[4,this.zh.vh(t.query,!0)];case 1:return e=r.sent(),n=t.view.Dv(e),this.isPrimary&&this.Hv(t.targetId,n.Iv),[2,n]}}))}))},t.prototype.nd=function(t){return s.__awaiter(this,void 0,void 0,(function(){var e,n,r=this;return s.__generator(this,(function(i){switch(i.label){case 0:return this.Wv("unlisten()"),w(!!(e=this.Uv.get(t)),"Trying to unlisten on query not found:"+t),(n=this.xv[e.targetId]).length>1?(this.xv[e.targetId]=n.filter((function(e){return!e.isEqual(t)})),this.Uv.delete(t),[2]):this.isPrimary?(this.Fv.Kd(e.targetId),this.Fv.qd(e.targetId)?[3,2]:[4,this.zh.dh(e.targetId,!1).then((function(){r.Fv.Jd(e.targetId),r.Rv.nd(e.targetId),r.Jv(e.targetId)})).catch(Yn)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return this.Jv(e.targetId),[4,this.zh.dh(e.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}}))}))},t.prototype.write=function(t,e){return s.__awaiter(this,void 0,void 0,(function(){var n;return s.__generator(this,(function(r){switch(r.label){case 0:return this.Wv("write()"),[4,this.zh.Qo(t)];case 1:return n=r.sent(),this.Fv.Bd(n.batchId),this.Yv(n.batchId,e),[4,this.Xv(n.Ku)];case 2:return r.sent(),[4,this.Rv.Xl()];case 3:return r.sent(),[2]}}))}))},t.prototype.runTransaction=function(t,e,n){new Gi(t,this.Rv,e,n).run()},t.prototype.Yo=function(t){return s.__awaiter(this,void 0,void 0,(function(){var e,n=this;return s.__generator(this,(function(r){switch(r.label){case 0:this.Wv("applyRemoteEvent()"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.zh.Yo(t)];case 2:return e=r.sent(),j(t.Si,(function(t,e){var r=n.Lv[Number(t)];r&&(w(e.Oi.size+e.Fi.size+e.Vi.size<=1,"Limbo resolution for single document contains multiple changes."),e.Oi.size>0?r.Ov=!0:e.Fi.size>0?w(r.Ov,"Received change for limbo target document without add."):e.Vi.size>0&&(w(r.Ov,"Received remove for limbo target document without add."),r.Ov=!1))})),[4,this.Xv(e,t)];case 3:return r.sent(),[3,6];case 4:return[4,Yn(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.Tv=function(t,e){if(this.isPrimary&&0===e||!this.isPrimary&&1===e){this.Wv("applyOnlineStateChange()");var n=[];this.Uv.forEach((function(e,r){var i=r.view.Tv(t);w(0===i.Iv.length,"OnlineState should not affect limbo documents."),i.snapshot&&n.push(i.snapshot)})),this.Vv.$v(t),this.Vv.kf(n),this.onlineState=t,this.isPrimary&&this.Fv.$d(t)}},t.prototype.od=function(t,e){return s.__awaiter(this,void 0,void 0,(function(){var n,r,i,o,a,u=this;return s.__generator(this,(function(s){switch(s.label){case 0:return this.Wv("rejectListens()"),this.Fv.Yd(t,"rejected",e),n=this.Lv[t],(r=n&&n.key)?(this.jv=this.jv.remove(r),delete this.Lv[t],i=(i=new vt(dt.G)).lt(r,new ee(r,ct.q())),o=Fe().add(r),a=new He(ct.MIN,{},new wt(_),i,o),[2,this.Yo(a)]):[3,1];case 1:return[4,this.zh.dh(t,!1).then((function(){return u.Jv(t,e)})).catch(Yn)];case 2:s.sent(),s.label=3;case 3:return[2]}}))}))},t.prototype.ov=function(t,e,n){return s.__awaiter(this,void 0,void 0,(function(){var r;return s.__generator(this,(function(i){switch(i.label){case 0:return this.Wv("applyBatchState()"),[4,this.zh.Go(t)];case 1:return null===(r=i.sent())?(v("SyncEngine","Cannot apply mutation batch with id: "+t),[2]):"pending"!==e?[3,3]:[4,this.Rv.Xl()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===e||"rejected"===e?(this.Zv(t,n||null),this.zh.bh(t)):g("Unknown batchState: "+e),i.label=4;case 4:return[4,this.Xv(r)];case 5:return i.sent(),[2]}}))}))},t.prototype.vd=function(t){return s.__awaiter(this,void 0,void 0,(function(){var e,n;return s.__generator(this,(function(r){switch(r.label){case 0:this.Wv("applySuccessfulWrite()"),e=t.batch.batchId,this.Zv(e,null),this.tw(e),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.zh.Os(t)];case 2:return n=r.sent(),this.Fv.Qd(e,"acknowledged"),[4,this.Xv(n)];case 3:return r.sent(),[3,6];case 4:return[4,Yn(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.pd=function(t,e){return s.__awaiter(this,void 0,void 0,(function(){var n;return s.__generator(this,(function(r){switch(r.label){case 0:this.Wv("rejectFailedWrite()"),this.Zv(t,e),this.tw(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.zh.Ho(t)];case 2:return n=r.sent(),this.Fv.Qd(t,"rejected",e),[4,this.Xv(n)];case 3:return r.sent(),[3,6];case 4:return[4,Yn(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.nw=function(t){return s.__awaiter(this,void 0,void 0,(function(){var e,n;return s.__generator(this,(function(r){switch(r.label){case 0:return this.Rv.jl()||v("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.zh.Gs()];case 1:return-1===(e=r.sent())?(t.resolve(),[2]):((n=this.Mv.get(e)||[]).push(t),this.Mv.set(e,n),[2])}}))}))},t.prototype.tw=function(t){(this.Mv.get(t)||[]).forEach((function(t){t.resolve()})),this.Mv.delete(t)},t.prototype.iw=function(t){this.Mv.forEach((function(e){e.forEach((function(e){e.reject(new O(A.CANCELLED,t))}))})),this.Mv.clear()},t.prototype.Yv=function(t,e){var n=this.Bv[this.currentUser.v()];n||(n=new vt(_)),n=n.lt(t,e),this.Bv[this.currentUser.v()]=n},t.prototype.Zv=function(t,e){var n=this.Bv[this.currentUser.v()];if(n){var r=n.get(t);r&&(w(t===n.vt(),"Mutation callbacks processed out-of-order?"),e?r.reject(e):r.resolve(),n=n.remove(t)),this.Bv[this.currentUser.v()]=n}},t.prototype.Jv=function(t,e){var n=this;void 0===e&&(e=null),this.Fv.Kd(t),w(this.xv[t]&&0!==this.xv[t].length,"There are no queries mapped to target id "+t);for(var r=0,i=this.xv[t];r<i.length;r++){var o=i[r];this.Uv.delete(o),e&&this.Vv.ew(o,e)}if(delete this.xv[t],this.isPrimary){var s=this.qv.Nu(t);this.qv.Pu(t),s.forEach((function(t){n.qv.Ou(t)||n.rw(t)}))}},t.prototype.rw=function(t){var e=this.jv.get(t);null!==e&&(this.Rv.nd(e),this.jv=this.jv.remove(t),delete this.Lv[e])},t.prototype.Hv=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i instanceof ji)this.qv.Du(i.key,t),this.uw(i);else if(i instanceof Fi){v("SyncEngine","Document no longer in limbo: "+i.key),this.qv.Ru(i.key,t),this.qv.Ou(i.key)||this.rw(i.key)}else g("Unknown limbo change: "+JSON.stringify(i))}},t.prototype.uw=function(t){var e=t.key;if(!this.jv.get(e)){v("SyncEngine","New document in limbo: "+e);var n=this.Qv.next(),r=ae.jn(e.path);this.Lv[n]=new Bi(e),this.Rv.listen(new Ne(r.Yn(),n,2,vn.Mr)),this.jv=this.jv.lt(e,n)}},t.prototype.sw=function(){return this.jv},t.prototype.Xv=function(t,e){return s.__awaiter(this,void 0,void 0,(function(){var n,r,i,o=this;return s.__generator(this,(function(s){switch(s.label){case 0:return n=[],r=[],i=[],this.Uv.forEach((function(s,a){i.push(Promise.resolve().then((function(){var e=a.view.pv(t);return e.Pa?o.zh.vh(a.query,!1).then((function(t){var n=t.documents;return a.view.pv(n,e)})):e})).then((function(t){var i=e&&e.Si[a.targetId],s=a.view.es(t,!0===o.isPrimary,i);if(o.Hv(a.targetId,s.Iv),s.snapshot){o.isPrimary&&o.Fv.Yd(a.targetId,s.snapshot.fromCache?"not-current":"current"),n.push(s.snapshot);var u=Kn.Io(a.targetId,s.snapshot);r.push(u)}})))})),[4,Promise.all(i)];case 1:return s.sent(),this.Vv.kf(n),[4,this.zh.uh(r)];case 2:return s.sent(),[2]}}))}))},t.prototype.Wv=function(t){w(null!==this.Vv,"Trying to call "+t+" before calling subscribe().")},t.prototype.bd=function(t){return s.__awaiter(this,void 0,void 0,(function(){var e,n;return s.__generator(this,(function(r){switch(r.label){case 0:return e=!this.currentUser.isEqual(t),this.currentUser=t,e?(this.iw("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.zh.Lo(t)]):[3,3];case 1:return n=r.sent(),this.Fv.Lo(t,n.Bo,n.Mo),[4,this.Xv(n.qo)];case 2:r.sent(),r.label=3;case 3:return[4,this.Rv.bd()];case 4:return r.sent(),[2]}}))}))},t.prototype.yd=function(t){return s.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,o,a,u=this;return s.__generator(this,(function(s){switch(s.label){case 0:return!0!==t||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.Rv.yd(!0)]);case 1:return s.sent(),o=this.Fv.Ld(),[4,this.ow(o.tt())];case 2:for(e=s.sent(),n=0,r=e;n<r.length;n++)i=r[n],this.Rv.listen(i);return[3,7];case 3:return!1!==t||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,o=[],a=Promise.resolve(),M(this.xv,(function(t,e){u.Fv.Hd(t)?o.push(t):a=a.then((function(){return u.Jv(t),u.zh.dh(t,!0)})),u.Rv.nd(t)})),[4,a]);case 4:return s.sent(),[4,this.ow(o)];case 5:return s.sent(),this.hw(),[4,this.Rv.yd(!1)];case 6:s.sent(),s.label=7;case 7:return[2]}}))}))},t.prototype.hw=function(){var t=this;M(this.Lv,(function(e){t.Rv.nd(e)})),this.qv.ku(),this.Lv=[],this.jv=new vt(dt.G)},t.prototype.ow=function(t){return s.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,o,a,u,c,h,f,l,p,d;return s.__generator(this,(function(s){switch(s.label){case 0:e=[],n=[],r=0,i=t,s.label=1;case 1:return r<i.length?(o=i[r],a=void 0,(u=this.xv[o])&&0!==u.length?[4,this.zh.dh(o,!0)]:[3,8]):[3,14];case 2:return s.sent(),[4,this.zh.hh(u[0].Yn())];case 3:a=s.sent(),c=0,h=u,s.label=4;case 4:return c<h.length?(f=h[c],w(!!(l=this.Uv.get(f)),"No query view found for "+f),[4,this.Kv(l)]):[3,7];case 5:(p=s.sent()).snapshot&&n.push(p.snapshot),s.label=6;case 6:return c++,[3,4];case 7:return[3,12];case 8:return w(!0===this.isPrimary,"A secondary tab should never have an active target without an active query."),[4,this.zh.Th(o)];case 9:return w(!!(d=s.sent()),"Target for id "+o+" not found"),[4,this.zh.hh(d)];case 10:return a=s.sent(),[4,this.zv(this.cw(d),o,!1)];case 11:s.sent(),s.label=12;case 12:e.push(a),s.label=13;case 13:return r++,[3,1];case 14:return this.Vv.kf(n),[2,e]}}))}))},t.prototype.cw=function(t){return new ae(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)},t.prototype.gh=function(){return this.zh.gh()},t.prototype.hv=function(t,e,n){return s.__awaiter(this,void 0,void 0,(function(){var r,i;return s.__generator(this,(function(o){switch(o.label){case 0:if(this.isPrimary)return v("SyncEngine","Ignoring unexpected query state notification."),[2];if(!this.xv[t])return[3,7];switch(e){case"current":case"not-current":return[3,1];case"rejected":return[3,4]}return[3,6];case 1:return[4,this.zh.Eh()];case 2:return r=o.sent(),i=He.Pi(t,"current"===e),[4,this.Xv(r,i)];case 3:return o.sent(),[3,7];case 4:return[4,this.zh.dh(t,!0)];case 5:return o.sent(),this.Jv(t,n),[3,7];case 6:g("Unexpected target state: "+e),o.label=7;case 7:return[2]}}))}))},t.prototype.cv=function(t,e){return s.__awaiter(this,void 0,void 0,(function(){var n,r,i,o,a,u,c,h,f,l=this;return s.__generator(this,(function(p){switch(p.label){case 0:if(!this.isPrimary)return[2];n=0,r=t,p.label=1;case 1:return n<r.length?(f=r[n],w(!this.xv[f],"Trying to add an already active target"),[4,this.zh.Th(f)]):[3,6];case 2:return w(!!(i=p.sent()),"Query data for active target "+f+" not found"),[4,this.zh.hh(i)];case 3:return o=p.sent(),[4,this.zv(this.cw(i),o.targetId,!1)];case 4:p.sent(),this.Rv.listen(o),p.label=5;case 5:return n++,[3,1];case 6:a=function(t){return s.__generator(this,(function(e){switch(e.label){case 0:return u.xv[t]?[4,u.zh.dh(t,!1).then((function(){l.Rv.nd(t),l.Jv(t)})).catch(Yn)]:[2,"continue"];case 1:return e.sent(),[2]}}))},u=this,c=0,h=e,p.label=7;case 7:return c<h.length?(f=h[c],[5,a(f)]):[3,10];case 8:p.sent(),p.label=9;case 9:return c++,[3,7];case 10:return[2]}}))}))},t.prototype.enableNetwork=function(){return this.zh.yh(!0),this.Rv.enableNetwork()},t.prototype.disableNetwork=function(){return this.zh.yh(!1),this.Rv.disableNetwork()},t.prototype.be=function(t){var e=this.Lv[t];if(e&&e.Ov)return Fe().add(e.key);var n=Fe(),r=this.xv[t];if(!r)return n;for(var i=0,o=r;i<o.length;i++){var s=o[i],a=this.Uv.get(s);w(!!a,"No query view found for "+s),n=n.Mt(a.view.mv)}return n},t}(),Hi=function(){this.aw=null,this.targetId=0,this.listeners=[]},Wi=function(){function t(t){this.rd=t,this.fw=new An((function(t){return t.canonicalId()})),this.onlineState="Unknown",this.lw=new Set,this.rd.subscribe(this)}return t.prototype.listen=function(t){var e=t.query,n=!1,r=this.fw.get(e);(r||(n=!0,r=new Hi,this.fw.set(e,r)),r.listeners.push(t),w(!t.Tv(this.onlineState),"applyOnlineStateChange() shouldn't raise an event for brand-new listeners."),r.aw)&&(t.dw(r.aw)&&this.vw());return n?this.rd.listen(e).then((function(t){return r.targetId=t,t})):Promise.resolve(r.targetId)},t.prototype.nd=function(t){return s.__awaiter(this,void 0,void 0,(function(){var e,n,r,i;return s.__generator(this,(function(o){return e=t.query,n=!1,(r=this.fw.get(e))&&(i=r.listeners.indexOf(t))>=0&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?(this.fw.delete(e),[2,this.rd.nd(e)]):[2]}))}))},t.prototype.kf=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.fw.get(o);if(s){for(var a=0,u=s.listeners;a<u.length;a++){u[a].dw(i)&&(e=!0)}s.aw=i}}e&&this.vw()},t.prototype.ew=function(t,e){var n=this.fw.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++){i[r].onError(e)}this.fw.delete(t)},t.prototype.$v=function(t){this.onlineState=t;var e=!1;this.fw.forEach((function(n,r){for(var i=0,o=r.listeners;i<o.length;i++){o[i].Tv(t)&&(e=!0)}})),e&&this.vw()},t.prototype.ww=function(t){this.lw.add(t),t.next()},t.prototype.mw=function(t){this.lw.delete(t)},t.prototype.vw=function(){this.lw.forEach((function(t){t.next()}))},t}(),Ki=function(){function t(t,e,n){this.query=t,this.pw=e,this.gw=!1,this.bw=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.dw=function(t){if(w(t.docChanges.length>0||t.Ti,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new ze(t.query,t.docs,t._i,e,t.Ii,t.fromCache,t.Ti,!0)}var o=!1;return this.gw?this.yw(t)&&(this.pw.next(t),o=!0):this._w(t,this.onlineState)&&(this.Iw(t),o=!0),this.bw=t,o},t.prototype.onError=function(t){this.pw.error(t)},t.prototype.Tv=function(t){this.onlineState=t;var e=!1;return this.bw&&!this.gw&&this._w(this.bw,t)&&(this.Iw(this.bw),e=!0),e},t.prototype._w=function(t,e){if(w(!this.gw,"Determining whether to raise first event but already had first event"),!t.fromCache)return!0;var n="Offline"!==e;return this.options.Tw&&n?(w(t.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!t.docs.J()||"Offline"===e},t.prototype.yw=function(t){if(t.docChanges.length>0)return!0;var e=this.bw&&this.bw.hasPendingWrites!==t.hasPendingWrites;return!(!t.Ti&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.Iw=function(t){w(!this.gw,"Trying to raise initial events for second time"),t=ze.Di(t.query,t.docs,t.Ii,t.fromCache),this.gw=!0,this.pw.next(t)},t}(),Qi=function(){function t(t,e){this.cacheSizeBytes=t,this.synchronizeTabs=e}return t.prototype.Xc=function(){return Zn.jh(this.cacheSizeBytes)},t}(),Yi=function(){},Ji=function(){function t(t,e,n,r){this.platform=t,this.Ew=e,this.credentials=n,this.Qr=r,this.clientId=b.u()}return t.prototype.start=function(t){var e=this;this.Dw();var n=new yn,r=new yn,i=!1;return this.credentials.T((function(o){i?e.Qr.$r((function(){return e.bd(o)})):(i=!0,e.Sw(t,r,o).then((function(t){return e.Rw(o,t)})).then(n.resolve,n.reject))})),this.Qr.$r((function(){return n.promise})),r.promise},t.prototype.enableNetwork=function(){var t=this;return this.Dw(),this.Qr.enqueue((function(){return t.rd.enableNetwork()}))},t.prototype.Sw=function(t,e,n){var r=this;return t instanceof Qi?this.Cw(n,t).then((function(t){return e.resolve(),t})).catch((function(t){if(e.reject(t),!r.Aw(t))throw t;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+t),r.Pw()})):(e.resolve(),this.Pw())},t.prototype.Aw=function(t){return t instanceof O?t.code===A.FAILED_PRECONDITION||t.code===A.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||(22===t.code||20===t.code||11===t.code)},t.prototype.Dw=function(){if(this.Qr.uu)throw new O(A.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.Cw=function(t,e){var n=this,r=qr.Ia(this.Ew),i=new un(this.Ew.s,{Te:!0});return Promise.resolve().then((function(){return s.__awaiter(n,void 0,void 0,(function(){var n,o;return s.__generator(this,(function(s){switch(s.label){case 0:if(e.synchronizeTabs&&!Ui.cs(this.platform))throw new O(A.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");return n=e.Xc(),this.Fv=e.synchronizeTabs?new Ui(this.Qr,this.platform,r,this.clientId,t):new Mi,[4,qr.Yc({allowTabSynchronization:e.synchronizeTabs,persistenceKey:r,clientId:this.clientId,platform:this.platform,Lc:this.Qr,serializer:i,Xc:n,qc:this.Fv})];case 1:return o=s.sent(),this.persistence=o,[2,o.As.Wh]}}))}))}))},t.prototype.Pw=function(){return this.persistence=Yr.Wa(this.clientId),this.Fv=new Mi,Promise.resolve(null)},t.prototype.Rw=function(t,e){var n=this;return v("FirestoreClient","Initializing. user=",t.uid),this.platform.kw(this.Ew).then((function(r){return s.__awaiter(n,void 0,void 0,(function(){var n,i,o,a,u,c,h=this;return s.__generator(this,(function(f){switch(f.label){case 0:return n=new Hr,this.zh=new Qn(this.persistence,n,t),[4,this.zh.start()];case 1:return f.sent(),e&&(this.Nw=new tr(e,this.Qr,this.zh)),i=this.platform.Ow(),o=this.platform.Fw(this.Ew.s),a=new ri(this.Qr,r,this.credentials,o),u=function(t){return h.rd.Tv(t,0)},c=function(t){return h.rd.Tv(t,1)},this.Rv=new Ai(this.zh,a,this.Qr,u,i),this.rd=new zi(this.zh,this.Rv,this.Fv,t),this.Fv.El=c,this.Rv.rd=this.rd,this.Fv.rd=this.rd,this.Vw=new Wi(this.rd),[4,this.Fv.start()];case 2:return f.sent(),[4,this.Rv.start()];case 3:return f.sent(),[4,this.persistence.ra((function(t){return s.__awaiter(h,void 0,void 0,(function(){return s.__generator(this,(function(e){switch(e.label){case 0:return[4,this.rd.yd(t)];case 1:return e.sent(),this.Nw&&(t&&!this.Nw.Co?this.Nw.start():t||this.Nw.stop()),[2]}}))}))}))];case 4:return f.sent(),[4,this.persistence.ua((function(){return s.__awaiter(h,void 0,void 0,(function(){return s.__generator(this,(function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}}))}))}))];case 5:return f.sent(),[2]}}))}))}))},t.prototype.bd=function(t){return this.Qr.du(),v("FirestoreClient","Credential Changed. Current user: "+t.uid),this.rd.bd(t)},t.prototype.disableNetwork=function(){var t=this;return this.Dw(),this.Qr.enqueue((function(){return t.rd.disableNetwork()}))},t.prototype.terminate=function(){var t=this;return this.Qr.au((function(){return s.__awaiter(t,void 0,void 0,(function(){return s.__generator(this,(function(t){switch(t.label){case 0:return this.Nw&&this.Nw.stop(),[4,this.Rv.shutdown()];case 1:return t.sent(),[4,this.Fv.shutdown()];case 2:return t.sent(),[4,this.persistence.shutdown()];case 3:return t.sent(),this.credentials.D(),[2]}}))}))}))},t.prototype.waitForPendingWrites=function(){var t=this;this.Dw();var e=new yn;return this.Qr.$r((function(){return t.rd.nw(e)})),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.Dw();var i=new Ki(t,e,n);return this.Qr.$r((function(){return r.Vw.listen(i)})),i},t.prototype.nd=function(t){var e=this;this.Uw||this.Qr.$r((function(){return e.Vw.nd(t)}))},t.prototype.xw=function(t){var e=this;return this.Dw(),this.Qr.enqueue((function(){return e.zh.oh(t)})).then((function(t){if(t instanceof te)return t;if(t instanceof ee)return null;throw new O(A.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")}))},t.prototype.jw=function(t){var e=this;return this.Dw(),this.Qr.enqueue((function(){return s.__awaiter(e,void 0,void 0,(function(){var e,n,r;return s.__generator(this,(function(i){switch(i.label){case 0:return[4,this.zh.vh(t,!0)];case 1:return e=i.sent(),n=new qi(t,e.mh),r=n.pv(e.documents),[2,n.es(r,!1).snapshot]}}))}))}))},t.prototype.write=function(t){var e=this;this.Dw();var n=new yn;return this.Qr.$r((function(){return e.rd.write(t,n)})),n.promise},t.prototype.s=function(){return this.Ew.s},t.prototype.ww=function(t){var e=this;this.Dw(),this.Qr.$r((function(){return e.Vw.ww(t),Promise.resolve()}))},t.prototype.mw=function(t){this.Uw||this.Vw.mw(t)},Object.defineProperty(t.prototype,"Uw",{get:function(){return this.Qr.uu},enumerable:!0,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.Dw();var n=new yn;return this.Qr.$r((function(){return e.rd.runTransaction(e.Qr,t,n),Promise.resolve()})),n.promise},t}(),Xi=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.Lw(this.observer.next,t)},t.prototype.error=function(t){this.Lw(this.observer.error,t)},t.prototype.qw=function(){this.muted=!0},t.prototype.Lw=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}();function $i(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=e;r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t,["next","error","complete"])}var Zi=Zn.Bh,to=function(){function t(t){if(void 0===t.host){if(void 0!==t.ssl)throw new O(A.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else K("settings","non-empty string","host",t.host),this.host=t.host,Q("settings","boolean","ssl",t.ssl),this.ssl=U(t.ssl,!0);if(nt("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),Q("settings","object","credentials",t.credentials),this.credentials=t.credentials,Q("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?y("\n  The timestampsInSnapshots setting now defaults to true and you no\n  longer need to explicitly set it. In a future release, the setting\n  will be removed entirely and so it is recommended that you remove it\n  from your firestore.settings() call now."):!1===t.timestampsInSnapshots&&y("\n  The timestampsInSnapshots setting will soon be removed. YOU MUST UPDATE\n  YOUR CODE.\n\n  To hide this warning, stop using the timestampsInSnapshots setting in your\n  firestore.settings({ ... }) call.\n\n  Once you remove the setting, Timestamps stored in Cloud Firestore will be\n  read back as Firebase Timestamp objects instead of as system Date objects.\n  So you will also need to update code expecting a Date to instead expect a\n  Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at'); const date =\n  timestamp.toDate();\n\n  Please audit all existing usages of Date when you enable the new\n  behavior."),this.timestampsInSnapshots=U(t.timestampsInSnapshots,!0),Q("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Zn.Qh;else{if(t.cacheSizeBytes!==Zi&&t.cacheSizeBytes<Zn.Mh)throw new O(A.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Zn.Mh);this.cacheSizeBytes=t.cacheSizeBytes}Q("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},t}(),eo=function(){function t(e,n){var r=this;if(this.Bw=null,this.Mw=new gn,this.INTERNAL={delete:function(){return s.__awaiter(r,void 0,void 0,(function(){return s.__generator(this,(function(t){switch(t.label){case 0:return this.Qw(),[4,this.Gw.terminate()];case 1:return t.sent(),[2]}}))}))}},"object"==typeof e.options){var i=e;this.Bw=i,this.Ww=t.zw(i),this.Kw=i.name,this.Hw=new C(n)}else{var o=e;if(!o.projectId)throw new O(A.INVALID_ARGUMENT,"Must provide projectId");this.Ww=new S(o.projectId,o.database),this.Kw="[DEFAULT]",this.Hw=new R}this.Jw=new to({}),this.Yw=this.Xw(this.Ww)}return t.prototype.settings=function(t){if(G("Firestore.settings",arguments,1),H("Firestore.settings","object",1,t),L(t,"persistence"))throw new O(A.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var e=new to(t);if(this.Gw&&!this.Jw.isEqual(e))throw new O(A.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this.Jw=e,void 0!==e.credentials&&(this.Hw=x(e.credentials))},t.prototype.enableNetwork=function(){return this.Qw(),this.Gw.enableNetwork()},t.prototype.disableNetwork=function(){return this.Qw(),this.Gw.disableNetwork()},t.prototype.enablePersistence=function(t){if(this.Gw)throw new O(A.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1;return t&&(void 0!==t.experimentalTabSynchronization&&y("The 'experimentalTabSynchronization' setting has been renamed to 'synchronizeTabs'. In a future release, the setting will be removed and it is recommended that you update your firestore.enablePersistence() call to use 'synchronizeTabs'."),e=U(void 0!==t.synchronizeTabs?t.synchronizeTabs:t.experimentalTabSynchronization,!1)),this.$w(new Qi(this.Jw.cacheSizeBytes,e))},t.prototype.clearPersistence=function(){var t=this,e=qr.Ia(this.Zw()),n=new yn;return this.Mw.su((function(){return s.__awaiter(t,void 0,void 0,(function(){var t;return s.__generator(this,(function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),void 0!==this.Gw&&!this.Gw.Uw)throw new O(A.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return[4,qr.clearPersistence(e)];case 1:return r.sent(),n.resolve(),[3,3];case 2:return t=r.sent(),n.reject(t),[3,3];case 3:return[2]}}))}))})),n.promise},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"tm",{get:function(){return this.Qw(),this.Gw.Uw},enumerable:!0,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this.Qw(),this.Gw.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){if(this.Qw(),$i(t))return this.nm(t);H("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.nm(e)},t.prototype.nm=function(t){var e=this,n=new Xi({next:function(){t.next&&t.next()},error:function(t){throw g("Uncaught Error in onSnapshotsInSync")}});return this.Gw.ww(n),function(){n.qw(),e.Gw.mw(n)}},t.prototype.Qw=function(){return this.Gw||this.$w(new Yi),this.Gw},t.prototype.Zw=function(){return new T(this.Ww,this.Kw,this.Jw.host,this.Jw.ssl,this.Jw.forceLongPolling)},t.prototype.$w=function(t){w(!!this.Jw.host,"FirestoreSettings.host is not set"),w(!this.Gw,"configureClient() called multiple times");var e=this.Zw();return this.Gw=new Ji(cn.t(),e,this.Hw,this.Mw),this.Gw.start(t)},t.prototype.Xw=function(t){return new wi((function(e){if(e instanceof io){var n=t,r=e.firestore.Ww;if(!r.isEqual(n))throw new O(A.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new gi(t,e.im)}return e}))},t.zw=function(t){var e=t.options;if(!L(e,"projectId"))throw new O(A.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var n=e.projectId;if(!n||"string"!=typeof n)throw new O(A.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new S(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.Bw)throw new O(A.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Bw},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){return G("Firestore.collection",arguments,1),H("Firestore.collection","non-empty string",1,t),this.Qw(),new ho(ft.it(t),this)},t.prototype.doc=function(t){return G("Firestore.doc",arguments,1),H("Firestore.doc","non-empty string",1,t),this.Qw(),io.em(ft.it(t),this)},t.prototype.collectionGroup=function(t){if(G("Firestore.collectionGroup",arguments,1),H("Firestore.collectionGroup","non-empty string",1,t),t.indexOf("/")>=0)throw new O(A.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Qw(),new uo(new ae(ft.et,t),this)},t.prototype.runTransaction=function(t){var e=this;return G("Firestore.runTransaction",arguments,1),H("Firestore.runTransaction","function",1,t),this.Qw().transaction((function(n){return t(new no(e,n))}))},t.prototype.batch=function(){return this.Qw(),new ro(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(p()){case 0:return"debug";case 1:return"error";case 2:return"silent";default:return g("Unknown log level: "+p())}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(G("Firestore.setLogLevel",arguments,1),H("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":d(0);break;case"error":d(1);break;case"silent":d(2);break;default:throw new O(A.INVALID_ARGUMENT,"Invalid log level: "+t)}},t.prototype.rm=function(){return this.Jw.timestampsInSnapshots},t}(),no=function(){function t(t,e){this.um=t,this.sm=e}return t.prototype.get=function(t){var e=this;G("Transaction.get",arguments,1);var n=vo("Transaction.get",t,this.um);return this.sm.lookup([n.im]).then((function(t){if(!t||1!==t.length)return g("Mismatch in docs returned from document lookup.");var r=t[0];if(r instanceof ee)return new so(e.um,n.im,null,!1,!1,n.om);if(r instanceof te)return new so(e.um,n.im,r,!1,!1,n.om);throw g("BatchGetDocumentsRequest returned unexpected document type: "+r.constructor.name)}))},t.prototype.set=function(t,e,n){B("Transaction.set",arguments,2,3);var r=vo("Transaction.set",t,this.um);n=fo("Transaction.set",n);var i=mo(r.om,e,"Transaction.set"),o=i[0],s=i[1],a=n.merge||n.mergeFields?this.um.Yw.sl(s,o,n.mergeFields):this.um.Yw.rl(s,o);return this.sm.set(r.im,a),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return"string"==typeof e||e instanceof ii?(V("Transaction.update",arguments,3),r=vo("Transaction.update",t,this.um),i=this.um.Yw.cl("Transaction.update",e,n,o)):(G("Transaction.update",arguments,2),r=vo("Transaction.update",t,this.um),i=this.um.Yw.ol("Transaction.update",e)),this.sm.update(r.im,i),this},t.prototype.delete=function(t){G("Transaction.delete",arguments,1);var e=vo("Transaction.delete",t,this.um);return this.sm.delete(e.im),this},t}(),ro=function(){function t(t){this.um=t,this.hm=[],this.cm=!1}return t.prototype.set=function(t,e,n){B("WriteBatch.set",arguments,2,3),this.am();var r=vo("WriteBatch.set",t,this.um);n=fo("WriteBatch.set",n);var i=mo(r.om,e,"WriteBatch.set"),o=i[0],s=i[1],a=n.merge||n.mergeFields?this.um.Yw.sl(s,o,n.mergeFields):this.um.Yw.rl(s,o);return this.hm=this.hm.concat(a.Hf(r.im,kt.NONE)),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.am(),"string"==typeof e||e instanceof ii?(V("WriteBatch.update",arguments,3),r=vo("WriteBatch.update",t,this.um),i=this.um.Yw.cl("WriteBatch.update",e,n,o)):(G("WriteBatch.update",arguments,2),r=vo("WriteBatch.update",t,this.um),i=this.um.Yw.ol("WriteBatch.update",e)),this.hm=this.hm.concat(i.Hf(r.im,kt.exists(!0))),this},t.prototype.delete=function(t){G("WriteBatch.delete",arguments,1),this.am();var e=vo("WriteBatch.delete",t,this.um);return this.hm=this.hm.concat(new xt(e.im,kt.NONE)),this},t.prototype.commit=function(){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(t){return this.am(),this.cm=!0,this.hm.length>0?[2,this.um.Qw().write(this.hm)]:[2]}))}))},t.prototype.am=function(){if(this.cm)throw new O(A.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),io=function(){function t(t,e,n){this.im=t,this.firestore=e,this.om=n,this.Gw=this.firestore.Qw()}return t.em=function(e,n,r){if(e.length%2!=0)throw new O(A.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.nt()+" has "+e.length);return new t(new dt(e),n,r)},Object.defineProperty(t.prototype,"id",{get:function(){return this.im.path.X()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new ho(this.im.path.H(),this.firestore,this.om)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.im.path.nt()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(G("DocumentReference.collection",arguments,1),H("DocumentReference.collection","non-empty string",1,t),!t)throw new O(A.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=ft.it(t);return new ho(this.im.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw rt("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this.im.isEqual(e.im)&&this.om===e.om},t.prototype.set=function(t,e){B("DocumentReference.set",arguments,1,2),e=fo("DocumentReference.set",e);var n=mo(this.om,t,"DocumentReference.set"),r=n[0],i=n[1],o=e.merge||e.mergeFields?this.firestore.Yw.sl(i,r,e.mergeFields):this.firestore.Yw.rl(i,r);return this.Gw.write(o.Hf(this.im,kt.NONE))},t.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof t||t instanceof ii?(V("DocumentReference.update",arguments,2),n=this.firestore.Yw.cl("DocumentReference.update",t,e,r)):(G("DocumentReference.update",arguments,1),n=this.firestore.Yw.ol("DocumentReference.update",t)),this.Gw.write(n.Hf(this.im,kt.exists(!0)))},t.prototype.delete=function(){return G("DocumentReference.delete",arguments,0),this.Gw.write([new xt(this.im,kt.NONE)])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];B("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||$i(t[i])||(nt("DocumentReference.onSnapshot",r=t[i],["includeMetadataChanges"]),Q("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return $i(t[i])?n=t[i]:(H("DocumentReference.onSnapshot","function",i,t[i]),W("DocumentReference.onSnapshot","function",i+1,t[i+1]),W("DocumentReference.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.fm(o,n)},t.prototype.fm=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Xi({next:function(t){if(e.next){w(t.docs.size<=1,"Too many documents returned on a document query");var r=t.docs.get(n.im);e.next(new so(n.firestore,n.im,r,t.fromCache,t.hasPendingWrites,n.om))}},error:r}),o=this.Gw.listen(ae.jn(this.im.path),i,t);return function(){i.qw(),n.Gw.nd(o)}},t.prototype.get=function(t){var e=this;return B("DocumentReference.get",arguments,0,1),po("DocumentReference.get",t),new Promise((function(n,r){t&&"cache"===t.source?e.firestore.Qw().xw(e.im).then((function(t){n(new so(e.firestore,e.im,t,!0,t instanceof te&&t.en,e.om))}),r):e.lm(n,r,t)}))},t.prototype.lm=function(t,e,n){var r=this.fm({includeMetadataChanges:!0,Tw:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new O(A.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?e(new O(A.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(i)},error:e})},t.prototype.withConverter=function(e){return new t(this.im,this.firestore,e)},t}(),oo=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),so=function(){function t(t,e,n,r,i,o){this.um=t,this.im=e,this.dm=n,this.vm=r,this.wm=i,this.om=o}return t.prototype.data=function(t){if(B("DocumentSnapshot.data",arguments,0,1),t=lo("DocumentSnapshot.data",t),this.dm){if(this.om){var e=new ao(this.um,this.im,this.dm,this.vm,this.wm);return this.om.fromFirestore(e,t)}return this.mm(this.dm.data(),Ut.mn(t,this.um.rm()))}},t.prototype.get=function(t,e){if(B("DocumentSnapshot.get",arguments,1,2),e=lo("DocumentSnapshot.get",e),this.dm){var n=this.dm.data().field(Ei("DocumentSnapshot.get",t));if(null!==n)return this.pm(n,Ut.mn(e,this.um.rm()))}},Object.defineProperty(t.prototype,"id",{get:function(){return this.im.path.X()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new io(this.im,this.um,this.om)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this.dm},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new oo(this.wm,this.vm)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw rt("isEqual","DocumentSnapshot",1,e);return this.um===e.um&&this.vm===e.vm&&this.im.isEqual(e.im)&&(null===this.dm?null===e.dm:this.dm.isEqual(e.dm))&&this.om===e.om},t.prototype.mm=function(t,e){var n=this,r={};return t.forEach((function(t,i){r[t]=n.pm(i,e)})),r},t.prototype.pm=function(t,e){if(t instanceof Jt)return this.mm(t,e);if(t instanceof $t)return this.gm(t,e);if(t instanceof Qt){var n=t.value(e),r=this.um.Qw().s();return t.s.isEqual(r)||y("Document "+this.im.path+" contains a document reference within a different database ("+t.s.projectId+"/"+t.s.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new io(n,this.um,this.om)}return t.value(e)},t.prototype.gm=function(t,e){var n=this;return t.Ht.map((function(t){return n.pm(t,e)}))},t}(),ao=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s.__extends(e,t),e.prototype.data=function(e){var n=t.prototype.data.call(this,e);return w(void 0!==n,"Document in a QueryDocumentSnapshot should exist"),n},e}(so),uo=function(){function t(t,e,n){this.bm=t,this.firestore=e,this.om=n}return t.prototype.where=function(e,n,r){G("Query.where",arguments,3),et("Query.where",3,r);var i,o=["<","<=","==",">=",">","array-contains","in","array-contains-any"];X("Query.where",o,2,n);var s=Ei("Query.where",e),a=ce.it(n);if(s.ut()){if(a===ce.ARRAY_CONTAINS||a===ce.ARRAY_CONTAINS_ANY)throw new O(A.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+a.toString()+"' queries on FieldPath.documentId().");if(a===ce.IN){this.ym(r,a);for(var u=[],c=0,h=r;c<h.length;c++){var f=h[c];u.push(this._m(f))}i=new $t(u)}else i=this._m(r)}else a!==ce.IN&&a!==ce.ARRAY_CONTAINS_ANY||this.ym(r,a),i=this.firestore.Yw.al("Query.where",r,a===ce.IN);var l=he.create(s,a,i);return this.Im(l),new t(this.bm.Bn(l),this.firestore,this.om)},t.prototype.orderBy=function(e,n){var r;if(B("Query.orderBy",arguments,1,2),W("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r=ye.ASCENDING;else{if("desc"!==n)throw new O(A.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=ye.DESCENDING}if(null!==this.bm.startAt)throw new O(A.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.bm.endAt)throw new O(A.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=Ei("Query.orderBy",e),o=new ge(i,r);return this.Tm(o),new t(this.bm.Qn(o),this.firestore,this.om)},t.prototype.limit=function(e){return G("Query.limit",arguments,1),H("Query.limit","number",1,e),it("Query.limit",1,e),new t(this.bm.Gn(e),this.firestore,this.om)},t.prototype.limitToLast=function(e){return G("Query.limitToLast",arguments,1),H("Query.limitToLast","number",1,e),it("Query.limitToLast",1,e),new t(this.bm.Wn(e),this.firestore,this.om)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];V("Query.startAt",arguments,1);var i=this.Em("Query.startAt",e,n,!0);return new t(this.bm.zn(i),this.firestore,this.om)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];V("Query.startAfter",arguments,1);var i=this.Em("Query.startAfter",e,n,!1);return new t(this.bm.zn(i),this.firestore,this.om)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];V("Query.endBefore",arguments,1);var i=this.Em("Query.endBefore",e,n,!0);return new t(this.bm.Kn(i),this.firestore,this.om)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];V("Query.endAt",arguments,1);var i=this.Em("Query.endAt",e,n,!1);return new t(this.bm.Kn(i),this.firestore,this.om)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw rt("isEqual","Query",1,e);return this.firestore===e.firestore&&this.bm.isEqual(e.bm)},t.prototype.withConverter=function(e){return new t(this.bm,this.firestore,e)},t.prototype.Em=function(t,e,n,r){if(et(t,1,e),e instanceof so){if(n.length>0)throw new O(A.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new O(A.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.Dm(t,i.dm,r)}var o=[e].concat(n);return this.Sm(t,o,r)},t.prototype.Dm=function(t,e,n){for(var r=[],i=0,o=this.bm.orderBy;i<o.length;i++){var s=o[i];if(s.field.ut())r.push(new Qt(this.firestore.Ww,e.key));else{var a=e.field(s.field);if(a instanceof Wt)throw new O(A.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var u=s.field.nt();throw new O(A.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(a)}}return new me(r,n)},t.prototype.Sm=function(t,e,n){var r=this.bm.On;if(e.length>r.length)throw new O(A.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var s=e[o];if(r[o].field.ut()){if("string"!=typeof s)throw new O(A.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.bm.ui()&&-1!==s.indexOf("/"))throw new O(A.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var a=this.bm.path.child(ft.it(s));if(!dt.ht(a))throw new O(A.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+a+"' is not because it contains an odd number of segments.");var u=new dt(a);i.push(new Qt(this.firestore.Ww,u))}else{var c=this.firestore.Yw.al(t,s);i.push(c)}}return new me(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];B("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||$i(t[i])||(nt("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),Q("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),$i(t[i])?n=t[i]:(H("Query.onSnapshot","function",i,t[i]),W("Query.onSnapshot","function",i+1,t[i+1]),W("Query.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.Rm(this.bm),this.fm(r,n)},t.prototype.fm=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Xi({next:function(t){e.next&&e.next(new co(n.firestore,n.bm,t,n.om))},error:r}),o=this.firestore.Qw(),s=o.listen(this.bm,i,t);return function(){i.qw(),o.nd(s)}},t.prototype.Rm=function(t){if(t.ei()&&0===t.On.length)throw new O(A.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},t.prototype.get=function(t){var e=this;return B("Query.get",arguments,0,1),po("Query.get",t),this.Rm(this.bm),new Promise((function(n,r){t&&"cache"===t.source?e.firestore.Qw().jw(e.bm).then((function(t){n(new co(e.firestore,e.bm,t,e.om))}),r):e.lm(n,r,t)}))},t.prototype.lm=function(t,e,n){var r=this.fm({includeMetadataChanges:!0,Tw:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?e(new O(A.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(i)},error:e})},t.prototype._m=function(t){if("string"==typeof t){if(""===t)throw new O(A.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.bm.ui()&&-1!==t.indexOf("/"))throw new O(A.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.bm.path.child(ft.it(t));if(!dt.ht(e))throw new O(A.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return new Qt(this.firestore.Ww,new dt(e))}if(t instanceof io){var n=t;return new Qt(this.firestore.Ww,n.im)}throw new O(A.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+tt(t)+".")},t.prototype.ym=function(t,e){if(!Array.isArray(t)||0===t.length)throw new O(A.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new O(A.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(t.indexOf(null)>=0)throw new O(A.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(t.filter((function(t){return Number.isNaN(t)})).length>0)throw new O(A.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},t.prototype.Im=function(t){if(t instanceof he){var e=[ce.ARRAY_CONTAINS,ce.ARRAY_CONTAINS_ANY],n=[ce.IN,ce.ARRAY_CONTAINS_ANY],r=e.indexOf(t.op)>=0,i=n.indexOf(t.op)>=0;if(t.Mn()){var o=this.bm.Ln();if(null!==o&&!o.isEqual(t.field))throw new O(A.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.bm.qn();null!==s&&this.Cm(t.field,s)}else if(i||r){var a=null;if(i&&(a=this.bm.ri(n)),null===a&&r&&(a=this.bm.ri(e)),null!=a)throw a===t.op?new O(A.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new O(A.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+a.toString()+"' filters.")}}},t.prototype.Tm=function(t){if(null===this.bm.qn()){var e=this.bm.Ln();null!==e&&this.Cm(e,t.field)}},t.prototype.Cm=function(t,e){if(!e.isEqual(t))throw new O(A.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},t}(),co=function(){function t(t,e,n,r){this.um=t,this.Am=e,this.Pm=n,this.om=r,this.km=null,this.Nm=null,this.metadata=new oo(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.Pm.docs.J()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.Pm.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;B("QuerySnapshot.forEach",arguments,1,2),H("QuerySnapshot.forEach","function",1,t),this.Pm.docs.forEach((function(r){t.call(e,n.Om(r))}))},Object.defineProperty(t.prototype,"query",{get:function(){return new uo(this.Am,this.um,this.om)},enumerable:!0,configurable:!0}),t.prototype.docChanges=function(t){t&&(nt("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Q("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Pm.Ei)throw new O(A.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.km&&this.Nm===e||(this.km=function(t,e,n,r){if(n._i.J()){var i,o=0;return n.docChanges.map((function(e){var s=new ao(t,e.doc.key,e.doc,n.fromCache,n.Ii.has(e.doc.key),r);return w(0===e.type,"Invalid event type for first snapshot"),w(!i||n.query.Xn(i,e.doc)<0,"Got added events in wrong order"),i=e.doc,{type:"added",doc:s,oldIndex:-1,newIndex:o++}}))}var s=n._i;return n.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var i=new ao(t,e.doc.key,e.doc,n.fromCache,n.Ii.has(e.doc.key),r),o=-1,a=-1;return 0!==e.type&&(w((o=s.indexOf(e.doc.key))>=0,"Index for document not found"),s=s.delete(e.doc.key)),1!==e.type&&(a=(s=s.add(e.doc)).indexOf(e.doc.key)),{type:yo(e.type),doc:i,oldIndex:o,newIndex:a}}))}(this.um,e,this.Pm,this.om),this.Nm=e),this.km},t.prototype.isEqual=function(e){if(!(e instanceof t))throw rt("isEqual","QuerySnapshot",1,e);return this.um===e.um&&this.Am.isEqual(e.Am)&&this.Pm.isEqual(e.Pm)&&this.om===e.om},t.prototype.Om=function(t){return new ao(this.um,t.key,t,this.metadata.fromCache,this.Pm.Ii.has(t.key),this.om)},t}();s.__spreadArrays(["length","forEach","map"],"undefined"!=typeof Symbol?[Symbol.iterator]:[]).forEach((function(t){try{Object.defineProperty(co.prototype.docChanges,t,{get:function(){return function(){throw new O(A.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}()}})}catch(t){}}));var ho=function(t){function e(e,n,r){var i=t.call(this,ae.jn(e),n,r)||this;if(i.Fm=e,e.length%2!=1)throw new O(A.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.nt()+" has "+e.length);return i}return s.__extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.bm.path.X()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.bm.path.H();return t.J()?null:new io(new dt(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.bm.path.nt()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(B("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=b.u()),H("CollectionReference.doc","non-empty string",1,t),""===t)throw new O(A.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=ft.it(t);return io.em(this.bm.path.child(e),this.firestore,this.om)},e.prototype.add=function(t){G("CollectionReference.add",arguments,1);var e=this.om?this.om.toFirestore(t):t;H("CollectionReference.add","object",1,e);var n=this.doc();return n.set(t).then((function(){return n}))},e.prototype.withConverter=function(t){return new e(this.Fm,this.firestore,t)},e}(uo);function fo(t,e){if(void 0===e)return{merge:!1};if(nt(t,e,["merge","mergeFields"]),Q(t,"boolean","merge",e.merge),Y(t,"mergeFields","a string or a FieldPath",e.mergeFields,(function(t){return"string"==typeof t||t instanceof ii})),void 0!==e.mergeFields&&void 0!==e.merge)throw new O(A.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function lo(t,e){return void 0===e?{}:(nt(t,e,["serverTimestamps"]),J(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function po(t,e){W(t,"object",1,e),e&&(nt(t,e,["source"]),J(t,0,"source",e.source,["default","server","cache"]))}function vo(t,e,n){if(e instanceof io){if(e.firestore!==n)throw new O(A.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw rt(t,"DocumentReference",1,e)}function yo(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return g("Unknown change type: "+t)}}function mo(t,e,n){var r;return t?(r=t.toFirestore(e),n="toFirestore() in "+n):r=e,[r,n]}var go=hn(eo,"Use firebase.firestore() instead."),wo=hn(no,"Use firebase.firestore().runTransaction() instead."),bo=hn(ro,"Use firebase.firestore().batch() instead."),_o=hn(io,"Use firebase.firestore().doc() instead."),Eo=hn(so),Io=hn(ao),To=hn(uo),So=hn(co),No=hn(ho,"Use firebase.firestore().collection() instead."),Ao={Firestore:go,GeoPoint:at,Timestamp:ut,Blob:dn,Transaction:wo,WriteBatch:bo,DocumentReference:_o,DocumentSnapshot:Eo,Query:To,QueryDocumentSnapshot:Io,QuerySnapshot:So,CollectionReference:No,FieldPath:ii,FieldValue:li,setLogLevel:eo.setLogLevel,CACHE_SIZE_UNLIMITED:Zi};function Oo(t){var e;t.INTERNAL.registerComponent(new c.Component("firestore",(function(t){var e=t.getProvider("app").getImmediate();return new eo(e,t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps((w((e=Ao)&&"object"==typeof e,"shallowCopy() expects object parameter."),s.__assign({},e))))}var ko=function(){function t(){}return t.prototype.xl=function(t){},t.prototype.shutdown=function(){},t}(),Ro=function(){function t(){var t=this;this.Vm=function(){return t.Um()},this.xm=function(){return t.jm()},this.Lm=[],this.qm()}return t.prototype.xl=function(t){this.Lm.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.Vm),window.removeEventListener("offline",this.xm)},t.prototype.qm=function(){window.addEventListener("online",this.Vm),window.addEventListener("offline",this.xm)},t.prototype.Um=function(){v("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Lm;t<e.length;t++){(0,e[t])(0)}},t.prototype.jm=function(){v("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Lm;t<e.length;t++){(0,e[t])(1)}},t.cs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Co=function(){function t(t){this.Bm=t.Bm,this.Mm=t.Mm}return t.prototype.Af=function(t){w(!this.Qm,"Called onOpen on stream twice!"),this.Qm=t},t.prototype.Ef=function(t){w(!this.Gm,"Called onClose on stream twice!"),this.Gm=t},t.prototype.onMessage=function(t){w(!this.Wm,"Called onMessage on stream twice!"),this.Wm=t},t.prototype.close=function(){this.Mm()},t.prototype.send=function(t){this.Bm(t)},t.prototype.zm=function(){w(void 0!==this.Qm,"Cannot call onOpen because no callback was set"),this.Qm()},t.prototype.Km=function(t){w(void 0!==this.Gm,"Cannot call onClose because no callback was set"),this.Gm(t)},t.prototype.Hm=function(t){w(void 0!==this.Wm,"Cannot call onMessage because no callback was set"),this.Wm(t)},t}(),Do={BatchGetDocuments:"batchGet",Commit:"commit"},Po="gl-js/ fire/"+f,xo=function(){function t(t){this.s=t.s;var e=t.ssl?"https":"http";this.Jm=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}return t.prototype.Ym=function(t,e){if(e)for(var n in e.g)e.g.hasOwnProperty(n)&&(t[n]=e.g[n]);t["X-Goog-Api-Client"]=Po},t.prototype.Bf=function(t,e,n){var r=this,i=this.Xm(t);return new Promise((function(o,a){var u=new h.XhrIo;u.listenOnce(h.EventType.COMPLETE,(function(){try{switch(u.getLastErrorCode()){case h.ErrorCode.NO_ERROR:var e=u.getResponseJson();v("Connection","XHR received:",JSON.stringify(e)),o(e);break;case h.ErrorCode.TIMEOUT:v("Connection",'RPC "'+t+'" timed out'),a(new O(A.DEADLINE_EXCEEDED,"Request time out"));break;case h.ErrorCode.HTTP_ERROR:var n=u.getStatus();if(v("Connection",'RPC "'+t+'" failed with status:',n,"response text:",u.getResponseText()),n>0){var r=u.getResponseJson().error;if(r&&r.status&&r.message){var i=(s=r.status,c=s.toLowerCase().replace("_","-"),Object.values(A).indexOf(c)>=0?c:A.UNKNOWN);a(new O(i,r.message))}else a(new O(A.UNKNOWN,"Server responded with status "+u.getStatus()))}else v("Connection",'RPC "'+t+'" failed'),a(new O(A.UNAVAILABLE,"Connection failed."));break;default:g('RPC "'+t+'" failed with unanticipated webchannel error '+u.getLastErrorCode()+": "+u.getLastError()+", giving up.")}}finally{v("Connection",'RPC "'+t+'" completed.')}var s,c}));var c=s.__assign({},e);delete c.database;var f=JSON.stringify(c);v("Connection","XHR sending: ",i+" "+f);var l={"Content-Type":"text/plain"};r.Ym(l,n),u.send(i,"POST",f,l,15)}))},t.prototype.Mf=function(t,e,n){return this.Bf(t,e,n)},t.prototype.Pf=function(t,e){var n=[this.Jm,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=h.createWebChannelTransport(),i={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Ym(i.initMessageHeaders,e),u.isMobileCordova()||u.isReactNative()||u.isElectron()||u.isIE()||u.isUWP()||u.isBrowserExtension()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");v("Connection","Creating WebChannel: "+o+" "+i);var s=r.createWebChannel(o,i),a=!1,c=!1,f=new Co({Bm:function(t){c?v("Connection","Not sending because WebChannel is closed:",t):(a||(v("Connection","Opening WebChannel transport."),s.open(),a=!0),v("Connection","WebChannel sending:",t),s.send(t))},Mm:function(){return s.close()}}),l=function(t,e){s.listen(t,(function(t){try{e(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return l(h.WebChannel.EventType.OPEN,(function(){c||v("Connection","WebChannel transport opened.")})),l(h.WebChannel.EventType.CLOSE,(function(){c||(c=!0,v("Connection","WebChannel transport closed"),f.Km())})),l(h.WebChannel.EventType.ERROR,(function(t){c||(c=!0,v("Connection","WebChannel transport errored:",t),f.Km(new O(A.UNAVAILABLE,"The operation could not be completed")))})),l(h.WebChannel.EventType.MESSAGE,(function(t){var e;if(!c){var n=t.data[0];w(!!n,"Got a webchannel message without data.");var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){v("Connection","WebChannel received error:",i);var o=i.status,a=function(t){var e=Te[t];if(void 0!==e)return ke(e)}(o),u=i.message;void 0===a&&(a=A.INTERNAL,u="Unknown error status: "+o+" with message "+i.message),c=!0,f.Km(new O(a,u)),s.close()}else v("Connection","WebChannel received:",n),f.Hm(n)}})),setTimeout((function(){f.zm()}),0),f},t.prototype.Xm=function(t){var e=Do[t];return w(void 0!==e,"Unknown REST mapping for: "+t),this.Jm+"/v1/projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents:"+e},t}(),Lo=function(){function t(){this.xr="undefined"!=typeof atob}return Object.defineProperty(t.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),t.prototype.kw=function(t){return Promise.resolve(new xo(t))},t.prototype.Ow=function(){return Ro.cs()?new Ro:new ko},t.prototype.Fw=function(t){return new un(t,{Te:!0})},t.prototype.i=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t}();cn.Ur(new Lo);function Uo(t){Oo(t),t.registerVersion("@firebase/firestore","1.12.2")}Uo(o);e.__PRIVATE_registerFirestore=Uo},40154:(t,e,n)=>{"use strict";n.r(e);n.d(e,{__extends:()=>i,__assign:()=>o,__rest:()=>s,__decorate:()=>a,__param:()=>u,__metadata:()=>c,__awaiter:()=>h,__generator:()=>f,__exportStar:()=>l,__values:()=>p,__read:()=>d,__spread:()=>v,__spreadArrays:()=>y,__await:()=>m,__asyncGenerator:()=>g,__asyncDelegator:()=>w,__asyncValues:()=>b,__makeTemplateObject:()=>_,__importStar:()=>E,__importDefault:()=>I,__classPrivateFieldGet:()=>T,__classPrivateFieldSet:()=>S});var r=function(t,e){r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n]};return r(t,e)};function i(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){o=Object.assign||function t(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o))e[o]=n[o]}return e};return o.apply(this,arguments)};function s(t,e){var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0)n[r]=t[r];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++){if(e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i]))n[r[i]]=t[r[i]]}return n}function a(t,e,n,r){var i=arguments.length,o=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,s;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)if(s=t[a])o=(i<3?s(o):i>3?s(e,n,o):s(e,n))||o;return i>3&&o&&Object.defineProperty(e,n,o),o}function u(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(t,e)}function h(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function f(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(t){return function(e){return u([t,e])}}function u(s){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=s[0]&2?i["return"]:s[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;if(i=0,o)s=[s[0]&2,o.value];switch(s[0]){case 0:case 1:o=s;break;case 4:n.label++;return{value:s[1],done:false};case 5:n.label++;i=s[1];s=[0];continue;case 7:s=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){n.label=s[1];break}if(s[0]===6&&n.label<o[1]){n.label=o[1];o=s;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(s);break}if(o[2])n.ops.pop();n.trys.pop();continue}s=e.call(t,n)}catch(a){s=[6,a];i=0}finally{r=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}}function l(t,e){for(var n in t)if(!e.hasOwnProperty(n))e[n]=t[n]}function p(t){var e=typeof Symbol==="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length==="number")return{next:function(){if(t&&r>=t.length)t=void 0;return{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function d(t,e){var n=typeof Symbol==="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],s;try{while((e===void 0||e-- >0)&&!(i=r.next()).done)o.push(i.value)}catch(a){s={error:a}}finally{try{if(i&&!i.done&&(n=r["return"]))n.call(r)}finally{if(s)throw s.error}}return o}function v(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(d(arguments[e]));return t}function y(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function m(t){return this instanceof m?(this.v=t,this):new m(t)}function g(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(t){if(r[t])i[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||a(t,e)}))}}function a(t,e){try{u(r[t](e))}catch(n){f(o[0][3],n)}}function u(t){t.value instanceof m?Promise.resolve(t.value.v).then(c,h):f(o[0][2],t)}function c(t){a("next",t)}function h(t){a("throw",t)}function f(t,e){if(t(e),o.shift(),o.length)a(o[0][0],o[0][1])}}function w(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:m(t[r](e)),done:r==="return"}:i?i(e):e}:i}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof p==="function"?p(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(e){n[e]=t[e]&&function(n){return new Promise((function(r,o){n=t[e](n),i(r,o,n.done,n.value)}))}}function i(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}}function _(t,e){if(Object.defineProperty){Object.defineProperty(t,"raw",{value:e})}else{t.raw=e}return t}function E(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)if(Object.hasOwnProperty.call(t,n))e[n]=t[n];e.default=t;return e}function I(t){return t&&t.__esModule?t:{default:t}}function T(t,e){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return e.get(t)}function S(t,e,n){if(!e.has(t)){throw new TypeError("attempted to set private field on non-instance")}e.set(t,n);return n}},24712:(t,e,n)=>{"use strict";function r(t){return t&&typeof t==="object"&&"default"in t?t["default"]:t}var i=r(n(99413));var o=n(61254);var s=n(56630);var a={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};var u=function(t){o.__extends(e,t);function e(n,r,i){var o=t.call(this,r)||this;Object.setPrototypeOf(o,e.prototype);o.code=n;o.details=i;return o}return e}(Error);function c(t){if(t>=200&&t<300){return"ok"}switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function h(t,e,n){var r=c(t);var i=r;var o=undefined;try{var s=e&&e.error;if(s){var h=s.status;if(typeof h==="string"){if(!a[h]){return new u("internal","internal")}r=a[h];i=h}var f=s.message;if(typeof f==="string"){i=f}o=s.details;if(o!==undefined){o=n.decode(o)}}}catch(l){}if(r==="ok"){return null}return new u(r,i,o)}var f=function(){function t(t,e){var n=this;this.auth=null;this.messaging=null;this.auth=t.getImmediate({optional:true});this.messaging=e.getImmediate({optional:true});if(!this.auth){t.get().then((function(t){return n.auth=t}),(function(){}))}if(!this.messaging){e.get().then((function(t){return n.messaging=t}),(function(){}))}}t.prototype.getAuthToken=function(){return o.__awaiter(this,void 0,void 0,(function(){var t,e;return o.__generator(this,(function(n){switch(n.label){case 0:if(!this.auth){return[2,undefined]}n.label=1;case 1:n.trys.push([1,3,,4]);return[4,this.auth.getToken()];case 2:t=n.sent();if(!t){return[2,undefined]}return[2,t.accessToken];case 3:e=n.sent();return[2,undefined];case 4:return[2]}}))}))};t.prototype.getInstanceIdToken=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){if(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"){return[2,undefined]}try{return[2,this.messaging.getToken()]}catch(e){return[2,undefined]}return[2]}))}))};t.prototype.getContext=function(){return o.__awaiter(this,void 0,void 0,(function(){var t,e;return o.__generator(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:t=n.sent();return[4,this.getInstanceIdToken()];case 2:e=n.sent();return[2,{authToken:t,instanceIdToken:e}]}}))}))};return t}();var l="type.googleapis.com/google.protobuf.Int64Value";var p="type.googleapis.com/google.protobuf.UInt64Value";function d(t,e){var n={};for(var r in t){if(t.hasOwnProperty(r)){n[r]=e(t[r])}}return n}var v=function(){function t(){}t.prototype.encode=function(t){var e=this;if(t==null){return null}if(t instanceof Number){t=t.valueOf()}if(typeof t==="number"&&isFinite(t)){return t}if(t===true||t===false){return t}if(Object.prototype.toString.call(t)==="[object String]"){return t}if(Array.isArray(t)){return t.map((function(t){return e.encode(t)}))}if(typeof t==="function"||typeof t==="object"){return d(t,(function(t){return e.encode(t)}))}throw new Error("Data cannot be encoded in JSON: "+t)};t.prototype.decode=function(t){var e=this;if(t==null){return t}if(t["@type"]){switch(t["@type"]){case l:case p:{var n=Number(t["value"]);if(isNaN(n)){throw new Error("Data cannot be decoded from JSON: "+t)}return n}default:{throw new Error("Data cannot be decoded from JSON: "+t)}}}if(Array.isArray(t)){return t.map((function(t){return e.decode(t)}))}if(typeof t==="function"||typeof t==="object"){return d(t,(function(t){return e.decode(t)}))}return t};return t}();function y(t){return new Promise((function(e,n){setTimeout((function(){n(new u("deadline-exceeded","deadline-exceeded"))}),t)}))}var m=function(){function t(t,e,n,r){var i=this;if(r===void 0){r="us-central1"}this.app_=t;this.region_=r;this.serializer=new v;this.emulatorOrigin=null;this.INTERNAL={delete:function(){return i.deleteService()}};this.contextProvider=new f(e,n);this.cancelAllRequests=new Promise((function(t){i.deleteService=function(){return t()}}))}Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:true,configurable:true});t.prototype._url=function(t){var e=this.app_.options.projectId;var n=this.region_;if(this.emulatorOrigin!==null){var r=this.emulatorOrigin;return r+"/"+e+"/"+n+"/"+t}return"https://"+n+"-"+e+".cloudfunctions.net/"+t};t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t};t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}};t.prototype.postJSON=function(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var r,i,s,a;return o.__generator(this,(function(o){switch(o.label){case 0:n.append("Content-Type","application/json");o.label=1;case 1:o.trys.push([1,3,,4]);return[4,fetch(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 2:r=o.sent();return[3,4];case 3:i=o.sent();return[2,{status:0,json:null}];case 4:s=null;o.label=5;case 5:o.trys.push([5,7,,8]);return[4,r.json()];case 6:s=o.sent();return[3,8];case 7:a=o.sent();return[3,8];case 8:return[2,{status:r.status,json:s}]}}))}))};t.prototype.call=function(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var r,i,s,a,c,f,l,p,d;return o.__generator(this,(function(o){switch(o.label){case 0:r=this._url(t);e=this.serializer.encode(e);i={data:e};s=new Headers;return[4,this.contextProvider.getContext()];case 1:a=o.sent();if(a.authToken){s.append("Authorization","Bearer "+a.authToken)}if(a.instanceIdToken){s.append("Firebase-Instance-ID-Token",a.instanceIdToken)}c=n.timeout||7e4;return[4,Promise.race([this.postJSON(r,i,s),y(c),this.cancelAllRequests])];case 2:f=o.sent();if(!f){throw new u("cancelled","Firebase Functions instance was deleted.")}l=h(f.status,f.json,this.serializer);if(l){throw l}if(!f.json){throw new u("internal","Response is not valid JSON object.")}p=f.json.data;if(typeof p==="undefined"){p=f.json.result}if(typeof p==="undefined"){throw new u("internal","Response is missing data field.")}d=this.serializer.decode(p);return[2,{data:d}]}}))}))};return t}();var g="functions";function w(t,e){var n=t.getProvider("app").getImmediate();var r=t.getProvider("auth-internal");var i=t.getProvider("messaging");return new m(n,r,i,e)}function b(t){var e={Functions:m};t.INTERNAL.registerComponent(new s.Component(g,w,"PUBLIC").setServiceProps(e).setMultipleInstances(true))}var _="@firebase/functions";var E="0.4.38";b(i);i.registerVersion(_,E)},61254:(t,e,n)=>{"use strict";n.r(e);n.d(e,{__extends:()=>i,__assign:()=>o,__rest:()=>s,__decorate:()=>a,__param:()=>u,__metadata:()=>c,__awaiter:()=>h,__generator:()=>f,__exportStar:()=>l,__values:()=>p,__read:()=>d,__spread:()=>v,__spreadArrays:()=>y,__await:()=>m,__asyncGenerator:()=>g,__asyncDelegator:()=>w,__asyncValues:()=>b,__makeTemplateObject:()=>_,__importStar:()=>E,__importDefault:()=>I,__classPrivateFieldGet:()=>T,__classPrivateFieldSet:()=>S});var r=function(t,e){r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n]};return r(t,e)};function i(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){o=Object.assign||function t(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o))e[o]=n[o]}return e};return o.apply(this,arguments)};function s(t,e){var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0)n[r]=t[r];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++){if(e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i]))n[r[i]]=t[r[i]]}return n}function a(t,e,n,r){var i=arguments.length,o=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,s;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)if(s=t[a])o=(i<3?s(o):i>3?s(e,n,o):s(e,n))||o;return i>3&&o&&Object.defineProperty(e,n,o),o}function u(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(t,e)}function h(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function f(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(t){return function(e){return u([t,e])}}function u(s){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=s[0]&2?i["return"]:s[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;if(i=0,o)s=[s[0]&2,o.value];switch(s[0]){case 0:case 1:o=s;break;case 4:n.label++;return{value:s[1],done:false};case 5:n.label++;i=s[1];s=[0];continue;case 7:s=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){n.label=s[1];break}if(s[0]===6&&n.label<o[1]){n.label=o[1];o=s;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(s);break}if(o[2])n.ops.pop();n.trys.pop();continue}s=e.call(t,n)}catch(a){s=[6,a];i=0}finally{r=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}}function l(t,e){for(var n in t)if(!e.hasOwnProperty(n))e[n]=t[n]}function p(t){var e=typeof Symbol==="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length==="number")return{next:function(){if(t&&r>=t.length)t=void 0;return{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function d(t,e){var n=typeof Symbol==="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],s;try{while((e===void 0||e-- >0)&&!(i=r.next()).done)o.push(i.value)}catch(a){s={error:a}}finally{try{if(i&&!i.done&&(n=r["return"]))n.call(r)}finally{if(s)throw s.error}}return o}function v(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(d(arguments[e]));return t}function y(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function m(t){return this instanceof m?(this.v=t,this):new m(t)}function g(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(t){if(r[t])i[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||a(t,e)}))}}function a(t,e){try{u(r[t](e))}catch(n){f(o[0][3],n)}}function u(t){t.value instanceof m?Promise.resolve(t.value.v).then(c,h):f(o[0][2],t)}function c(t){a("next",t)}function h(t){a("throw",t)}function f(t,e){if(t(e),o.shift(),o.length)a(o[0][0],o[0][1])}}function w(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:m(t[r](e)),done:r==="return"}:i?i(e):e}:i}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof p==="function"?p(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(e){n[e]=t[e]&&function(n){return new Promise((function(r,o){n=t[e](n),i(r,o,n.done,n.value)}))}}function i(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}}function _(t,e){if(Object.defineProperty){Object.defineProperty(t,"raw",{value:e})}else{t.raw=e}return t}function E(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)if(Object.hasOwnProperty.call(t,n))e[n]=t[n];e.default=t;return e}function I(t){return t&&t.__esModule?t:{default:t}}function T(t,e){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return e.get(t)}function S(t,e,n){if(!e.has(t)){throw new TypeError("attempted to set private field on non-instance")}e.set(t,n);return n}},5216:(t,e,n)=>{"use strict";n.r(e);n.d(e,{registerInstallations:()=>Jt});var r=n(99413);var i=n(56630);var o=function(t,e){o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n]};return o(t,e)};function s(t,e){o(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var a=function(){a=Object.assign||function t(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o))e[o]=n[o]}return e};return a.apply(this,arguments)};function u(t,e){var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0)n[r]=t[r];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++){if(e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i]))n[r[i]]=t[r[i]]}return n}function c(t,e,n,r){var i=arguments.length,o=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,s;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)if(s=t[a])o=(i<3?s(o):i>3?s(e,n,o):s(e,n))||o;return i>3&&o&&Object.defineProperty(e,n,o),o}function h(t,e){return function(n,r){e(n,r,t)}}function f(t,e){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(t,e)}function l(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function p(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(t){return function(e){return u([t,e])}}function u(s){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=s[0]&2?i["return"]:s[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;if(i=0,o)s=[s[0]&2,o.value];switch(s[0]){case 0:case 1:o=s;break;case 4:n.label++;return{value:s[1],done:false};case 5:n.label++;i=s[1];s=[0];continue;case 7:s=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){n.label=s[1];break}if(s[0]===6&&n.label<o[1]){n.label=o[1];o=s;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(s);break}if(o[2])n.ops.pop();n.trys.pop();continue}s=e.call(t,n)}catch(a){s=[6,a];i=0}finally{r=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}}function d(t,e){for(var n in t)if(!e.hasOwnProperty(n))e[n]=t[n]}function v(t){var e=typeof Symbol==="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length==="number")return{next:function(){if(t&&r>=t.length)t=void 0;return{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(t,e){var n=typeof Symbol==="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],s;try{while((e===void 0||e-- >0)&&!(i=r.next()).done)o.push(i.value)}catch(a){s={error:a}}finally{try{if(i&&!i.done&&(n=r["return"]))n.call(r)}finally{if(s)throw s.error}}return o}function m(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(y(arguments[e]));return t}function g(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function w(t){return this instanceof w?(this.v=t,this):new w(t)}function b(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(t){if(r[t])i[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||a(t,e)}))}}function a(t,e){try{u(r[t](e))}catch(n){f(o[0][3],n)}}function u(t){t.value instanceof w?Promise.resolve(t.value.v).then(c,h):f(o[0][2],t)}function c(t){a("next",t)}function h(t){a("throw",t)}function f(t,e){if(t(e),o.shift(),o.length)a(o[0][0],o[0][1])}}function _(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:w(t[r](e)),done:r==="return"}:i?i(e):e}:i}}function E(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof v==="function"?v(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(e){n[e]=t[e]&&function(n){return new Promise((function(r,o){n=t[e](n),i(r,o,n.done,n.value)}))}}function i(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}}function I(t,e){if(Object.defineProperty){Object.defineProperty(t,"raw",{value:e})}else{t.raw=e}return t}function T(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)if(Object.hasOwnProperty.call(t,n))e[n]=t[n];e.default=t;return e}function S(t){return t&&t.__esModule?t:{default:t}}function N(t,e){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return e.get(t)}function A(t,e,n){if(!e.has(t)){throw new TypeError("attempted to set private field on non-instance")}e.set(t,n);return n}var O=n(71470);var k=n(70015);var R="@firebase/installations";var C="0.4.6";var D=1e4;var P="w:"+C;var x="FIS_v2";var L="https://firebaseinstallations.googleapis.com/v1";var U=60*60*1e3;var M="installations";var j="Installations";var F;var q=(F={},F["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',F["not-registered"]="Firebase Installation is not registered.",F["installation-not-found"]="Firebase Installation not found.",F["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',F["app-offline"]="Could not process request. Application offline.",F["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",F);var G=new O.ErrorFactory(M,j,q);function V(t){return t instanceof O.FirebaseError&&t.code.includes("request-failed")}function B(t){var e=t.projectId;return L+"/projects/"+e+"/installations"}function z(t){return{token:t.token,requestStatus:2,expiresIn:Y(t.expiresIn),creationTime:Date.now()}}function H(t,e){return l(this,void 0,void 0,(function(){var n,r;return p(this,(function(i){switch(i.label){case 0:return[4,e.json()];case 1:n=i.sent();r=n.error;return[2,G.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})]}}))}))}function W(t){var e=t.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function K(t,e){var n=e.refreshToken;var r=W(t);r.append("Authorization",J(n));return r}function Q(t){return l(this,void 0,void 0,(function(){var e;return p(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:e=n.sent();if(e.status>=500&&e.status<600){return[2,t()]}return[2,e]}}))}))}function Y(t){return Number(t.replace("s","000"))}function J(t){return x+" "+t}function X(t,e){var n=e.fid;return l(this,void 0,void 0,(function(){var e,r,i,o,s,a,u;return p(this,(function(c){switch(c.label){case 0:e=B(t);r=W(t);i={fid:n,authVersion:x,appId:t.appId,sdkVersion:P};o={method:"POST",headers:r,body:JSON.stringify(i)};return[4,Q((function(){return fetch(e,o)}))];case 1:s=c.sent();if(!s.ok)return[3,3];return[4,s.json()];case 2:a=c.sent();u={fid:a.fid||n,registrationStatus:2,refreshToken:a.refreshToken,authToken:z(a.authToken)};return[2,u];case 3:return[4,H("Create Installation",s)];case 4:throw c.sent()}}))}))}function $(t){return new Promise((function(e){setTimeout(e,t)}))}function Z(t){var e=btoa(String.fromCharCode.apply(String,m(t)));return e.replace(/\+/g,"-").replace(/\//g,"_")}var tt=/^[cdef][\w-]{21}$/;var et="";function nt(){try{var t=new Uint8Array(17);var e=self.crypto||self.msCrypto;e.getRandomValues(t);t[0]=112+t[0]%16;var n=rt(t);return tt.test(n)?n:et}catch(F){return et}}function rt(t){var e=Z(t);return e.substr(0,22)}function it(t){return t.appName+"!"+t.appId}var ot=new Map;function st(t,e){var n=it(t);ct(n,e);ht(n,e)}function at(t,e){lt();var n=it(t);var r=ot.get(n);if(!r){r=new Set;ot.set(n,r)}r.add(e)}function ut(t,e){var n=it(t);var r=ot.get(n);if(!r){return}r.delete(e);if(r.size===0){ot.delete(n)}pt()}function ct(t,e){var n,r;var i=ot.get(t);if(!i){return}try{for(var o=v(i),s=o.next();!s.done;s=o.next()){var a=s.value;a(e)}}catch(u){n={error:u}}finally{try{if(s&&!s.done&&(r=o.return))r.call(o)}finally{if(n)throw n.error}}}function ht(t,e){var n=lt();if(n){n.postMessage({key:t,fid:e})}pt()}var ft=null;function lt(){if(!ft&&"BroadcastChannel"in self){ft=new BroadcastChannel("[Firebase] FID Change");ft.onmessage=function(t){ct(t.data.key,t.data.fid)}}return ft}function pt(){if(ot.size===0&&ft){ft.close();ft=null}}var dt="firebase-installations-database";var vt=1;var yt="firebase-installations-store";var mt=null;function gt(){if(!mt){mt=(0,k.openDb)(dt,vt,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(yt)}}))}return mt}function wt(t,e){return l(this,void 0,void 0,(function(){var n,r,i,o,s;return p(this,(function(a){switch(a.label){case 0:n=it(t);return[4,gt()];case 1:r=a.sent();i=r.transaction(yt,"readwrite");o=i.objectStore(yt);return[4,o.get(n)];case 2:s=a.sent();return[4,o.put(e,n)];case 3:a.sent();return[4,i.complete];case 4:a.sent();if(!s||s.fid!==e.fid){st(t,e.fid)}return[2,e]}}))}))}function bt(t){return l(this,void 0,void 0,(function(){var e,n,r;return p(this,(function(i){switch(i.label){case 0:e=it(t);return[4,gt()];case 1:n=i.sent();r=n.transaction(yt,"readwrite");return[4,r.objectStore(yt).delete(e)];case 2:i.sent();return[4,r.complete];case 3:i.sent();return[2]}}))}))}function _t(t,e){return l(this,void 0,void 0,(function(){var n,r,i,o,s,a;return p(this,(function(u){switch(u.label){case 0:n=it(t);return[4,gt()];case 1:r=u.sent();i=r.transaction(yt,"readwrite");o=i.objectStore(yt);return[4,o.get(n)];case 2:s=u.sent();a=e(s);if(!(a===undefined))return[3,4];return[4,o.delete(n)];case 3:u.sent();return[3,6];case 4:return[4,o.put(a,n)];case 5:u.sent();u.label=6;case 6:return[4,i.complete];case 7:u.sent();if(a&&(!s||s.fid!==a.fid)){st(t,a.fid)}return[2,a]}}))}))}function Et(t){return l(this,void 0,void 0,(function(){var e,n,r;return p(this,(function(i){switch(i.label){case 0:return[4,_t(t,(function(n){var r=It(n);var i=Tt(t,r);e=i.registrationPromise;return i.installationEntry}))];case 1:n=i.sent();if(!(n.fid===et))return[3,3];r={};return[4,e];case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}}))}))}function It(t){var e=t||{fid:nt(),registrationStatus:0};return Ot(e)}function Tt(t,e){if(e.registrationStatus===0){if(!navigator.onLine){var n=Promise.reject(G.create("app-offline"));return{installationEntry:e,registrationPromise:n}}var r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()};var i=St(t,r);return{installationEntry:r,registrationPromise:i}}else if(e.registrationStatus===1){return{installationEntry:e,registrationPromise:Nt(t)}}else{return{installationEntry:e}}}function St(t,e){return l(this,void 0,void 0,(function(){var n,r;return p(this,(function(i){switch(i.label){case 0:i.trys.push([0,2,,7]);return[4,X(t,e)];case 1:n=i.sent();return[2,wt(t,n)];case 2:r=i.sent();if(!(V(r)&&r.serverCode===409))return[3,4];return[4,bt(t)];case 3:i.sent();return[3,6];case 4:return[4,wt(t,{fid:e.fid,registrationStatus:0})];case 5:i.sent();i.label=6;case 6:throw r;case 7:return[2]}}))}))}function Nt(t){return l(this,void 0,void 0,(function(){var e,n,r,i;return p(this,(function(o){switch(o.label){case 0:return[4,At(t)];case 1:e=o.sent();o.label=2;case 2:if(!(e.registrationStatus===1))return[3,5];return[4,$(100)];case 3:o.sent();return[4,At(t)];case 4:e=o.sent();return[3,2];case 5:if(!(e.registrationStatus===0))return[3,7];return[4,Et(t)];case 6:n=o.sent(),r=n.installationEntry,i=n.registrationPromise;if(i){return[2,i]}else{return[2,r]}case 7:return[2,e]}}))}))}function At(t){return _t(t,(function(t){if(!t){throw G.create("installation-not-found")}return Ot(t)}))}function Ot(t){if(kt(t)){return{fid:t.fid,registrationStatus:0}}return t}function kt(t){return t.registrationStatus===1&&t.registrationTime+D<Date.now()}function Rt(t,e){var n=t.appConfig,r=t.platformLoggerProvider;return l(this,void 0,void 0,(function(){var t,i,o,s,a,u,c,h;return p(this,(function(f){switch(f.label){case 0:t=Ct(n,e);i=K(n,e);o=r.getImmediate({optional:true});if(o){i.append("x-firebase-client",o.getPlatformInfoString())}s={installation:{sdkVersion:P}};a={method:"POST",headers:i,body:JSON.stringify(s)};return[4,Q((function(){return fetch(t,a)}))];case 1:u=f.sent();if(!u.ok)return[3,3];return[4,u.json()];case 2:c=f.sent();h=z(c);return[2,h];case 3:return[4,H("Generate Auth Token",u)];case 4:throw f.sent()}}))}))}function Ct(t,e){var n=e.fid;return B(t)+"/"+n+"/authTokens:generate"}function Dt(t,e){if(e===void 0){e=false}return l(this,void 0,void 0,(function(){var n,r,i,o;return p(this,(function(s){switch(s.label){case 0:return[4,_t(t.appConfig,(function(r){if(!Ut(r)){throw G.create("not-registered")}var i=r.authToken;if(!e&&Mt(i)){return r}else if(i.requestStatus===1){n=Pt(t,e);return r}else{if(!navigator.onLine){throw G.create("app-offline")}var o=Ft(r);n=Lt(t,o);return o}}))];case 1:r=s.sent();if(!n)return[3,3];return[4,n];case 2:o=s.sent();return[3,4];case 3:o=r.authToken;s.label=4;case 4:i=o;return[2,i]}}))}))}function Pt(t,e){return l(this,void 0,void 0,(function(){var n,r;return p(this,(function(i){switch(i.label){case 0:return[4,xt(t.appConfig)];case 1:n=i.sent();i.label=2;case 2:if(!(n.authToken.requestStatus===1))return[3,5];return[4,$(100)];case 3:i.sent();return[4,xt(t.appConfig)];case 4:n=i.sent();return[3,2];case 5:r=n.authToken;if(r.requestStatus===0){return[2,Dt(t,e)]}else{return[2,r]}}}))}))}function xt(t){return _t(t,(function(t){if(!Ut(t)){throw G.create("not-registered")}var e=t.authToken;if(qt(e)){return a(a({},t),{authToken:{requestStatus:0}})}return t}))}function Lt(t,e){return l(this,void 0,void 0,(function(){var n,r,i,r;return p(this,(function(o){switch(o.label){case 0:o.trys.push([0,3,,8]);return[4,Rt(t,e)];case 1:n=o.sent();r=a(a({},e),{authToken:n});return[4,wt(t.appConfig,r)];case 2:o.sent();return[2,n];case 3:i=o.sent();if(!(V(i)&&(i.serverCode===401||i.serverCode===404)))return[3,5];return[4,bt(t.appConfig)];case 4:o.sent();return[3,7];case 5:r=a(a({},e),{authToken:{requestStatus:0}});return[4,wt(t.appConfig,r)];case 6:o.sent();o.label=7;case 7:throw i;case 8:return[2]}}))}))}function Ut(t){return t!==undefined&&t.registrationStatus===2}function Mt(t){return t.requestStatus===2&&!jt(t)}function jt(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+U}function Ft(t){var e={requestStatus:1,requestTime:Date.now()};return a(a({},t),{authToken:e})}function qt(t){return t.requestStatus===1&&t.requestTime+D<Date.now()}function Gt(t){return l(this,void 0,void 0,(function(){var e,n,r;return p(this,(function(i){switch(i.label){case 0:return[4,Et(t.appConfig)];case 1:e=i.sent(),n=e.installationEntry,r=e.registrationPromise;if(r){r.catch(console.error)}else{Dt(t).catch(console.error)}return[2,n.fid]}}))}))}function Vt(t,e){if(e===void 0){e=false}return l(this,void 0,void 0,(function(){var n;return p(this,(function(r){switch(r.label){case 0:return[4,Bt(t.appConfig)];case 1:r.sent();return[4,Dt(t,e)];case 2:n=r.sent();return[2,n.token]}}))}))}function Bt(t){return l(this,void 0,void 0,(function(){var e;return p(this,(function(n){switch(n.label){case 0:return[4,Et(t)];case 1:e=n.sent().registrationPromise;if(!e)return[3,3];return[4,e];case 2:n.sent();n.label=3;case 3:return[2]}}))}))}function zt(t,e){return l(this,void 0,void 0,(function(){var n,r,i,o;return p(this,(function(s){switch(s.label){case 0:n=Ht(t,e);r=K(t,e);i={method:"DELETE",headers:r};return[4,Q((function(){return fetch(n,i)}))];case 1:o=s.sent();if(!!o.ok)return[3,3];return[4,H("Delete Installation",o)];case 2:throw s.sent();case 3:return[2]}}))}))}function Ht(t,e){var n=e.fid;return B(t)+"/"+n}function Wt(t){return l(this,void 0,void 0,(function(){var e,n;return p(this,(function(r){switch(r.label){case 0:e=t.appConfig;return[4,_t(e,(function(t){if(t&&t.registrationStatus===0){return undefined}return t}))];case 1:n=r.sent();if(!n)return[3,6];if(!(n.registrationStatus===1))return[3,2];throw G.create("delete-pending-registration");case 2:if(!(n.registrationStatus===2))return[3,6];if(!!navigator.onLine)return[3,3];throw G.create("app-offline");case 3:return[4,zt(e,n)];case 4:r.sent();return[4,bt(e)];case 5:r.sent();r.label=6;case 6:return[2]}}))}))}function Kt(t,e){var n=t.appConfig;at(n,e);return function(){ut(n,e)}}function Qt(t){var e,n;if(!t||!t.options){throw Yt("App Configuration")}if(!t.name){throw Yt("App Name")}var r=["projectId","apiKey","appId"];try{for(var i=v(r),o=i.next();!o.done;o=i.next()){var s=o.value;if(!t.options[s]){throw Yt(s)}}}catch(a){e={error:a}}finally{try{if(o&&!o.done&&(n=i.return))n.call(i)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Yt(t){return G.create("missing-app-config-values",{valueName:t})}function Jt(t){var e="installations";t.INTERNAL.registerComponent(new i.Component(e,(function(t){var e=t.getProvider("app").getImmediate();var n=Qt(e);var r=t.getProvider("platform-logger");var i={appConfig:n,platformLoggerProvider:r};var o={app:e,getId:function(){return Gt(i)},getToken:function(t){return Vt(i,t)},delete:function(){return Wt(i)},onIdChange:function(t){return Kt(i,t)}};return o}),"PUBLIC"));t.registerVersion(R,C)}Jt(r.default)},69623:(t,e,n)=>{"use strict";n.r(e);var r=n(99413);var i=n(5216);var o=n(56630);var s=function(t,e){s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n]};return s(t,e)};function a(t,e){s(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var u=function(){u=Object.assign||function t(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o))e[o]=n[o]}return e};return u.apply(this,arguments)};function c(t,e){var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0)n[r]=t[r];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++){if(e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i]))n[r[i]]=t[r[i]]}return n}function h(t,e,n,r){var i=arguments.length,o=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,s;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)if(s=t[a])o=(i<3?s(o):i>3?s(e,n,o):s(e,n))||o;return i>3&&o&&Object.defineProperty(e,n,o),o}function f(t,e){return function(n,r){e(n,r,t)}}function l(t,e){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(t,e)}function p(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function d(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(t){return function(e){return u([t,e])}}function u(s){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=s[0]&2?i["return"]:s[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;if(i=0,o)s=[s[0]&2,o.value];switch(s[0]){case 0:case 1:o=s;break;case 4:n.label++;return{value:s[1],done:false};case 5:n.label++;i=s[1];s=[0];continue;case 7:s=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){n.label=s[1];break}if(s[0]===6&&n.label<o[1]){n.label=o[1];o=s;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(s);break}if(o[2])n.ops.pop();n.trys.pop();continue}s=e.call(t,n)}catch(a){s=[6,a];i=0}finally{r=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}}function v(t,e){for(var n in t)if(!e.hasOwnProperty(n))e[n]=t[n]}function y(t){var e=typeof Symbol==="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length==="number")return{next:function(){if(t&&r>=t.length)t=void 0;return{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(t,e){var n=typeof Symbol==="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],s;try{while((e===void 0||e-- >0)&&!(i=r.next()).done)o.push(i.value)}catch(a){s={error:a}}finally{try{if(i&&!i.done&&(n=r["return"]))n.call(r)}finally{if(s)throw s.error}}return o}function g(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(m(arguments[e]));return t}function w(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function b(t){return this instanceof b?(this.v=t,this):new b(t)}function _(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(t){if(r[t])i[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||a(t,e)}))}}function a(t,e){try{u(r[t](e))}catch(n){f(o[0][3],n)}}function u(t){t.value instanceof b?Promise.resolve(t.value.v).then(c,h):f(o[0][2],t)}function c(t){a("next",t)}function h(t){a("throw",t)}function f(t,e){if(t(e),o.shift(),o.length)a(o[0][0],o[0][1])}}function E(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:b(t[r](e)),done:r==="return"}:i?i(e):e}:i}}function I(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof y==="function"?y(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(e){n[e]=t[e]&&function(n){return new Promise((function(r,o){n=t[e](n),i(r,o,n.done,n.value)}))}}function i(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}}function T(t,e){if(Object.defineProperty){Object.defineProperty(t,"raw",{value:e})}else{t.raw=e}return t}function S(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)if(Object.hasOwnProperty.call(t,n))e[n]=t[n];e.default=t;return e}function N(t){return t&&t.__esModule?t:{default:t}}function A(t,e){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return e.get(t)}function O(t,e,n){if(!e.has(t)){throw new TypeError("attempted to set private field on non-instance")}e.set(t,n);return n}var k=n(71470);var R=n(70015);var C;var D=(C={},C["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',C["only-available-in-window"]="This method is available in a Window context.",C["only-available-in-sw"]="This method is available in a service worker context.",C["permission-default"]="The notification permission was not granted and dismissed instead.",C["permission-blocked"]="The notification permission was not granted and blocked instead.",C["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",C["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",C["token-subscribe-failed"]="A problem occured while subscribing the user to FCM: {$errorInfo}",C["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",C["token-unsubscribe-failed"]="A problem occured while unsubscribing the "+"user from FCM: {$errorInfo}",C["token-update-failed"]="A problem occured while updating the user from FCM: {$errorInfo}",C["token-update-no-token"]="FCM returned no token when updating the user to push.",C["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be "+"called before calling getToken() to ensure your service worker is used.",C["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",C["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",C["invalid-vapid-key"]="The public VAPID key must be a string.",C["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be "+"called before calling getToken() to ensure your VAPID key is used.",C);var P=new k.ErrorFactory("messaging","Messaging",D);function x(t){var e,n;if(!t||!t.options){throw L("App Configuration Object")}if(!t.name){throw L("App Name")}var r=["projectId","apiKey","appId","messagingSenderId"];var i=t.options;try{for(var o=y(r),s=o.next();!s.done;s=o.next()){var a=s.value;if(!i[a]){throw L(a)}}}catch(u){e={error:u}}finally{try{if(s&&!s.done&&(n=o.return))n.call(o)}finally{if(e)throw e.error}}return{appName:t.name,projectId:i.projectId,apiKey:i.apiKey,appId:i.appId,senderId:i.messagingSenderId}}function L(t){return P.create("missing-app-config-values",{valueName:t})}function U(t){var e=new Uint8Array(t);var n=btoa(String.fromCharCode.apply(String,g(e)));return n.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}var M="fcm_token_details_db";var j=5;var F="fcm_token_object_Store";function q(t){return p(this,void 0,void 0,(function(){var e,n,r,i;var o=this;return d(this,(function(s){switch(s.label){case 0:if(!("databases"in indexedDB))return[3,2];return[4,indexedDB.databases()];case 1:e=s.sent();n=e.map((function(t){return t.name}));if(!n.includes(M)){return[2,null]}s.label=2;case 2:r=null;return[4,(0,R.openDb)(M,j,(function(e){return p(o,void 0,void 0,(function(){var n,i,o,o,o;var s;return d(this,(function(a){switch(a.label){case 0:if(e.oldVersion<2){return[2]}if(!e.objectStoreNames.contains(F)){return[2]}n=e.transaction.objectStore(F);return[4,n.index("fcmSenderId").get(t)];case 1:i=a.sent();return[4,n.clear()];case 2:a.sent();if(!i){return[2]}if(e.oldVersion===2){o=i;if(!o.auth||!o.p256dh||!o.endpoint){return[2]}r={token:o.fcmToken,createTime:(s=o.createTime)!==null&&s!==void 0?s:Date.now(),subscriptionOptions:{auth:o.auth,p256dh:o.p256dh,endpoint:o.endpoint,swScope:o.swScope,vapidKey:typeof o.vapidKey==="string"?o.vapidKey:U(o.vapidKey)}}}else if(e.oldVersion===3){o=i;r={token:o.fcmToken,createTime:o.createTime,subscriptionOptions:{auth:U(o.auth),p256dh:U(o.p256dh),endpoint:o.endpoint,swScope:o.swScope,vapidKey:U(o.vapidKey)}}}else if(e.oldVersion===4){o=i;r={token:o.fcmToken,createTime:o.createTime,subscriptionOptions:{auth:U(o.auth),p256dh:U(o.p256dh),endpoint:o.endpoint,swScope:o.swScope,vapidKey:U(o.vapidKey)}}}return[2]}}))}))}))];case 3:i=s.sent();i.close();return[4,(0,R.deleteDb)(M)];case 4:s.sent();return[4,(0,R.deleteDb)("fcm_vapid_details_db")];case 5:s.sent();return[4,(0,R.deleteDb)("undefined")];case 6:s.sent();return[2,G(r)?r:null]}}))}))}function G(t){if(!t||!t.subscriptionOptions){return false}var e=t.subscriptionOptions;return typeof t.createTime==="number"&&t.createTime>0&&typeof t.token==="string"&&t.token.length>0&&typeof e.auth==="string"&&e.auth.length>0&&typeof e.p256dh==="string"&&e.p256dh.length>0&&typeof e.endpoint==="string"&&e.endpoint.length>0&&typeof e.swScope==="string"&&e.swScope.length>0&&typeof e.vapidKey==="string"&&e.vapidKey.length>0}var V="firebase-messaging-database";var B=1;var z="firebase-messaging-store";var H=null;function W(){if(!H){H=(0,R.openDb)(V,B,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(z)}}))}return H}function K(t){return p(this,void 0,void 0,(function(){var e,n,r,i;return d(this,(function(o){switch(o.label){case 0:e=J(t);return[4,W()];case 1:n=o.sent();return[4,n.transaction(z).objectStore(z).get(e)];case 2:r=o.sent();if(!r)return[3,3];return[2,r];case 3:return[4,q(t.appConfig.senderId)];case 4:i=o.sent();if(!i)return[3,6];return[4,Q(t,i)];case 5:o.sent();return[2,i];case 6:return[2]}}))}))}function Q(t,e){return p(this,void 0,void 0,(function(){var n,r,i;return d(this,(function(o){switch(o.label){case 0:n=J(t);return[4,W()];case 1:r=o.sent();i=r.transaction(z,"readwrite");return[4,i.objectStore(z).put(e,n)];case 2:o.sent();return[4,i.complete];case 3:o.sent();return[2,e]}}))}))}function Y(t){return p(this,void 0,void 0,(function(){var e,n,r;return d(this,(function(i){switch(i.label){case 0:e=J(t);return[4,W()];case 1:n=i.sent();r=n.transaction(z,"readwrite");return[4,r.objectStore(z).delete(e)];case 2:i.sent();return[4,r.complete];case 3:i.sent();return[2]}}))}))}function J(t){var e=t.appConfig;return e.appId}var X="/firebase-messaging-sw.js";var $="/firebase-cloud-messaging-push-scope";var Z="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4";var tt="https://fcmregistrations.googleapis.com/v1";var et="FCM_MSG";var nt="google.c.a.c_id";var rt="google.c.a.c_l";var it="google.c.a.ts";var ot="google.c.a.e";function st(t,e){return p(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return d(this,(function(c){switch(c.label){case 0:return[4,ht(t)];case 1:n=c.sent();r=ft(e);i={method:"POST",headers:n,body:JSON.stringify(r)};c.label=2;case 2:c.trys.push([2,5,,6]);return[4,fetch(ct(t.appConfig),i)];case 3:s=c.sent();return[4,s.json()];case 4:o=c.sent();return[3,6];case 5:a=c.sent();throw P.create("token-subscribe-failed",{errorInfo:a});case 6:if(o.error){u=o.error.message;throw P.create("token-subscribe-failed",{errorInfo:u})}if(!o.token){throw P.create("token-subscribe-no-token")}return[2,o.token]}}))}))}function at(t,e){return p(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return d(this,(function(c){switch(c.label){case 0:return[4,ht(t)];case 1:n=c.sent();r=ft(e.subscriptionOptions);i={method:"PATCH",headers:n,body:JSON.stringify(r)};c.label=2;case 2:c.trys.push([2,5,,6]);return[4,fetch(ct(t.appConfig)+"/"+e.token,i)];case 3:s=c.sent();return[4,s.json()];case 4:o=c.sent();return[3,6];case 5:a=c.sent();throw P.create("token-update-failed",{errorInfo:a});case 6:if(o.error){u=o.error.message;throw P.create("token-update-failed",{errorInfo:u})}if(!o.token){throw P.create("token-update-no-token")}return[2,o.token]}}))}))}function ut(t,e){return p(this,void 0,void 0,(function(){var n,r,i,o,s,a;return d(this,(function(u){switch(u.label){case 0:return[4,ht(t)];case 1:n=u.sent();r={method:"DELETE",headers:n};u.label=2;case 2:u.trys.push([2,5,,6]);return[4,fetch(ct(t.appConfig)+"/"+e,r)];case 3:i=u.sent();return[4,i.json()];case 4:o=u.sent();if(o.error){s=o.error.message;throw P.create("token-unsubscribe-failed",{errorInfo:s})}return[3,6];case 5:a=u.sent();throw P.create("token-unsubscribe-failed",{errorInfo:a});case 6:return[2]}}))}))}function ct(t){var e=t.projectId;return tt+"/projects/"+e+"/registrations"}function ht(t){var e=t.appConfig,n=t.installations;return p(this,void 0,void 0,(function(){var t;return d(this,(function(r){switch(r.label){case 0:return[4,n.getToken()];case 1:t=r.sent();return[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":"FIS "+t})]}}))}))}function ft(t){var e=t.p256dh,n=t.auth,r=t.endpoint,i=t.vapidKey;var o={web:{endpoint:r,auth:n,p256dh:e}};if(i!==Z){o.web.applicationPubKey=i}return o}var lt=7*24*60*60*1e3;function pt(t,e,n){return p(this,void 0,void 0,(function(){var r,i,o,s;return d(this,(function(a){switch(a.label){case 0:if(Notification.permission!=="granted"){throw P.create("permission-blocked")}return[4,mt(e,n)];case 1:r=a.sent();return[4,K(t)];case 2:i=a.sent();o={vapidKey:n,swScope:e.scope,endpoint:r.endpoint,auth:U(r.getKey("auth")),p256dh:U(r.getKey("p256dh"))};if(!!i)return[3,3];return[2,yt(t,o)];case 3:if(!!gt(i.subscriptionOptions,o))return[3,8];a.label=4;case 4:a.trys.push([4,6,,7]);return[4,ut(t,i.token)];case 5:a.sent();return[3,7];case 6:s=a.sent();console.warn(s);return[3,7];case 7:return[2,yt(t,o)];case 8:if(Date.now()>=i.createTime+lt){return[2,vt({token:i.token,createTime:Date.now(),subscriptionOptions:o},t,e)]}else{return[2,i.token]}case 9:return[2]}}))}))}function dt(t,e){return p(this,void 0,void 0,(function(){var n,r;return d(this,(function(i){switch(i.label){case 0:return[4,K(t)];case 1:n=i.sent();if(!n)return[3,4];return[4,ut(t,n.token)];case 2:i.sent();return[4,Y(t)];case 3:i.sent();i.label=4;case 4:return[4,e.pushManager.getSubscription()];case 5:r=i.sent();if(r){return[2,r.unsubscribe()]}return[2,true]}}))}))}function vt(t,e,n){return p(this,void 0,void 0,(function(){var r,i,o;return d(this,(function(s){switch(s.label){case 0:s.trys.push([0,3,,5]);return[4,at(e,t)];case 1:r=s.sent();i=u({token:r,createTime:Date.now()},t);return[4,Q(e,i)];case 2:s.sent();return[2,r];case 3:o=s.sent();return[4,dt(e,n)];case 4:s.sent();throw o;case 5:return[2]}}))}))}function yt(t,e){return p(this,void 0,void 0,(function(){var n,r;return d(this,(function(i){switch(i.label){case 0:return[4,st(t,e)];case 1:n=i.sent();r={token:n,createTime:Date.now(),subscriptionOptions:e};return[4,Q(t,r)];case 2:i.sent();return[2,r.token]}}))}))}function mt(t,e){return p(this,void 0,void 0,(function(){var n;return d(this,(function(r){switch(r.label){case 0:return[4,t.pushManager.getSubscription()];case 1:n=r.sent();if(n){return[2,n]}return[2,t.pushManager.subscribe({userVisibleOnly:true,applicationServerKey:e})]}}))}))}function gt(t,e){var n=e.vapidKey===t.vapidKey;var r=e.endpoint===t.endpoint;var i=e.auth===t.auth;var o=e.p256dh===t.p256dh;return n&&r&&i&&o}var wt;(function(t){t["PUSH_RECEIVED"]="push-received";t["NOTIFICATION_CLICKED"]="notification-clicked"})(wt||(wt={}));function bt(t){return typeof t==="object"&&!!t&&nt in t}var _t=function(){function t(t){var e=this;this.firebaseDependencies=t;this.vapidKey=null;this.onMessageCallback=null;navigator.serviceWorker.addEventListener("message",(function(t){return e.messageEventListener(t)}))}Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:true,configurable:true});t.prototype.getToken=function(){return p(this,void 0,void 0,(function(){var t;return d(this,(function(e){switch(e.label){case 0:if(!this.vapidKey){this.vapidKey=Z}return[4,this.getServiceWorkerRegistration()];case 1:t=e.sent();if(!(Notification.permission==="default"))return[3,3];return[4,Notification.requestPermission()];case 2:e.sent();e.label=3;case 3:if(Notification.permission!=="granted"){throw P.create("permission-blocked")}return[2,pt(this.firebaseDependencies,t,this.vapidKey)]}}))}))};t.prototype.deleteToken=function(){return p(this,void 0,void 0,(function(){var t;return d(this,(function(e){switch(e.label){case 0:return[4,this.getServiceWorkerRegistration()];case 1:t=e.sent();return[2,dt(this.firebaseDependencies,t)]}}))}))};t.prototype.requestPermission=function(){return p(this,void 0,void 0,(function(){var t;return d(this,(function(e){switch(e.label){case 0:if(Notification.permission==="granted"){return[2]}return[4,Notification.requestPermission()];case 1:t=e.sent();if(t==="granted"){return[2]}else if(t==="denied"){throw P.create("permission-blocked")}else{throw P.create("permission-default")}}}))}))};t.prototype.usePublicVapidKey=function(t){if(this.vapidKey!==null){throw P.create("use-vapid-key-after-get-token")}if(typeof t!=="string"||t.length===0){throw P.create("invalid-vapid-key")}this.vapidKey=t};t.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration)){throw P.create("invalid-sw-registration")}if(this.swRegistration){throw P.create("use-sw-after-get-token")}this.swRegistration=t};t.prototype.onMessage=function(t){var e=this;this.onMessageCallback=typeof t==="function"?t:t.next;return function(){e.onMessageCallback=null}};t.prototype.setBackgroundMessageHandler=function(){throw P.create("only-available-in-sw")};t.prototype.onTokenRefresh=function(){return function(){}};t.prototype.getServiceWorkerRegistration=function(){return p(this,void 0,void 0,(function(){var t,e;return d(this,(function(n){switch(n.label){case 0:if(!!this.swRegistration)return[3,4];n.label=1;case 1:n.trys.push([1,3,,4]);t=this;return[4,navigator.serviceWorker.register(X,{scope:$})];case 2:t.swRegistration=n.sent();this.swRegistration.update().catch((function(){}));return[3,4];case 3:e=n.sent();throw P.create("failed-service-worker-registration",{browserErrorMessage:e.message});case 4:return[2,this.swRegistration]}}))}))};t.prototype.messageEventListener=function(t){var e;return p(this,void 0,void 0,(function(){var n,r,i,o;return d(this,(function(s){switch(s.label){case 0:if(!((e=t.data)===null||e===void 0?void 0:e.firebaseMessaging)){return[2]}n=t.data.firebaseMessaging,r=n.type,i=n.payload;if(this.onMessageCallback&&r===wt.PUSH_RECEIVED){this.onMessageCallback(i)}o=i.data;if(!(bt(o)&&o[ot]==="1"))return[3,2];return[4,this.logEvent(r,o)];case 1:s.sent();s.label=2;case 2:return[2]}}))}))};t.prototype.logEvent=function(t,e){return p(this,void 0,void 0,(function(){var n,r;return d(this,(function(i){switch(i.label){case 0:n=Et(t);return[4,this.firebaseDependencies.analyticsProvider.get()];case 1:r=i.sent();r.logEvent(n,{message_id:e[nt],message_name:e[rt],message_time:e[it],message_device_time:Math.floor(Date.now()/1e3)});return[2]}}))}))};return t}();function Et(t){switch(t){case wt.NOTIFICATION_CLICKED:return"notification_open";case wt.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function It(t){return new Promise((function(e){setTimeout(e,t)}))}var Tt=function(){function t(t){var e=this;this.firebaseDependencies=t;this.vapidKey=null;this.bgMessageHandler=null;self.addEventListener("push",(function(t){t.waitUntil(e.onPush(t))}));self.addEventListener("pushsubscriptionchange",(function(t){t.waitUntil(e.onSubChange(t))}));self.addEventListener("notificationclick",(function(t){t.waitUntil(e.onNotificationClick(t))}))}Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:true,configurable:true});t.prototype.setBackgroundMessageHandler=function(t){if(!t||typeof t!=="function"){throw P.create("invalid-bg-handler")}this.bgMessageHandler=t};t.prototype.getToken=function(){var t,e;return p(this,void 0,void 0,(function(){var n;return d(this,(function(r){switch(r.label){case 0:if(!!this.vapidKey)return[3,2];return[4,K(this.firebaseDependencies)];case 1:n=r.sent();this.vapidKey=(e=(t=n===null||n===void 0?void 0:n.subscriptionOptions)===null||t===void 0?void 0:t.vapidKey)!==null&&e!==void 0?e:Z;r.label=2;case 2:return[2,pt(this.firebaseDependencies,self.registration,this.vapidKey)]}}))}))};t.prototype.deleteToken=function(){return dt(this.firebaseDependencies,self.registration)};t.prototype.requestPermission=function(){throw P.create("only-available-in-window")};t.prototype.usePublicVapidKey=function(t){if(this.vapidKey!==null){throw P.create("use-vapid-key-after-get-token")}if(typeof t!=="string"||t.length===0){throw P.create("invalid-vapid-key")}this.vapidKey=t};t.prototype.useServiceWorker=function(){throw P.create("only-available-in-window")};t.prototype.onMessage=function(){throw P.create("only-available-in-window")};t.prototype.onTokenRefresh=function(){throw P.create("only-available-in-window")};t.prototype.onPush=function(t){return p(this,void 0,void 0,(function(){var e,n,r;return d(this,(function(i){switch(i.label){case 0:e=St(t);if(!e){return[2]}return[4,Rt()];case 1:n=i.sent();if(Ot(n)){return[2,kt(n,e)]}r=Nt(e);if(!r)return[3,3];return[4,Dt(r)];case 2:i.sent();return[3,5];case 3:if(!this.bgMessageHandler)return[3,5];return[4,this.bgMessageHandler(e)];case 4:i.sent();i.label=5;case 5:return[2]}}))}))};t.prototype.onSubChange=function(t){var e,n;return p(this,void 0,void 0,(function(){var r,i;return d(this,(function(o){switch(o.label){case 0:r=t.newSubscription;if(!!r)return[3,2];return[4,dt(this.firebaseDependencies,self.registration)];case 1:o.sent();return[2];case 2:return[4,K(this.firebaseDependencies)];case 3:i=o.sent();return[4,dt(this.firebaseDependencies,self.registration)];case 4:o.sent();return[4,pt(this.firebaseDependencies,self.registration,(n=(e=i===null||i===void 0?void 0:i.subscriptionOptions)===null||e===void 0?void 0:e.vapidKey)!==null&&n!==void 0?n:Z)];case 5:o.sent();return[2]}}))}))};t.prototype.onNotificationClick=function(t){var e,n;return p(this,void 0,void 0,(function(){var r,i,o,s;return d(this,(function(a){switch(a.label){case 0:r=(n=(e=t.notification)===null||e===void 0?void 0:e.data)===null||n===void 0?void 0:n[et];if(!r){return[2]}else if(t.action){return[2]}t.stopImmediatePropagation();t.notification.close();i=Pt(r);if(!i){return[2]}return[4,At(i)];case 1:o=a.sent();if(!!o)return[3,4];return[4,self.clients.openWindow(i)];case 2:o=a.sent();return[4,It(3e3)];case 3:a.sent();return[3,6];case 4:return[4,o.focus()];case 5:o=a.sent();a.label=6;case 6:if(!o){return[2]}s=Ct(wt.NOTIFICATION_CLICKED,r);return[2,o.postMessage(s)]}}))}))};return t}();function St(t){var e=t.data;if(!e){return null}try{return e.json()}catch(n){return null}}function Nt(t){var e;if(!t||typeof t.notification!=="object"){return}var n=u({},t.notification);n.data=u(u({},t.notification.data),(e={},e[et]=t,e));return n}function At(t){return p(this,void 0,void 0,(function(){var e,n,r,i,o,s;var a,u;return d(this,(function(c){switch(c.label){case 0:e=new URL(t,self.location.href).href;return[4,Rt()];case 1:n=c.sent();try{for(r=y(n),i=r.next();!i.done;i=r.next()){o=i.value;s=new URL(o.url,self.location.href).href;if(s===e){return[2,o]}}}catch(h){a={error:h}}finally{try{if(i&&!i.done&&(u=r.return))u.call(r)}finally{if(a)throw a.error}}return[2,null]}}))}))}function Ot(t){return t.some((function(t){return t.visibilityState==="visible"&&!t.url.startsWith("chrome-extension://")}))}function kt(t,e){var n,r;var i=Ct(wt.PUSH_RECEIVED,e);try{for(var o=y(t),s=o.next();!s.done;s=o.next()){var a=s.value;a.postMessage(i)}}catch(u){n={error:u}}finally{try{if(s&&!s.done&&(r=o.return))r.call(o)}finally{if(n)throw n.error}}}function Rt(){return self.clients.matchAll({type:"window",includeUncontrolled:true})}function Ct(t,e){return{firebaseMessaging:{type:t,payload:e}}}function Dt(t){var e;var n=(e=t.title)!==null&&e!==void 0?e:"";var r=t.actions;var i=Notification.maxActions;if(r&&i&&r.length>i){console.warn("This browser only supports "+i+" actions. The remaining actions will not be displayed.")}return self.registration.showNotification(n,t)}function Pt(t){var e,n,r;var i=(n=(e=t.fcmOptions)===null||e===void 0?void 0:e.link)!==null&&n!==void 0?n:(r=t.notification)===null||r===void 0?void 0:r.click_action;if(i){return i}if(bt(t.data)){return self.location.origin}else{return null}}var xt="messaging";function Lt(t){var e=t.getProvider("app").getImmediate();var n=x(e);var r=t.getProvider("installations").getImmediate();var i=t.getProvider("analytics-internal");var o={app:e,appConfig:n,installations:r,analyticsProvider:i};if(!Mt()){throw P.create("unsupported-browser")}if(self&&"ServiceWorkerGlobalScope"in self){return new Tt(o)}else{return new _t(o)}}var Ut={isSupported:Mt};r.default.INTERNAL.registerComponent(new o.Component(xt,Lt,"PUBLIC").setServiceProps(Ut));function Mt(){if(self&&"ServiceWorkerGlobalScope"in self){return Ft()}else{return jt()}}function jt(){return"indexedDB"in window&&indexedDB!==null&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function Ft(){return"indexedDB"in self&&indexedDB!==null&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}},36772:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:true});function r(t){return t&&typeof t==="object"&&"default"in t?t["default"]:t}var i=r(n(99413));n(5216);var o=n(46121);var s=n(71470);var a=n(13936);var u=n(56630);var c="@firebase/performance";var h="0.2.36";var f=h;var l="FB-PERF-TRACE-START";var p="FB-PERF-TRACE-STOP";var d="FB-PERF-TRACE-MEASURE";var v="_wt_";var y="_fp";var m="_fcp";var g="_fid";var w="@firebase/performance/config";var b="@firebase/performance/configexpire";var _="performance";var E="Performance";var I;var T=(I={},I["trace started"]="Trace {$traceName} was started before.",I["trace stopped"]="Trace {$traceName} is not running.",I["no window"]="Window is not available.",I["no app id"]="App id is not available.",I["no project id"]="Project id is not available.",I["no api key"]="Api key is not available.",I["invalid cc log"]="Attempted to queue invalid cc event",I["FB not default"]="Performance can only start when Firebase app instance is the default one.",I["RC response not ok"]="RC response is not ok",I["invalid attribute name"]="Attribute name {$attributeName} is invalid.",I["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",I["invalide custom metric name"]="Custom metric name {$customMetricName} is invalid",I);var S=new s.ErrorFactory(_,E,T);var N;var A;var O=function(){function t(t){this.window=t;if(!t){throw S.create("no window")}this.performance=t.performance;this.PerformanceObserver=t.PerformanceObserver;this.windowLocation=t.location;this.navigator=t.navigator;this.document=t.document;if(this.navigator&&this.navigator.cookieEnabled){this.localStorage=t.localStorage}if(t.perfMetrics&&t.perfMetrics.onFirstInputDelay){this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay}}t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]};t.prototype.mark=function(t){if(!this.performance||!this.performance.mark){return}this.performance.mark(t)};t.prototype.measure=function(t,e,n){if(!this.performance||!this.performance.measure){return}this.performance.measure(t,e,n)};t.prototype.getEntriesByType=function(t){if(!this.performance||!this.performance.getEntriesByType){return[]}return this.performance.getEntriesByType(t)};t.prototype.getEntriesByName=function(t){if(!this.performance||!this.performance.getEntriesByName){return[]}return this.performance.getEntriesByName(t)};t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)};t.prototype.requiredApisAvailable=function(){if(fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled){return true}return false};t.prototype.setupObserver=function(t,e){if(!this.PerformanceObserver){return}var n=new this.PerformanceObserver((function(t){for(var n=0,r=t.getEntries();n<r.length;n++){var i=r[n];e(i)}}));n.observe({entryTypes:[t]})};t.getInstance=function(){if(N===undefined){N=new t(A)}return N};return t}();function k(t){A=t}var R;var C=function(){function t(){this.instrumentationEnabled=true;this.dataCollectionEnabled=true;this.loggingEnabled=false;this.tracesSamplingRate=1;this.networkRequestsSamplingRate=1;this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto";this.logSource=462;this.logTraceAfterSampling=false;this.logNetworkAfterSampling=false;this.configTimeToLive=12}t.prototype.getAppId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t){throw S.create("no app id")}return t};t.prototype.getProjectId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t){throw S.create("no project id")}return t};t.prototype.getApiKey=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t){throw S.create("no api key")}return t};t.getInstance=function(){if(R===undefined){R=new t}return R};return t}();var D;function P(){var t=C.getInstance().installationsService.getId();t.then((function(t){D=t}));return t}function x(){return D}function L(){var t=C.getInstance().installationsService.getToken();t.then((function(t){}));return t}var U;(function(t){t[t["UNKNOWN"]=0]="UNKNOWN";t[t["VISIBLE"]=1]="VISIBLE";t[t["HIDDEN"]=2]="HIDDEN"})(U||(U={}));var M=["firebase_","google_","ga_"];var j=new RegExp("^[a-zA-Z]\\w*$");var F=40;var q=100;function G(){var t=O.getInstance().navigator;if("serviceWorker"in t){if(t.serviceWorker.controller){return 2}else{return 3}}else{return 1}}function V(){var t=O.getInstance().document;var e=t.visibilityState;switch(e){case"visible":return U.VISIBLE;case"hidden":return U.HIDDEN;default:return U.UNKNOWN}}function B(){var t=O.getInstance().navigator;var e=t.connection;var n=e&&e.effectiveType;switch(n){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function z(t){if(t.length===0||t.length>F){return false}var e=M.some((function(e){return t.startsWith(e)}));return!e&&!!t.match(j)}function H(t){return t.length!==0&&t.length<=q}var W=new a.Logger(E);W.logLevel=a.LogLevel.INFO;var K="0.0.1";var Q={loggingEnabled:true};var Y="FIREBASE_INSTALLATIONS_AUTH";function J(t){var e=X();if(e){et(e);return Promise.resolve()}return tt(t).then((function(t){return et(t)})).then((function(t){return $(t)}),(function(){}))}function X(){var t=O.getInstance().localStorage;if(!t){return}var e=t.getItem(b);if(!e||!nt(e)){return}var n=t.getItem(w);if(!n){return}try{var r=JSON.parse(n);return r}catch(I){return}}function $(t){var e=O.getInstance().localStorage;if(!t||!e){return}e.setItem(w,JSON.stringify(t));e.setItem(b,String(Date.now()+C.getInstance().configTimeToLive*60*60*1e3))}var Z="Could not fetch config, will use default configs";function tt(t){return L().then((function(e){var n=C.getInstance().getProjectId();var r="https://firebaseremoteconfig.googleapis.com/v1/projects/"+n+"/namespaces/fireperf:fetch?key="+C.getInstance().getApiKey();var i=new Request(r,{method:"POST",headers:{Authorization:Y+" "+e},body:JSON.stringify({app_instance_id:t,app_instance_id_token:e,app_id:C.getInstance().getAppId(),app_version:f,sdk_version:K})});return fetch(i).then((function(t){if(t.ok){return t.json()}throw S.create("RC response not ok")}))})).catch((function(){W.info(Z);return undefined}))}function et(t){if(!t){return t}var e=C.getInstance();var n=t.entries||{};if(n.fpr_enabled!==undefined){e.loggingEnabled=String(n.fpr_enabled)==="true"}else{e.loggingEnabled=Q.loggingEnabled}if(n.fpr_log_source){e.logSource=Number(n.fpr_log_source)}if(n.fpr_log_endpoint_url){e.logEndPointUrl=n.fpr_log_endpoint_url}if(n.fpr_vc_network_request_sampling_rate!==undefined){e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)}if(n.fpr_vc_trace_sampling_rate!==undefined){e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)}e.logTraceAfterSampling=rt(e.tracesSamplingRate);e.logNetworkAfterSampling=rt(e.networkRequestsSamplingRate);return t}function nt(t){return Number(t)>Date.now()}function rt(t){return Math.random()<=t}var it=1;var ot;function st(){it=2;ot=ot||ut();return ot}function at(){return it===3}function ut(){return ct().then((function(){return P()})).then((function(t){return J(t)})).then((function(){return ht()}),(function(){return ht()}))}function ct(){var t=O.getInstance().document;return new Promise((function(e){if(t&&t.readyState!=="complete"){var n=function(){if(t.readyState==="complete"){t.removeEventListener("readystatechange",n);e()}};t.addEventListener("readystatechange",n)}else{e()}}))}function ht(){it=3}var ft=10*1e3;var lt=5.5*1e3;var pt=3;var dt=pt;var vt=[];var yt=false;function mt(){if(!yt){gt(lt);yt=true}}function gt(t){setTimeout((function(){if(dt===0){return}if(!vt.length){return gt(ft)}var t=o.__spreadArrays(vt);vt=[];var e=t.map((function(t){return{source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)}}));var n={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:C.getInstance().logSource,log_event:e};fetch(C.getInstance().logEndPointUrl,{method:"POST",body:JSON.stringify(n)}).then((function(t){if(!t.ok){W.info("Call to Firebase backend failed.")}return t.json()})).then((function(t){var e=Number(t.next_request_wait_millis);var n=isNaN(e)?ft:Math.max(ft,e);dt=pt;gt(n)})).catch((function(){vt=o.__spreadArrays(t,vt);dt--;W.info("Tries left: "+dt+".");gt(ft)}))}),t)}function wt(t){if(!t.eventTime||!t.message){throw S.create("invalid cc log")}vt=o.__spreadArrays(vt,[t])}function bt(t){return function(){var e=[];for(var n=0;n<arguments.length;n++){e[n]=arguments[n]}var r=t.apply(void 0,e);wt({message:r,eventTime:Date.now()})}}var _t;function Et(t,e){if(!_t){_t=bt(Nt)}_t(t,e)}function It(t){var e=C.getInstance();if(!e.instrumentationEnabled&&t.isAuto){return}if(!e.dataCollectionEnabled&&!t.isAuto){return}if(!O.getInstance().requiredApisAvailable()){return}if(t.isAuto&&V()!==U.VISIBLE){return}if(!e.loggingEnabled||!e.logTraceAfterSampling){return}if(at()){Tt(t)}else{st().then((function(){return Tt(t)}),(function(){return Tt(t)}))}}function Tt(t){if(x()){setTimeout((function(){return Et(t,1)}),0)}}function St(t){var e=C.getInstance();if(!e.instrumentationEnabled){return}if(t.url===e.logEndPointUrl.split("?")[0]){return}if(!e.loggingEnabled||!e.logNetworkAfterSampling){return}setTimeout((function(){return Et(t,0)}),0)}function Nt(t,e){if(e===0){return At(t)}return Ot(t)}function At(t){var e={url:t.url,http_method:t.httpMethod||0,http_response_code:200,response_payload_bytes:t.responsePayloadBytes,client_start_time_us:t.startTimeUs,time_to_response_initiated_us:t.timeToResponseInitiatedUs,time_to_response_completed_us:t.timeToResponseCompletedUs};var n={application_info:kt(),network_request_metric:e};return JSON.stringify(n)}function Ot(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};if(Object.keys(t.counters).length!==0){e.counters=t.counters}var n=t.getAttributes();if(Object.keys(n).length!==0){e.custom_attributes=n}var r={application_info:kt(),trace_metric:e};return JSON.stringify(r)}function kt(){return{google_app_id:C.getInstance().getAppId(),app_instance_id:x(),web_app_info:{sdk_version:f,page_url:O.getInstance().getUrl(),service_worker_status:G(),visibility_state:V(),effective_connection_type:B()},application_process_state:0}}var Rt=100;var Ct="_";var Dt=[y,m,g];function Pt(t,e){if(t.length===0||t.length>Rt){return false}return e&&e.startsWith(v)&&Dt.indexOf(t)>-1||!t.startsWith(Ct)}var xt=function(){function t(t,e,n){if(e===void 0){e=false}this.name=t;this.isAuto=e;this.state=1;this.customAttributes={};this.counters={};this.api=O.getInstance();this.randomId=Math.floor(Math.random()*1e6);if(!this.isAuto){this.traceStartMark=l+"-"+this.randomId+"-"+this.name;this.traceStopMark=p+"-"+this.randomId+"-"+this.name;this.traceMeasure=n||d+"-"+this.randomId+"-"+this.name;if(n){this.calculateTraceMetrics()}}}t.prototype.start=function(){if(this.state!==1){throw S.create("trace started",{traceName:this.name})}this.api.mark(this.traceStartMark);this.state=2};t.prototype.stop=function(){if(this.state!==2){throw S.create("trace stopped",{traceName:this.name})}this.state=3;this.api.mark(this.traceStopMark);this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark);this.calculateTraceMetrics();It(this)};t.prototype.record=function(t,e,n){this.durationUs=Math.floor(e*1e3);this.startTimeUs=Math.floor(t*1e3);if(n&&n.attributes){this.customAttributes=o.__assign({},n.attributes)}if(n&&n.metrics){for(var r=0,i=Object.keys(n.metrics);r<i.length;r++){var s=i[r];if(!isNaN(Number(n.metrics[s]))){this.counters[s]=Number(Math.floor(n.metrics[s]))}}}It(this)};t.prototype.incrementMetric=function(t,e){if(e===void 0){e=1}if(this.counters[t]===undefined){this.putMetric(t,0)}this.counters[t]+=e};t.prototype.putMetric=function(t,e){if(Pt(t,this.name)){this.counters[t]=e}else{throw S.create("invalide custom metric name",{customMetricName:t})}};t.prototype.getMetric=function(t){return this.counters[t]||0};t.prototype.putAttribute=function(t,e){var n=z(t);var r=H(e);if(n&&r){this.customAttributes[t]=e;return}if(!n){throw S.create("invalid attribute name",{attributeName:t})}if(!r){throw S.create("invalid attribute value",{attributeValue:e})}};t.prototype.getAttribute=function(t){return this.customAttributes[t]};t.prototype.removeAttribute=function(t){if(this.customAttributes[t]===undefined){return}delete this.customAttributes[t]};t.prototype.getAttributes=function(){return o.__assign({},this.customAttributes)};t.prototype.setStartTime=function(t){this.startTimeUs=t};t.prototype.setDuration=function(t){this.durationUs=t};t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure);var e=t&&t[0];if(e){this.durationUs=Math.floor(e.duration*1e3);this.startTimeUs=Math.floor((e.startTime+this.api.getTimeOrigin())*1e3)}};t.createOobTrace=function(e,n,r){var i=O.getInstance().getUrl();if(!i){return}var o=new t(v+i,true);var s=Math.floor(O.getInstance().getTimeOrigin()*1e3);o.setStartTime(s);if(e&&e[0]){o.setDuration(Math.floor(e[0].duration*1e3));o.putMetric("domInteractive",Math.floor(e[0].domInteractive*1e3));o.putMetric("domContentLoadedEventEnd",Math.floor(e[0].domContentLoadedEventEnd*1e3));o.putMetric("loadEventEnd",Math.floor(e[0].loadEventEnd*1e3))}var a="first-paint";var u="first-contentful-paint";if(n){var c=n.find((function(t){return t.name===a}));if(c&&c.startTime){o.putMetric(y,Math.floor(c.startTime*1e3))}var h=n.find((function(t){return t.name===u}));if(h&&h.startTime){o.putMetric(m,Math.floor(h.startTime*1e3))}if(r){o.putMetric(g,Math.floor(r*1e3))}}It(o)};t.createUserTimingTrace=function(e){var n=new t(e,false,e);It(n)};return t}();function Lt(t){var e=t;if(!e||e.responseStart===undefined){return}var n=O.getInstance().getTimeOrigin();var r=Math.floor((e.startTime+n)*1e3);var i=e.responseStart?Math.floor((e.responseStart-e.startTime)*1e3):undefined;var o=Math.floor((e.responseEnd-e.startTime)*1e3);var s=e.name&&e.name.split("?")[0];var a={url:s,responsePayloadBytes:e.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o};St(a)}var Ut=5e3;function Mt(){if(!x()){return}setTimeout((function(){return Ft()}),0);setTimeout((function(){return jt()}),0);setTimeout((function(){return qt()}),0)}function jt(){var t=O.getInstance();var e=t.getEntriesByType("resource");for(var n=0,r=e;n<r.length;n++){var i=r[n];Lt(i)}t.setupObserver("resource",Lt)}function Ft(){var t=O.getInstance();var e=t.getEntriesByType("navigation");var n=t.getEntriesByType("paint");if(t.onFirstInputDelay){var r=setTimeout((function(){xt.createOobTrace(e,n);r=undefined}),Ut);t.onFirstInputDelay((function(t){if(r){clearTimeout(r);xt.createOobTrace(e,n,t)}}))}else{xt.createOobTrace(e,n)}}function qt(){var t=O.getInstance();var e=t.getEntriesByType("measure");for(var n=0,r=e;n<r.length;n++){var i=r[n];Gt(i)}t.setupObserver("measure",Gt)}function Gt(t){var e=t.name;if(e.substring(0,d.length)===d){return}xt.createUserTimingTrace(e)}var Vt=function(){function t(t){this.app=t;if(O.getInstance().requiredApisAvailable()){mt();st().then(Mt,Mt)}else{W.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled.")}}t.prototype.trace=function(t){return new xt(t)};Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return C.getInstance().instrumentationEnabled},set:function(t){C.getInstance().instrumentationEnabled=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return C.getInstance().dataCollectionEnabled},set:function(t){C.getInstance().dataCollectionEnabled=t},enumerable:true,configurable:true});return t}();var Bt="[DEFAULT]";function zt(t){var e=function(t,e){if(t.name!==Bt){throw S.create("FB not default")}if(typeof window==="undefined"){throw S.create("no window")}k(window);C.getInstance().firebaseAppInstance=t;C.getInstance().installationsService=e;return new Vt(t)};t.INTERNAL.registerComponent(new u.Component("performance",(function(t){var n=t.getProvider("app").getImmediate();var r=t.getProvider("installations").getImmediate();return e(n,r)}),"PUBLIC"));t.registerVersion(c,h)}zt(i);e.registerPerformance=zt},46121:(t,e,n)=>{"use strict";n.r(e);n.d(e,{__extends:()=>i,__assign:()=>o,__rest:()=>s,__decorate:()=>a,__param:()=>u,__metadata:()=>c,__awaiter:()=>h,__generator:()=>f,__exportStar:()=>l,__values:()=>p,__read:()=>d,__spread:()=>v,__spreadArrays:()=>y,__await:()=>m,__asyncGenerator:()=>g,__asyncDelegator:()=>w,__asyncValues:()=>b,__makeTemplateObject:()=>_,__importStar:()=>E,__importDefault:()=>I,__classPrivateFieldGet:()=>T,__classPrivateFieldSet:()=>S});var r=function(t,e){r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n]};return r(t,e)};function i(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){o=Object.assign||function t(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o))e[o]=n[o]}return e};return o.apply(this,arguments)};function s(t,e){var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0)n[r]=t[r];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++){if(e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i]))n[r[i]]=t[r[i]]}return n}function a(t,e,n,r){var i=arguments.length,o=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,s;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)if(s=t[a])o=(i<3?s(o):i>3?s(e,n,o):s(e,n))||o;return i>3&&o&&Object.defineProperty(e,n,o),o}function u(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(t,e)}function h(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function f(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(t){return function(e){return u([t,e])}}function u(s){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=s[0]&2?i["return"]:s[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;if(i=0,o)s=[s[0]&2,o.value];switch(s[0]){case 0:case 1:o=s;break;case 4:n.label++;return{value:s[1],done:false};case 5:n.label++;i=s[1];s=[0];continue;case 7:s=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){n.label=s[1];break}if(s[0]===6&&n.label<o[1]){n.label=o[1];o=s;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(s);break}if(o[2])n.ops.pop();n.trys.pop();continue}s=e.call(t,n)}catch(a){s=[6,a];i=0}finally{r=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}}function l(t,e){for(var n in t)if(!e.hasOwnProperty(n))e[n]=t[n]}function p(t){var e=typeof Symbol==="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length==="number")return{next:function(){if(t&&r>=t.length)t=void 0;return{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function d(t,e){var n=typeof Symbol==="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],s;try{while((e===void 0||e-- >0)&&!(i=r.next()).done)o.push(i.value)}catch(a){s={error:a}}finally{try{if(i&&!i.done&&(n=r["return"]))n.call(r)}finally{if(s)throw s.error}}return o}function v(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(d(arguments[e]));return t}function y(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function m(t){return this instanceof m?(this.v=t,this):new m(t)}function g(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(t){if(r[t])i[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||a(t,e)}))}}function a(t,e){try{u(r[t](e))}catch(n){f(o[0][3],n)}}function u(t){t.value instanceof m?Promise.resolve(t.value.v).then(c,h):f(o[0][2],t)}function c(t){a("next",t)}function h(t){a("throw",t)}function f(t,e){if(t(e),o.shift(),o.length)a(o[0][0],o[0][1])}}function w(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:m(t[r](e)),done:r==="return"}:i?i(e):e}:i}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof p==="function"?p(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(e){n[e]=t[e]&&function(n){return new Promise((function(r,o){n=t[e](n),i(r,o,n.done,n.value)}))}}function i(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}}function _(t,e){if(Object.defineProperty){Object.defineProperty(t,"raw",{value:e})}else{t.raw=e}return t}function E(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)if(Object.hasOwnProperty.call(t,n))e[n]=t[n];e.default=t;return e}function I(t){return t&&t.__esModule?t:{default:t}}function T(t,e){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return e.get(t)}function S(t,e,n){if(!e.has(t)){throw new TypeError("attempted to set private field on non-instance")}e.set(t,n);return n}},19917:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:true});function r(t){return t&&typeof t==="object"&&"default"in t?t["default"]:t}var i=r(n(99413));n(5216);var o=n(24196);var s=n(71470);var a=n(13936);var u=n(56630);var c=function(){function t(t,e,n,r){this.client=t;this.storage=e;this.storageCache=n;this.logger=r}t.prototype.isCachedDataFresh=function(t,e){if(!e){this.logger.debug("Config fetch cache check. Cache unpopulated.");return false}var n=Date.now()-e;var r=n<=t;this.logger.debug("Config fetch cache check."+(" Cache age millis: "+n+".")+(" Cache max age millis (minimumFetchIntervalMillis setting): "+t+".")+(" Is cache hit: "+r+"."));return r};t.prototype.fetch=function(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,s;return o.__generator(this,(function(o){switch(o.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:e=o.sent(),n=e[0],r=e[1];if(r&&this.isCachedDataFresh(t.cacheMaxAgeMillis,n)){return[2,r]}t.eTag=r&&r.eTag;return[4,this.client.fetch(t)];case 2:i=o.sent();s=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];if(i.status===200){s.push(this.storage.setLastSuccessfulFetchResponse(i))}return[4,Promise.all(s)];case 3:o.sent();return[2,i]}}))}))};return t}();var h;var f=(h={},h["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",h["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",h["registration-api-key"]="Undefined API key. Check Firebase app initialization.",h["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",h["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",h["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",h["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",h["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",h["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection."+" Original error: {$originalErrorMessage}.",h["fetch-timeout"]="The config fetch request timed out. "+' Configure timeout using "fetchTimeoutMillis" SDK setting.',h["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state."+' Configure timeout using "fetchTimeoutMillis" SDK setting.'+" Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",h["fetch-client-parse"]="Fetch client could not parse response."+" Original error: {$originalErrorMessage}.",h["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",h);var l=new s.ErrorFactory("remoteconfig","Remote Config",f);function p(t,e){return t instanceof s.FirebaseError&&t.code.indexOf(e)!==-1}function d(t){if(t===void 0){t=navigator}return t.languages&&t.languages[0]||t.language}var v=function(){function t(t,e,n,r,i,o){this.firebaseInstallations=t;this.sdkVersion=e;this.namespace=n;this.projectId=r;this.apiKey=i;this.appId=o}t.prototype.fetch=function(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,s,a,u,c,h,f,p,v,y,m,g,w,b,_,E;return o.__generator(this,(function(o){switch(o.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:e=o.sent(),n=e[0],r=e[1];i=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com";s=i+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey;a={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"};u={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:r,app_id:this.appId,language_code:d()};c={method:"POST",headers:a,body:JSON.stringify(u)};h=fetch(s,c);f=new Promise((function(e,n){t.signal.addEventListener((function(){var t=new Error("The operation was aborted.");t.name="AbortError";n(t)}))}));o.label=2;case 2:o.trys.push([2,5,,6]);return[4,Promise.race([h,f])];case 3:o.sent();return[4,h];case 4:p=o.sent();return[3,6];case 5:v=o.sent();y="fetch-client-network";if(v.name==="AbortError"){y="fetch-timeout"}throw l.create(y,{originalErrorMessage:v.message});case 6:m=p.status;g=p.headers.get("ETag")||undefined;if(!(p.status===200))return[3,11];_=void 0;o.label=7;case 7:o.trys.push([7,9,,10]);return[4,p.json()];case 8:_=o.sent();return[3,10];case 9:E=o.sent();throw l.create("fetch-client-parse",{originalErrorMessage:E.message});case 10:w=_["entries"];b=_["state"];o.label=11;case 11:if(b==="INSTANCE_STATE_UNSPECIFIED"){m=500}else if(b==="NO_CHANGE"){m=304}else if(b==="NO_TEMPLATE"||b==="EMPTY_CONFIG"){w={}}if(m!==304&&m!==200){throw l.create("fetch-status",{httpStatus:m})}return[2,{status:m,eTag:g,config:w}]}}))}))};return t}();var y=function(){function t(){this.listeners=[]}t.prototype.addEventListener=function(t){this.listeners.push(t)};t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))};return t}();var m=false;var g="";var w=0;var b=["1","true","t","yes","y","on"];var _=function(){function t(t,e){if(e===void 0){e=g}this._source=t;this._value=e}t.prototype.asString=function(){return this._value};t.prototype.asBoolean=function(){if(this._source==="static"){return m}return b.indexOf(this._value.toLowerCase())>=0};t.prototype.asNumber=function(){if(this._source==="static"){return w}var t=Number(this._value);if(isNaN(t)){t=w}return t};t.prototype.getSource=function(){return this._source};return t}();var E=60*1e3;var I=12*60*60*1e3;var T=function(){function t(t,e,n,r,i){this.app=t;this._client=e;this._storageCache=n;this._storage=r;this._logger=i;this._isInitializationComplete=false;this.settings={fetchTimeoutMillis:E,minimumFetchIntervalMillis:I};this.defaultConfig={}}t.prototype.setLogLevel=function(t){switch(t){case"debug":this._logger.logLevel=a.LogLevel.DEBUG;break;case"silent":this._logger.logLevel=a.LogLevel.SILENT;break;default:this._logger.logLevel=a.LogLevel.ERROR}};Object.defineProperty(t.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:true,configurable:true});t.prototype.activate=function(){return o.__awaiter(this,void 0,void 0,(function(){var t,e,n;return o.__generator(this,(function(r){switch(r.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:t=r.sent(),e=t[0],n=t[1];if(!e||!e.config||!e.eTag||e.eTag===n){return[2,false]}return[4,Promise.all([this._storageCache.setActiveConfig(e.config),this._storage.setActiveConfigEtag(e.eTag)])];case 2:r.sent();return[2,true]}}))}))};t.prototype.ensureInitialized=function(){var t=this;if(!this._initializePromise){this._initializePromise=this._storageCache.loadFromStorage().then((function(){t._isInitializationComplete=true}))}return this._initializePromise};t.prototype.fetch=function(){return o.__awaiter(this,void 0,void 0,(function(){var t,e,n;var r=this;return o.__generator(this,(function(i){switch(i.label){case 0:t=new y;setTimeout((function(){return o.__awaiter(r,void 0,void 0,(function(){return o.__generator(this,(function(e){t.abort();return[2]}))}))}),this.settings.fetchTimeoutMillis);i.label=1;case 1:i.trys.push([1,4,,6]);return[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:t})];case 2:i.sent();return[4,this._storageCache.setLastFetchStatus("success")];case 3:i.sent();return[3,6];case 4:e=i.sent();n=p(e,"fetch-throttle")?"throttle":"failure";return[4,this._storageCache.setLastFetchStatus(n)];case 5:i.sent();throw e;case 6:return[2]}}))}))};t.prototype.fetchAndActivate=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){switch(t.label){case 0:return[4,this.fetch()];case 1:t.sent();return[2,this.activate()]}}))}))};t.prototype.getAll=function(){var t=this;return S(this._storageCache.getActiveConfig(),this.defaultConfig).reduce((function(e,n){e[n]=t.getValue(n);return e}),{})};t.prototype.getBoolean=function(t){return this.getValue(t).asBoolean()};t.prototype.getNumber=function(t){return this.getValue(t).asNumber()};t.prototype.getString=function(t){return this.getValue(t).asString()};t.prototype.getValue=function(t){if(!this._isInitializationComplete){this._logger.debug('A value was requested for key "'+t+'" before SDK initialization completed.'+" Await on ensureInitialized if the intent was to get a previously activated value.")}var e=this._storageCache.getActiveConfig();if(e&&e[t]!==undefined){return new _("remote",e[t])}else if(this.defaultConfig&&this.defaultConfig[t]!==undefined){return new _("default",String(this.defaultConfig[t]))}this._logger.debug('Returning static value for key "'+t+'".'+" Define a default or remote value if this is unintentional.");return new _("static")};return t}();function S(t,e){if(t===void 0){t={}}if(e===void 0){e={}}return Object.keys(o.__assign(o.__assign({},t),e))}function N(t,e){var n=t.target.error||undefined;return l.create(e,{originalErrorMessage:n&&n.message})}var A="app_namespace_store";var O="firebase_remote_config";var k=1;function R(){return new Promise((function(t,e){var n=indexedDB.open(O,k);n.onerror=function(t){e(N(t,"storage-open"))};n.onsuccess=function(e){t(e.target.result)};n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(A,{keyPath:"compositeKey"})}}}))}var C=function(){function t(t,e,n,r){if(r===void 0){r=R()}this.appId=t;this.appName=e;this.namespace=n;this.openDbPromise=r}t.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")};t.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)};t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")};t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)};t.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")};t.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)};t.prototype.getActiveConfig=function(){return this.get("active_config")};t.prototype.setActiveConfig=function(t){return this.set("active_config",t)};t.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")};t.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)};t.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")};t.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)};t.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")};t.prototype.get=function(t){return o.__awaiter(this,void 0,void 0,(function(){var e;var n=this;return o.__generator(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:e=r.sent();return[2,new Promise((function(r,i){var o=e.transaction([A],"readonly");var s=o.objectStore(A);var a=n.createCompositeKey(t);try{var u=s.get(a);u.onerror=function(t){i(N(t,"storage-get"))};u.onsuccess=function(t){var e=t.target.result;if(e){r(e.value)}else{r(undefined)}}}catch(c){i(l.create("storage-get",{originalErrorMessage:c&&c.message}))}}))]}}))}))};t.prototype.set=function(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n;var r=this;return o.__generator(this,(function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:n=i.sent();return[2,new Promise((function(i,o){var s=n.transaction([A],"readwrite");var a=s.objectStore(A);var u=r.createCompositeKey(t);try{var c=a.put({compositeKey:u,value:e});c.onerror=function(t){o(N(t,"storage-set"))};c.onsuccess=function(){i()}}catch(h){o(l.create("storage-set",{originalErrorMessage:h&&h.message}))}}))]}}))}))};t.prototype.delete=function(t){return o.__awaiter(this,void 0,void 0,(function(){var e;var n=this;return o.__generator(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:e=r.sent();return[2,new Promise((function(r,i){var o=e.transaction([A],"readwrite");var s=o.objectStore(A);var a=n.createCompositeKey(t);try{var u=s.delete(a);u.onerror=function(t){i(N(t,"storage-delete"))};u.onsuccess=function(){r()}}catch(c){i(l.create("storage-delete",{originalErrorMessage:c&&c.message}))}}))]}}))}))};t.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()};return t}();var D=function(){function t(t){this.storage=t}t.prototype.getLastFetchStatus=function(){return this.lastFetchStatus};t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis};t.prototype.getActiveConfig=function(){return this.activeConfig};t.prototype.loadFromStorage=function(){return o.__awaiter(this,void 0,void 0,(function(){var t,e,n,r,i,s;return o.__generator(this,(function(o){switch(o.label){case 0:t=this.storage.getLastFetchStatus();e=this.storage.getLastSuccessfulFetchTimestampMillis();n=this.storage.getActiveConfig();return[4,t];case 1:r=o.sent();if(r){this.lastFetchStatus=r}return[4,e];case 2:i=o.sent();if(i){this.lastSuccessfulFetchTimestampMillis=i}return[4,n];case 3:s=o.sent();if(s){this.activeConfig=s}return[2]}}))}))};t.prototype.setLastFetchStatus=function(t){this.lastFetchStatus=t;return this.storage.setLastFetchStatus(t)};t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){this.lastSuccessfulFetchTimestampMillis=t;return this.storage.setLastSuccessfulFetchTimestampMillis(t)};t.prototype.setActiveConfig=function(t){this.activeConfig=t;return this.storage.setActiveConfig(t)};return t}();var P=1e3;var x=2;var L=4*60*60*1e3;var U=.5;function M(t){var e=P*Math.pow(x,t);var n=Math.round(U*e*(Math.random()-.5)*2);return Math.min(L,e+n)}function j(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0);var o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o);r(l.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}function F(t){if(!(t instanceof s.FirebaseError)){return false}var e=Number(t["httpStatus"]);return e===429||e===500||e===503||e===504}var q=function(){function t(t,e){this.client=t;this.storage=e}t.prototype.fetch=function(t){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:e=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()};return[2,this.attemptFetch(t,e)]}}))}))};t.prototype.attemptFetch=function(t,e){var n=e.throttleEndTimeMillis,r=e.backoffCount;return o.__awaiter(this,void 0,void 0,(function(){var e,i,s;return o.__generator(this,(function(o){switch(o.label){case 0:return[4,j(t.signal,n)];case 1:o.sent();o.label=2;case 2:o.trys.push([2,5,,7]);return[4,this.client.fetch(t)];case 3:e=o.sent();return[4,this.storage.deleteThrottleMetadata()];case 4:o.sent();return[2,e];case 5:i=o.sent();if(!F(i)){throw i}s={throttleEndTimeMillis:Date.now()+M(r),backoffCount:r+1};return[4,this.storage.setThrottleMetadata(s)];case 6:o.sent();return[2,this.attemptFetch(t,s)];case 7:return[2]}}))}))};return t}();var G="@firebase/remote-config";var V="0.1.17";function B(t){t.INTERNAL.registerComponent(new u.Component("remoteConfig",e,"PUBLIC").setMultipleInstances(true));t.registerVersion(G,V);function e(e,n){var r=e.getProvider("app").getImmediate();var i=e.getProvider("installations").getImmediate();if(typeof window==="undefined"){throw l.create("registration-window")}var o=r.options,s=o.projectId,u=o.apiKey,h=o.appId;if(!s){throw l.create("registration-project-id")}if(!u){throw l.create("registration-api-key")}if(!h){throw l.create("registration-app-id")}n=n||"firebase";var f=new C(h,r.name,n);var p=new D(f);var d=new a.Logger(G);d.logLevel=a.LogLevel.ERROR;var y=new v(i,t.SDK_VERSION,n,s,u,h);var m=new q(y,f);var g=new c(m,f,p,d);var w=new T(r,g,p,f,d);w.ensureInitialized();return w}}B(i);e.registerRemoteConfig=B},24196:(t,e,n)=>{"use strict";n.r(e);n.d(e,{__extends:()=>i,__assign:()=>o,__rest:()=>s,__decorate:()=>a,__param:()=>u,__metadata:()=>c,__awaiter:()=>h,__generator:()=>f,__exportStar:()=>l,__values:()=>p,__read:()=>d,__spread:()=>v,__spreadArrays:()=>y,__await:()=>m,__asyncGenerator:()=>g,__asyncDelegator:()=>w,__asyncValues:()=>b,__makeTemplateObject:()=>_,__importStar:()=>E,__importDefault:()=>I,__classPrivateFieldGet:()=>T,__classPrivateFieldSet:()=>S});var r=function(t,e){r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n]};return r(t,e)};function i(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){o=Object.assign||function t(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o))e[o]=n[o]}return e};return o.apply(this,arguments)};function s(t,e){var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0)n[r]=t[r];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++){if(e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i]))n[r[i]]=t[r[i]]}return n}function a(t,e,n,r){var i=arguments.length,o=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,s;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)if(s=t[a])o=(i<3?s(o):i>3?s(e,n,o):s(e,n))||o;return i>3&&o&&Object.defineProperty(e,n,o),o}function u(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(t,e)}function h(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function f(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(t){return function(e){return u([t,e])}}function u(s){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=s[0]&2?i["return"]:s[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;if(i=0,o)s=[s[0]&2,o.value];switch(s[0]){case 0:case 1:o=s;break;case 4:n.label++;return{value:s[1],done:false};case 5:n.label++;i=s[1];s=[0];continue;case 7:s=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){n.label=s[1];break}if(s[0]===6&&n.label<o[1]){n.label=o[1];o=s;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(s);break}if(o[2])n.ops.pop();n.trys.pop();continue}s=e.call(t,n)}catch(a){s=[6,a];i=0}finally{r=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}}function l(t,e){for(var n in t)if(!e.hasOwnProperty(n))e[n]=t[n]}function p(t){var e=typeof Symbol==="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length==="number")return{next:function(){if(t&&r>=t.length)t=void 0;return{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function d(t,e){var n=typeof Symbol==="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],s;try{while((e===void 0||e-- >0)&&!(i=r.next()).done)o.push(i.value)}catch(a){s={error:a}}finally{try{if(i&&!i.done&&(n=r["return"]))n.call(r)}finally{if(s)throw s.error}}return o}function v(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(d(arguments[e]));return t}function y(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function m(t){return this instanceof m?(this.v=t,this):new m(t)}function g(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(t){if(r[t])i[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||a(t,e)}))}}function a(t,e){try{u(r[t](e))}catch(n){f(o[0][3],n)}}function u(t){t.value instanceof m?Promise.resolve(t.value.v).then(c,h):f(o[0][2],t)}function c(t){a("next",t)}function h(t){a("throw",t)}function f(t,e){if(t(e),o.shift(),o.length)a(o[0][0],o[0][1])}}function w(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:m(t[r](e)),done:r==="return"}:i?i(e):e}:i}}function b(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof p==="function"?p(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(e){n[e]=t[e]&&function(n){return new Promise((function(r,o){n=t[e](n),i(r,o,n.done,n.value)}))}}function i(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}}function _(t,e){if(Object.defineProperty){Object.defineProperty(t,"raw",{value:e})}else{t.raw=e}return t}function E(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)if(Object.hasOwnProperty.call(t,n))e[n]=t[n];e.default=t;return e}function I(t){return t&&t.__esModule?t:{default:t}}function T(t,e){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return e.get(t)}function S(t,e,n){if(!e.has(t)){throw new TypeError("attempted to set private field on non-instance")}e.set(t,n);return n}},4997:(t,e,n)=>{"use strict";n.r(e);n.d(e,{registerStorage:()=>sn});var r=n(99413);var i=function(t,e){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n]};return i(t,e)};function o(t,e){i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var s=function(){s=Object.assign||function t(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o))e[o]=n[o]}return e};return s.apply(this,arguments)};function a(t,e){var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0)n[r]=t[r];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++){if(e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i]))n[r[i]]=t[r[i]]}return n}function u(t,e,n,r){var i=arguments.length,o=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,s;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)if(s=t[a])o=(i<3?s(o):i>3?s(e,n,o):s(e,n))||o;return i>3&&o&&Object.defineProperty(e,n,o),o}function c(t,e){return function(n,r){e(n,r,t)}}function h(t,e){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(t,e)}function f(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function s(t){try{u(r.next(t))}catch(e){o(e)}}function a(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function l(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(t){return function(e){return u([t,e])}}function u(s){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,i&&(o=s[0]&2?i["return"]:s[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;if(i=0,o)s=[s[0]&2,o.value];switch(s[0]){case 0:case 1:o=s;break;case 4:n.label++;return{value:s[1],done:false};case 5:n.label++;i=s[1];s=[0];continue;case 7:s=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){n.label=s[1];break}if(s[0]===6&&n.label<o[1]){n.label=o[1];o=s;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(s);break}if(o[2])n.ops.pop();n.trys.pop();continue}s=e.call(t,n)}catch(a){s=[6,a];i=0}finally{r=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}}function p(t,e){for(var n in t)if(!e.hasOwnProperty(n))e[n]=t[n]}function d(t){var e=typeof Symbol==="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length==="number")return{next:function(){if(t&&r>=t.length)t=void 0;return{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(t,e){var n=typeof Symbol==="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],s;try{while((e===void 0||e-- >0)&&!(i=r.next()).done)o.push(i.value)}catch(a){s={error:a}}finally{try{if(i&&!i.done&&(n=r["return"]))n.call(r)}finally{if(s)throw s.error}}return o}function y(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(v(arguments[e]));return t}function m(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function g(t){return this instanceof g?(this.v=t,this):new g(t)}function w(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(t){if(r[t])i[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||a(t,e)}))}}function a(t,e){try{u(r[t](e))}catch(n){f(o[0][3],n)}}function u(t){t.value instanceof g?Promise.resolve(t.value.v).then(c,h):f(o[0][2],t)}function c(t){a("next",t)}function h(t){a("throw",t)}function f(t,e){if(t(e),o.shift(),o.length)a(o[0][0],o[0][1])}}function b(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:g(t[r](e)),done:r==="return"}:i?i(e):e}:i}}function _(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof d==="function"?d(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(e){n[e]=t[e]&&function(n){return new Promise((function(r,o){n=t[e](n),i(r,o,n.done,n.value)}))}}function i(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}}function E(t,e){if(Object.defineProperty){Object.defineProperty(t,"raw",{value:e})}else{t.raw=e}return t}function I(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)if(Object.hasOwnProperty.call(t,n))e[n]=t[n];e.default=t;return e}function T(t){return t&&t.__esModule?t:{default:t}}function S(t,e){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return e.get(t)}function N(t,e,n){if(!e.has(t)){throw new TypeError("attempted to set private field on non-instance")}e.set(t,n);return n}var A=n(56630);var O="firebasestorage.googleapis.com";var k="storageBucket";var R=2*60*1e3;var C=10*60*1e3;var D=-9007199254740991;var P=function(){function t(t,e){this.code_=L(t);this.message_="Firebase Storage: "+e;this.serverResponse_=null;this.name_="FirebaseError"}t.prototype.codeProp=function(){return this.code};t.prototype.codeEquals=function(t){return L(t)===this.codeProp()};t.prototype.serverResponseProp=function(){return this.serverResponse_};t.prototype.setServerResponseProp=function(t){this.serverResponse_=t};Object.defineProperty(t.prototype,"name",{get:function(){return this.name_},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"code",{get:function(){return this.code_},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"message",{get:function(){return this.message_},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"serverResponse",{get:function(){return this.serverResponse_},enumerable:true,configurable:true});return t}();var x={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error"};function L(t){return"storage/"+t}function U(){var t="An unknown error occurred, please check the error payload for "+"server response.";return new P(x.UNKNOWN,t)}function M(t){return new P(x.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function j(t){return new P(x.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on "+"https://firebase.google.com/pricing/.")}function F(){var t="User is not authenticated, please authenticate using Firebase "+"Authentication and try again.";return new P(x.UNAUTHENTICATED,t)}function q(t){return new P(x.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function G(){return new P(x.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function V(){return new P(x.CANCELED,"User canceled the upload/download.")}function B(t){return new P(x.INVALID_URL,"Invalid URL '"+t+"'.")}function z(t){return new P(x.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function H(){return new P(x.NO_DEFAULT_BUCKET,"No default bucket "+"found. Did you set the '"+k+"' property when initializing the app?")}function W(){return new P(x.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function K(){return new P(x.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function Q(){return new P(x.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Y(t,e,n){return new P(x.INVALID_ARGUMENT,"Invalid argument in `"+e+"` at index "+t+": "+n)}function J(t,e,n,r){var i;var o;if(t===e){i=t;o=t===1?"argument":"arguments"}else{i="between "+t+" and "+e;o="arguments"}return new P(x.INVALID_ARGUMENT_COUNT,"Invalid argument count in `"+n+"`: Expected "+i+" "+o+", received "+r+".")}function X(){return new P(x.APP_DELETED,"The Firebase app was deleted.")}function $(t){return new P(x.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root "+"reference using child, such as .child('file.png').")}function Z(t,e){return new P(x.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function tt(t){throw new P(x.INTERNAL_ERROR,"Internal error: "+t)}var et={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};function nt(t){switch(t){case et.RAW:case et.BASE64:case et.BASE64URL:case et.DATA_URL:return;default:throw"Expected one of the event types: ["+et.RAW+", "+et.BASE64+", "+et.BASE64URL+", "+et.DATA_URL+"]."}}var rt=function(){function t(t,e){this.data=t;this.contentType=e||null}return t}();function it(t,e){switch(t){case et.RAW:return new rt(ot(e));case et.BASE64:case et.BASE64URL:return new rt(at(t,e));case et.DATA_URL:return new rt(ct(e),ht(e))}throw U()}function ot(t){var e=[];for(var n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127){e.push(r)}else{if(r<=2047){e.push(192|r>>6,128|r&63)}else{if((r&64512)===55296){var i=n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320;if(!i){e.push(239,191,189)}else{var o=r;var s=t.charCodeAt(++n);r=65536|(o&1023)<<10|s&1023;e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}}else{if((r&64512)===56320){e.push(239,191,189)}else{e.push(224|r>>12,128|r>>6&63,128|r&63)}}}}}return new Uint8Array(e)}function st(t){var e;try{e=decodeURIComponent(t)}catch(n){throw Z(et.DATA_URL,"Malformed data URL.")}return ot(e)}function at(t,e){switch(t){case et.BASE64:{var n=e.indexOf("-")!==-1;var r=e.indexOf("_")!==-1;if(n||r){var i=n?"-":"_";throw Z(t,"Invalid character '"+i+"' found: is it base64url encoded?")}break}case et.BASE64URL:{var o=e.indexOf("+")!==-1;var s=e.indexOf("/")!==-1;if(o||s){var i=o?"+":"/";throw Z(t,"Invalid character '"+i+"' found: is it base64 encoded?")}e=e.replace(/-/g,"+").replace(/_/g,"/");break}}var a;try{a=atob(e)}catch(h){throw Z(t,"Invalid character found")}var u=new Uint8Array(a.length);for(var c=0;c<a.length;c++){u[c]=a.charCodeAt(c)}return u}var ut=function(){function t(t){this.base64=false;this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(e===null){throw Z(et.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>")}var n=e[1]||null;if(n!=null){this.base64=ft(n,";base64");this.contentType=this.base64?n.substring(0,n.length-";base64".length):n}this.rest=t.substring(t.indexOf(",")+1)}return t}();function ct(t){var e=new ut(t);if(e.base64){return at(et.BASE64,e.rest)}else{return st(e.rest)}}function ht(t){var e=new ut(t);return e.contentType}function ft(t,e){var n=t.length>=e.length;if(!n){return false}return t.substring(t.length-e.length)===e}var lt={STATE_CHANGED:"state_changed"};var pt={RUNNING:"running",PAUSING:"pausing",PAUSED:"paused",SUCCESS:"success",CANCELING:"canceling",CANCELED:"canceled",ERROR:"error"};var dt={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function vt(t){switch(t){case pt.RUNNING:case pt.PAUSING:case pt.CANCELING:return dt.RUNNING;case pt.PAUSED:return dt.PAUSED;case pt.SUCCESS:return dt.SUCCESS;case pt.CANCELED:return dt.CANCELED;case pt.ERROR:return dt.ERROR;default:return dt.ERROR}}function yt(t){return t!=null}function mt(t){return t!==void 0}function gt(t){return typeof t==="function"}function wt(t){return typeof t==="object"}function bt(t){return wt(t)&&t!==null}function _t(t){return wt(t)&&!Array.isArray(t)}function Et(t){return typeof t==="string"||t instanceof String}function It(t){return Tt(t)&&Number.isInteger(t)}function Tt(t){return typeof t==="number"||t instanceof Number}function St(t){return Nt()&&t instanceof Blob}function Nt(){return typeof Blob!=="undefined"}var At;(function(t){t[t["NO_ERROR"]=0]="NO_ERROR";t[t["NETWORK_ERROR"]=1]="NETWORK_ERROR";t[t["ABORT"]=2]="ABORT"})(At||(At={}));var Ot=function(){function t(){var t=this;this.sent_=false;this.xhr_=new XMLHttpRequest;this.errorCode_=At.NO_ERROR;this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=At.ABORT;e(t)}));t.xhr_.addEventListener("error",(function(){t.errorCode_=At.NETWORK_ERROR;e(t)}));t.xhr_.addEventListener("load",(function(){e(t)}))}))}t.prototype.send=function(t,e,n,r){if(this.sent_){throw tt("cannot .send() more than once")}this.sent_=true;this.xhr_.open(e,t,true);if(yt(r)){for(var i in r){if(r.hasOwnProperty(i)){this.xhr_.setRequestHeader(i,r[i].toString())}}}if(yt(n)){this.xhr_.send(n)}else{this.xhr_.send()}return this.sendPromise_};t.prototype.getErrorCode=function(){if(!this.sent_){throw tt("cannot .getErrorCode() before sending")}return this.errorCode_};t.prototype.getStatus=function(){if(!this.sent_){throw tt("cannot .getStatus() before sending")}try{return this.xhr_.status}catch(t){return-1}};t.prototype.getResponseText=function(){if(!this.sent_){throw tt("cannot .getResponseText() before sending")}return this.xhr_.responseText};t.prototype.abort=function(){this.xhr_.abort()};t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)};t.prototype.addUploadProgressListener=function(t){if(yt(this.xhr_.upload)){this.xhr_.upload.addEventListener("progress",t)}};t.prototype.removeUploadProgressListener=function(t){if(yt(this.xhr_.upload)){this.xhr_.upload.removeEventListener("progress",t)}};return t}();var kt=function(){function t(){}t.prototype.createXhrIo=function(){return new Ot};return t}();function Rt(){if(typeof BlobBuilder!=="undefined"){return BlobBuilder}else if(typeof WebKitBlobBuilder!=="undefined"){return WebKitBlobBuilder}else{return undefined}}function Ct(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}var n=Rt();if(n!==undefined){var r=new n;for(var i=0;i<t.length;i++){r.append(t[i])}return r.getBlob()}else{if(Nt()){return new Blob(t)}else{throw Error("This browser doesn't seem to support creating Blobs")}}}function Dt(t,e,n){if(t.webkitSlice){return t.webkitSlice(e,n)}else if(t.mozSlice){return t.mozSlice(e,n)}else if(t.slice){return t.slice(e,n)}return null}var Pt=function(){function t(t,e){var n=0;var r="";if(St(t)){this.data_=t;n=t.size;r=t.type}else if(t instanceof ArrayBuffer){if(e){this.data_=new Uint8Array(t)}else{this.data_=new Uint8Array(t.byteLength);this.data_.set(new Uint8Array(t))}n=this.data_.length}else if(t instanceof Uint8Array){if(e){this.data_=t}else{this.data_=new Uint8Array(t.length);this.data_.set(t)}n=t.length}this.size_=n;this.type_=r}t.prototype.size=function(){return this.size_};t.prototype.type=function(){return this.type_};t.prototype.slice=function(e,n){if(St(this.data_)){var r=this.data_;var i=Dt(r,e,n);if(i===null){return null}return new t(i)}else{var o=new Uint8Array(this.data_.buffer,e,n-e);return new t(o,true)}};t.getBlob=function(){var e=[];for(var n=0;n<arguments.length;n++){e[n]=arguments[n]}if(Nt()){var r=e.map((function(e){if(e instanceof t){return e.data_}else{return e}}));return new t(Ct.apply(null,r))}else{var i=e.map((function(t){if(Et(t)){return it(et.RAW,t).data}else{return t.data_}}));var o=0;i.forEach((function(t){o+=t.byteLength}));var s=new Uint8Array(o);var a=0;i.forEach((function(t){for(var e=0;e<t.length;e++){s[a++]=t[e]}}));return new t(s,true)}};t.prototype.uploadData=function(){return this.data_};return t}();var xt=function(){function t(t,e){this.bucket=t;this.path_=e}Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"isRoot",{get:function(){return this.path.length===0},enumerable:true,configurable:true});t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)};t.prototype.bucketOnlyServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o"};t.makeFromBucketSpec=function(e){var n;try{n=t.makeFromUrl(e)}catch(r){return new t(e,"")}if(n.path===""){return n}else{throw z(e)}};t.makeFromUrl=function(e){var n=null;var r="([A-Za-z0-9.\\-_]+)";function i(t){if(t.path.charAt(t.path.length-1)==="/"){t.path_=t.path_.slice(0,-1)}}var o="(/(.*))?$";var s="(/([^?#]*).*)?$";var a=new RegExp("^gs://"+r+o,"i");var u={bucket:1,path:3};function c(t){t.path_=decodeURIComponent(t.path)}var h="v[A-Za-z0-9_]+";var f=O.replace(/[.]/g,"\\.");var l=new RegExp("^https?://"+f+"/"+h+"/b/"+r+"/o"+s,"i");var p={bucket:1,path:3};var d=[{regex:a,indices:u,postModify:i},{regex:l,indices:p,postModify:c}];for(var v=0;v<d.length;v++){var y=d[v];var m=y.regex.exec(e);if(m){var g=m[y.indices.bucket];var w=m[y.indices.path];if(!w){w=""}n=new t(g,w);y.postModify(n);break}}if(n==null){throw B(e)}return n};return t}();function Lt(t){var e;try{e=JSON.parse(t)}catch(n){return null}if(_t(e)){return e}else{return null}}function Ut(t){if(t.length===0){return null}var e=t.lastIndexOf("/");if(e===-1){return""}var n=t.slice(0,e);return n}function Mt(t,e){var n=e.split("/").filter((function(t){return t.length>0})).join("/");if(t.length===0){return n}else{return t+"/"+n}}function jt(t){var e=t.lastIndexOf("/",t.length-2);if(e===-1){return t}else{return t.slice(e+1)}}function Ft(t){return"https://"+O+"/v0"+t}function qt(t){var e=encodeURIComponent;var n="?";for(var r in t){if(t.hasOwnProperty(r)){var i=e(r)+"="+e(t[r]);n=n+i+"&"}}n=n.slice(0,-1);return n}function Gt(t,e){return e}var Vt=function(){function t(t,e,n,r){this.server=t;this.local=e||t;this.writable=!!n;this.xform=r||Gt}return t}();var Bt=null;function zt(t){if(!Et(t)||t.length<2){return t}else{return jt(t)}}function Ht(){if(Bt){return Bt}var t=[];t.push(new Vt("bucket"));t.push(new Vt("generation"));t.push(new Vt("metageneration"));t.push(new Vt("name","fullPath",true));function e(t,e){return zt(e)}var n=new Vt("name");n.xform=e;t.push(n);function r(t,e){if(yt(e)){return Number(e)}else{return e}}var i=new Vt("size");i.xform=r;t.push(i);t.push(new Vt("timeCreated"));t.push(new Vt("updated"));t.push(new Vt("md5Hash",null,true));t.push(new Vt("cacheControl",null,true));t.push(new Vt("contentDisposition",null,true));t.push(new Vt("contentEncoding",null,true));t.push(new Vt("contentLanguage",null,true));t.push(new Vt("contentType",null,true));t.push(new Vt("metadata","customMetadata",true));Bt=t;return Bt}function Wt(t,e){function n(){var n=t["bucket"];var r=t["fullPath"];var i=new xt(n,r);return e.makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function Kt(t,e,n){var r={};r["type"]="file";var i=n.length;for(var o=0;o<i;o++){var s=n[o];r[s.local]=s.xform(r,e[s.server])}Wt(r,t);return r}function Qt(t,e,n){var r=Lt(e);if(r===null){return null}var i=r;return Kt(t,i,n)}function Yt(t,e){var n=Lt(e);if(n===null){return null}if(!Et(n["downloadTokens"])){return null}var r=n["downloadTokens"];if(r.length===0){return null}var i=encodeURIComponent;var o=r.split(",");var s=o.map((function(e){var n=t["bucket"];var r=t["fullPath"];var o="/b/"+i(n)+"/o/"+i(r);var s=Ft(o);var a=qt({alt:"media",token:e});return s+a}));return s[0]}function Jt(t,e){var n={};var r=e.length;for(var i=0;i<r;i++){var o=e[i];if(o.writable){n[o.server]=t[o.local]}}return JSON.stringify(n)}function Xt(t){if(!wt(t)||!t){throw"Expected Metadata object."}for(var e in t){if(t.hasOwnProperty(e)){var n=t[e];if(e==="customMetadata"){if(!wt(n)){throw"Expected object for 'customMetadata' mapping."}}else{if(bt(n)){throw"Mapping for '"+e+"' cannot be an object."}}}}}var $t="maxResults";var Zt=1e3;var te="pageToken";var ee="prefixes";var ne="items";function re(t,e){var n={prefixes:[],items:[],nextPageToken:e["nextPageToken"]};var r=t.bucket();if(r===null){throw H()}if(e[ee]){for(var i=0,o=e[ee];i<o.length;i++){var s=o[i];var a=s.replace(/\/$/,"");var u=t.makeStorageReference(new xt(r,a));n.prefixes.push(u)}}if(e[ne]){for(var c=0,h=e[ne];c<h.length;c++){var f=h[c];var u=t.makeStorageReference(new xt(r,f["name"]));n.items.push(u)}}return n}function ie(t,e){var n=Lt(e);if(n===null){return null}var r=n;return re(t,r)}function oe(t){if(!wt(t)||!t){throw"Expected ListOptions object."}for(var e in t){if(e===$t){if(!It(t[$t])||t[$t]<=0){throw"Expected maxResults to be a positive number."}if(t[$t]>1e3){throw"Expected maxResults to be less than or equal to "+Zt+"."}}else if(e===te){if(t[te]&&!Et(t[te])){throw"Expected pageToken to be string."}}else{throw"Unknown option: "+e}}}var se=function(){function t(t,e,n,r){this.url=t;this.method=e;this.handler=n;this.timeout=r;this.urlParams={};this.headers={};this.body=null;this.errorHandler=null;this.progressCallback=null;this.successCodes=[200];this.additionalRetryCodes=[]}return t}();function ae(t){if(!t){throw U()}}function ue(t,e){function n(n,r){var i=Qt(t,r,e);ae(i!==null);return i}return n}function ce(t){function e(e,n){var r=ie(t,n);ae(r!==null);return r}return e}function he(t,e){function n(n,r){var i=Qt(t,r,e);ae(i!==null);return Yt(i,r)}return n}function fe(t){function e(e,n){var r;if(e.getStatus()===401){r=F()}else{if(e.getStatus()===402){r=j(t.bucket)}else{if(e.getStatus()===403){r=q(t.path)}else{r=n}}}r.setServerResponseProp(n.serverResponseProp());return r}return e}function le(t){var e=fe(t);function n(n,r){var i=e(n,r);if(n.getStatus()===404){i=M(t.path)}i.setServerResponseProp(r.serverResponseProp());return i}return n}function pe(t,e,n){var r=e.fullServerUrl();var i=Ft(r);var o="GET";var s=t.maxOperationRetryTime();var a=new se(i,o,ue(t,n),s);a.errorHandler=le(e);return a}function de(t,e,n,r,i){var o={};if(e.isRoot){o["prefix"]=""}else{o["prefix"]=e.path+"/"}if(n&&n.length>0){o["delimiter"]=n}if(r){o["pageToken"]=r}if(i){o["maxResults"]=i}var s=e.bucketOnlyServerUrl();var a=Ft(s);var u="GET";var c=t.maxOperationRetryTime();var h=new se(a,u,ce(t),c);h.urlParams=o;h.errorHandler=fe(e);return h}function ve(t,e,n){var r=e.fullServerUrl();var i=Ft(r);var o="GET";var s=t.maxOperationRetryTime();var a=new se(i,o,he(t,n),s);a.errorHandler=le(e);return a}function ye(t,e,n,r){var i=e.fullServerUrl();var o=Ft(i);var s="PATCH";var a=Jt(n,r);var u={"Content-Type":"application/json; charset=utf-8"};var c=t.maxOperationRetryTime();var h=new se(o,s,ue(t,r),c);h.headers=u;h.body=a;h.errorHandler=le(e);return h}function me(t,e){var n=e.fullServerUrl();var r=Ft(n);var i="DELETE";var o=t.maxOperationRetryTime();function s(t,e){}var a=new se(r,i,s,o);a.successCodes=[200,204];a.errorHandler=le(e);return a}function ge(t,e){return t&&t["contentType"]||e&&e.type()||"application/octet-stream"}function we(t,e,n){var r=Object.assign({},n);r["fullPath"]=t.path;r["size"]=e.size();if(!r["contentType"]){r["contentType"]=ge(null,e)}return r}function be(t,e,n,r,i){var o=e.bucketOnlyServerUrl();var s={"X-Goog-Upload-Protocol":"multipart"};function a(){var t="";for(var e=0;e<2;e++){t=t+Math.random().toString().slice(2)}return t}var u=a();s["Content-Type"]="multipart/related; boundary="+u;var c=we(e,r,i);var h=Jt(c,n);var f="--"+u+"\r\n"+"Content-Type: application/json; charset=utf-8\r\n\r\n"+h+"\r\n--"+u+"\r\n"+"Content-Type: "+c["contentType"]+"\r\n\r\n";var l="\r\n--"+u+"--";var p=Pt.getBlob(f,r,l);if(p===null){throw W()}var d={name:c["fullPath"]};var v=Ft(o);var y="POST";var m=t.maxUploadRetryTime();var g=new se(v,y,ue(t,n),m);g.urlParams=d;g.headers=s;g.body=p.uploadData();g.errorHandler=fe(e);return g}var _e=function(){function t(t,e,n,r){this.current=t;this.total=e;this.finalized=!!n;this.metadata=r||null}return t}();function Ee(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(i){ae(false)}var r=e||["active"];ae(!!n&&r.indexOf(n)!==-1);return n}function Ie(t,e,n,r,i){var o=e.bucketOnlyServerUrl();var s=we(e,r,i);var a={name:s["fullPath"]};var u=Ft(o);var c="POST";var h={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":s["contentType"],"Content-Type":"application/json; charset=utf-8"};var f=Jt(s,n);var l=t.maxUploadRetryTime();function p(t){Ee(t);var e;try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(n){ae(false)}ae(Et(e));return e}var d=new se(u,c,p,l);d.urlParams=a;d.headers=h;d.body=f;d.errorHandler=fe(e);return d}function Te(t,e,n,r){var i={"X-Goog-Upload-Command":"query"};function o(t){var e=Ee(t,["active","final"]);var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(o){ae(false)}if(!n){ae(false)}var i=Number(n);ae(!isNaN(i));return new _e(i,r.size(),e==="final")}var s="POST";var a=t.maxUploadRetryTime();var u=new se(n,s,o,a);u.headers=i;u.errorHandler=fe(e);return u}var Se=256*1024;function Ne(t,e,n,r,i,o,s,a){var u=new _e(0,0);if(s){u.current=s.current;u.total=s.total}else{u.current=0;u.total=r.size()}if(r.size()!==u.total){throw K()}var c=u.total-u.current;var h=c;if(i>0){h=Math.min(h,i)}var f=u.current;var l=f+h;var p=h===c?"upload, finalize":"upload";var d={"X-Goog-Upload-Command":p,"X-Goog-Upload-Offset":u.current};var v=r.slice(f,l);if(v===null){throw W()}function y(t,n){var i=Ee(t,["active","final"]);var s=u.current+h;var a=r.size();var c;if(i==="final"){c=ue(e,o)(t,n)}else{c=null}return new _e(s,a,i==="final",c)}var m="POST";var g=e.maxUploadRetryTime();var w=new se(n,m,y,g);w.headers=d;w.body=v.uploadData();w.progressCallback=a||null;w.errorHandler=fe(t);return w}var Ae=function(){function t(t,e,n){var r=gt(t)||yt(e)||yt(n);if(r){this.next=t;this.error=e||null;this.complete=n||null}else{var i=t;this.next=i.next||null;this.error=i.error||null;this.complete=i.complete||null}}return t}();var Oe=function(){function t(t,e,n,r,i,o){this.bytesTransferred=t;this.totalBytes=e;this.state=n;this.metadata=r;this.task=i;this.ref=o}return t}();function ke(t,e,n){var r=e.length;var i=e.length;for(var o=0;o<e.length;o++){if(e[o].optional){r=o;break}}var s=r<=n.length&&n.length<=i;if(!s){throw J(r,i,t,n.length)}for(var o=0;o<n.length;o++){try{e[o].validator(n[o])}catch(a){if(a instanceof Error){throw Y(o,t,a.message)}else{throw Y(o,t,a)}}}}var Re=function(){function t(t,e){var n=this;this.validator=function(e){if(n.optional&&!mt(e)){return}t(e)};this.optional=!!e}return t}();function Ce(t,e){return function(n){t(n);e(n)}}function De(t,e){function n(t){if(!Et(t)){throw"Expected string."}}var r;if(t){r=Ce(n,t)}else{r=n}return new Re(r,e)}function Pe(){function t(t){var e=t instanceof Uint8Array||t instanceof ArrayBuffer||Nt()&&t instanceof Blob;if(!e){throw"Expected Blob or File."}}return new Re(t)}function xe(t){return new Re(Xt,t)}function Le(t){return new Re(oe,t)}function Ue(){function t(t){var e=Tt(t)&&t>=0;if(!e){throw"Expected a number 0 or greater."}}return new Re(t)}function Me(t,e){function n(e){var n=e===null||yt(e)&&e instanceof Object;if(!n){throw"Expected an Object."}if(t!==undefined&&t!==null){t(e)}}return new Re(n,e)}function je(t){function e(t){var e=t===null||gt(t);if(!e){throw"Expected a Function."}}return new Re(e,t)}function Fe(t){return function(){var e=[];for(var n=0;n<arguments.length;n++){e[n]=arguments[n]}Promise.resolve().then((function(){return t.apply(void 0,e)}))}}var qe=function(){function t(t,e,n,r,i,o){var s=this;if(o===void 0){o=null}this.transferred_=0;this.needToFetchStatus_=false;this.needToFetchMetadata_=false;this.observers_=[];this.error_=null;this.uploadUrl_=null;this.request_=null;this.chunkMultiplier_=1;this.resolve_=null;this.reject_=null;this.ref_=t;this.authWrapper_=e;this.location_=n;this.blob_=i;this.metadata_=o;this.mappings_=r;this.resumable_=this.shouldDoResumable_(this.blob_);this.state_=pt.RUNNING;this.errorHandler_=function(t){s.request_=null;s.chunkMultiplier_=1;if(t.codeEquals(x.CANCELED)){s.needToFetchStatus_=true;s.completeTransitions_()}else{s.error_=t;s.transition_(pt.ERROR)}};this.metadataErrorHandler_=function(t){s.request_=null;if(t.codeEquals(x.CANCELED)){s.completeTransitions_()}else{s.error_=t;s.transition_(pt.ERROR)}};this.promise_=new Promise((function(t,e){s.resolve_=t;s.reject_=e;s.start_()}));this.promise_.then(null,(function(){}))}t.prototype.makeProgressCallback_=function(){var t=this;var e=this.transferred_;return function(n){return t.updateProgress_(e+n)}};t.prototype.shouldDoResumable_=function(t){return t.size()>256*1024};t.prototype.start_=function(){if(this.state_!==pt.RUNNING){return}if(this.request_!==null){return}if(this.resumable_){if(this.uploadUrl_===null){this.createResumable_()}else{if(this.needToFetchStatus_){this.fetchStatus_()}else{if(this.needToFetchMetadata_){this.fetchMetadata_()}else{this.continueUpload_()}}}}else{this.oneShotUpload_()}};t.prototype.resolveToken_=function(t){var e=this;this.authWrapper_.getAuthToken().then((function(n){switch(e.state_){case pt.RUNNING:t(n);break;case pt.CANCELING:e.transition_(pt.CANCELED);break;case pt.PAUSING:e.transition_(pt.PAUSED);break}}))};t.prototype.createResumable_=function(){var t=this;this.resolveToken_((function(e){var n=Ie(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_);var r=t.authWrapper_.makeRequest(n,e);t.request_=r;r.getPromise().then((function(e){t.request_=null;t.uploadUrl_=e;t.needToFetchStatus_=false;t.completeTransitions_()}),t.errorHandler_)}))};t.prototype.fetchStatus_=function(){var t=this;var e=this.uploadUrl_;this.resolveToken_((function(n){var r=Te(t.authWrapper_,t.location_,e,t.blob_);var i=t.authWrapper_.makeRequest(r,n);t.request_=i;i.getPromise().then((function(e){e=e;t.request_=null;t.updateProgress_(e.current);t.needToFetchStatus_=false;if(e.finalized){t.needToFetchMetadata_=true}t.completeTransitions_()}),t.errorHandler_)}))};t.prototype.continueUpload_=function(){var t=this;var e=Se*this.chunkMultiplier_;var n=new _e(this.transferred_,this.blob_.size());var r=this.uploadUrl_;this.resolveToken_((function(i){var o;try{o=Ne(t.location_,t.authWrapper_,r,t.blob_,e,t.mappings_,n,t.makeProgressCallback_())}catch(a){t.error_=a;t.transition_(pt.ERROR);return}var s=t.authWrapper_.makeRequest(o,i);t.request_=s;s.getPromise().then((function(e){t.increaseMultiplier_();t.request_=null;t.updateProgress_(e.current);if(e.finalized){t.metadata_=e.metadata;t.transition_(pt.SUCCESS)}else{t.completeTransitions_()}}),t.errorHandler_)}))};t.prototype.increaseMultiplier_=function(){var t=Se*this.chunkMultiplier_;if(t<32*1024*1024){this.chunkMultiplier_*=2}};t.prototype.fetchMetadata_=function(){var t=this;this.resolveToken_((function(e){var n=pe(t.authWrapper_,t.location_,t.mappings_);var r=t.authWrapper_.makeRequest(n,e);t.request_=r;r.getPromise().then((function(e){t.request_=null;t.metadata_=e;t.transition_(pt.SUCCESS)}),t.metadataErrorHandler_)}))};t.prototype.oneShotUpload_=function(){var t=this;this.resolveToken_((function(e){var n=be(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_);var r=t.authWrapper_.makeRequest(n,e);t.request_=r;r.getPromise().then((function(e){t.request_=null;t.metadata_=e;t.updateProgress_(t.blob_.size());t.transition_(pt.SUCCESS)}),t.errorHandler_)}))};t.prototype.updateProgress_=function(t){var e=this.transferred_;this.transferred_=t;if(this.transferred_!==e){this.notifyObservers_()}};t.prototype.transition_=function(t){if(this.state_===t){return}switch(t){case pt.CANCELING:this.state_=t;if(this.request_!==null){this.request_.cancel()}break;case pt.PAUSING:this.state_=t;if(this.request_!==null){this.request_.cancel()}break;case pt.RUNNING:var e=this.state_===pt.PAUSED;this.state_=t;if(e){this.notifyObservers_();this.start_()}break;case pt.PAUSED:this.state_=t;this.notifyObservers_();break;case pt.CANCELED:this.error_=V();this.state_=t;this.notifyObservers_();break;case pt.ERROR:this.state_=t;this.notifyObservers_();break;case pt.SUCCESS:this.state_=t;this.notifyObservers_();break}};t.prototype.completeTransitions_=function(){switch(this.state_){case pt.PAUSING:this.transition_(pt.PAUSED);break;case pt.CANCELING:this.transition_(pt.CANCELED);break;case pt.RUNNING:this.start_();break}};Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=vt(this.state_);return new Oe(this.transferred_,this.blob_.size(),t,this.metadata_,this,this.ref_)},enumerable:true,configurable:true});t.prototype.on=function(t,e,n,r){function i(){if(t!==lt.STATE_CHANGED){throw"Expected one of the event types: ["+lt.STATE_CHANGED+"]."}}var o="Expected a function or an Object with one of "+"`next`, `error`, `complete` properties.";var s=je(true).validator;var a=Me(null,true).validator;function u(t){try{s(t);return}catch(n){}try{a(t);var e=mt(t["next"])||mt(t["error"])||mt(t["complete"]);if(!e){throw""}return}catch(n){throw o}}var c=[De(i),Me(u,true),je(true),je(true)];ke("on",c,arguments);var h=this;function f(t){function e(e,n,i){if(t!==null){ke("on",t,arguments)}var o=new Ae(e,n,r);h.addObserver_(o);return function(){h.removeObserver_(o)}}return e}function l(t){if(t===null){throw o}u(t)}var p=[Me(l),je(true),je(true)];var d=!(mt(e)||mt(n)||mt(r));if(d){return f(p)}else{return f(null)(e,n,r)}};t.prototype.then=function(t,e){return this.promise_.then(t,e)};t.prototype.catch=function(t){return this.then(null,t)};t.prototype.addObserver_=function(t){this.observers_.push(t);this.notifyObserver_(t)};t.prototype.removeObserver_=function(t){var e=this.observers_.indexOf(t);if(e!==-1){this.observers_.splice(e,1)}};t.prototype.notifyObservers_=function(){var t=this;this.finishPromise_();var e=this.observers_.slice();e.forEach((function(e){t.notifyObserver_(e)}))};t.prototype.finishPromise_=function(){if(this.resolve_!==null){var t=true;switch(vt(this.state_)){case dt.SUCCESS:Fe(this.resolve_.bind(null,this.snapshot))();break;case dt.CANCELED:case dt.ERROR:var e=this.reject_;Fe(e.bind(null,this.error_))();break;default:t=false;break}if(t){this.resolve_=null;this.reject_=null}}};t.prototype.notifyObserver_=function(t){var e=vt(this.state_);switch(e){case dt.RUNNING:case dt.PAUSED:if(t.next){Fe(t.next.bind(t,this.snapshot))()}break;case dt.SUCCESS:if(t.complete){Fe(t.complete.bind(t))()}break;case dt.CANCELED:case dt.ERROR:if(t.error){Fe(t.error.bind(t,this.error_))()}break;default:if(t.error){Fe(t.error.bind(t,this.error_))()}}};t.prototype.resume=function(){ke("resume",[],arguments);var t=this.state_===pt.PAUSED||this.state_===pt.PAUSING;if(t){this.transition_(pt.RUNNING)}return t};t.prototype.pause=function(){ke("pause",[],arguments);var t=this.state_===pt.RUNNING;if(t){this.transition_(pt.PAUSING)}return t};t.prototype.cancel=function(){ke("cancel",[],arguments);var t=this.state_===pt.RUNNING||this.state_===pt.PAUSING;if(t){this.transition_(pt.CANCELING)}return t};return t}();var Ge=function(){function t(t,e){this.authWrapper=t;if(e instanceof xt){this.location=e}else{this.location=xt.makeFromUrl(e)}}t.prototype.toString=function(){ke("toString",[],arguments);return"gs://"+this.location.bucket+"/"+this.location.path};t.prototype.newRef=function(e,n){return new t(e,n)};t.prototype.mappings=function(){return Ht()};t.prototype.child=function(t){ke("child",[De()],arguments);var e=Mt(this.location.path,t);var n=new xt(this.location.bucket,e);return this.newRef(this.authWrapper,n)};Object.defineProperty(t.prototype,"parent",{get:function(){var t=Ut(this.location.path);if(t===null){return null}var e=new xt(this.location.bucket,t);return this.newRef(this.authWrapper,e)},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"root",{get:function(){var t=new xt(this.location.bucket,"");return this.newRef(this.authWrapper,t)},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"fullPath",{get:function(){return this.location.path},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"name",{get:function(){return jt(this.location.path)},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"storage",{get:function(){return this.authWrapper.service()},enumerable:true,configurable:true});t.prototype.put=function(t,e){if(e===void 0){e=null}ke("put",[Pe(),xe(true)],arguments);this.throwIfRoot_("put");return new qe(this,this.authWrapper,this.location,this.mappings(),new Pt(t),e)};t.prototype.putString=function(t,e,n){if(e===void 0){e=et.RAW}ke("putString",[De(),De(nt,true),xe(true)],arguments);this.throwIfRoot_("putString");var r=it(e,t);var i=Object.assign({},n);if(!yt(i["contentType"])&&yt(r.contentType)){i["contentType"]=r.contentType}return new qe(this,this.authWrapper,this.location,this.mappings(),new Pt(r.data,true),i)};t.prototype.delete=function(){var t=this;ke("delete",[],arguments);this.throwIfRoot_("delete");return this.authWrapper.getAuthToken().then((function(e){var n=me(t.authWrapper,t.location);return t.authWrapper.makeRequest(n,e).getPromise()}))};t.prototype.listAll=function(){ke("listAll",[],arguments);var t={prefixes:[],items:[]};return this.listAllHelper(t).then((function(){return t}))};t.prototype.listAllHelper=function(t,e){return f(this,void 0,void 0,(function(){var n,r;var i,o;return l(this,(function(s){switch(s.label){case 0:n={pageToken:e};return[4,this.list(n)];case 1:r=s.sent();(i=t.prefixes).push.apply(i,r.prefixes);(o=t.items).push.apply(o,r.items);if(!(r.nextPageToken!=null))return[3,3];return[4,this.listAllHelper(t,r.nextPageToken)];case 2:s.sent();s.label=3;case 3:return[2]}}))}))};t.prototype.list=function(t){ke("list",[Le(true)],arguments);var e=this;return this.authWrapper.getAuthToken().then((function(n){var r=t||{};var i=de(e.authWrapper,e.location,"/",r.pageToken,r.maxResults);return e.authWrapper.makeRequest(i,n).getPromise()}))};t.prototype.getMetadata=function(){var t=this;ke("getMetadata",[],arguments);this.throwIfRoot_("getMetadata");return this.authWrapper.getAuthToken().then((function(e){var n=pe(t.authWrapper,t.location,t.mappings());return t.authWrapper.makeRequest(n,e).getPromise()}))};t.prototype.updateMetadata=function(t){var e=this;ke("updateMetadata",[xe()],arguments);this.throwIfRoot_("updateMetadata");return this.authWrapper.getAuthToken().then((function(n){var r=ye(e.authWrapper,e.location,t,e.mappings());return e.authWrapper.makeRequest(r,n).getPromise()}))};t.prototype.getDownloadURL=function(){var t=this;ke("getDownloadURL",[],arguments);this.throwIfRoot_("getDownloadURL");return this.authWrapper.getAuthToken().then((function(e){var n=ve(t.authWrapper,t.location,t.mappings());return t.authWrapper.makeRequest(n,e).getPromise().then((function(t){if(t===null){throw Q()}return t}))}))};t.prototype.throwIfRoot_=function(t){if(this.location.path===""){throw $(t)}};return t}();var Ve=function(){function t(t){this.promise_=Promise.reject(t)}t.prototype.getPromise=function(){return this.promise_};t.prototype.cancel=function(t){};return t}();var Be=function(){function t(){this.map=new Map;this.id=D}t.prototype.addRequest=function(t){var e=this;var n=this.id;this.id++;this.map.set(n,t);t.getPromise().then((function(){return e.map.delete(n)}),(function(){return e.map.delete(n)}))};t.prototype.clear=function(){this.map.forEach((function(t){t&&t.cancel(true)}));this.map.clear()};return t}();var ze=function(){function t(e,n,r,i,o,s){var a;this.bucket_=null;this.appId_=null;this.deleted_=false;this.app_=e;if(this.app_!==null){var u=this.app_.options;if(yt(u)){this.bucket_=t.extractBucket_(u);this.appId_=(a=u.appId)!==null&&a!==void 0?a:null}}this.authProvider_=n;this.storageRefMaker_=r;this.requestMaker_=i;this.pool_=s;this.service_=o;this.maxOperationRetryTime_=R;this.maxUploadRetryTime_=C;this.requestMap_=new Be}t.extractBucket_=function(t){var e=t[k]||null;if(e==null){return null}var n=xt.makeFromBucketSpec(e);return n.bucket};t.prototype.getAuthToken=function(){var t=this.authProvider_.getImmediate({optional:true});if(t){return t.getToken().then((function(t){if(t!==null){return t.accessToken}else{return null}}),(function(){return null}))}else{return Promise.resolve(null)}};t.prototype.bucket=function(){if(this.deleted_){throw X()}else{return this.bucket_}};t.prototype.service=function(){return this.service_};t.prototype.makeStorageReference=function(t){return this.storageRefMaker_(this,t)};t.prototype.makeRequest=function(t,e){if(!this.deleted_){var n=this.requestMaker_(t,this.appId_,e,this.pool_);this.requestMap_.addRequest(n);return n}else{return new Ve(X())}};t.prototype.deleteApp=function(){this.deleted_=true;this.app_=null;this.requestMap_.clear()};t.prototype.maxUploadRetryTime=function(){return this.maxUploadRetryTime_};t.prototype.setMaxUploadRetryTime=function(t){this.maxUploadRetryTime_=t};t.prototype.maxOperationRetryTime=function(){return this.maxOperationRetryTime_};t.prototype.setMaxOperationRetryTime=function(t){this.maxOperationRetryTime_=t};return t}();function He(t,e,n){var r=1;var i=null;var o=false;var s=0;function a(){return s===2}var u=false;function c(){var t=[];for(var n=0;n<arguments.length;n++){t[n]=arguments[n]}if(!u){u=true;e.apply(null,t)}}function h(e){i=setTimeout((function(){i=null;t(f,a())}),e)}function f(t){var e=[];for(var n=1;n<arguments.length;n++){e[n-1]=arguments[n]}if(u){return}if(t){c.call.apply(c,m([null,t],e));return}var i=a()||o;if(i){c.call.apply(c,m([null,t],e));return}if(r<64){r*=2}var f;if(s===1){s=2;f=0}else{f=(r+Math.random())*1e3}h(f)}var l=false;function p(t){if(l){return}l=true;if(u){return}if(i!==null){if(!t){s=2}clearTimeout(i);h(0)}else{if(!t){s=1}}}h(0);setTimeout((function(){o=true;p(true)}),n);return p}function We(t){t(false)}var Ke=function(){function t(t,e,n,r,i,o,s,a,u,c,h){var f=this;this.pendingXhr_=null;this.backoffId_=null;this.resolve_=null;this.reject_=null;this.canceled_=false;this.appDelete_=false;this.url_=t;this.method_=e;this.headers_=n;this.body_=r;this.successCodes_=i.slice();this.additionalRetryCodes_=o.slice();this.callback_=s;this.errorCallback_=a;this.progressCallback_=c;this.timeout_=u;this.pool_=h;this.promise_=new Promise((function(t,e){f.resolve_=t;f.reject_=e;f.start_()}))}t.prototype.start_=function(){var t=this;function e(e,n){if(n){e(false,new Qe(false,null,true));return}var r=t.pool_.createXhrIo();t.pendingXhr_=r;function i(e){var n=e.loaded;var r=e.lengthComputable?e.total:-1;if(t.progressCallback_!==null){t.progressCallback_(n,r)}}if(t.progressCallback_!==null){r.addUploadProgressListener(i)}r.send(t.url_,t.method_,t.body_,t.headers_).then((function(n){if(t.progressCallback_!==null){n.removeUploadProgressListener(i)}t.pendingXhr_=null;n=n;var r=n.getErrorCode()===At.NO_ERROR;var o=n.getStatus();if(!r||t.isRetryStatusCode_(o)){var s=n.getErrorCode()===At.ABORT;e(false,new Qe(false,null,s));return}var a=t.successCodes_.indexOf(o)!==-1;e(true,new Qe(a,n))}))}function n(e,n){var r=t.resolve_;var i=t.reject_;var o=n.xhr;if(n.wasSuccessCode){try{var s=t.callback_(o,o.getResponseText());if(mt(s)){r(s)}else{r()}}catch(u){i(u)}}else{if(o!==null){var a=U();a.setServerResponseProp(o.getResponseText());if(t.errorCallback_){i(t.errorCallback_(o,a))}else{i(a)}}else{if(n.canceled){var a=t.appDelete_?X():V();i(a)}else{var a=G();i(a)}}}}if(this.canceled_){n(false,new Qe(false,null,true))}else{this.backoffId_=He(e,n,this.timeout_)}};t.prototype.getPromise=function(){return this.promise_};t.prototype.cancel=function(t){this.canceled_=true;this.appDelete_=t||false;if(this.backoffId_!==null){We(this.backoffId_)}if(this.pendingXhr_!==null){this.pendingXhr_.abort()}};t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600;var n=[408,429];var r=n.indexOf(t)!==-1;var i=this.additionalRetryCodes_.indexOf(t)!==-1;return e||r||i};return t}();var Qe=function(){function t(t,e,n){this.wasSuccessCode=t;this.xhr=e;this.canceled=!!n}return t}();function Ye(t,e){if(e!==null&&e.length>0){t["Authorization"]="Firebase "+e}}function Je(t){var e=typeof r.default!=="undefined"?r.default.SDK_VERSION:"AppManager";t["X-Firebase-Storage-Version"]="webjs/"+e}function Xe(t,e){if(e){t["X-Firebase-GMPID"]=e}}function $e(t,e,n,r){var i=qt(t.urlParams);var o=t.url+i;var s=Object.assign({},t.headers);Xe(s,e);Ye(s,n);Je(s);return new Ke(o,t.method,s,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r)}var Ze=function(){function t(t,e,n,r){this.bucket_=null;function i(t,e){return new Ge(t,e)}this.authWrapper_=new ze(t,e,i,$e,this,n);this.app_=t;if(r!=null){this.bucket_=xt.makeFromBucketSpec(r)}else{var o=this.authWrapper_.bucket();if(o!=null){this.bucket_=new xt(o,"")}}this.internals_=new tn(this)}t.prototype.ref=function(t){function e(t){if(typeof t!=="string"){throw"Path is not a string."}if(/^[A-Za-z]+:\/\//.test(t)){throw"Expected child path but got a URL, use refFromURL instead."}}ke("ref",[De(e,true)],arguments);if(this.bucket_==null){throw new Error("No Storage Bucket defined in Firebase Options.")}var n=new Ge(this.authWrapper_,this.bucket_);if(t!=null){return n.child(t)}else{return n}};t.prototype.refFromURL=function(t){function e(t){if(typeof t!=="string"){throw"Path is not a string."}if(!/^[A-Za-z]+:\/\//.test(t)){throw"Expected full URL but got a child path, use ref instead."}try{xt.makeFromUrl(t)}catch(e){throw"Expected valid full URL but got an invalid one."}}ke("refFromURL",[De(e,false)],arguments);return new Ge(this.authWrapper_,t)};Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this.authWrapper_.maxUploadRetryTime()},enumerable:true,configurable:true});t.prototype.setMaxUploadRetryTime=function(t){ke("setMaxUploadRetryTime",[Ue()],arguments);this.authWrapper_.setMaxUploadRetryTime(t)};t.prototype.setMaxOperationRetryTime=function(t){ke("setMaxOperationRetryTime",[Ue()],arguments);this.authWrapper_.setMaxOperationRetryTime(t)};Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:true,configurable:true});return t}();var tn=function(){function t(t){this.service_=t}t.prototype.delete=function(){this.service_.authWrapper_.deleteApp();return Promise.resolve()};return t}();var en="@firebase/storage";var nn="0.3.30";var rn="storage";function on(t,e){var n=t.getProvider("app").getImmediate();var r=t.getProvider("auth-internal");return new Ze(n,r,new kt,e)}function sn(t){var e={TaskState:dt,TaskEvent:lt,StringFormat:et,Storage:Ze,Reference:Ge};t.INTERNAL.registerComponent(new A.Component(rn,on,"PUBLIC").setServiceProps(e).setMultipleInstances(true));t.registerVersion(en,nn)}sn(r.default)},49713:(t,e,n)=>{"use strict";n.r(e);n.d(e,{default:()=>Dr,ErrorCode:()=>Or,EventType:()=>kr,WebChannel:()=>Rr,XhrIo:()=>Cr,createWebChannelTransport:()=>Ar});var r=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof n.g!=="undefined"?n.g:typeof self!=="undefined"?self:{};var i,o=o||{},s=r;function a(t){return"string"==typeof t}function u(t){return"number"==typeof t}function c(t,e){t=t.split(".");e=e||s;for(var n=0;n<t.length;n++)if(e=e[t[n]],null==e)return null;return e}function h(){}function f(t){var e=typeof t;if("object"==e)if(t){if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&"undefined"!=typeof t.splice&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof t.call&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==e&&"undefined"==typeof t.call)return"object";return e}function l(t){return"array"==f(t)}function p(t){var e=f(t);return"array"==e||"object"==e&&"number"==typeof t.length}function d(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var v="closure_uid_"+(1e9*Math.random()>>>0),y=0;function m(t,e,n){return t.call.apply(t.bind,arguments)}function g(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(n,r);return t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function w(t,e,n){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?w=m:w=g;return w.apply(null,arguments)}function b(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();e.push.apply(e,arguments);return t.apply(this,e)}}var _=Date.now||function(){return+new Date};function E(t,e){function n(){}n.prototype=e.prototype;t.N=e.prototype;t.prototype=new n;t.prototype.constructor=t;t.yb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function I(){this.j=this.j;this.i=this.i}var T=0;I.prototype.j=!1;I.prototype.la=function(){if(!this.j&&(this.j=!0,this.G(),0!=T)){var t=this[v]||(this[v]=++y)}};I.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var S=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(a(t))return a(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},N=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=a(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function A(t){t:{var e=Hn;for(var n=t.length,r=a(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:a(t)?t.charAt(e):t[e]}function O(t){return Array.prototype.concat.apply([],arguments)}function k(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function R(t){return/^[\s\xa0]*$/.test(t)}var C=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function D(t,e){return-1!=t.indexOf(e)}function P(t,e){return t<e?-1:t>e?1:0}var x;t:{var L=s.navigator;if(L){var U=L.userAgent;if(U){x=U;break t}}x=""}function M(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function j(t){var e={},n;for(n in t)e[n]=t[n];return e}var F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function q(t,e){for(var n,r,i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(var o=0;o<F.length;o++)n=F[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function G(t){G[" "](t);return t}G[" "]=h;function V(t,e){var n=tt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var B=D(x,"Opera"),z=D(x,"Trident")||D(x,"MSIE"),H=D(x,"Edge"),W=H||z,K=D(x,"Gecko")&&!(D(x.toLowerCase(),"webkit")&&!D(x,"Edge"))&&!(D(x,"Trident")||D(x,"MSIE"))&&!D(x,"Edge"),Q=D(x.toLowerCase(),"webkit")&&!D(x,"Edge");function Y(){var t=s.document;return t?t.documentMode:void 0}var J;t:{var X="",$=function(){var t=x;if(K)return/rv:([^\);]+)(\)|;)/.exec(t);if(H)return/Edge\/([\d\.]+)/.exec(t);if(z)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(Q)return/WebKit\/(\S+)/.exec(t);if(B)return/(?:Version)[ \/]?(\S+)/.exec(t)}();$&&(X=$?$[1]:"");if(z){var Z=Y();if(null!=Z&&Z>parseFloat(X)){J=String(Z);break t}}J=X}var tt={};function et(t){return V(t,(function(){for(var e=0,n=C(String(J)).split("."),r=C(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""];a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""];if(0==s[0].length&&0==a[0].length)break;e=P(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||P(0==s[2].length,0==a[2].length)||P(s[2],a[2]);s=s[3];a=a[3]}while(0==e)}return 0<=e}))}var nt;var rt=s.document;nt=rt&&z?Y()||("CSS1Compat"==rt.compatMode?parseInt(J,10):5):void 0;var it=!z||9<=Number(nt),ot=z&&!et("9"),st=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{s.addEventListener("test",h,e),s.removeEventListener("test",h,e)}catch(n){}return t}();function at(t,e){this.type=t;this.a=this.target=e;this.Ia=!0}at.prototype.b=function(){this.Ia=!1};function ut(t,e){at.call(this,t?t.type:"");this.relatedTarget=this.a=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.pointerId=0;this.pointerType="";this.c=null;if(t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;this.target=t.target||t.srcElement;this.a=e;if(e=t.relatedTarget){if(K){t:{try{G(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e;r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0);this.button=t.button;this.key=t.key||"";this.ctrlKey=t.ctrlKey;this.altKey=t.altKey;this.shiftKey=t.shiftKey;this.metaKey=t.metaKey;this.pointerId=t.pointerId||0;this.pointerType=a(t.pointerType)?t.pointerType:ct[t.pointerType]||"";this.c=t;t.defaultPrevented&&this.b()}}E(ut,at);var ct={2:"touch",3:"pen",4:"mouse"};ut.prototype.b=function(){ut.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,ot)try{if(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)t.keyCode=-1}catch(e){}};var ht="closure_listenable_"+(1e6*Math.random()|0),ft=0;function lt(t,e,n,r,i){this.listener=t;this.proxy=null;this.src=e;this.type=n;this.capture=!!r;this.da=i;this.key=++ft;this.X=this.Z=!1}function pt(t){t.X=!0;t.listener=null;t.proxy=null;t.src=null;t.da=null}function dt(t){this.src=t;this.a={};this.b=0}dt.prototype.add=function(t,e,n,r,i){var o=t.toString();t=this.a[o];t||(t=this.a[o]=[],this.b++);var s=yt(t,e,r,i);-1<s?(e=t[s],n||(e.Z=!1)):(e=new lt(e,this.src,o,!!r,i),e.Z=n,t.push(e));return e};function vt(t,e){var n=e.type;if(n in t.a){var r=t.a[n],i=S(r,e),o;(o=0<=i)&&Array.prototype.splice.call(r,i,1);o&&(pt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function yt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}var mt="closure_lm_"+(1e6*Math.random()|0),gt={};function wt(t,e,n,r,i){if(r&&r.once)return Et(t,e,n,r,i);if(l(e)){for(var o=0;o<e.length;o++)wt(t,e[o],n,r,i);return null}n=Rt(n);return t&&t[ht]?t.za(e,n,d(r)?!!r.capture:!!r,i):bt(t,e,n,!1,r,i)}function bt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=d(i)?!!i.capture:!!i;if(s&&!it)return null;var a=Ot(t);a||(t[mt]=a=new dt(t));n=a.add(e,n,r,s,o);if(n.proxy)return n;r=_t();n.proxy=r;r.src=t;r.listener=n;if(t.addEventListener)st||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(St(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function _t(){var t=At,e=it?function(n){return t.call(e.src,e.listener,n)}:function(n){n=t.call(e.src,e.listener,n);if(!n)return n};return e}function Et(t,e,n,r,i){if(l(e)){for(var o=0;o<e.length;o++)Et(t,e[o],n,r,i);return null}n=Rt(n);return t&&t[ht]?t.Aa(e,n,d(r)?!!r.capture:!!r,i):bt(t,e,n,!0,r,i)}function It(t,e,n,r,i){if(l(e))for(var o=0;o<e.length;o++)It(t,e[o],n,r,i);else(r=d(r)?!!r.capture:!!r,n=Rt(n),t&&t[ht])?(t=t.c,e=String(e).toString(),e in t.a&&(o=t.a[e],n=yt(o,n,r,i),-1<n&&(pt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=Ot(t))&&(e=t.a[e.toString()],t=-1,e&&(t=yt(e,n,r,i)),(n=-1<t?e[t]:null)&&Tt(n))}function Tt(t){if(!u(t)&&t&&!t.X){var e=t.src;if(e&&e[ht])vt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(St(n),r):e.addListener&&e.removeListener&&e.removeListener(r);(n=Ot(e))?(vt(n,t),0==n.b&&(n.src=null,e[mt]=null)):pt(t)}}}function St(t){return t in gt?gt[t]:gt[t]="on"+t}function Nt(t,e){var n=t.listener,r=t.da||t.src;t.Z&&Tt(t);return n.call(r,e)}function At(t,e){return t.X?!0:it?Nt(t,new ut(e,this)):(e=new ut(e||c("window.event"),this),Nt(t,e))}function Ot(t){t=t[mt];return t instanceof dt?t:null}var kt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Rt(t){if("function"==f(t))return t;t[kt]||(t[kt]=function(e){return t.handleEvent(e)});return t[kt]}function Ct(){I.call(this);this.c=new dt(this);this.J=this;this.B=null}E(Ct,I);Ct.prototype[ht]=!0;i=Ct.prototype;i.addEventListener=function(t,e,n,r){wt(this,t,e,n,r)};i.removeEventListener=function(t,e,n,r){It(this,t,e,n,r)};i.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var r=t.type||t;if(a(t))t=new at(t,n);else if(t instanceof at)t.target=t.target||n;else{var i=t;t=new at(r,n);q(t,i)}i=!0;if(e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=Dt(s,r,!0,t)&&i}s=t.a=n;i=Dt(s,r,!0,t)&&i;i=Dt(s,r,!1,t)&&i;if(e)for(o=0;o<e.length;o++)s=t.a=e[o],i=Dt(s,r,!1,t)&&i;return i};i.G=function(){Ct.N.G.call(this);if(this.c){var t=this.c,e;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)pt(n[r]);delete t.a[e];t.b--}}this.B=null};i.za=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)};i.Aa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};function Dt(t,e,n,r){e=t.c.a[String(e)];if(!e)return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.X&&s.capture==n){var a=s.listener,u=s.da||s.src;s.Z&&vt(t.c,s);i=!1!==a.call(u,r)&&i}}return i&&0!=r.Ia}var Pt=s.JSON.stringify;function xt(t,e){this.c=t;this.f=e;this.b=0;this.a=null}xt.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next;t.next=null}else t=this.c();return t};function Lt(){this.b=this.a=null}var Ut=new xt((function(){return new jt}),(function(t){t.reset()}));Lt.prototype.add=function(t,e){var n=Ut.get();n.set(t,e);this.b?this.b.next=n:this.a=n;this.b=n};function Mt(){var t=zt,e=null;t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null);return e}function jt(){this.next=this.b=this.a=null}jt.prototype.set=function(t,e){this.a=t;this.b=e;this.next=null};jt.prototype.reset=function(){this.next=this.b=this.a=null};function Ft(t){s.setTimeout((function(){throw t}),0)}function qt(t,e){Gt||Vt();Bt||(Gt(),Bt=!0);zt.add(t,e)}var Gt;function Vt(){var t=s.Promise.resolve(void 0);Gt=function(){t.then(Ht)}}var Bt=!1,zt=new Lt;function Ht(){for(var t;t=Mt();){try{t.a.call(t.b)}catch(n){Ft(n)}var e=Ut;e.f(t);100>e.b&&(e.b++,t.next=e.a,e.a=t)}Bt=!1}function Wt(t,e){Ct.call(this);this.b=t||1;this.a=e||s;this.f=w(this.gb,this);this.g=_()}E(Wt,Ct);i=Wt.prototype;i.ba=!1;i.L=null;i.gb=function(){if(this.ba){var t=_()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(Kt(this),this.start()))}};i.start=function(){this.ba=!0;this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=_())};function Kt(t){t.ba=!1;t.L&&(t.a.clearTimeout(t.L),t.L=null)}i.G=function(){Wt.N.G.call(this);Kt(this);delete this.a};function Qt(t,e,n){if("function"==f(t))n&&(t=w(t,n));else if(t&&"function"==typeof t.handleEvent)t=w(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:s.setTimeout(t,e||0)}function Yt(t,e,n){I.call(this);this.f=null!=n?w(t,n):t;this.c=e;this.b=w(this.$a,this);this.a=[]}E(Yt,I);i=Yt.prototype;i.ea=!1;i.U=null;i.Ta=function(t){this.a=arguments;this.U?this.ea=!0:Jt(this)};i.G=function(){Yt.N.G.call(this);this.U&&(s.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])};i.$a=function(){this.U=null;this.ea&&(this.ea=!1,Jt(this))};function Jt(t){t.U=Qt(t.b,t.c);t.f.apply(null,t.a)}function Xt(t){I.call(this);this.b=t;this.a={}}E(Xt,I);var $t=[];function Zt(t,e,n,r){l(n)||(n&&($t[0]=n.toString()),n=$t);for(var i=0;i<n.length;i++){var o=wt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function te(t){M(t.a,(function(t,e){this.a.hasOwnProperty(e)&&Tt(t)}),t);t.a={}}Xt.prototype.G=function(){Xt.N.G.call(this);te(this)};Xt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function ee(){}var ne=new Ct;function re(t){at.call(this,"serverreachability",t)}E(re,at);function ie(t){ne.dispatchEvent(new re(ne,t))}function oe(t){at.call(this,"statevent",t)}E(oe,at);function se(t){ne.dispatchEvent(new oe(ne,t))}function ae(t){at.call(this,"timingevent",t)}E(ae,at);function ue(t,e){if("function"!=f(t))throw Error("Fn must not be null and must be a function");return s.setTimeout((function(){t()}),e)}var ce={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,La:7,TIMEOUT:8,sb:9};var he={jb:"complete",wb:"success",Ma:"error",La:"abort",ub:"ready",vb:"readystatechange",TIMEOUT:"timeout",qb:"incrementaldata",tb:"progress",lb:"downloadprogress",xb:"uploadprogress"};function fe(){}fe.prototype.a=null;function le(t){var e;(e=t.a)||(e=t.a={});return e}function pe(){}var de={OPEN:"a",ib:"b",Ma:"c",rb:"d"};function ve(){at.call(this,"d")}E(ve,at);function ye(){at.call(this,"c")}E(ye,at);var me;function ge(){}E(ge,fe);me=new ge;function we(t,e,n){this.g=t;this.W=e;this.V=n||1;this.I=new Xt(this);this.O=be;t=W?125:void 0;this.P=new Wt(t);this.h=null;this.b=!1;this.l=this.D=this.f=this.F=this.v=this.R=this.i=null;this.j=[];this.a=null;this.A=0;this.c=this.w=null;this.o=-1;this.m=!1;this.J=0;this.B=null;this.s=this.S=this.H=!1}var be=45e3,_e={},Ee={};i=we.prototype;i.setTimeout=function(t){this.O=t};function Ie(t,e,n){t.F=1;t.f=Xe(ze(e));t.l=n;t.H=!0;Se(t,null)}function Te(t,e,n,r){t.F=1;t.f=Xe(ze(e));t.l=null;t.H=n;Se(t,r)}function Se(t,e){t.v=_();Oe(t);t.D=ze(t.f);Je(t.D,"t",t.V);t.A=0;t.a=t.g.$(t.g.Y()?e:null);0<t.J&&(t.B=new Yt(w(t.Ja,t,t.a),t.J));Zt(t.I,t.a,"readystatechange",t.cb);e=t.h?j(t.h):{};t.l?(t.w||(t.w="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,e)):(t.w="GET",t.a.ca(t.D,t.w,null,e));ie(1)}i.cb=function(t){t=t.target;var e=this.B;e&&3==Xn(t)?e.Ta():this.Ja(t)};i.Ja=function(t){try{if(t==this.a)t:{var e=Xn(this.a),n=this.a.ya(),r=this.a.T();if(!(3>e||3==e&&!W&&!this.a.aa())){this.m||4!=e||7==n||(8==n||0>=r?ie(3):ie(2));Re(this);var i=this.a.T();this.o=i;var o=this.a.aa();if(this.b=200==i){if(this.S&&!this.s){e:{if(this.a){var s=$n(this.a,"X-HTTP-Initial-Response");if(s&&!R(s)){var a=s;break e}}a=null}if(a)this.s=!0,Pe(this,a);else{this.b=!1;this.c=3;se(12);De(this);Ce(this);break t}}this.H?(Ne(this,e,o),W&&this.b&&3==e&&(Zt(this.I,this.P,"tick",this.bb),this.P.start())):Pe(this,o);4==e&&De(this);this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,Oe(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,se(12)):(this.c=0,se(13)),De(this),Ce(this)}}}catch(u){}finally{}};function Ne(t,e,n){for(var r=!0;!t.m&&t.A<n.length;){var i=Ae(t,n);if(i==Ee){4==e&&(t.c=4,se(14),r=!1);break}else if(i==_e){t.c=4;se(15);r=!1;break}else Pe(t,i)}4==e&&0==n.length&&(t.c=1,se(16),r=!1);t.b=t.b&&r;r||(De(t),Ce(t))}i.bb=function(){if(this.a){var t=Xn(this.a),e=this.a.aa();this.A<e.length&&(Re(this),Ne(this,t,e),this.b&&4!=t&&Oe(this))}};function Ae(t,e){var n=t.A,r=e.indexOf("\n",n);if(-1==r)return Ee;n=Number(e.substring(n,r));if(isNaN(n))return _e;r+=1;if(r+n>e.length)return Ee;e=e.substr(r,n);t.A=r+n;return e}i.cancel=function(){this.m=!0;De(this)};function Oe(t){t.R=_()+t.O;ke(t,t.O)}function ke(t,e){if(null!=t.i)throw Error("WatchDog timer not null");t.i=ue(w(t.ab,t),e)}function Re(t){t.i&&(s.clearTimeout(t.i),t.i=null)}i.ab=function(){this.i=null;var t=_();0<=t-this.R?(2!=this.F&&(ie(3),se(17)),De(this),this.c=2,Ce(this)):ke(this,this.R-t)};function Ce(t){t.g.Ca()||t.m||t.g.na(t)}function De(t){Re(t);var e=t.B;e&&"function"==typeof e.la&&e.la();t.B=null;Kt(t.P);te(t.I);t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function Pe(t,e){try{t.g.Fa(t,e),ie(4)}catch(n){}}function xe(t){if(t.C&&"function"==typeof t.C)return t.C();if(a(t))return t.split("");if(p(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[];n=0;for(r in t)e[n++]=t[r];return e}function Le(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(p(t)||a(t))N(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(p(t)||a(t)){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;r=xe(t);i=r.length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ue(t,e){this.b={};this.a=[];this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ue)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}i=Ue.prototype;i.C=function(){Fe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t};i.K=function(){Fe(this);return this.a.concat()};function Me(t){t.b={};t.a.length=0;t.c=0}function je(t,e){qe(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Fe(t))}function Fe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];qe(t.b,r)&&(t.a[n++]=r);e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)r=t.a[e],qe(i,r)||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}i.get=function(t,e){return qe(this.b,t)?this.b[t]:e};i.set=function(t,e){qe(this.b,t)||(this.c++,this.a.push(t));this.b[t]=e};i.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};function qe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Ge=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ve(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Be(t,e){this.b=this.j=this.f="";this.i=null;this.g=this.a="";this.h=!1;var n;t instanceof Be?(this.h=void 0!==e?e:t.h,He(this,t.f),this.j=t.j,We(this,t.b),Ke(this,t.i),this.a=t.a,Qe(this,dn(t.c)),this.g=t.g):t&&(n=String(t).match(Ge))?(this.h=!!e,He(this,n[1]||"",!0),this.j=tn(n[2]||""),We(this,n[3]||"",!0),Ke(this,n[4]),this.a=tn(n[5]||"",!0),Qe(this,n[6]||"",!0),this.g=tn(n[7]||"")):(this.h=!!e,this.c=new cn(null,this.h))}Be.prototype.toString=function(){var t=[],e=this.f;e&&t.push(en(e,rn,!0),":");var n=this.b;if(n||"file"==e)t.push("//"),(e=this.j)&&t.push(en(e,rn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.i,null!=n&&t.push(":",String(n));if(n=this.a)this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(en(n,"/"==n.charAt(0)?sn:on,!0));(n=this.c.toString())&&t.push("?",n);(n=this.g)&&t.push("#",en(n,un));return t.join("")};Be.prototype.resolve=function(t){var e=ze(this),n=!!t.f;n?He(e,t.f):n=!!t.j;n?e.j=t.j:n=!!t.b;n?We(e,t.b):n=null!=t.i;var r=t.a;if(n)Ke(e,t.i);else if(n=!!t.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=e.a.lastIndexOf("/");-1!=i&&(r=e.a.substr(0,i+1)+r)}i=r;if(".."==i||"."==i)r="";else if(D(i,"./")||D(i,"/.")){r=0==i.lastIndexOf("/",0);i=i.split("/");for(var o=[],s=0;s<i.length;){var a=i[s++];"."==a?r&&s==i.length&&o.push(""):".."==a?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&s==i.length&&o.push("")):(o.push(a),r=!0)}r=o.join("/")}else r=i}n?e.a=r:n=""!==t.c.toString();n?Qe(e,dn(t.c)):n=!!t.g;n&&(e.g=t.g);return e};function ze(t){return new Be(t)}function He(t,e,n){t.f=n?tn(e,!0):e;t.f&&(t.f=t.f.replace(/:$/,""))}function We(t,e,n){t.b=n?tn(e,!0):e}function Ke(t,e){if(e){e=Number(e);if(isNaN(e)||0>e)throw Error("Bad port number "+e);t.i=e}else t.i=null}function Qe(t,e,n){e instanceof cn?(t.c=e,yn(t.c,t.h)):(n||(e=en(e,an)),t.c=new cn(e,t.h))}function Ye(t,e,n){t.c.set(e,n)}function Je(t,e,n){l(n)||(n=[String(n)]);pn(t.c,e,n)}function Xe(t){Ye(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^_()).toString(36));return t}function $e(t){return t instanceof Be?ze(t):new Be(t,void 0)}function Ze(t,e,n,r){var i=new Be(null,void 0);t&&He(i,t);e&&We(i,e);n&&Ke(i,n);r&&(i.a=r);return i}function tn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function en(t,e,n){return a(t)?(t=encodeURI(t).replace(e,nn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function nn(t){t=t.charCodeAt(0);return"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var rn=/[#\/\?@]/g,on=/[#\?:]/g,sn=/[#\?]/g,an=/[#\?@]/g,un=/#/g;function cn(t,e){this.b=this.a=null;this.c=t||null;this.f=!!e}function hn(t){t.a||(t.a=new Ue,t.b=0,t.c&&Ve(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}i=cn.prototype;i.add=function(t,e){hn(this);this.c=null;t=vn(this,t);var n=this.a.get(t);n||this.a.set(t,n=[]);n.push(e);this.b+=1;return this};function fn(t,e){hn(t);e=vn(t,e);qe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,je(t.a,e))}function ln(t,e){hn(t);e=vn(t,e);return qe(t.a.b,e)}i.forEach=function(t,e){hn(this);this.a.forEach((function(n,r){N(n,(function(n){t.call(e,n,r,this)}),this)}),this)};i.K=function(){hn(this);for(var t=this.a.C(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n};i.C=function(t){hn(this);var e=[];if(a(t))ln(this,t)&&(e=O(e,this.a.get(vn(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=O(e,t[n])}return e};i.set=function(t,e){hn(this);this.c=null;t=vn(this,t);ln(this,t)&&(this.b-=this.a.get(t).length);this.a.set(t,[e]);this.b+=1;return this};i.get=function(t,e){if(!t)return e;t=this.C(t);return 0<t.length?String(t[0]):e};function pn(t,e,n){fn(t,e);0<n.length&&(t.c=null,t.a.set(vn(t,e),k(n)),t.b+=n.length)}i.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.C(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o])));t.push(s)}}return this.c=t.join("&")};function dn(t){var e=new cn;e.c=t.c;t.a&&(e.a=new Ue(t.a),e.b=t.b);return e}function vn(t,e){e=String(e);t.f&&(e=e.toLowerCase());return e}function yn(t,e){e&&!t.f&&(hn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(fn(this,e),pn(this,n,t))}),t));t.f=e}function mn(){}function gn(){}E(gn,mn);function wn(t){this.a=t;this.b=this.h=null;this.g=!1;this.i=null;this.c=-1;this.l=this.f=null}i=wn.prototype;i.M=null;function bn(t){var e=t.a.F.a;if(null!=e)se(4),e?(se(10),lr(t.a,t,!1)):(se(11),lr(t.a,t,!0));else{t.b=new we(t,void 0,void 0);t.b.h=t.h;e=t.a;e=mr(e,e.Y()?t.f:null,t.i);se(4);Je(e,"TYPE","xmlhttp");var n=t.a.j,r=t.a.I;n&&r&&Ye(e,n,r);Te(t.b,e,!1,t.f)}}i.$=function(t){return this.a.$(t)};i.abort=function(){this.b&&(this.b.cancel(),this.b=null);this.c=-1};i.Ca=function(){return!1};i.Fa=function(t,e){this.c=t.o;if(0==this.M){if(!this.a.o&&(t=t.a)){var n=$n(t,"X-Client-Wire-Protocol");this.l=n?n:null;this.a.j&&(t=$n(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(e){try{var r=this.a.ja.a.parse(e)}catch(i){e=this.a;e.m=this.c;vr(e,2);return}this.f=r[0]}else e=this.a,e.m=this.c,vr(e,2)}else if(1==this.M)if(this.g)se(6);else if("11111"==e){if(se(5),this.g=!0,!z||10<=Number(nt))this.c=200,this.b.cancel(),se(11),lr(this.a,this,!0)}else se(7),this.g=!1};i.na=function(){this.c=this.b.o;if(this.b.b)0==this.M?(this.M=1,bn(this)):1==this.M&&(this.g?(se(11),lr(this.a,this,!0)):(se(10),lr(this.a,this,!1)));else{0==this.M?se(8):1==this.M&&se(9);var t=this.a;t.m=this.c;vr(t,2)}};i.Y=function(){return this.a.Y()};i.ma=function(){return this.a.ma()};function _n(){this.a=this.b=null}function En(){this.a=new Ue}function In(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[v]||(t[v]=++y)):e.charAt(0)+t}En.prototype.add=function(t){this.a.set(In(t),t)};En.prototype.C=function(){return this.a.C()};function Tn(t,e){this.b=t;this.a=e}function Sn(t){this.g=t||Nn;s.PerformanceNavigationTiming?(t=s.performance.getEntriesByType("navigation"),t=0<t.length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol)):t=!!(s.ka&&s.ka.Da&&s.ka.Da()&&s.ka.Da().zb);this.f=t?this.g:1;this.a=null;1<this.f&&(this.a=new En);this.b=null;this.c=[]}var Nn=10;function An(t,e){!t.a&&(D(e,"spdy")||D(e,"quic")||D(e,"h2"))&&(t.f=t.g,t.a=new En,t.b&&(Cn(t,t.b),t.b=null))}function On(t){return t.b?!0:t.a?t.a.a.c>=t.f:!1}function kn(t){return t.b?1:t.a?t.a.a.c:0}function Rn(t,e){t.b?t=t.b==e:t.a?(e=In(e),t=qe(t.a.a.b,e)):t=!1;return t}function Cn(t,e){t.a?t.a.add(e):t.b=e}function Dn(t,e){if(t.b&&t.b==e)t.b=null;else{var n;if(n=t.a)n=In(e),n=qe(t.a.a.b,n);n&&je(t.a.a,In(e))}}Sn.prototype.cancel=function(){this.c=Pn(this);this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(N(this.a.C(),(function(t){t.cancel()})),Me(this.a.a))};function Pn(t){if(null!=t.b)return t.c.concat(t.b.j);if(null!=t.a&&0!=t.a.a.c){var e=t.c;N(t.a.C(),(function(t){e=e.concat(t.j)}));return e}return k(t.c)}function xn(){}xn.prototype.stringify=function(t){return s.JSON.stringify(t,void 0)};xn.prototype.parse=function(t){return s.JSON.parse(t,void 0)};function Ln(){this.a=new xn}function Un(t,e,n){var r=n||"";try{Le(t,(function(t,n){var i=t;d(t)&&(i=Pt(t));e.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Mn(t,e){var n=new ee;if(s.Image){var r=new Image;r.onload=b(jn,n,r,"TestLoadImage: loaded",!0,e);r.onerror=b(jn,n,r,"TestLoadImage: error",!1,e);r.onabort=b(jn,n,r,"TestLoadImage: abort",!1,e);r.ontimeout=b(jn,n,r,"TestLoadImage: timeout",!1,e);s.setTimeout((function(){if(r.ontimeout)r.ontimeout()}),1e4);r.src=t}else e(!1)}function jn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}var Fn=s.JSON.parse;function qn(t){Ct.call(this);this.headers=new Ue;this.H=t||null;this.b=!1;this.s=this.a=null;this.A="";this.h=0;this.f="";this.g=this.w=this.l=this.v=!1;this.o=0;this.m=null;this.I=Gn;this.D=this.F=!1}E(qn,Ct);var Gn="",Vn=/^https?$/i,Bn=["POST","PUT"];i=qn.prototype;i.ca=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);e=e?e.toUpperCase():"GET";this.A=t;this.f="";this.h=0;this.v=!1;this.b=!0;this.a=new XMLHttpRequest;this.s=this.H?le(this.H):le(me);this.a.onreadystatechange=w(this.Ea,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(o){Wn(this,o);return}t=n||"";var i=new Ue(this.headers);r&&Le(r,(function(t,e){i.set(e,t)}));r=A(i.K());n=s.FormData&&t instanceof s.FormData;!(0<=S(Bn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this);this.I&&(this.a.responseType=this.I);"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Jn(this),0<this.o&&((this.D=zn(this.a))?(this.a.timeout=this.o,this.a.ontimeout=w(this.Ba,this)):this.m=Qt(this.Ba,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){Wn(this,o)}};function zn(t){return z&&et(9)&&u(t.timeout)&&void 0!==t.ontimeout}function Hn(t){return"content-type"==t.toLowerCase()}i.Ba=function(){"undefined"!=typeof o&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))};function Wn(t,e){t.b=!1;t.a&&(t.g=!0,t.a.abort(),t.g=!1);t.f=e;t.h=5;Kn(t);Yn(t)}function Kn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}i.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Yn(this))};i.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Yn(this,!0));qn.N.G.call(this)};i.Ea=function(){this.j||(this.w||this.l||this.g?Qn(this):this.Za())};i.Za=function(){Qn(this)};function Qn(t){if(t.b&&"undefined"!=typeof o&&(!t.s[1]||4!=Xn(t)||2!=t.T()))if(t.l&&4==Xn(t))Qt(t.Ea,0,t);else if(t.dispatchEvent("readystatechange"),4==Xn(t)){t.b=!1;try{var e=t.T();t:switch(e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var n=!0;break t;default:n=!1}var r;if(!(r=n)){var i;if(i=0===e){var a=String(t.A).match(Ge)[1]||null;if(!a&&s.self&&s.self.location){var u=s.self.location.protocol;a=u.substr(0,u.length-1)}i=!Vn.test(a?a.toLowerCase():"")}r=i}if(r)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var c=2<Xn(t)?t.a.statusText:""}catch(h){c=""}t.f=c+" ["+t.T()+"]";Kn(t)}}finally{Yn(t)}}}function Yn(t,e){if(t.a){Jn(t);var n=t.a,r=t.s[0]?h:null;t.a=null;t.s=null;e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){}}}function Jn(t){t.a&&t.D&&(t.a.ontimeout=null);t.m&&(s.clearTimeout(t.m),t.m=null)}function Xn(t){return t.a?t.a.readyState:0}i.T=function(){try{return 2<Xn(this)?this.a.status:-1}catch(t){return-1}};i.aa=function(){try{return this.a?this.a.responseText:""}catch(t){return""}};i.Ua=function(t){if(this.a){var e=this.a.responseText;t&&0==e.indexOf(t)&&(e=e.substring(t.length));return Fn(e)}};function $n(t,e){return t.a?t.a.getResponseHeader(e):null}i.ya=function(){return this.h};i.Xa=function(){return a(this.f)?this.f:String(this.f)};function Zn(t){var e="";M(t,(function(t,n){e+=n;e+=":";e+=t;e+="\r\n"}));return e}function tr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;n=Zn(n);if(a(t)){e=encodeURIComponent(String(e));n=null!=n?"="+encodeURIComponent(String(n)):"";if(e+=n){n=t.indexOf("#");0>n&&(n=t.length);r=t.indexOf("?");if(0>r||r>n){r=n;var i=""}else i=t.substring(r+1,n);t=[t.substr(0,r),i,t.substr(n)];n=t[1];t[1]=e?n?n+"&"+e:e:n;t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}Ye(t,e,n);return t}function er(t){this.f=[];this.F=new _n;this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null;this.Qa=this.P=0;this.Oa=!!c("internalChannelParams.failFast",t);this.ia=this.w=this.s=this.l=this.h=this.c=null;this.oa=!0;this.m=this.ra=this.O=-1;this.S=this.v=this.A=0;this.Na=c("internalChannelParams.baseRetryDelayMs",t)||5e3;this.Ra=c("internalChannelParams.retryDelaySeedMs",t)||1e4;this.Pa=c("internalChannelParams.forwardChannelMaxRetries",t)||2;this.qa=c("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4;this.Ka=t&&t.Ab||void 0;this.D=void 0;this.R=t&&t.supportsCrossDomainXhr||!1;this.H="";this.b=new Sn(t&&t.concurrentRequestLimit);this.ja=new Ln;this.o=t&&void 0!==t.backgroundChannelTest?t.backgroundChannelTest:!0;(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0);t&&t.forceLongPolling&&(this.oa=!1);this.fa=void 0}i=er.prototype;i.wa=8;i.u=1;function nr(t){rr(t);if(3==t.u){var e=t.P++,n=ze(t.B);Ye(n,"SID",t.H);Ye(n,"RID",e);Ye(n,"TYPE","terminate");ur(t,n);e=new we(t,e,void 0);e.F=2;e.f=Xe(ze(n));n=!1;s.navigator&&s.navigator.sendBeacon&&(n=s.navigator.sendBeacon(e.f.toString(),""));!n&&s.Image&&((new Image).src=e.f,n=!0);n||(e.a=e.g.$(null),e.a.ca(e.f));e.v=_();Oe(e)}yr(t)}function rr(t){t.w&&(t.w.abort(),t.w=null);t.a&&(t.a.cancel(),t.a=null);t.l&&(s.clearTimeout(t.l),t.l=null);pr(t);t.b.cancel();t.h&&(u(t.h)&&s.clearTimeout(t.h),t.h=null)}function ir(t,e){t.f.push(new Tn(t.Qa++,e));3==t.u&&or(t)}i.Ca=function(){return 0==this.u};function or(t){On(t.b)||t.h||(t.h=!0,qt(t.Ha,t),t.A=0)}function sr(t,e){if(kn(t.b)>=t.b.f-(t.h?1:0))return!1;if(t.h)return t.f=e.j.concat(t.f),!0;if(1==t.u||2==t.u||t.A>=(t.Oa?0:t.Pa))return!1;t.h=ue(w(t.Ha,t,e),dr(t,t.A));t.A++;return!0}i.Ha=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random());t=this.P++;var e=new we(this,t,void 0),n=this.i;this.J&&(n?(n=j(n),q(n,this.J)):n=this.J);null===this.g&&(e.h=n);var r;if(this.W)t:{for(var i=r=0;i<this.f.length;i++){e:{var o=this.f[i];if("__data__"in o.a&&(o=o.a.__data__,a(o))){o=o.length;break e}o=void 0}if(void 0===o)break;r+=o;if(4096<r){r=i;break t}if(4096===r||i===this.f.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=cr(this,e,r);i=ze(this.B);Ye(i,"RID",t);Ye(i,"CVER",22);this.o&&this.j&&Ye(i,"X-HTTP-Session-Id",this.j);ur(this,i);this.g&&n&&tr(i,this.g,n);Cn(this.b,e);this.W?(Ye(i,"$req",r),Ye(i,"SID","null"),e.S=!0,Ie(e,i,null)):Ie(e,i,r);this.u=2}}else 3==this.u&&(t?ar(this,t):0==this.f.length||On(this.b)||ar(this))};function ar(t,e){var n;e?n=e.W:n=t.P++;var r=ze(t.B);Ye(r,"SID",t.H);Ye(r,"RID",n);Ye(r,"AID",t.O);ur(t,r);t.g&&t.i&&tr(r,t.g,t.i);n=new we(t,n,t.A+1);null===t.g&&(n.h=t.i);e&&(t.f=e.j.concat(t.f));e=cr(t,n,1e3);n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random()));Cn(t.b,n);Ie(n,r,e)}function ur(t,e){t.c&&Le({},(function(t,n){Ye(e,n,t)}))}function cr(t,e,n){n=Math.min(t.f.length,n);var r=t.c?w(t.c.Sa,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;c-=o;if(0>c)o=Math.max(0,i[u].b-100),a=!1;else try{Un(h,s,"req"+c+"_")}catch(f){r&&r(h)}}if(a){r=s.join("&");break t}}t=t.f.splice(0,n);e.j=t;return r}function hr(t){t.a||t.l||(t.S=1,qt(t.Ga,t),t.v=0)}function fr(t){if(t.a||t.l||3<=t.v)return!1;t.S++;t.l=ue(w(t.Ga,t),dr(t,t.v));t.v++;return!0}i.Ga=function(){this.l=null;this.a=new we(this,"rpc",this.S);null===this.g&&(this.a.h=this.i);this.a.J=0;var t=ze(this.pa);Ye(t,"RID","rpc");Ye(t,"SID",this.H);Ye(t,"CI",this.ia?"0":"1");Ye(t,"AID",this.O);ur(this,t);Ye(t,"TYPE","xmlhttp");this.g&&this.i&&tr(t,this.g,this.i);this.D&&this.a.setTimeout(this.D);Te(this.a,t,!0,this.ga)};function lr(t,e,n){var r=e.l;r&&An(t.b,r);t.ia=t.oa&&n;t.m=e.c;t.B=mr(t,null,t.ha);or(t)}i.Fa=function(t,e){if(0!=this.u&&(this.a==t||Rn(this.b,t)))if(this.m=t.o,!t.s&&Rn(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(o){n=null}if(l(n)&&3==n.length){e=n;if(0==e[0])t:{if(!this.l){if(this.a)if(this.a.v+3e3<t.v)pr(this),this.a.cancel(),this.a=null;else break t;fr(this);se(18)}}else this.ra=e[1],0<this.ra-this.O&&37500>e[2]&&this.ia&&0==this.v&&!this.s&&(this.s=ue(w(this.Ya,this),6e3));if(1>=kn(this.b)&&this.fa){try{this.fa()}catch(o){}this.fa=void 0}}else vr(this,11)}else if((t.s||this.a==t)&&pr(this),!R(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var r=e[n];this.O=r[0];r=r[1];if(2==this.u)if("c"==r[0]){this.H=r[1];this.ga=r[2];var i=r[3];null!=i&&(this.wa=i);r=r[5];null!=r&&u(r)&&0<r&&(this.D=1.5*r);this.o&&(r=t.a)&&((i=$n(r,"X-Client-Wire-Protocol"))&&An(this.b,i),this.j&&(r=$n(r,"X-HTTP-Session-Id")))&&(this.I=r,Ye(this.B,this.j,r));this.u=3;this.c&&this.c.va();r=t;this.pa=mr(this,this.Y()?this.ga:null,this.ha);r.s?(Dn(this.b,r),(i=this.D)&&r.setTimeout(i),r.i&&(Re(r),Oe(r)),this.a=r):hr(this);0<this.f.length&&or(this)}else"stop"!=r[0]&&"close"!=r[0]||vr(this,7);else 3==this.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?vr(this,7):nr(this):"noop"!=r[0]&&this.c&&this.c.ua(r),this.v=0)}};i.Ya=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,fr(this),se(19))};function pr(t){null!=t.s&&(s.clearTimeout(t.s),t.s=null)}i.na=function(t){var e=null;if(this.a==t){pr(this);this.a=null;var n=2}else if(Rn(this.b,t))e=t.j,Dn(this.b,t),n=1;else return;this.m=t.o;if(0!=this.u)if(t.b)1==n?(e=_()-t.v,ne.dispatchEvent(new ae(ne,t.l?t.l.length:0,e,this.A)),or(this)):hr(this);else{var r=t.c;if(3==r||0==r&&0<this.m||!(1==n&&sr(this,t)||2==n&&fr(this)))switch(e&&0<e.length&&(t=this.b,t.c=t.c.concat(e)),r){case 1:vr(this,5);break;case 4:vr(this,10);break;case 3:vr(this,6);break;default:vr(this,2)}}};function dr(t,e){var n=t.Na+Math.floor(Math.random()*t.Ra);t.ma()||(n*=2);return n*e}function vr(t,e){if(2==e){var n=null;t.c&&(n=null);var r=w(t.eb,t);n||(n=new Be("//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||He(n,"https"),Xe(n));Mn(n.toString(),r)}else se(2);t.u=0;t.c&&t.c.ta(e);yr(t);rr(t)}i.eb=function(t){t?se(2):se(1)};function yr(t){t.u=0;t.m=-1;if(t.c){if(0!=Pn(t.b).length||0!=t.f.length)t.b.c.length=0,k(t.f),t.f.length=0;t.c.sa()}}function mr(t,e,n){var r=$e(n);if(""!=r.b)e&&We(r,e+"."+r.b),Ke(r,r.i);else{var i=s.location,o;e?o=e+"."+i.hostname:o=i.hostname;r=Ze(i.protocol,o,+i.port,n)}t.V&&M(t.V,(function(t,e){Ye(r,e,t)}));e=t.j;n=t.I;e&&n&&Ye(r,e,n);Ye(r,"VER",t.wa);ur(t,r);return r}i.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");t=new qn(this.Ka);t.F=this.R;return t};i.ma=function(){return!!this.c&&!0};i.Y=function(){return this.R};function gr(){}i=gr.prototype;i.va=function(){};i.ua=function(){};i.ta=function(){};i.sa=function(){};i.Sa=function(){};function wr(t){for(var e=arguments[0],n=1;n<arguments.length;n++){var r=arguments[n];if(0==r.lastIndexOf("/",0))e=r;else{var i;(i=""==e)||(i=e.length-1,i=0<=i&&e.indexOf("/",i)==i);i?e+=r:e+="/"+r}}return e}function br(){if(z&&!(10<=Number(nt)))throw Error("Environmental error: no available transport.")}br.prototype.a=function(t,e){return new _r(t,e)};function _r(t,e){Ct.call(this);this.a=new er(e);this.g=t;this.m=e&&e.fb?e.fb:wr(this.g,"test");this.b=e&&e.messageUrlParams||null;t=e&&e.messageHeaders||null;e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"});this.a.i=t;t=e&&e.initMessageHeaders||null;e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType});e&&e.xa&&(t?t["X-WebChannel-Client-Profile"]=e.xa:t={"X-WebChannel-Client-Profile":e.xa});this.a.J=t;(t=e&&e.httpHeadersOverwriteParam)&&!R(t)&&(this.a.g=t);this.l=e&&e.supportsCrossDomainXhr||!1;this.h=e&&e.sendRawJson||!1;(e=e&&e.httpSessionIdParam)&&!R(e)&&(this.a.j=e,t=this.b,null!==t&&e in t&&(t=this.b,e in t&&delete t[e]));this.f=new Tr(this)}E(_r,Ct);i=_r.prototype;i.addEventListener=function(t,e,n,r){_r.N.addEventListener.call(this,t,e,n,r)};i.removeEventListener=function(t,e,n,r){_r.N.removeEventListener.call(this,t,e,n,r)};i.Va=function(){this.a.c=this.f;this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,r=this.b||void 0;se(0);t.ha=n;t.V=r||{};t.o&&(t.F.b=[],t.F.a=!1);t.w=new wn(t);null===t.g&&(t.w.h=t.i);n=e;t.g&&t.i&&(n=tr(e,t.g,t.i));t=t.w;t.i=n;e=mr(t.a,null,t.i);se(3);n=t.a.F.b;null!=n?(t.f=n[0],t.M=1,bn(t)):(Je(e,"MODE","init"),!t.a.o&&t.a.j&&Je(e,"X-HTTP-Session-Id",t.a.j),t.b=new we(t,void 0,void 0),t.b.h=t.h,Te(t.b,e,!1,null),t.M=0)};i.close=function(){nr(this.a)};i.Wa=function(t){if(a(t)){var e={};e.__data__=t;ir(this.a,e)}else this.h?(e={},e.__data__=Pt(t),ir(this.a,e)):ir(this.a,t)};i.G=function(){this.a.c=null;delete this.f;nr(this.a);delete this.a;_r.N.G.call(this)};function Er(t){ve.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}E(Er,ve);function Ir(){ye.call(this);this.status=1}E(Ir,ye);function Tr(t){this.a=t}E(Tr,gr);Tr.prototype.va=function(){this.a.dispatchEvent("a")};Tr.prototype.ua=function(t){this.a.dispatchEvent(new Er(t))};Tr.prototype.ta=function(t){this.a.dispatchEvent(new Ir(t))};Tr.prototype.sa=function(){this.a.dispatchEvent("b")};var Sr=b((function(t,e){function n(){}n.prototype=t.prototype;var r=new n;t.apply(r,Array.prototype.slice.call(arguments,1));return r}),br);br.prototype.createWebChannel=br.prototype.a;_r.prototype.send=_r.prototype.Wa;_r.prototype.open=_r.prototype.Va;_r.prototype.close=_r.prototype.close;ce.NO_ERROR=0;ce.TIMEOUT=8;ce.HTTP_ERROR=6;he.COMPLETE="complete";pe.EventType=de;de.OPEN="a";de.CLOSE="b";de.ERROR="c";de.MESSAGE="d";Ct.prototype.listen=Ct.prototype.za;qn.prototype.listenOnce=qn.prototype.Aa;qn.prototype.getLastError=qn.prototype.Xa;qn.prototype.getLastErrorCode=qn.prototype.ya;qn.prototype.getStatus=qn.prototype.T;qn.prototype.getResponseJson=qn.prototype.Ua;qn.prototype.getResponseText=qn.prototype.aa;qn.prototype.send=qn.prototype.ca;var Nr={createWebChannelTransport:Sr,ErrorCode:ce,EventType:he,WebChannel:pe,XhrIo:qn};var Ar=Nr.createWebChannelTransport;var Or=Nr.ErrorCode;var kr=Nr.EventType;var Rr=Nr.WebChannel;var Cr=Nr.XhrIo;const Dr=Nr},39333:(t,e,n)=>{"use strict";function r(t){return t&&typeof t==="object"&&"default"in t?t["default"]:t}var i=r(n(99413));n(38881);n(87145);n(91779);n(24712);n(69623);n(4997);n(36772);n(56139);n(19917);var o="firebase";var s="7.12.0";i.registerVersion(o,s,"app");var a="firebase";var u="7.12.0";console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport * as firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n");i.registerVersion(a,u);t.exports=i},70015:function(t,e){(function(t,n){true?n(e):0})(this,(function(t){"use strict";function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)};t.onerror=function(){n(t.error)}}))}function r(t,e,r){var i;var o=new Promise((function(o,s){i=t[e].apply(t,r);n(i).then(o,s)}));o.request=i;return o}function i(t,e,n){var i=r(t,e,n);return i.then((function(t){if(!t)return;return new h(t,i.request)}))}function o(t,e,n){n.forEach((function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})}))}function s(t,e,n,i){i.forEach((function(i){if(!(i in n.prototype))return;t.prototype[i]=function(){return r(this[e],i,arguments)}}))}function a(t,e,n,r){r.forEach((function(r){if(!(r in n.prototype))return;t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)}}))}function u(t,e,n,r){r.forEach((function(r){if(!(r in n.prototype))return;t.prototype[r]=function(){return i(this[e],r,arguments)}}))}function c(t){this._index=t}o(c,"_index",["name","keyPath","multiEntry","unique"]);s(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]);u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]);function h(t,e){this._cursor=t;this._request=e}o(h,"_cursor",["direction","key","primaryKey","value"]);s(h,"_cursor",IDBCursor,["update","delete"]);["advance","continue","continuePrimaryKey"].forEach((function(t){if(!(t in IDBCursor.prototype))return;h.prototype[t]=function(){var e=this;var r=arguments;return Promise.resolve().then((function(){e._cursor[t].apply(e._cursor,r);return n(e._request).then((function(t){if(!t)return;return new h(t,e._request)}))}))}}));function f(t){this._store=t}f.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))};f.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))};o(f,"_store",["name","keyPath","indexNames","autoIncrement"]);s(f,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]);u(f,"_store",IDBObjectStore,["openCursor","openKeyCursor"]);a(f,"_store",IDBObjectStore,["deleteIndex"]);function l(t){this._tx=t;this.complete=new Promise((function(e,n){t.oncomplete=function(){e()};t.onerror=function(){n(t.error)};t.onabort=function(){n(t.error)}}))}l.prototype.objectStore=function(){return new f(this._tx.objectStore.apply(this._tx,arguments))};o(l,"_tx",["objectStoreNames","mode"]);a(l,"_tx",IDBTransaction,["abort"]);function p(t,e,n){this._db=t;this.oldVersion=e;this.transaction=new l(n)}p.prototype.createObjectStore=function(){return new f(this._db.createObjectStore.apply(this._db,arguments))};o(p,"_db",["name","version","objectStoreNames"]);a(p,"_db",IDBDatabase,["deleteObjectStore","close"]);function d(t){this._db=t}d.prototype.transaction=function(){return new l(this._db.transaction.apply(this._db,arguments))};o(d,"_db",["name","version","objectStoreNames"]);a(d,"_db",IDBDatabase,["close"]);["openCursor","openKeyCursor"].forEach((function(t){[f,c].forEach((function(n){if(!(t in n.prototype))return;n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments);var r=n[n.length-1];var i=this._store||this._index;var o=i[t].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}}}))}));[c,f].forEach((function(t){if(t.prototype.getAll)return;t.prototype.getAll=function(t,e){var n=this;var r=[];return new Promise((function(i){n.iterateCursor(t,(function(t){if(!t){i(r);return}r.push(t.value);if(e!==undefined&&r.length==e){i(r);return}t.continue()}))}))}}));function v(t,e,n){var i=r(indexedDB,"open",[t,e]);var o=i.request;if(o){o.onupgradeneeded=function(t){if(n){n(new p(o.result,t.oldVersion,o.transaction))}}}return i.then((function(t){return new d(t)}))}function y(t){return r(indexedDB,"deleteDatabase",[t])}t.openDb=v;t.deleteDb=y;Object.defineProperty(t,"__esModule",{value:true})}))}}]);
//# sourceMappingURL=9333.93178c20eb4aa08e1408.js.map?v=93178c20eb4aa08e1408