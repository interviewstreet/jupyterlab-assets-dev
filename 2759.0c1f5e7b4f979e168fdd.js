"use strict";(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[2759],{82759:(e,t,n)=>{n.r(t);n.d(t,{EditorSyntaxStatus:()=>b,EditorTableOfContentsFactory:()=>S,FileEditor:()=>g,FileEditorAdapter:()=>r,FileEditorFactory:()=>f,FileEditorSearchProvider:()=>y,FileEditorWidget:()=>m,IEditorTracker:()=>R,LaTeXTableOfContentsFactory:()=>O,LaTeXTableOfContentsModel:()=>k,MarkdownTableOfContentsFactory:()=>D,MarkdownTableOfContentsModel:()=>F,PythonTableOfContentsFactory:()=>N,PythonTableOfContentsModel:()=>W,TabSpaceStatus:()=>E});var i=n(52959);var s=n(97540);var o=n(55172);class r extends s.WidgetLSPAdapter{constructor(e,t){const{docRegistry:n,...i}=t;super(e,i);this._readyDelegate=new o.PromiseDelegate;this.editor=e.content;this._docRegistry=n;this._virtualEditor=Object.freeze({getEditor:()=>this.editor.editor,ready:()=>Promise.resolve(this.editor.editor),reveal:()=>Promise.resolve(this.editor.editor)});Promise.all([this.editor.context.ready,this.connectionManager.ready]).then((async()=>{await this.initOnceReady();this._readyDelegate.resolve()})).catch(console.error)}get ready(){return this._readyDelegate.promise}get documentPath(){return this.widget.context.path}get mimeType(){var e;const t=this.editor.model.mimeType;const n=Array.isArray(t)?(e=t[0])!==null&&e!==void 0?e:i.IEditorMimeTypeService.defaultMimeType:t;const s=this.editor.context.contentsModel;if(n!=i.IEditorMimeTypeService.defaultMimeType){return n}else if(s){let e=this._docRegistry.getFileTypeForModel(s);return e.mimeTypes[0]}else{return n}}get languageFileExtension(){let e=this.documentPath.split(".");return e[e.length-1]}get ceEditor(){return this.editor.editor}get activeEditor(){return this._virtualEditor}get wrapperElement(){return this.widget.node}get path(){return this.widget.context.path}get editors(){var e,t;return[{ceEditor:this._virtualEditor,type:"code",value:(t=(e=this.editor)===null||e===void 0?void 0:e.model.sharedModel.getSource())!==null&&t!==void 0?t:""}]}dispose(){if(this.isDisposed){return}this.editor.model.mimeTypeChanged.disconnect(this.reloadConnection);super.dispose()}createVirtualDocument(){return new s.VirtualDocument({language:this.language,foreignCodeExtractors:this.options.foreignCodeExtractorsManager,path:this.documentPath,fileExtension:this.languageFileExtension,standalone:true,hasLspSupportedFile:true})}getEditorIndexAt(e){return 0}getEditorIndex(e){return 0}getEditorWrapper(e){return this.wrapperElement}async initOnceReady(){this.initVirtual();await this.connectDocument(this.virtualDocument,false);this.editor.model.mimeTypeChanged.connect(this.reloadConnection,this)}}var a=n(87447);var l=n(1458);var d=n(35627);var c=n(27425);var u=n(65178);const h="jpCodeRunner";const p="jpUndoer";class g extends u.Widget{constructor(e){super();this._ready=new o.PromiseDelegate;this.addClass("jp-FileEditor");const t=this._context=e.context;this._mimeTypeService=e.mimeTypeService;const n=this._editorWidget=new i.CodeEditorWrapper({factory:e.factory,model:t.model,editorOptions:{config:g.defaultEditorConfig}});this._editorWidget.addClass("jp-FileEditorCodeWrapper");this._editorWidget.node.dataset[h]="true";this._editorWidget.node.dataset[p]="true";this.editor=n.editor;this.model=n.model;void t.ready.then((()=>{this._onContextReady()}));this._onPathChanged();t.pathChanged.connect(this._onPathChanged,this);const s=this.layout=new u.StackedLayout;s.addWidget(n)}get context(){return this._context}get ready(){return this._ready.promise}handleEvent(e){if(!this.model){return}switch(e.type){case"mousedown":this._ensureFocus();break;default:break}}onAfterAttach(e){super.onAfterAttach(e);const t=this.node;t.addEventListener("mousedown",this)}onBeforeDetach(e){const t=this.node;t.removeEventListener("mousedown",this)}onActivateRequest(e){this._ensureFocus()}_ensureFocus(){if(!this.editor.hasFocus()){this.editor.focus()}}_onContextReady(){if(this.isDisposed){return}this.editor.clearHistory();this._ready.resolve(undefined)}_onPathChanged(){const e=this.editor;const t=this._context.localPath;e.model.mimeType=this._mimeTypeService.getMimeTypeByFilePath(t)}}(function(e){e.defaultEditorConfig={lineNumbers:true,scrollPastEnd:true}})(g||(g={}));class m extends d.DocumentWidget{async setFragment(e){const t=e.split("=");if(t[0]!=="#line"){return}const n=t[1];let i;if(n.includes(",")){i=n.split(",")[0]||"0"}else{i=n}return this.context.ready.then((()=>{const e={line:parseInt(i,10),column:0};this.content.editor.setCursorPosition(e);this.content.editor.revealPosition(e)}))}}class f extends d.ABCWidgetFactory{constructor(e){super(e.factoryOptions);this._services=e.editorServices}createNewWidget(e){const t=this._services.factoryService.newDocumentEditor;const n=e=>t(e);const i=new g({factory:n,context:e,mimeTypeService:this._services.mimeTypeService});i.title.icon=c.textEditorIcon;const s=new m({content:i,context:e});return s}}class y extends l.EditorSearchProvider{constructor(e){super();this.widget=e;this._searchActive=false}get isReadOnly(){return this.editor.getOption("readOnly")}get replaceOptionsSupport(){return{preserveCase:true}}get editor(){return this.widget.content.editor}get model(){return this.widget.content.model}async startQuery(e,t){this._searchActive=true;await super.startQuery(e,t);await this.highlightNext(true,{from:"selection-start",scroll:false,select:false})}async endQuery(){this._searchActive=false;await super.endQuery()}async onSharedModelChanged(e,t){if(this._searchActive){return super.onSharedModelChanged(e,t)}}static createNew(e,t){return new y(e)}static isApplicable(e){return e instanceof a.MainAreaWidget&&e.content instanceof g&&e.content.editor instanceof l.CodeMirrorEditor}getInitialQuery(){const e=this.editor;const t=e.state.sliceDoc(e.state.selection.main.from,e.state.selection.main.to);return t}}var v=n(53825);var _=n(50724);var C=n(37900);var x=n.n(C);function w(e){return x().createElement(v.TextItem,{source:e.language,onClick:e.handleClick})}class b extends c.VDomRenderer{constructor(e){var t;super(new b.Model(e.languages));this._handleClick=()=>{const e=new u.Menu({commands:this._commands});const t="fileeditor:change-language";if(this._popup){this._popup.dispose()}this.model.languages.getLanguages().sort(((e,t)=>{var n,i;const s=(n=e.displayName)!==null&&n!==void 0?n:e.name;const o=(i=t.displayName)!==null&&i!==void 0?i:t.name;return s.localeCompare(o)})).forEach((n=>{var i;if(n.name.toLowerCase().indexOf("brainf")===0){return}const s={name:n.name,displayName:(i=n.displayName)!==null&&i!==void 0?i:n.name};e.addItem({command:t,args:s})}));this._popup=(0,v.showPopup)({body:e,anchor:this,align:"left"})};this._popup=null;this._commands=e.commands;this.translator=(t=e.translator)!==null&&t!==void 0?t:_.nullTranslator;const n=this.translator.load("jupyterlab");this.addClass("jp-mod-highlighted");this.title.caption=n.__("Change text editor syntax highlighting")}render(){if(!this.model){return null}return x().createElement(w,{language:this.model.language,handleClick:this._handleClick})}}(function(e){class t extends c.VDomModel{constructor(e){super();this.languages=e;this._onMIMETypeChange=(e,t)=>{var n;const s=this._language;const o=this.languages.findByMIME(t.newValue);this._language=(n=o===null||o===void 0?void 0:o.name)!==null&&n!==void 0?n:i.IEditorMimeTypeService.defaultMimeType;this._triggerChange(s,this._language)};this._language="";this._editor=null}get language(){return this._language}get editor(){return this._editor}set editor(e){var t;const n=this._editor;if(n!==null){n.model.mimeTypeChanged.disconnect(this._onMIMETypeChange)}const s=this._language;this._editor=e;if(this._editor===null){this._language=""}else{const e=this.languages.findByMIME(this._editor.model.mimeType);this._language=(t=e===null||e===void 0?void 0:e.name)!==null&&t!==void 0?t:i.IEditorMimeTypeService.defaultMimeType;this._editor.model.mimeTypeChanged.connect(this._onMIMETypeChange)}this._triggerChange(s,this._language)}_triggerChange(e,t){if(e!==t){this.stateChanged.emit(void 0)}}}e.Model=t})(b||(b={}));function T(e){const t=e.translator||_.nullTranslator;const n=t.load("jupyterlab");const i=typeof e.tabSpace==="number"?n.__("Spaces"):n.__("Tab Indent");return x().createElement(v.TextItem,{onClick:e.handleClick,source:typeof e.tabSpace==="number"?`${i}: ${e.tabSpace}`:i,title:n.__("Change the indentationâ€¦")})}class E extends c.VDomRenderer{constructor(e){super(new E.Model);this._popup=null;this._menu=e.menu;this.translator=e.translator||_.nullTranslator;this.addClass("jp-mod-highlighted")}render(){var e;if(!((e=this.model)===null||e===void 0?void 0:e.indentUnit)){return null}else{const e=this.model.indentUnit==="Tab"?null:parseInt(this.model.indentUnit,10);return x().createElement(T,{tabSpace:e,handleClick:()=>this._handleClick(),translator:this.translator})}}_handleClick(){const e=this._menu;if(this._popup){this._popup.dispose()}e.aboutToClose.connect(this._menuClosed,this);this._popup=(0,v.showPopup)({body:e,anchor:this,align:"right"});e.update()}_menuClosed(){this.removeClass("jp-mod-clicked")}}(function(e){class t extends c.VDomModel{get indentUnit(){return this._indentUnit}set indentUnit(e){if(e!==this._indentUnit){this._indentUnit=e;this.stateChanged.emit()}}}e.Model=t})(E||(E={}));var M=n(41252);class S extends M.TableOfContentsFactory{createNew(e,t){const n=super.createNew(e,t);const i=(t,n)=>{if(n){e.content.editor.setCursorPosition({line:n.line,column:0})}};n.activeHeadingChanged.connect(i);e.disposed.connect((()=>{n.activeHeadingChanged.disconnect(i)}));return n}}const P={part:1,chapter:1,section:1,subsection:2,subsubsection:3,paragraph:4,subparagraph:5};const A=/^\s*\\(section|subsection|subsubsection){(.+)}/;class k extends M.TableOfContentsModel{get documentType(){return"latex"}get supportedOptions(){return["maximalDepth","numberHeaders"]}getHeadings(){if(!this.isActive){return Promise.resolve(null)}const e=this.widget.content.model.sharedModel.getSource().split("\n");const t=new Array;let n=t.length;const i=new Array;for(let s=0;s<e.length;s++){const o=e[s].match(A);if(o){const e=P[o[1]];if(e<=this.configuration.maximalDepth){const r=M.TableOfContentsUtils.getPrefix(e,n,t,{...this.configuration,baseNumbering:1,numberingH1:true});n=e;i.push({text:o[2],prefix:r,level:e,line:s})}}}return Promise.resolve(i)}}class O extends S{isApplicable(e){var t,n;const i=super.isApplicable(e);if(i){let i=(n=(t=e.content)===null||t===void 0?void 0:t.model)===null||n===void 0?void 0:n.mimeType;return i&&(i==="text/x-latex"||i==="text/x-stex")}return false}_createNew(e,t){return new k(e,t)}}class F extends M.TableOfContentsModel{get documentType(){return"markdown"}getHeadings(){if(!this.isActive){return Promise.resolve(null)}const e=this.widget.content.model.sharedModel.getSource();const t=M.TableOfContentsUtils.filterHeadings(M.TableOfContentsUtils.Markdown.getHeadings(e),{...this.configuration,numberHeaders:false});return Promise.resolve(t)}}class D extends S{isApplicable(e){var t,n;const i=super.isApplicable(e);if(i){let i=(n=(t=e.content)===null||t===void 0?void 0:t.model)===null||n===void 0?void 0:n.mimeType;return i&&M.TableOfContentsUtils.Markdown.isMarkdown(i)}return false}_createNew(e,t){return new F(e,t)}}let I;try{I=new RegExp("^\\s*(class |def |from |import )","d")}catch(U){I=new RegExp("^\\s*(class |def |from |import )")}class W extends M.TableOfContentsModel{get documentType(){return"python"}async getHeadings(){if(!this.isActive){return Promise.resolve(null)}const e=this.widget.content.model.sharedModel.getSource().split("\n");let t=new Array;let i=false;let s=1;let o=-1;for(const r of e){o++;let e;if(I.flags.includes("d")){e=I.exec(r)}else{const{default:t}=await n.e(1123).then(n.t.bind(n,61123,23));e=t(I,r)}if(e){const[n]=e.indices[1];if(s===1&&n>0){s=n}const a=["from ","import "].includes(e[1]);if(a&&i){continue}i=a;const l=1+n/s;if(l>this.configuration.maximalDepth){continue}t.push({text:r.slice(n),level:l,line:o})}}return Promise.resolve(t)}}class N extends S{isApplicable(e){var t,n;const i=super.isApplicable(e);if(i){let i=(n=(t=e.content)===null||t===void 0?void 0:t.model)===null||n===void 0?void 0:n.mimeType;return i&&(i==="application/x-python-code"||i==="text/x-python")}return false}_createNew(e,t){return new W(e,t)}}const R=new o.Token("@jupyterlab/fileeditor:IEditorTracker",`A widget tracker for file editors.\n  Use this if you want to be able to iterate over and interact with file editors\n  created by the application.`)}}]);
//# sourceMappingURL=2759.0c1f5e7b4f979e168fdd.js.map?v=0c1f5e7b4f979e168fdd