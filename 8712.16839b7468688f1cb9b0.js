"use strict";(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[8712],{18712:(e,t,a)=>{a.r(t);a.d(t,{DETAILS_CLASS:()=>u,IMermaidManager:()=>h,IMermaidMarkdown:()=>M,MERMAID_CLASS:()=>c,MERMAID_CODE_CLASS:()=>o,MERMAID_DARK_THEME:()=>m,MERMAID_DEFAULT_THEME:()=>d,MERMAID_FILE_EXTENSIONS:()=>s,MERMAID_MIME_TYPE:()=>i,MermaidManager:()=>p,MermaidMarkdown:()=>_,RenderedMermaid:()=>w,SUMMARY_CLASS:()=>g,WARNING_CLASS:()=>l,rendererFactory:()=>C});var n=a(55172);var r=a(78098);const i="text/vnd.mermaid";const s=[".mmd",".mermaid"];const d="default";const m="dark";const c="jp-RenderedMermaid";const o="mermaid";const l="jp-mod-warning";const u="jp-RenderedMermaid-Details";const g="jp-RenderedMermaid-Summary";const h=new n.Token("@jupyterlab/mermaid:IMermaidManager",`a manager for rendering mermaid text-based diagrams`);const M=new n.Token("@jupyterlab/mermaid:IMermaidMarkdown",`a manager for rendering mermaid text-based diagrams in markdown fenced code blocks`);class p{constructor(e={}){this._diagrams=new r.LruCache({maxSize:e.maxCacheSize||null});if(e.themes){f.initThemes(e.themes||null);e.themes.themeChanged.connect(this.initialize,this)}}static cleanMermaidSvg(e){return e.replace(f.RE_VOID_ELEMENT,f.replaceVoidElement)}initialize(){this._diagrams.clear();f.initMermaid()}async getMermaid(){return await f.ensureMermaid()}getMermaidVersion(){return f.version()}getCachedFigure(e){return this._diagrams.get(e)}async renderSvg(e){const t=await this.getMermaid();const a=`jp-mermaid-${f.nextMermaidId()}`;const n=document.createElement("div");document.body.appendChild(n);try{let{svg:r}=await t.render(a,e,n);r=p.cleanMermaidSvg(r);const i=new DOMParser;const s=i.parseFromString(r,"image/svg+xml");const d={text:e,svg:r};const m=s.querySelector("svg");const{maxWidth:c}=(m===null||m===void 0?void 0:m.style)||{};d.width=c?parseFloat(c):null;const o=s.querySelector("title");const l=s.querySelector("desc");if(o){d.accessibleTitle=o.textContent}if(l){d.accessibleDescription=l.textContent}return d}finally{n.remove()}}async renderFigure(e){let t=this._diagrams.get(e);if(t!=null){return t}let a=c;let n=null;t=document.createElement("div");t.className=a;try{const t=await this.renderSvg(e);n=this.makeMermaidFigure(t)}catch(i){t.classList.add(l);n=await this.makeMermaidError(e)}let r=this.getMermaidVersion();if(r){n.dataset.jpMermaidVersion=r}t.appendChild(n);this._diagrams.set(e,t);return t}makeMermaidCode(e){const t=document.createElement("pre");const a=document.createElement("code");a.innerText=e;t.appendChild(a);a.className=o;a.textContent=e;return t}async makeMermaidError(e){const t=await this.getMermaid();let a="";try{await t.parse(e)}catch(s){a=`${s}`}const n=document.createElement("details");n.className=u;const r=document.createElement("summary");r.className=g;r.appendChild(this.makeMermaidCode(e));n.appendChild(r);const i=document.createElement("pre");i.innerText=a;n.appendChild(i);return n}makeMermaidFigure(e){const t=document.createElement("figure");const a=document.createElement("img");t.appendChild(a);a.setAttribute("src",`data:image/svg+xml,${encodeURIComponent(e.svg)}`);if(e.width){a.width=e.width}if(e.accessibleTitle){a.setAttribute("alt",e.accessibleTitle)}t.appendChild(this.makeMermaidCode(e.text));if(e.accessibleDescription){const a=document.createElement("figcaption");a.className="sr-only";a.textContent=e.accessibleDescription;t.appendChild(a)}return t}}var f;(function(e){let t=null;let r=null;let i=null;let s=0;let c=null;function o(e){t=e}e.initThemes=o;function l(){return c}e.version=l;function u(){if(!r){return false}let e=d;if(t){const a=t.theme;e=a&&t.isLight(a)?d:m}const a=window.getComputedStyle(document.body).getPropertyValue("--jp-ui-font-family");r.mermaidAPI.globalReset();r.mermaidAPI.initialize({theme:e,fontFamily:a,securityLevel:"strict",maxTextSize:1e5,maxEdges:1e5,startOnLoad:false});return true}e.initMermaid=u;function g(){return r}e.getMermaid=g;function h(){return s++}e.nextMermaidId=h;async function M(){if(r!=null){return r}if(i){return i.promise}i=new n.PromiseDelegate;c=(await a.e(3212).then(a.t.bind(a,43212,19))).version;r=(await Promise.all([a.e(5741),a.e(3556)]).then(a.bind(a,33556))).default;u();i.resolve(r);return r}e.ensureMermaid=M;e.RE_VOID_ELEMENT=/<\s*(area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)\s*([^>]*?)\s*>/gi;function p(e,t,a){a=a.trim();if(!a.endsWith("/")){a=`${a} /`}return`<${t} ${a}>`}e.replaceVoidElement=p})(f||(f={}));class _{constructor(e){this.languages=["mermaid"];this.rank=100;this._mermaid=e.mermaid}async walk(e){await this._mermaid.renderFigure(e)}render(e){let t=this._mermaid.getCachedFigure(e);if(t){return t.outerHTML}return null}}var y=a(65178);const E="image/svg+xml";class w extends y.Widget{constructor(e){super();this._lastRendered=null;this._mimeType=e.mimeType;this.addClass(c)}static set manager(e){if(w._manager){console.warn("Mermaid manager may only be set once, and is already set.");return}w._manager=e;w._managerReady.resolve(e)}async renderModel(e){const t=await w._managerReady.promise;const a=e.data[this._mimeType];if(a==null||a===this._lastRendered){return}this._lastRendered=a;const n=await t.renderFigure(a);if(n.classList.contains(l)){this.node.classList.add(l)}else{this.node.classList.remove(l)}if(!n.firstChild){return}if(this.node.innerHTML!==n.innerHTML){this.node.innerHTML=n.innerHTML}const r=t.getMermaidVersion();const s={...e.metadata[i]||{},version:r};const d={...e.metadata,[i]:s};const m=n.querySelector("img");if(m){const t=decodeURIComponent(m.src.split(",")[1]);const a=e.data[E];if(t!==a){e.setData({data:{...e.data,[E]:t},metadata:d})}}else{const t={...e.data};delete t[E];e.setData({data:t,metadata:d})}}}w._manager=null;w._managerReady=new n.PromiseDelegate;const C={safe:true,mimeTypes:[i],createRenderer:e=>new w(e)}}}]);
//# sourceMappingURL=8712.16839b7468688f1cb9b0.js.map?v=16839b7468688f1cb9b0