"use strict";(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[2072],{42072:(e,t,s)=>{s.r(t);s.d(t,{AttachmentsCell:()=>Xe,AttachmentsCellModel:()=>J,Cell:()=>Je,CellDragUtils:()=>h,CellFooter:()=>P,CellHeader:()=>b,CellModel:()=>Q,CellSearchProvider:()=>ue,CodeCell:()=>qe,CodeCellLayout:()=>Ge,CodeCellModel:()=>X,Collapser:()=>f,ExecutionCountWidget:()=>F,InputArea:()=>W,InputCollapser:()=>v,InputPlaceholder:()=>oe,InputPrompt:()=>N,MarkdownCell:()=>Ke,MarkdownCellModel:()=>q,OutputCollapser:()=>y,OutputPlaceholder:()=>re,Placeholder:()=>ne,RawCell:()=>Ye,RawCellModel:()=>G,SELECTED_HIGHLIGHT_CLASS:()=>he,createCellSearchProvider:()=>ge,isCodeCellModel:()=>B,isMarkdownCellModel:()=>U,isRawCellModel:()=>$});var i=s(48130);const n=5;const o="jp-dragImage";const r="jp-dragImage-singlePrompt";const a="jp-dragImage-content";const d="jp-dragImage-prompt";const l="jp-dragImage-multipleBack";var h;(function(e){function t(e,t,s){let i=-1;while(e&&e.parentElement){if(s(e)){let s=-1;for(const n of t){if(n.node===e){i=++s;break}}break}e=e.parentElement}return i}e.findCell=t;function s(e,t){var s,i;let n;if(e){if((s=e.editorWidget)===null||s===void 0?void 0:s.node.contains(t)){n="input"}else if((i=e.promptNode)===null||i===void 0?void 0:i.contains(t)){n="prompt"}else{n="cell"}}else{n="unknown"}return n}e.detectTargetArea=s;function h(e,t,s,i){const o=Math.abs(s-e);const r=Math.abs(i-t);return o>=n||r>=n}e.shouldStartDrag=h;function u(e,t){const s=t.length;let n;if(e.model.type==="code"){const t=e.model.executionCount;n=" ";if(t){n=t.toString()}}else{n=""}const h=e.model.sharedModel.getSource().split("\n")[0].slice(0,26);if(s>1){if(n!==""){return i.VirtualDOM.realize(i.h.div(i.h.div({className:o},i.h.span({className:d},"["+n+"]:"),i.h.span({className:a},h)),i.h.div({className:l},"")))}else{return i.VirtualDOM.realize(i.h.div(i.h.div({className:o},i.h.span({className:d}),i.h.span({className:a},h)),i.h.div({className:l},"")))}}else{if(n!==""){return i.VirtualDOM.realize(i.h.div(i.h.div({className:`${o} ${r}`},i.h.span({className:d},"["+n+"]:"),i.h.span({className:a},h))))}else{return i.VirtualDOM.realize(i.h.div(i.h.div({className:`${o} ${r}`},i.h.span({className:d}),i.h.span({className:a},h))))}}}e.createCellDragImage=u})(h||(h={}));var u=s(27425);var c=s(76838);var p=s(37900);const g="jp-Collapser";const m="jp-Collapser-child";const C="jp-InputCollapser";const _="jp-OutputCollapser";class f extends u.ReactWidget{constructor(){super();this.addClass(g)}get collapsed(){return false}render(){const e=m;return p.createElement("div",{className:e,onClick:e=>this.handleClick(e)})}}class v extends f{constructor(){super();this.addClass(C)}get collapsed(){var e;const t=(e=this.parent)===null||e===void 0?void 0:e.parent;if(t){return t.inputHidden}else{return false}}handleClick(e){var t;const s=(t=this.parent)===null||t===void 0?void 0:t.parent;if(s){s.inputHidden=!s.inputHidden}this.update()}}class y extends f{constructor(){super();this.addClass(_)}get collapsed(){var e;const t=(e=this.parent)===null||e===void 0?void 0:e.parent;if(t){return t.outputHidden}else{return false}}handleClick(e){var t,s;const i=(t=this.parent)===null||t===void 0?void 0:t.parent;if(i){i.outputHidden=!i.outputHidden;if(i.outputHidden){let e=(s=i.parent)===null||s===void 0?void 0:s.node;if(e){c.ElementExt.scrollIntoViewIfNeeded(e,i.node)}}}this.update()}}var w=s(65178);const x="jp-CellHeader";const M="jp-CellFooter";class b extends w.Widget{constructor(){super();this.addClass(x)}}class P extends w.Widget{constructor(){super();this.addClass(M)}}var S=s(52959);var O=s(87447);const A=3;class H extends O.ReactWidget{constructor(){super();this._collaborators=[]}get collaborators(){return this._collaborators}set collaborators(e){this._collaborators=e;this.update()}render(){const e=this._collaborators.slice(0,A);const t=e.length===A?this._collaborators.slice(A):[];return p.createElement("div",{style:{display:"flex",justifyContent:"flex-end",flexWrap:"wrap"}},e.map((function(e,t){var s;return p.createElement("div",{style:{color:e.color,marginRight:4,fontWeight:"bold"},key:e.username,title:e.name},(s=e.name)===null||s===void 0?void 0:s.charAt(0).toUpperCase())})),t.length>0?p.createElement("div",{title:t.map((e=>e.name)).join(", ")},"..."):null)}}const E="jp-InputArea";const I="jp-ExecutionContent";const k="jp-InputArea-prompt";const D="jp-InputPrompt";const j="jp-InputArea-editor";class W extends w.Widget{constructor(e){super();this.addClass(E);const{contentFactory:t,editorOptions:s,model:i}=e;this.model=i;this.contentFactory=t;const n=this._prompt=t.createInputPrompt();n.addClass(k);const o=this._editor=new S.CodeEditorWrapper({factory:t.editorFactory,model:i,editorOptions:s});o.addClass(j);const r=this.layout=new w.PanelLayout;r.addWidget(n);r.addWidget(o)}get editorWidget(){return this._editor}get editor(){return this._editor.editor}get promptNode(){return this._prompt.node}get renderedInput(){return this._rendered}get collaborators(){return this._prompt.collaborators}set collaborators(e){this._prompt.collaborators=e}renderInput(e){const t=this.layout;if(this._rendered){this._rendered.parent=null}this._editor.hide();this._rendered=e;t.addWidget(e)}showEditor(){if(this._rendered){this._rendered.parent=null}this._editor.show()}setPrompt(e){this._prompt.executionCount=e}dispose(){if(this.isDisposed){return}this._prompt=null;this._editor=null;this._rendered=null;super.dispose()}}(function(e){class t{constructor(e){this._editor=e.editorFactory}get editorFactory(){return this._editor}createInputPrompt(){return new N}}e.ContentFactory=t})(W||(W={}));class N extends w.Widget{constructor(){super();const e=this.layout=new w.PanelLayout;const t=this._collaboratorsWidget=new H;const s=this._executionCountWidget=new F;e.addWidget(s);e.addWidget(t);this.addClass(D)}get executionCount(){return this._executionCountWidget.executionCount}set executionCount(e){this._executionCountWidget.executionCount=e}get collaborators(){return this._collaboratorsWidget.collaborators}set collaborators(e){this._collaboratorsWidget.collaborators=e}}class F extends w.Widget{constructor(){super();this._executionCount=null;this.addClass(I)}get executionCount(){return this._executionCount}set executionCount(e){this._executionCount=e;if(e===null){this.node.textContent=" "}else{this.node.textContent=`[${e||" "}]:`}}}var L=s(19289);var T=s(6294);var R=s(32143);var V=s(95205);const z=(0,V.createMutex)();function B(e){return e.type==="code"}function U(e){return e.type==="markdown"}function $(e){return e.type==="raw"}class Q extends S.CodeEditor.Model{constructor(e={}){const{cell_type:t,sharedModel:s,...i}=e;super({sharedModel:s!==null&&s!==void 0?s:(0,V.createStandaloneCell)({cell_type:t!==null&&t!==void 0?t:"raw",id:e.id}),...i});this.contentChanged=new L.Signal(this);this.stateChanged=new L.Signal(this);this._metadataChanged=new L.Signal(this);this._trusted=false;this.standaloneModel=typeof e.sharedModel==="undefined";this.trusted=!!this.getMetadata("trusted")||!!e.trusted;this.sharedModel.changed.connect(this.onGenericChange,this);this.sharedModel.metadataChanged.connect(this._onMetadataChanged,this);this.sharedModel.changed.connect(this._onSharedModelChanged,this)}get metadataChanged(){return this._metadataChanged}get id(){return this.sharedModel.getId()}get metadata(){return this.sharedModel.metadata}get trusted(){return this._trusted}set trusted(e){const t=this.trusted;if(t!==e){this._trusted=e;this.onTrustedChanged(this,{newValue:e,oldValue:t})}}dispose(){if(this.isDisposed){return}this.sharedModel.changed.disconnect(this.onGenericChange,this);this.sharedModel.metadataChanged.disconnect(this._onMetadataChanged,this);this.sharedModel.changed.disconnect(this._onSharedModelChanged,this);super.dispose()}onTrustedChanged(e,t){}deleteMetadata(e){return this.sharedModel.deleteMetadata(e)}getMetadata(e){return this.sharedModel.getMetadata(e)}setMetadata(e,t){if(typeof t==="undefined"){this.sharedModel.deleteMetadata(e)}else{this.sharedModel.setMetadata(e,t)}}toJSON(){return this.sharedModel.toJSON()}onGenericChange(){this.contentChanged.emit(void 0)}_onMetadataChanged(e,t){this._metadataChanged.emit(t)}_onSharedModelChanged(e,t){if(t.collaboratorsChange){this.stateChanged.emit({name:"collaborators",oldValue:t.collaboratorsChange.oldValue,newValue:t.collaboratorsChange.newValue})}}}class J extends Q{constructor(e){var t;super(e);const s=(t=e.contentFactory)!==null&&t!==void 0?t:J.defaultContentFactory;const i=this.sharedModel.getAttachments();this._attachments=s.createAttachmentsModel({values:i});this._attachments.stateChanged.connect(this.onGenericChange,this);this._attachments.changed.connect(this._onAttachmentsChange,this)}get attachments(){return this._attachments}dispose(){if(this.isDisposed){return}this._attachments.stateChanged.disconnect(this.onGenericChange,this);this._attachments.changed.disconnect(this._onAttachmentsChange,this);this._attachments.dispose();super.dispose()}toJSON(){return super.toJSON()}_onAttachmentsChange(e,t){const s=this.sharedModel;z((()=>s.setAttachments(e.toJSON())))}}(function(e){class t{createAttachmentsModel(e){return new T.AttachmentsModel(e)}}e.ContentFactory=t;e.defaultContentFactory=new t})(J||(J={}));class G extends J{constructor(e={}){super({cell_type:"raw",...e})}get type(){return"raw"}toJSON(){return super.toJSON()}}class q extends J{constructor(e={}){super({cell_type:"markdown",...e});this.mimeType="text/x-ipythongfm"}get type(){return"markdown"}toJSON(){return super.toJSON()}}class X extends Q{constructor(e={}){var t;super({cell_type:"code",...e});this._executedCode="";this._isDirty=false;const s=(t=e===null||e===void 0?void 0:e.contentFactory)!==null&&t!==void 0?t:X.defaultContentFactory;const i=this.trusted;const n=this.sharedModel.getOutputs();this._outputs=s.createOutputArea({trusted:i,values:n});this.sharedModel.changed.connect(this._onSharedModelChanged,this);this._outputs.changed.connect(this.onGenericChange,this);this._outputs.changed.connect(this.onOutputsChange,this)}get type(){return"code"}get executionCount(){return this.sharedModel.execution_count||null}set executionCount(e){this.sharedModel.execution_count=e||null}get isDirty(){return this._isDirty}get outputs(){return this._outputs}clearExecution(){this.outputs.clear();this.executionCount=null;this._setDirty(false);this.sharedModel.deleteMetadata("execution");this.trusted=true}dispose(){if(this.isDisposed){return}this.sharedModel.changed.disconnect(this._onSharedModelChanged,this);this._outputs.changed.disconnect(this.onGenericChange,this);this._outputs.changed.disconnect(this.onOutputsChange,this);this._outputs.dispose();this._outputs=null;super.dispose()}onTrustedChanged(e,t){const s=t.newValue;if(this._outputs){this._outputs.trusted=s}if(s){const e=this.sharedModel;const t=e.getMetadata();t.trusted=true;e.setMetadata(t)}this.stateChanged.emit({name:"trusted",oldValue:t.oldValue,newValue:s})}toJSON(){return super.toJSON()}onOutputsChange(e,t){const s=this.sharedModel;z((()=>{switch(t.type){case"add":{const e=t.newValues.map((e=>e.toJSON()));s.updateOutputs(t.newIndex,t.newIndex,e);break}case"set":{const e=t.newValues.map((e=>e.toJSON()));s.updateOutputs(t.oldIndex,t.oldIndex+e.length,e);break}case"remove":s.updateOutputs(t.oldIndex,t.oldValues.length);break;default:throw new Error(`Invalid event type: ${t.type}`)}}))}_onSharedModelChanged(e,t){super._onSharedModelChanged(e,t);if(t.outputsChange){z((()=>{this.outputs.clear();e.getOutputs().forEach((e=>this._outputs.add(e)))}))}if(t.executionCountChange){if(t.executionCountChange.newValue&&(this.isDirty||!t.executionCountChange.oldValue)){this._setDirty(false)}this.stateChanged.emit({name:"executionCount",oldValue:t.executionCountChange.oldValue,newValue:t.executionCountChange.newValue})}if(t.sourceChange&&this.executionCount!==null){this._setDirty(this._executedCode!==this.sharedModel.getSource().trim())}}_setDirty(e){if(!e){this._executedCode=this.sharedModel.getSource().trim()}if(e!==this._isDirty){this._isDirty=e;this.stateChanged.emit({name:"isDirty",oldValue:!e,newValue:e})}}}(function(e){class t{createOutputArea(e){return new R.OutputAreaModel(e)}}e.ContentFactory=t;e.defaultContentFactory=new t})(X||(X={}));var K=s(50724);const Y="jp-Placeholder";const Z="jp-Placeholder-prompt jp-InputPrompt";const ee="jp-Placeholder-prompt jp-OutputPrompt";const te="jp-Placeholder-content";const se="jp-InputPlaceholder";const ie="jp-OutputPlaceholder";class ne extends w.Widget{constructor(e){var t,s,i;const n=document.createElement("div");super({node:n});const o=((t=e.translator)!==null&&t!==void 0?t:K.nullTranslator).load("jupyterlab");const r=document.createElement("div");r.className=(s=e.promptClass)!==null&&s!==void 0?s:"";n.insertAdjacentHTML("afterbegin",r.outerHTML);this._cell=document.createElement("div");this._cell.classList.add(te);this._cell.title=o.__("Click to expand");const a=this._cell.appendChild(document.createElement("div"));a.classList.add("jp-Placeholder-contentContainer");this._textContent=a.appendChild(document.createElement("span"));this._textContent.className="jp-PlaceholderText";this._textContent.innerText=(i=e.text)!==null&&i!==void 0?i:"";n.appendChild(this._cell);u.ellipsesIcon.element({container:a.appendChild(document.createElement("span")),className:"jp-MoreHorizIcon",elementPosition:"center",height:"auto",width:"32px"});this.addClass(Y);this._callback=e.callback}set text(e){this._textContent.innerText=e}get text(){return this._textContent.innerText}onAfterAttach(e){super.onAfterAttach(e);this.node.addEventListener("click",this._callback)}onBeforeDetach(e){this.node.removeEventListener("click",this._callback);super.onBeforeDetach(e)}}class oe extends ne{constructor(e){super({...e,promptClass:Z});this.addClass(se)}}class re extends ne{constructor(e){super({...e,promptClass:ee});this.addClass(ie)}}var ae=s(1458);var de=s(78098);var le=s(80379);const he="jp-mod-selected";class ue extends ae.EditorSearchProvider{constructor(e){super();this.cell=e;if(!this.cell.inViewport&&!this.cell.editor){void(0,de.signalToPromise)(e.inViewportChanged).then((([,e])=>{if(e){this.cmHandler.setEditor(this.editor)}}))}}get editor(){return this.cell.editor}get model(){return this.cell.model}}class ce extends ue{constructor(e){super(e);this.currentProviderIndex=-1;this.outputsProvider=[];const t=this.cell.outputArea;this._onOutputsChanged(t,t.widgets.length).catch((e=>{console.error(`Failed to initialize search on cell outputs.`,e)}));t.outputLengthChanged.connect(this._onOutputsChanged,this);t.disposed.connect((()=>{t.outputLengthChanged.disconnect(this._onOutputsChanged)}),this)}get matchesCount(){if(!this.isActive){return 0}return super.matchesCount+this.outputsProvider.reduce(((e,t)=>{var s;return e+((s=t.matchesCount)!==null&&s!==void 0?s:0)}),0)}async clearHighlight(){await super.clearHighlight();await Promise.all(this.outputsProvider.map((e=>e.clearHighlight())))}dispose(){if(this.isDisposed){return}super.dispose();this.outputsProvider.map((e=>{e.dispose()}));this.outputsProvider.length=0}async highlightNext(e,t){if(this.matchesCount===0||!this.isActive){this.currentIndex=null}else{if(this.currentProviderIndex===-1){const e=await super.highlightNext(true,t);if(e){this.currentIndex=this.cmHandler.currentIndex;return e}else{this.currentProviderIndex=0}}while(this.currentProviderIndex<this.outputsProvider.length){const e=this.outputsProvider[this.currentProviderIndex];const t=await e.highlightNext(false);if(t){this.currentIndex=super.matchesCount+this.outputsProvider.slice(0,this.currentProviderIndex).reduce(((e,t)=>{var s;return e+=(s=t.matchesCount)!==null&&s!==void 0?s:0}),0)+e.currentMatchIndex;return t}else{this.currentProviderIndex+=1}}this.currentProviderIndex=-1;this.currentIndex=null;return undefined}}async highlightPrevious(){if(this.matchesCount===0||!this.isActive){this.currentIndex=null}else{if(this.currentIndex===null){this.currentProviderIndex=this.outputsProvider.length-1}while(this.currentProviderIndex>=0){const e=this.outputsProvider[this.currentProviderIndex];const t=await e.highlightPrevious(false);if(t){this.currentIndex=super.matchesCount+this.outputsProvider.slice(0,this.currentProviderIndex).reduce(((e,t)=>{var s;return e+=(s=t.matchesCount)!==null&&s!==void 0?s:0}),0)+e.currentMatchIndex;return t}else{this.currentProviderIndex-=1}}const e=await super.highlightPrevious();if(e){this.currentIndex=this.cmHandler.currentIndex;return e}else{this.currentIndex=null;return undefined}}}async startQuery(e,t){await super.startQuery(e,t);if((t===null||t===void 0?void 0:t.output)!==false&&this.isActive){await Promise.all(this.outputsProvider.map((t=>t.startQuery(e))))}}async endQuery(){var e;await super.endQuery();if(((e=this.filters)===null||e===void 0?void 0:e.output)!==false&&this.isActive){await Promise.all(this.outputsProvider.map((e=>e.endQuery())))}}async _onOutputsChanged(e,t){var s;this.outputsProvider.forEach((e=>{e.dispose()}));this.outputsProvider.length=0;this.currentProviderIndex=-1;this.outputsProvider=this.cell.outputArea.widgets.map((e=>new le.GenericSearchProvider(e)));if(this.isActive&&this.query&&((s=this.filters)===null||s===void 0?void 0:s.output)!==false){await Promise.all([this.outputsProvider.map((e=>{void e.startQuery(this.query)}))])}this._stateChanged.emit()}}class pe extends ue{constructor(e){super(e);this._unrenderedByHighlight=false;this.renderedProvider=new le.GenericSearchProvider(e.renderer)}async clearHighlight(){await super.clearHighlight();await this.renderedProvider.clearHighlight()}dispose(){if(this.isDisposed){return}super.dispose();this.renderedProvider.dispose()}async endQuery(){await super.endQuery();await this.renderedProvider.endQuery()}async highlightNext(){let e=undefined;if(!this.isActive){return e}const t=this.cell;if(t.rendered&&this.matchesCount>0){this._unrenderedByHighlight=true;const e=(0,de.signalToPromise)(t.renderedChanged);t.rendered=false;await e}e=await super.highlightNext();return e}async highlightPrevious(){let e=undefined;const t=this.cell;if(t.rendered&&this.matchesCount>0){this._unrenderedByHighlight=true;const e=(0,de.signalToPromise)(t.renderedChanged);t.rendered=false;await e}e=await super.highlightPrevious();return e}async startQuery(e,t){await super.startQuery(e,t);const s=this.cell;if(s.rendered){this.onRenderedChanged(s,s.rendered)}s.renderedChanged.connect(this.onRenderedChanged,this)}async replaceAllMatches(e){const t=await super.replaceAllMatches(e);if(this.cell.rendered){this.cell.update()}return t}onRenderedChanged(e,t){var s;if(!this._unrenderedByHighlight){this.currentIndex=null}this._unrenderedByHighlight=false;if(this.isActive){if(t){void this.renderedProvider.startQuery(this.query)}else{(s=e.editor)===null||s===void 0?void 0:s.setCursorPosition({column:0,line:0});void this.renderedProvider.endQuery()}}}}function ge(e){if(e.isPlaceholder()){return new ue(e)}switch(e.model.type){case"code":return new ce(e);case"markdown":return new pe(e);default:return new ue(e)}}var me=s(5502);var Ce=s(59238);var _e=s(41252);var fe=s(55172);var ve=s(10535);var ye=s(37917);var we=s(65061);const xe="jp-CellResizeHandle";const Me="jp-mod-resizedCell";class be extends w.Widget{constructor(e){super();this.targetNode=e;this._isActive=false;this._isDragging=false;this.sizeChanged=new L.Signal(this);this.addClass(xe);this._resizer=new we.Throttler((e=>this._resize(e)),50)}dispose(){this._resizer.dispose();super.dispose()}handleEvent(e){var t,s;switch(e.type){case"dblclick":(t=this.targetNode.parentNode)===null||t===void 0?void 0:t.childNodes.forEach((e=>{e.classList.remove(Me)}));document.documentElement.style.setProperty("--jp-side-by-side-output-size",`1fr`);this._isActive=false;break;case"mousedown":this._isDragging=true;if(!this._isActive){(s=this.targetNode.parentNode)===null||s===void 0?void 0:s.childNodes.forEach((e=>{e.classList.add(Me)}));this._isActive=true}window.addEventListener("mousemove",this);window.addEventListener("mouseup",this);break;case"mousemove":{if(this._isActive&&this._isDragging){void this._resizer.invoke(e)}break}case"mouseup":this._isDragging=false;window.removeEventListener("mousemove",this);window.removeEventListener("mouseup",this);break;default:break}}onAfterAttach(e){this.node.addEventListener("dblclick",this);this.node.addEventListener("mousedown",this);super.onAfterAttach(e)}onBeforeDetach(e){this.node.removeEventListener("dblclick",this);this.node.removeEventListener("mousedown",this);super.onBeforeDetach(e)}_resize(e){const{width:t,x:s}=this.targetNode.getBoundingClientRect();const i=e.clientX-s;const n=t/i-1;if(0<n){const e=Math.max(Math.min(Math.abs(n),50),.05);document.documentElement.style.setProperty("--jp-side-by-side-output-size",`${e}fr`);this.sizeChanged.emit(e)}}}const Pe="jp-Cell";const Se="jp-Cell-header";const Oe="jp-Cell-footer";const Ae="jp-Cell-inputWrapper";const He="jp-Cell-outputWrapper";const Ee="jp-Cell-inputArea";const Ie="jp-Cell-outputArea";const ke="jp-Cell-inputCollapser";const De="jp-Cell-outputCollapser";const je="jp-mod-dirty";const We="jp-CodeCell";const Ne="jp-MarkdownCell";const Fe="jp-MarkdownOutput";const Le="jp-MarkdownHeadingCollapsed";const Te="jp-collapseHeadingButton";const Re="jp-showHiddenCellsButton";const Ve="jp-RawCell";const ze="jp-mod-rendered";const Be="jp-mod-noOutputs";const Ue="Type Markdown and LaTeX: $ α^2 $";const $e=1e3;const Qe="application/x-jupyter-icontentsrich";class Je extends w.Widget{constructor(e){var t,s,i;super();this.prompt="";this._displayChanged=new L.Signal(this);this._editorConfig={};this._inputHidden=false;this._inViewportChanged=new L.Signal(this);this._readOnly=false;this._ready=new fe.PromiseDelegate;this._resizeDebouncer=new we.Debouncer((()=>{this._displayChanged.emit()}),0);this._syncCollapse=false;this._syncEditable=false;this._collabCache=[];this.addClass(Pe);const n=this._model=e.model;this.contentFactory=e.contentFactory;this.layout=(t=e.layout)!==null&&t!==void 0?t:new w.PanelLayout;this.translator=(s=e.translator)!==null&&s!==void 0?s:K.nullTranslator;this._editorConfig={searchWithCM:false,...e.editorConfig};this._placeholder=true;this._inViewport=false;this.placeholder=(i=e.placeholder)!==null&&i!==void 0?i:true;n.metadataChanged.connect(this.onMetadataChanged,this);n.stateChanged.connect(this.onStateChanged,this)}initializeState(){this.loadCollapseState();this.loadEditableState();return this}get displayChanged(){return this._displayChanged}get inViewport(){return this._inViewport}set inViewport(e){if(this._inViewport!==e){this._inViewport=e;this._inViewportChanged.emit(this._inViewport)}}get inViewportChanged(){return this._inViewportChanged}get placeholder(){return this._placeholder}set placeholder(e){if(this._placeholder!==e&&e===false){this.initializeDOM();this._placeholder=e;this._ready.resolve()}}get promptNode(){if(this.placeholder){return null}if(!this._inputHidden){return this._input.promptNode}else{return this._inputPlaceholder.node.firstElementChild}}get editorWidget(){var e,t;return(t=(e=this._input)===null||e===void 0?void 0:e.editorWidget)!==null&&t!==void 0?t:null}get editor(){var e,t;return(t=(e=this._input)===null||e===void 0?void 0:e.editor)!==null&&t!==void 0?t:null}get editorConfig(){return this._editorConfig}get headings(){return new Array}get model(){return this._model}get inputArea(){return this._input}get readOnly(){return this._readOnly}set readOnly(e){if(e===this._readOnly){return}this._readOnly=e;if(this.syncEditable){this.saveEditableState()}this.update()}isPlaceholder(){return this.placeholder}saveEditableState(){const{sharedModel:e}=this.model;const t=e.getMetadata("editable");if(this.readOnly&&t===false||!this.readOnly&&t===undefined){return}if(this.readOnly){e.setMetadata("editable",false)}else{e.deleteMetadata("editable")}}loadEditableState(){this.readOnly=this.model.sharedModel.getMetadata("editable")===false}get ready(){return this._ready.promise}setPrompt(e){var t;this.prompt=e;(t=this._input)===null||t===void 0?void 0:t.setPrompt(e)}get inputHidden(){return this._inputHidden}set inputHidden(e){var t;if(this._inputHidden===e){return}if(!this.placeholder){const s=this._inputWrapper.layout;if(e){this._input.parent=null;if(this._inputPlaceholder){this._inputPlaceholder.text=(t=this.model.sharedModel.getSource().split("\n"))===null||t===void 0?void 0:t[0]}s.addWidget(this._inputPlaceholder)}else{this._inputPlaceholder.parent=null;s.addWidget(this._input)}}this._inputHidden=e;if(this.syncCollapse){this.saveCollapseState()}this.handleInputHidden(e)}saveCollapseState(){const e={...this.model.getMetadata("jupyter")};if(this.inputHidden&&e.source_hidden===true||!this.inputHidden&&e.source_hidden===undefined){return}if(this.inputHidden){e.source_hidden=true}else{delete e.source_hidden}if(Object.keys(e).length===0){this.model.deleteMetadata("jupyter")}else{this.model.setMetadata("jupyter",e)}}loadCollapseState(){var e;const t=(e=this.model.getMetadata("jupyter"))!==null&&e!==void 0?e:{};this.inputHidden=!!t.source_hidden}handleInputHidden(e){return}get syncCollapse(){return this._syncCollapse}set syncCollapse(e){if(this._syncCollapse===e){return}this._syncCollapse=e;if(e){this.loadCollapseState()}}get syncEditable(){return this._syncEditable}set syncEditable(e){if(this._syncEditable===e){return}this._syncEditable=e;if(e){this.loadEditableState()}}clone(){const e=this.constructor;return new e({model:this.model,contentFactory:this.contentFactory,placeholder:false,translator:this.translator})}dispose(){if(this.isDisposed){return}this._resizeDebouncer.dispose();this._input=null;this._model=null;this._inputWrapper=null;this._inputPlaceholder=null;super.dispose()}onStateChanged(e,t){switch(t.name){case"collaborators":if(this._input){this._input.collaborators=t.newValue}else{this._collabCache=t.newValue}break;default:break}}updateEditorConfig(e){this._editorConfig={...this._editorConfig,...e};if(this.editor){this.editor.setOptions(this._editorConfig)}}initializeDOM(){if(!this.placeholder){return}const e=this.contentFactory;const t=this._model;const s=e.createCellHeader();s.addClass(Se);this.layout.addWidget(s);const i=this._inputWrapper=new w.Panel;i.addClass(Ae);const n=new v;n.addClass(ke);const o=this._input=new W({model:t,contentFactory:e,editorOptions:this.getEditorOptions()});this._input.collaborators=this._collabCache;o.addClass(Ee);i.addWidget(n);i.addWidget(o);this.layout.addWidget(i);this._inputPlaceholder=new oe({callback:()=>{this.inputHidden=!this.inputHidden},text:o.model.sharedModel.getSource().split("\n")[0],translator:this.translator});o.model.contentChanged.connect(((e,t)=>{var s;if(this._inputPlaceholder&&this.inputHidden){this._inputPlaceholder.text=(s=e.sharedModel.getSource().split("\n"))===null||s===void 0?void 0:s[0]}}));if(this.inputHidden){o.parent=null;i.layout.addWidget(this._inputPlaceholder)}const r=this.contentFactory.createCellFooter();r.addClass(Oe);this.layout.addWidget(r)}getEditorOptions(){return{config:this.editorConfig}}onBeforeAttach(e){if(this.placeholder){this.placeholder=false}}onAfterAttach(e){this.update()}onActivateRequest(e){var t;(t=this.editor)===null||t===void 0?void 0:t.focus()}onResize(e){void this._resizeDebouncer.invoke()}onUpdateRequest(e){var t,s;if(!this._model){return}if(((t=this.editor)===null||t===void 0?void 0:t.getOption("readOnly"))!==this._readOnly){(s=this.editor)===null||s===void 0?void 0:s.setOption("readOnly",this._readOnly)}}onContentChanged(){var e;if(this.inputHidden&&this._inputPlaceholder){this._inputPlaceholder.text=(e=this.model.sharedModel.getSource().split("\n"))===null||e===void 0?void 0:e[0]}}onMetadataChanged(e,t){switch(t.key){case"jupyter":if(this.syncCollapse){this.loadCollapseState()}break;case"editable":if(this.syncEditable){this.loadEditableState()}break;default:break}}}(function(e){let t;(function(e){e[e["HTML"]=0]="HTML";e[e["Markdown"]=1]="Markdown"})(t=e.HeadingType||(e.HeadingType={}));class s{constructor(e){this._editorFactory=e.editorFactory}get editorFactory(){return this._editorFactory}createCellHeader(){return new b}createCellFooter(){return new P}createInputPrompt(){return new N}createOutputPrompt(){return new R.OutputPrompt}createStdin(e){return new R.Stdin(e)}}e.ContentFactory=s})(Je||(Je={}));class Ge extends w.PanelLayout{onBeforeAttach(e){let t=true;const s=this.parent.node.firstElementChild;for(const i of this){if(s){if(i.node===s){t=false}else{ye.MessageLoop.sendMessage(i,e);if(t){this.parent.node.insertBefore(i.node,s)}else{this.parent.node.appendChild(i.node)}if(!this.parent.isHidden){i.setFlag(w.Widget.Flag.IsVisible)}ye.MessageLoop.sendMessage(i,w.Widget.Msg.AfterAttach)}}}}onAfterDetach(e){for(const t of this){if(!t.hasClass(He)&&t.node.isConnected){ye.MessageLoop.sendMessage(t,w.Widget.Msg.BeforeDetach);this.parent.node.removeChild(t.node);ye.MessageLoop.sendMessage(t,e)}}}}class qe extends Je{constructor(e){var t;super({layout:new Ge,...e,placeholder:true});this._headingsCache=null;this._outputHidden=false;this._outputWrapper=null;this._outputPlaceholder=null;this._syncScrolled=false;this.addClass(We);const s=this.translator.load("jupyterlab");const i=this._rendermime=e.rendermime;const n=this.contentFactory;const o=this.model;this.maxNumberOutputs=e.maxNumberOutputs;const r=o.outputs.length===0?s.__("Code Cell Content"):s.__("Code Cell Content with Output");this.node.setAttribute("aria-label",r);const a=this._output=new R.OutputArea({model:this.model.outputs,rendermime:i,contentFactory:n,maxNumberOutputs:this.maxNumberOutputs,translator:this.translator,promptOverlay:true,inputHistoryScope:e.inputHistoryScope});a.addClass(Ie);a.toggleScrolling.connect((()=>{this.outputsScrolled=!this.outputsScrolled}));a.initialize.connect((()=>{this.updatePromptOverlayIcon()}));this.placeholder=(t=e.placeholder)!==null&&t!==void 0?t:true;o.outputs.changed.connect(this.onOutputChanged,this);o.outputs.stateChanged.connect(this.onOutputChanged,this)}initializeDOM(){if(!this.placeholder){return}super.initializeDOM();this.setPrompt(this.prompt);const e=this._outputWrapper=new w.Panel;e.addClass(He);const t=new y;t.addClass(De);e.addWidget(t);if(this.model.outputs.length===0){this.addClass(Be)}this._output.outputLengthChanged.connect(this._outputLengthHandler,this);e.addWidget(this._output);const s=this.layout;const i=new be(this.node);i.sizeChanged.connect(this._sizeChangedHandler,this);s.insertWidget(s.widgets.length-1,i);s.insertWidget(s.widgets.length-1,e);if(this.model.isDirty){this.addClass(je)}this._outputPlaceholder=new re({callback:()=>{this.outputHidden=!this.outputHidden},text:this.getOutputPlaceholderText(),translator:this.translator});const n=e.layout;if(this.outputHidden){n.removeWidget(this._output);n.addWidget(this._outputPlaceholder);if(this.inputHidden&&!e.isHidden){this._outputWrapper.hide()}}const o=this.translator.load("jupyterlab");const r=this.model.outputs.length===0?o.__("Code Cell Content"):o.__("Code Cell Content with Output");this.node.setAttribute("aria-label",r)}getOutputPlaceholderText(){var e;const t=this.model.outputs.get(0);const s=t===null||t===void 0?void 0:t.data;if(!s){return undefined}const i=["text/html","image/svg+xml","application/pdf","text/markdown","text/plain","application/vnd.jupyter.stderr","application/vnd.jupyter.stdout","text"];const n=i.find((e=>{const s=t.data[e];return(Array.isArray(s)?typeof s[0]:typeof s)==="string"}));const o=t.data[n!==null&&n!==void 0?n:""];if(o!==undefined){return(e=Array.isArray(o)?o:o===null||o===void 0?void 0:o.split("\n"))===null||e===void 0?void 0:e.find((e=>e!==""))}return undefined}initializeState(){super.initializeState();this.loadScrolledState();this.setPrompt(`${this.model.executionCount||""}`);return this}get headings(){if(!this._headingsCache){const e=[];const t=this.model.outputs;for(let s=0;s<t.length;s++){const i=t.get(s);let n=null;let o=null;Object.keys(i.data).forEach((e=>{if(!o&&_e.TableOfContentsUtils.Markdown.isMarkdown(e)){o=e}else if(!n&&_e.TableOfContentsUtils.isHTML(e)){n=e}}));if(n){e.push(..._e.TableOfContentsUtils.getHTMLHeadings(this._rendermime.sanitizer.sanitize(i.data[n])).map((e=>({...e,outputIndex:s,type:Je.HeadingType.HTML}))))}else if(o){e.push(..._e.TableOfContentsUtils.Markdown.getHeadings(i.data[o]).map((e=>({...e,outputIndex:s,type:Je.HeadingType.Markdown}))))}}this._headingsCache=e}return[...this._headingsCache]}get outputArea(){return this._output}get outputHidden(){return this._outputHidden}set outputHidden(e){var t;if(this._outputHidden===e){return}if(!this.placeholder){const s=this._outputWrapper.layout;if(e){s.removeWidget(this._output);s.addWidget(this._outputPlaceholder);if(this.inputHidden&&!this._outputWrapper.isHidden){this._outputWrapper.hide()}if(this._outputPlaceholder){this._outputPlaceholder.text=(t=this.getOutputPlaceholderText())!==null&&t!==void 0?t:""}}else{if(this._outputWrapper.isHidden){this._outputWrapper.show()}s.removeWidget(this._outputPlaceholder);s.addWidget(this._output)}}this._outputHidden=e;if(this.syncCollapse){this.saveCollapseState()}}saveCollapseState(){this.model.sharedModel.transact((()=>{super.saveCollapseState();const e=this.model.getMetadata("collapsed");if(this.outputHidden&&e===true||!this.outputHidden&&e===undefined){return}if(this.outputHidden){this.model.setMetadata("collapsed",true)}else{this.model.deleteMetadata("collapsed")}}),false)}loadCollapseState(){super.loadCollapseState();this.outputHidden=!!this.model.getMetadata("collapsed")}get outputsScrolled(){return this._outputsScrolled}set outputsScrolled(e){this.toggleClass("jp-mod-outputsScrolled",e);this._outputsScrolled=e;if(this.syncScrolled){this.saveScrolledState()}this.updatePromptOverlayIcon()}updatePromptOverlayIcon(){var e;const t=O.DOMUtils.findElement(this.node,"jp-OutputArea-promptOverlay");if(!t){return}const s=16+4+4;if(t.clientHeight<=s){(e=t.firstChild)===null||e===void 0?void 0:e.remove();return}let i;if(this._outputsScrolled){u.expandIcon.element({container:t});i="Expand Output"}else{u.collapseIcon.element({container:t});i="Collapse Output"}const n=this.translator.load("jupyterlab");t.title=n.__(i)}saveScrolledState(){const e=this.model.getMetadata("scrolled");if(this.outputsScrolled&&e===true||!this.outputsScrolled&&e===undefined){return}if(this.outputsScrolled){this.model.setMetadata("scrolled",true)}else{this.model.deleteMetadata("scrolled")}}loadScrolledState(){if(this.model.getMetadata("scrolled")==="auto"){this.outputsScrolled=false}else{this.outputsScrolled=!!this.model.getMetadata("scrolled")}}get syncScrolled(){return this._syncScrolled}set syncScrolled(e){if(this._syncScrolled===e){return}this._syncScrolled=e;if(e){this.loadScrolledState()}}handleInputHidden(e){if(this.placeholder){return}if(!e&&this._outputWrapper.isHidden){this._outputWrapper.show()}else if(e&&!this._outputWrapper.isHidden&&this._outputHidden){this._outputWrapper.hide()}}clone(){const e=this.constructor;return new e({model:this.model,contentFactory:this.contentFactory,rendermime:this._rendermime,placeholder:false,translator:this.translator})}cloneOutputArea(){return new R.SimplifiedOutputArea({model:this.model.outputs,contentFactory:this.contentFactory,rendermime:this._rendermime})}dispose(){if(this.isDisposed){return}this._output.outputLengthChanged.disconnect(this._outputLengthHandler,this);this._rendermime=null;this._output=null;this._outputWrapper=null;this._outputPlaceholder=null;super.dispose()}onStateChanged(e,t){super.onStateChanged(e,t);switch(t.name){case"executionCount":this.setPrompt(`${e.executionCount||""}`);break;case"isDirty":if(e.isDirty){this.addClass(je)}else{this.removeClass(je)}break;default:break}}onOutputChanged(){var e;this._headingsCache=null;if(this._outputPlaceholder&&this.outputHidden){this._outputPlaceholder.text=(e=this.getOutputPlaceholderText())!==null&&e!==void 0?e:""}this.updatePromptOverlayIcon()}onMetadataChanged(e,t){switch(t.key){case"scrolled":if(this.syncScrolled){this.loadScrolledState()}break;case"collapsed":if(this.syncCollapse){this.loadCollapseState()}break;default:break}super.onMetadataChanged(e,t)}_outputLengthHandler(e,t){const s=t===0?true:false;this.toggleClass(Be,s);const i=this.translator.load("jupyterlab");const n=s?i.__("Code Cell Content"):i.__("Code Cell Content with Output");this.node.setAttribute("aria-label",n)}_sizeChangedHandler(e){this._displayChanged.emit()}}(function(e){async function t(e,t,s){var i;const n=e.model;const o=n.sharedModel.getSource();if(!o.trim()||!((i=t.session)===null||i===void 0?void 0:i.kernel)){n.sharedModel.transact((()=>{n.clearExecution()}),false);return}const r={cellId:n.sharedModel.getId()};s={...n.metadata,...s,...r};const{recordTiming:a}=s;n.sharedModel.transact((()=>{n.clearExecution();e.outputHidden=false}),false);e.setPrompt("*");n.trusted=true;let d;try{const i=R.OutputArea.execute(o,e.outputArea,t,s);if(a){const t=e=>{let t;switch(e.header.msg_type){case"status":t=`status.${e.content.execution_state}`;break;case"execute_input":t="execute_input";break;default:return true}const s=e.header.date||(new Date).toISOString();const i=Object.assign({},n.getMetadata("execution"));i[`iopub.${t}`]=s;n.setMetadata("execution",i);return true};e.outputArea.future.registerMessageHook(t)}else{n.deleteMetadata("execution")}d=e.outputArea.future;const r=await i;n.executionCount=r.content.execution_count;if(a){const e=Object.assign({},n.getMetadata("execution"));const t=r.metadata.started;if(t){e["shell.execute_reply.started"]=t}const s=r.header.date;e["shell.execute_reply"]=s||(new Date).toISOString();n.setMetadata("execution",e)}return r}catch(l){if(d&&!e.isDisposed&&e.outputArea.future===d){e.setPrompt("");if(a&&d.isDisposed){const e=Object.assign({},n.getMetadata("execution"));e["execution_failed"]=(new Date).toISOString();n.setMetadata("execution",e)}}throw l}}e.execute=t})(qe||(qe={}));class Xe extends Je{handleEvent(e){switch(e.type){case"lm-dragover":this._evtDragOver(e);break;case"lm-drop":this._evtDrop(e);break;default:break}}getEditorOptions(){var e,t;const s=(e=super.getEditorOptions())!==null&&e!==void 0?e:{};s.extensions=[...(t=s.extensions)!==null&&t!==void 0?t:[],me.EditorView.domEventHandlers({dragenter:e=>{e.preventDefault()},dragover:e=>{e.preventDefault()},drop:e=>{this._evtNativeDrop(e)},paste:e=>{this._evtPaste(e)}})];return s}onAfterAttach(e){super.onAfterAttach(e);const t=this.node;t.addEventListener("lm-dragover",this);t.addEventListener("lm-drop",this)}onBeforeDetach(e){const t=this.node;t.removeEventListener("lm-dragover",this);t.removeEventListener("lm-drop",this);super.onBeforeDetach(e)}_evtDragOver(e){const t=(0,ve.some)(Ce.imageRendererFactory.mimeTypes,(t=>{if(!e.mimeData.hasData(Qe)){return false}const s=e.mimeData.getData(Qe);return s.model.mimetype===t}));if(!t){return}e.preventDefault();e.stopPropagation();e.dropAction=e.proposedAction}_evtPaste(e){if(e.clipboardData){const t=e.clipboardData.items;for(let s=0;s<t.length;s++){if(t[s].type==="text/plain"){if(s<t.length-1&&t[s+1].kind==="file"){continue}t[s].getAsString((e=>{var t,s;(s=(t=this.editor).replaceSelection)===null||s===void 0?void 0:s.call(t,e)}))}this._attachFiles(e.clipboardData.items)}}e.preventDefault()}_evtNativeDrop(e){if(e.dataTransfer){this._attachFiles(e.dataTransfer.items)}e.preventDefault()}_evtDrop(e){const t=e.mimeData.types().filter((t=>{if(t===Qe){const t=e.mimeData.getData(Qe);return Ce.imageRendererFactory.mimeTypes.indexOf(t.model.mimetype)!==-1}return Ce.imageRendererFactory.mimeTypes.indexOf(t)!==-1}));if(t.length===0){return}e.preventDefault();e.stopPropagation();if(e.proposedAction==="none"){e.dropAction="none";return}e.dropAction="copy";for(const s of t){if(s===Qe){const{model:t,withContent:s}=e.mimeData.getData(Qe);if(t.type==="file"){const e=this._generateURI(t.name);this.updateCellSourceWithAttachment(t.name,e);void s().then((t=>{this.model.attachments.set(e,{[t.mimetype]:t.content})}))}}else{const t=this._generateURI();this.model.attachments.set(t,{[s]:e.mimeData.getData(s)});this.updateCellSourceWithAttachment(t,t)}}}_attachFiles(e){for(let t=0;t<e.length;t++){const s=e[t];if(s.kind==="file"){const e=s.getAsFile();if(e){this._attachFile(e)}}}}_attachFile(e){const t=new FileReader;t.onload=s=>{const{href:i,protocol:n}=de.URLExt.parse(t.result);if(n!=="data:"){return}const o=/([\w+\/\+]+)?(?:;(charset=[\w\d-]*|base64))?,(.*)/;const r=o.exec(i);if(!r||r.length!==4){return}const a=r[1];const d=r[3];const l={[a]:d};const h=this._generateURI(e.name);if(a.startsWith("image/")){this.model.attachments.set(h,l);this.updateCellSourceWithAttachment(e.name,h)}};t.onerror=t=>{console.error(`Failed to attach ${e.name}`+t)};t.readAsDataURL(e)}_generateURI(e=""){const t=e.lastIndexOf(".");return t!==-1?fe.UUID.uuid4().concat(e.substring(t)):fe.UUID.uuid4()}}class Ke extends Xe{constructor(e){var t,s,i,n;super({...e,placeholder:true});this._headingsCache=null;this._headingCollapsedChanged=new L.Signal(this);this._prevText="";this._rendered=true;this._renderedChanged=new L.Signal(this);this._showEditorForReadOnlyMarkdown=true;this.addClass(Ne);this.model.contentChanged.connect(this.onContentChanged,this);const o=this.translator.load("jupyterlab");this.node.setAttribute("aria-label",o.__("Markdown Cell Content"));this._rendermime=e.rendermime.clone({resolver:new T.AttachmentsResolver({parent:(t=e.rendermime.resolver)!==null&&t!==void 0?t:undefined,model:this.model.attachments})});this._renderer=this._rendermime.createRenderer("text/markdown");this._renderer.addClass(Fe);this._headingCollapsed=(s=this.model.getMetadata(Le))!==null&&s!==void 0?s:false;this._showEditorForReadOnlyMarkdown=(i=e.showEditorForReadOnlyMarkdown)!==null&&i!==void 0?i:Ke.defaultShowEditorForReadOnlyMarkdown;this.placeholder=(n=e.placeholder)!==null&&n!==void 0?n:true;this._monitor=new de.ActivityMonitor({signal:this.model.contentChanged,timeout:$e});this.ready.then((()=>{if(this.isDisposed){return}this._monitor.activityStopped.connect((()=>{if(this._rendered){this.update()}}),this)})).catch((e=>{console.error("Failed to be ready",e)}))}get headingInfo(){const e=this.headings;if(e.length>0){const{text:t,level:s}=e.reduce(((e,t)=>e.level<=t.level?e:t),e[0]);return{text:t,level:s}}else{return{text:"",level:-1}}}get headings(){if(!this._headingsCache){const e=_e.TableOfContentsUtils.Markdown.getHeadings(this.model.sharedModel.getSource());this._headingsCache=e.map((e=>({...e,type:Je.HeadingType.Markdown})))}return[...this._headingsCache]}get headingCollapsed(){return this._headingCollapsed}set headingCollapsed(e){var t;if(this._headingCollapsed!==e){this._headingCollapsed=e;if(e){this.model.setMetadata(Le,e)}else if(this.model.getMetadata(Le)!=="undefined"){this.model.deleteMetadata(Le)}const s=(t=this.inputArea)===null||t===void 0?void 0:t.promptNode.getElementsByClassName(Te)[0];if(s){if(e){s.classList.add("jp-mod-collapsed")}else{s.classList.remove("jp-mod-collapsed")}}this.renderCollapseButtons(this._renderer);this._headingCollapsedChanged.emit(this._headingCollapsed)}}get numberChildNodes(){return this._numberChildNodes}set numberChildNodes(e){this._numberChildNodes=e;this.renderCollapseButtons(this._renderer)}get headingCollapsedChanged(){return this._headingCollapsedChanged}get rendered(){return this._rendered}set rendered(e){if(this.readOnly&&this._showEditorForReadOnlyMarkdown===false){e=true}if(e===this._rendered){return}this._rendered=e;this._handleRendered().then((()=>{this._displayChanged.emit();this._renderedChanged.emit(this._rendered)})).catch((e=>{console.error("Failed to render",e)}))}get renderedChanged(){return this._renderedChanged}get showEditorForReadOnly(){return this._showEditorForReadOnlyMarkdown}set showEditorForReadOnly(e){this._showEditorForReadOnlyMarkdown=e;if(e===false){this.rendered=true}}get renderer(){return this._renderer}dispose(){if(this.isDisposed){return}this._monitor.dispose();super.dispose()}initializeDOM(){if(!this.placeholder){return}super.initializeDOM();this.renderCollapseButtons(this._renderer);this._handleRendered().catch((e=>{console.error("Failed to render",e)}))}maybeCreateCollapseButton(){var e;const{level:t}=this.headingInfo;if(t>0&&((e=this.inputArea)===null||e===void 0?void 0:e.promptNode.getElementsByClassName(Te).length)==0){let e=this.inputArea.promptNode.appendChild(document.createElement("button"));e.className=`jp-Button ${Te}`;e.setAttribute("data-heading-level",t.toString());if(this._headingCollapsed){e.classList.add("jp-mod-collapsed")}else{e.classList.remove("jp-mod-collapsed")}e.onclick=e=>{this.headingCollapsed=!this.headingCollapsed}}}maybeCreateOrUpdateExpandButton(){const e=this.node.getElementsByClassName(Re);let t=this.translator.load("jupyterlab");let s=t._n("%1 cell hidden","%1 cells hidden",this._numberChildNodes);let i=this.headingCollapsed&&this._numberChildNodes>0&&e.length==0;if(i){const e=document.createElement("button");e.className=`jp-mod-minimal jp-Button ${Re}`;u.addIcon.render(e);const t=document.createElement("div");t.textContent=s;e.appendChild(t);e.onclick=()=>{this.headingCollapsed=false};this.node.appendChild(e)}let n=this.headingCollapsed&&this._numberChildNodes>0&&e.length==1;if(n){e[0].childNodes[1].textContent=s}let o=!(this.headingCollapsed&&this._numberChildNodes>0);if(o){for(const t of e){this.node.removeChild(t)}}}onContentChanged(){super.onContentChanged();this._headingsCache=null}renderCollapseButtons(e){this.node.classList.toggle(Le,this._headingCollapsed);this.maybeCreateCollapseButton();this.maybeCreateOrUpdateExpandButton()}renderInput(e){this.addClass(ze);if(!this.placeholder&&!this.isDisposed){this.renderCollapseButtons(e);this.inputArea.renderInput(e)}}showEditor(){this.removeClass(ze);if(!this.placeholder&&!this.isDisposed){this.inputArea.showEditor();let e=(this.model.sharedModel.getSource().match(/^#+/g)||[""])[0].length;if(e>0){this.inputArea.editor.setCursorPosition({column:e+1,line:0},{scroll:false})}}}onUpdateRequest(e){this._handleRendered().catch((e=>{console.error("Failed to render",e)}));super.onUpdateRequest(e)}updateCellSourceWithAttachment(e,t){var s,i;const n=`![${e}](attachment:${t!==null&&t!==void 0?t:e})`;(i=(s=this.editor)===null||s===void 0?void 0:s.replaceSelection)===null||i===void 0?void 0:i.call(s,n)}async _handleRendered(){if(!this._rendered){this.showEditor()}else{await this._updateRenderedInput();if(this._rendered){this.renderInput(this._renderer)}}}_updateRenderedInput(){if(this.placeholder){return Promise.resolve()}const e=this.model;const t=e&&e.sharedModel.getSource()||Ue;if(t!==this._prevText){const e=new Ce.MimeModel({data:{"text/markdown":t}});this._prevText=t;return this._renderer.renderModel(e)}return Promise.resolve()}clone(){const e=this.constructor;return new e({model:this.model,contentFactory:this.contentFactory,rendermime:this._rendermime,placeholder:false,translator:this.translator})}}(function(e){e.defaultShowEditorForReadOnlyMarkdown=true})(Ke||(Ke={}));class Ye extends Je{constructor(e){super(e);this.addClass(Ve);const t=this.translator.load("jupyterlab");this.node.setAttribute("aria-label",t.__("Raw Cell Content"))}clone(){const e=this.constructor;return new e({model:this.model,contentFactory:this.contentFactory,placeholder:false,translator:this.translator})}}}}]);
//# sourceMappingURL=2072.147dabf639bf9e02766b.js.map?v=147dabf639bf9e02766b